-- MariaDB dump 10.17  Distrib 10.5.3-MariaDB, for Linux (x86_64)
--
-- Host: localhost    Database: elapse
-- ------------------------------------------------------
-- Server version	10.5.3-MariaDB

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `admins`
--

DROP TABLE IF EXISTS `admins`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `admins` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `username` varchar(16) NOT NULL COMMENT '登录名',
  `password` varchar(40) NOT NULL,
  `salt` char(10) DEFAULT NULL COMMENT '混淆码',
  `email` varchar(100) NOT NULL COMMENT '邮箱',
  `mobile` char(11) DEFAULT NULL COMMENT '手机号码',
  `role` smallint(5) unsigned DEFAULT NULL COMMENT '角色',
  `status` bigint(20) DEFAULT 0 COMMENT '0=正常，其它（1=永久冻结，冻结时间）不可登录	',
  `create_time` datetime NOT NULL DEFAULT current_timestamp() COMMENT '创建时间',
  `last_login` bigint(20) DEFAULT NULL COMMENT '最后登录时间',
  PRIMARY KEY (`id`),
  UNIQUE KEY `username` (`username`),
  KEY `group` (`role`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 COMMENT='后台用户表';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `admins`
--

LOCK TABLES `admins` WRITE;
/*!40000 ALTER TABLE `admins` DISABLE KEYS */;
INSERT INTO `admins` VALUES (1,'fortune','c2a3b691ee173bbaee19a5d6aae8c995507fa706','25ee364a54','luck@fmail.pro','13428122341',1,0,'2008-08-18 18:58:13',1614241128);
/*!40000 ALTER TABLE `admins` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `article`
--

DROP TABLE IF EXISTS `article`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `article` (
  `id` tinyint(20) NOT NULL AUTO_INCREMENT COMMENT '文章ID',
  `title` varchar(50) NOT NULL COMMENT '标题',
  `cover` varchar(255) DEFAULT NULL COMMENT '列表封面图',
  `summary` varchar(255) DEFAULT NULL COMMENT '文章摘要',
  `seo_title` varchar(255) DEFAULT NULL COMMENT 'SEO标题',
  `seo_keywords` varchar(255) DEFAULT NULL COMMENT 'SEO关键词',
  `seo_description` varchar(255) DEFAULT NULL COMMENT 'SEO描述',
  `content_id` int(50) NOT NULL COMMENT '内容ID',
  `category_id` int(50) DEFAULT NULL COMMENT '文章分类ID',
  `category` varchar(20) DEFAULT NULL COMMENT '分类名，对应article_category表',
  `columns_id` int(50) NOT NULL DEFAULT 0 COMMENT '专栏ID，0不属于任何专栏',
  `available` smallint(6) DEFAULT 0 COMMENT '阅读权限：0免费、1登录、2私密',
  `nav_id` tinyint(20) DEFAULT NULL COMMENT '所属导航栏',
  `visit` int(11) NOT NULL DEFAULT 0 COMMENT '阅读次数',
  `collect` int(11) NOT NULL DEFAULT 0 COMMENT '收藏次数',
  `share` int(11) NOT NULL DEFAULT 0 COMMENT '分享次数',
  `user_id` tinyint(20) DEFAULT NULL COMMENT '文章发表用户ID',
  `username` varchar(50) DEFAULT NULL COMMENT '展示文章发表人',
  `create` bigint(20) DEFAULT NULL COMMENT '创建时间( Unix 时间戳)',
  `last_time` datetime DEFAULT NULL ON UPDATE current_timestamp() COMMENT '最后修改时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=43 DEFAULT CHARSET=utf8 COMMENT='文章表';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `article`
--

LOCK TABLES `article` WRITE;
/*!40000 ALTER TABLE `article` DISABLE KEYS */;
INSERT INTO `article` VALUES (1,'Linux VPS初始化配置',NULL,'拿到一台新的Linux服务器，我们应该怎么做呢？立马安装LANP或LNMP，服务器管理初始化有门道…         ','dds','ddd','adssd',1,0,'',0,1,NULL,0,0,0,1,'',NULL,'2021-02-25 05:51:44'),(2,'Linux挂载新硬盘',NULL,'现在很多云商家所给的Linux都把数据盘和系统分开来，所以在Linux下挂载硬盘就成了大家必修课… ','','','',2,0,'Linux',0,2,NULL,0,0,0,2,'',NULL,'2021-02-08 07:05:59'),(3,'MariaDB源码编绎安装',NULL,'MariaDB(Mysql重要开源分支)，现在大多数Linux默认安装MariaDB而非MySql，所以未来必定是以MariaDB为主！！','mysql主从配置','mysql主从配置','mysql主从配置',3,0,'',0,0,NULL,0,0,0,2,NULL,NULL,'2018-11-06 14:02:23'),(4,'MySql源码安装（mysql 5.7.6版本及以前方法）',NULL,'MySql源码编译安装（mysql 5.7.6）',NULL,NULL,NULL,4,NULL,'MariaDB',0,0,NULL,0,0,0,2,NULL,NULL,'2017-10-14 11:12:55'),(5,'VPN服务器之L2TPIPSec搭建',NULL,'生活在天朝，对整个网络实行了闭关锁国的政策，让我们这些天朝的屁民们都接触不到外面的世界！！唯有拥有一个自己的VPN才能翻墙看看外面的世界，这就是成语“一枝红杳出墙来”',NULL,NULL,NULL,5,NULL,'Linux',0,0,NULL,0,0,0,2,NULL,NULL,'2017-10-15 17:02:35'),(6,'phpMyAdmin连接管理多台MySQL',NULL,'配置phpMyAdmin下拉选择多台Mysql数据库，这样不用切换数据库连接时每次都要打密码 ','phpMyAdmin连接管理多台MySQL','phpMyAdmin连接管理多台MySQL','phpMyAdmin连接管理多台MySQL',6,0,'',0,0,NULL,0,0,0,2,'',NULL,'2020-06-30 16:32:45'),(7,'服务器带宽选择（1M带宽同时能承受多少人在线）',NULL,'在选购主机时会面对一个问题，带宽1M到底能容纳多少人呢?“共享宽带”和“独享宽带”到底选择哪个才好呢？',NULL,NULL,NULL,7,NULL,'Linux',0,0,NULL,0,0,0,2,NULL,NULL,'2017-10-18 11:04:29'),(8,'Git日常使用',NULL,'Git最近流行起来了，很多公司平时开发就直接用GIT作为版本管理工具了，不再像以前只有SVN来管理代码和多人协作开发！！所以问题来了，我们必须学会Git的简单使用……     ','','','',8,0,'Git',0,0,NULL,0,0,0,2,'',NULL,'2021-02-02 10:28:43'),(9,'连接VPN出错“ L2TP连接尝试失败 ，因为安全层在初始化与远程计算机的协商时遇到了一个处理错误',NULL,'重新安半Windows10，连接VPN时出错“ L2TP连接尝试失败:ERROR因为安全层在初始化与远程计算机的协商时遇到了一个处理错误”，真心累，为了能用Google,而不用国内的X度，所以折腾……',NULL,NULL,NULL,9,NULL,'VPN',0,0,NULL,0,0,0,2,NULL,NULL,'2017-10-22 12:15:40'),(10,'源码编译安装Nginx与PHP ',NULL,'做为PHP的服务器环境很多人选择LAMP，但是在性能上还是LNMP略胜一筹！所以本站的环境是选择了LNMP（Linux+Nginx+PHP），于是就开始源码编译安装Nginx与PHP ',NULL,NULL,NULL,10,NULL,'Linux',0,0,NULL,0,0,0,2,NULL,NULL,'2017-10-28 17:03:31'),(11,'SVN(subversion)服务器搭建及配置 ',NULL,'SVN(subversion)服务器源码编译其实也挺简单的，最重要的是要配置服务端钩子自动更新，这样在测试服中就可以直接SVN更新的代码在WEB中体现出来！当然罗，生产环境不推荐直接用SVN的勾子自动更新代码！但相对来说本站（技术派）这种小型的技术分享网，还是直接用勾子更新代码更为方便些',NULL,NULL,NULL,11,NULL,'svn',0,0,NULL,0,0,0,2,NULL,NULL,NULL),(12,'SSH2设置SOCKS5代理实现科学上网',NULL,'为了实现科学上网（可以用谷歌，可以看facebook,可以随意看外国视频），很多同学又架设ss，又架设VPN等一系列设置，把菜鸟一下子就吓得更菜了，看来科学上网这只鸡不是谁都能吃的？？其实错了，只需要一个很简单的SOCKS5代理就可以直接吃鸡（科学上网）啦！！！','SOCKS5代理上谷歌','SOCKS5代理上谷歌','SOCKS5代理上谷歌',13,0,'',0,0,NULL,0,0,0,2,NULL,NULL,'2019-10-09 18:24:30'),(13,'升级Windows10 Build 17074后VMware Workstation运行出错“与De',NULL,'今天蛋疼外加无聊，就升级Windows10到开发版Build 17074，没想到虚拟机出错（VMware Workstation 与 Device/Credential Guard 不兼容。在禁用 Device/Credential Guard 后，可以运行 VMware Workstation。有关更多详细信息，请访问http://www.vmware.com/go/turnoff_CG_DG。）',NULL,NULL,NULL,14,NULL,'windwos',0,0,NULL,0,0,0,2,NULL,NULL,'2018-01-22 11:58:00'),(14,'风创未来----资金短缺',NULL,'气冲冲从工商局回来后，坐电脑前，想起了这个月公司的社保还没扣缴。上电子税务局，直接选择社保申报，飞快点到扣缴费...','风创未来 小说','风创未来创业故事','风创未来创始人奋斗故事',15,0,'',0,0,NULL,0,0,0,1,'luck',1539704692,'2018-10-17 01:06:19'),(15,'Linux开机自动启动（适用于Debina、Ubuntu）',NULL,'很多时候，自己源码编译的软件都想设置为开机自动启动，免得机器不小心重启后还要手动去开启服务；特别是mysql、PHP、 Nginx等；','Linux开机自动启动（适用于Debina、Ubuntu）','Linux开机自动启动;Debina开机自动启动;Ubuntu开机自动启动;','Linux开机自动启动（适用于Debina、Ubuntu）',16,0,'',0,0,NULL,0,0,0,1,'蜜蜂Linux',1540521595,'2018-10-26 10:41:50'),(16,'都在一条船上',NULL,'收到140万元赞赏网络爆文，但7月24日下午，文章发布平台“张凯律师”一号已因被投诉，涉嫌违反《即时通信工具公众信息服务发展管理暂行规定》被屏蔽所有功能。但这么好的文章不应该沉没，特别转发、留存、欣赏。虽然文章笔记很差，但是说的很事实，大家自己观看，自己觉得是真还是假！不管你信不信，反正我是信了！！！ ','假疫苗事件，都在一条船上－－张凯律师','假疫苗事件;都在一条船上;张凯律师;地沟油;','假疫苗事件;都在一条船上;张凯律师，出处：http://blog.sina.com.cn/s/blog_13f88c2ed0102yq5w.html　假疫苗事件;都在一条船上;张凯律师;地沟油;\"皮革奶\"风波;\"三聚氰胺\"事件;三聚氰胺;疫苗问题;长生生物;\r\n上联：满朝文武藏绿卡，下联： 半壁江山养红颜，横批：颜色革命',17,0,'',0,1,NULL,0,0,0,1,'张凯律师',1542695844,'2018-11-20 15:28:44'),(17,'Flutter象棋：1.开发环境',NULL,'无论做什么，都要先准备好工具，这样子才能做到事半功倍的效率。同样用Flutter开发象棋APP也是先弄好Flutter的开发环境！                       ','Flutter象棋','Flutter象棋','Flutter象棋',22,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598071511,'2021-02-04 06:28:04'),(18,'Flutter象棋：2.绘制棋盘',NULL,'Flutter绘制棋盘      ','','','',23,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598152821,'2020-08-23 07:18:00'),(19,'Flutter象棋：3.绘制棋子',NULL,'           ','','','',24,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598172925,'2020-08-25 03:06:19'),(20,'Flutter象棋：4.处理行棋',NULL,'        ','','','',25,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598321032,'2020-08-25 08:33:16'),(21,'Flutter象棋：5.添加基本界面',NULL,'     ','Flutter象棋','Flutter象棋','',26,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598360751,'2020-08-26 16:26:32'),(22,'Flutter象棋：6.使用象棋云库',NULL,'  ','','','',27,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598492904,'2020-08-28 02:57:47'),(23,'Flutter象棋：7.象棋着法检测',NULL,'    ','','','',28,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598580359,'2020-08-28 13:13:56'),(24,'Flutter象棋：8.实现胜负逻辑',NULL,' ','','','',29,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598691721,'2020-08-30 03:01:53'),(25,'Flutter象棋：9.添加声音动画',NULL,'           ','','','',30,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598753895,'2020-08-30 09:57:54'),(26,'Flutter象棋：10.记谱悔棋功能',NULL,'     ','','','',31,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1598890625,'2020-09-04 17:11:31'),(27,'Flutter象棋：11.云库局面分析',NULL,'   ','','','',32,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1599368603,'2020-09-07 11:35:54'),(28,'Flutter象棋：12.游戏设置',NULL,'    ','','','',33,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1599474765,'2020-09-07 12:51:59'),(29,'Flutter象棋：13.打包上架',NULL,NULL,NULL,NULL,NULL,34,3,'Flutter',1,0,NULL,0,0,0,1,'临来笑笑生',1599480639,NULL),(30,'中国象棋通用引擎协议 UCCI',NULL,NULL,NULL,NULL,NULL,35,NULL,NULL,0,0,NULL,0,0,0,1,'临来笑笑生',1599481572,NULL),(31,'中国象棋游戏规范',NULL,NULL,NULL,NULL,NULL,36,NULL,NULL,0,0,NULL,0,0,0,1,'临来笑笑生',1599481801,NULL),(32,'中国象棋FEN局面表示',NULL,' ','','','',37,0,'',0,0,NULL,0,0,0,1,'临来笑笑生',1599482191,'2020-09-18 15:29:54'),(33,'Xubuntu断电后重启，提示Read-only file system',NULL,NULL,NULL,NULL,NULL,38,NULL,NULL,0,0,NULL,0,0,0,1,'fortune',1600929348,NULL),(34,'XUbuntu修改双显示器分辨率',NULL,'为了利用上闲置的一台显示器,多买了一条5块钱(最便宜)的VGA线,连接上我的电脑,没想到第二显示器只有一个很小的分辨率(640*480),着实让人接受不了,然后就有了此文!     ','','XUbuntu修改双显示器分辨率','XUbuntu修改双显示器分辨率',39,6,'Linux',0,0,NULL,0,0,0,1,'fortune',1602995858,'2020-10-19 05:30:12'),(35,'配置gitlab服务器的hooks钩子实现代码自动部署',NULL,'让GIT服务器可以自动化更新Git的提交到网站目录，从而达到代码自动更新到测试服。    ','gitlab服务器的hooks钩子','gitlab服务器的hooks钩子','gitlab服务器的hooks钩子;配置gitlab服务器的hooks钩子实现代码自动部署',40,6,'Linux',0,0,NULL,0,0,0,1,'fortune',1606793418,'2021-01-27 11:10:18'),(36,'rsync实现linx文件同步',NULL,NULL,NULL,NULL,NULL,41,6,'Linux',0,0,NULL,0,0,0,1,'fortune',1609392979,NULL),(37,'linux实现内网穿透',NULL,NULL,NULL,NULL,NULL,42,NULL,NULL,0,0,NULL,0,0,0,1,'fortune',1609405236,NULL),(38,'linux定时任务crontab',NULL,NULL,NULL,NULL,NULL,43,NULL,NULL,0,0,NULL,0,0,0,1,'fortune',1609486326,NULL),(39,'nginx+php+mysql高并发问题调优',NULL,'高并发下默认的nginx+php+mysql组合，经常出现502，所以做了一次日志排查和调优     ','nginx+php+mysql高并发问题调优','nginx+php+mysql高并发问题调优','nginx+php+mysql高并发问题调优',44,6,'Linux',0,0,NULL,0,0,0,1,'fortune',1610612859,'2021-01-14 11:37:33'),(40,'ubuntu下Fiddler抓包',NULL,'手机APP开发调试，还是要有个抓包工具才方便调试 ','','','',45,0,'',0,0,NULL,0,0,0,1,'fortune',1611196448,'2021-01-21 02:35:02'),(41,'linux使用wine安装微信（其它windows软件同理可安装）',NULL,'  ','','','',46,0,'',0,0,NULL,0,0,0,1,'fortune',1612423258,'2021-02-04 15:41:19'),(42,'Linux(Ubuntu) 安装PostgreSQL',NULL,'用PostgreSQL替代MySql',NULL,'PostgreSQL','PostgreSQL',47,NULL,NULL,0,0,NULL,0,0,0,1,'fortune',1614241232,NULL);
/*!40000 ALTER TABLE `article` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `article_category`
--

DROP TABLE IF EXISTS `article_category`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `article_category` (
  `id` tinyint(20) NOT NULL AUTO_INCREMENT COMMENT '分类ID',
  `category` varchar(20) NOT NULL COMMENT '文章分类名',
  `seo_title` varchar(255) DEFAULT NULL COMMENT 'SEO标题',
  `seo_keywords` varchar(255) DEFAULT NULL COMMENT 'SEO关键词',
  `seo_description` varchar(255) DEFAULT NULL COMMENT 'SEO描述',
  `show` tinyint(1) NOT NULL DEFAULT 1 COMMENT '是否显示：默认1显示，0不显示',
  `order_by` int(1) DEFAULT 1 COMMENT '显示先后:小前大后',
  `modify_id` int(11) unsigned DEFAULT NULL COMMENT '最后修改者ID',
  `modify_time` datetime DEFAULT NULL COMMENT '修改时间',
  `create_id` int(11) unsigned DEFAULT NULL COMMENT '创建者ID',
  `create_time` datetime NOT NULL DEFAULT current_timestamp() COMMENT '创建时间',
  PRIMARY KEY (`id`),
  KEY `category` (`category`)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8 COMMENT='文章分类表';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `article_category`
--

LOCK TABLES `article_category` WRITE;
/*!40000 ALTER TABLE `article_category` DISABLE KEYS */;
INSERT INTO `article_category` VALUES (1,'Rust','rust','rust','rust',1,1,NULL,NULL,NULL,'2020-08-22 04:36:43'),(2,'PHP','PHP','PHP','PHP',1,1,NULL,NULL,NULL,'2020-08-22 04:38:09'),(3,'Flutter','Flutter','Flutter','Flutter',1,1,1,'2020-08-22 11:39:58',1,'2020-06-30 12:36:29'),(6,'Linux','s','s','s',1,1,NULL,NULL,1,'2020-06-30 21:10:55');
/*!40000 ALTER TABLE `article_category` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `article_content`
--

DROP TABLE IF EXISTS `article_content`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `article_content` (
  `id` int(11) NOT NULL AUTO_INCREMENT COMMENT '内容ID',
  `content` text DEFAULT NULL COMMENT '内容',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=48 DEFAULT CHARSET=utf8 COMMENT='文章类内容表';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `article_content`
--

LOCK TABLES `article_content` WRITE;
/*!40000 ALTER TABLE `article_content` DISABLE KEYS */;
INSERT INTO `article_content` VALUES (1,'                                                                                                                                                                                                                                                                                                &nbsp; <br><h5>一、检查硬件及系统</h5>\r\n										<ol>\r\n											<li>查看VPS虚拟架构：</li>\r\n											<pre><code>\r\nroot@Toka:~# dmidecode -t 1\r\n# dmidecode 2.12\r\nSMBIOS 2.4 present.\r\n\r\nHandle 0x0100, DMI type 1, 27 bytes\r\nSystem Information\r\n		Manufacturer: Red Hat\r\n		Product Name: KVM\r\n		Version: RHEL 7.0.0 PC (i440FX + PIIX, 1996)\r\n		Serial Number: Not Specified\r\n		UUID: FA7BF371-7B90-4E7D-9A06-FC98D2FC234F\r\n		Wake-up Type: Power Switch\r\n		SKU Number: Not Specified\r\n		Family: Red Hat Enterprise Linux\r\nroot@Toka:~# 这一台是KVM架构的VPS，还有QEMU、Xen、VMware\r\nroot@Toka:~# 相对来说KVM是比较贵的,也比较稀少,下面这台是QEMU\r\n\r\nroot@Hotf:~# dmidecode -t 1\r\n# dmidecode 2.12\r\nSMBIOS 2.8 present.\r\n\r\nHandle 0x0100, DMI type 1, 27 bytes\r\nSystem Information\r\n        Manufacturer: QEMU\r\n        Product Name: Standard PC (i440FX + PIIX, 1996)\r\n        Version: pc-i440fx-2.1\r\n        Serial Number: 1ecccaa5-3bc5-40cd-b0a5-0066e4de084a\r\n        UUID: 1ECCCAA5-3BC5-40CD-B0A5-0066E4DE084A\r\n        Wake-up Type: Power Switch\r\n        SKU Number: Not Specified\r\n        Family: Not Specified\r\n\r\n											</code></pre>\r\n											<li>查看系统版本：</li> \r\n											<pre><code>\r\nroot@Toka:~# cat /etc/issue\r\nDebian GNU/Linux 9 \\n \\l\r\nroot@Toka:~# lsb_release -a\r\nNo LSB modules are available.\r\nDistributor ID: Debian\r\nDescription:    Debian GNU/Linux 9.1 (stretch)\r\nRelease:        9.1\r\nCodename:       stretch\r\nroot@Toka:~# cat /etc/os-release \r\nPRETTY_NAME=\"Debian GNU/Linux 9 (stretch)\"\r\nNAME=\"Debian GNU/Linux\"\r\nVERSION_ID=\"9\"\r\nVERSION=\"9 (stretch)\"\r\nID=debian\r\nHOME_URL=\"https://www.debian.org/\"\r\nSUPPORT_URL=\"https://www.debian.org/support\"\r\nBUG_REPORT_URL=\"https://bugs.debian.org/\"\r\nroot@Toka:~# cat /proc/version \r\nLinux version 4.9.0-3-amd64 (debian-kernel@lists.debian.org) (gcc version 6.3.0 20170516 (Debian 6.3.0-18) ) #1 SMP Debian 4.9.30-2+deb9u2 (2017-06-26)\r\nroot@Toka:~# uname -a\r\nLinux Toka 4.9.0-3-amd64 #1 SMP Debian 4.9.30-2+deb9u2 (2017-06-26) x86_64 GNU/Linux									</code></pre>\r\n											<li>查看是否为64位系统：</li>\r\n											<pre><code>\r\n[root@tokay.win(CentOS):~#] file /sbin/init\r\n/sbin/init: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.18, stripped\r\nroot@toka.pro(Debian):~# file /lib/systemd/systemd\r\n/lib/systemd/systemd: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=9c328d5dd958a001ea35a2bd711ff5ec2b648a21, stripped\r\nroot@www.xdiary.win(Debian):~# Debian系列与CentOS系列所执行的命令行并不相同！</code>如果看到有<b>x86-64</b>字样，则是64位Linux操作系统。</pre>\r\n\r\n											<li>查看CPU信息：</li>\r\n											<pre><code>\r\nroot@toka.pro:~# dmidecode -t 4\r\n# dmidecode 2.12\r\nSMBIOS 2.4 present.\r\n\r\nHandle 0x0401, DMI type 4, 32 bytes\r\nProcessor Information\r\n        Socket Designation: CPU 1\r\n        Type: Central Processor\r\n        Family: Other\r\n        Manufacturer: Bochs\r\n        ID: D3 06 00 00 FD FB 8B 07\r\n        Version: Not Specified\r\n        Voltage: Unknown\r\n        External Clock: Unknown\r\n        Max Speed: 2000 MHz\r\n        Current Speed: 2000 MHz\r\n        Status: Populated, Enabled\r\n        Upgrade: Other\r\n        L1 Cache Handle: Not Provided\r\n        L2 Cache Handle: Not Provided\r\n        L3 Cache Handle: Not Provided\r\n\r\nroot@toka.pro:~# cat /proc/cpuinfo\r\nprocessor       : 0\r\nvendor_id       : GenuineIntel\r\ncpu family      : 6\r\nmodel           : 45\r\nmodel name      : Intel(R) Xeon(R) CPU E5-2620 0 @ 2.00GHz\r\nstepping        : 7\r\nmicrocode       : 1796\r\ncpu MHz         : 1999.996\r\ncache size      : 15360 KB\r\nphysical id     : 0\r\nsiblings        : 12\r\ncore id         : 0\r\ncpu cores       : 6\r\napicid          : 0\r\ninitial apicid  : 0\r\nfpu             : yes\r\nfpu_exception   : yes\r\ncpuid level     : 13\r\nwp              : yes\r\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx pdpe1gb rdtscp lm constant_tsc arch_perfmon pebs bts rep_good xtopology nonstop_tsc aperfmperf pni pclmulqdq dtes64 monitor ds_cpl vmx smx est tm2 ssse3 cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic popcnt tsc_deadline_timer aes xsave avx lahf_lm ida arat epb pln pts dtherm tpr_shadow vnmi flexpriority ept vpid xsaveopt\r\nbogomips        : 3999.99\r\nclflush size    : 64\r\ncache_alignment : 64\r\naddress sizes   : 46 bits physical, 48 bits virtual\r\npower management:\r\n											</code></pre>\r\n\r\n											<li>查看内存信息:</li>\r\n											<pre>命令 <b>free -m</b> 与 <b>cat /proc/meminfo</b> 都可以查看到内存的信息<code>\r\nroot@toka.pro:~# dmidecode -t 16\r\n# dmidecode 2.12\r\nSMBIOS 2.4 present.\r\n\r\nHandle 0x1000, DMI type 16, 15 bytes\r\nPhysical Memory Array\r\n        Location: Other\r\n        Use: System Memory\r\n        Error Correction Type: Multi-bit ECC\r\n        Maximum Capacity: 2 GB\r\n        Error Information Handle: Not Provided\r\n        Number Of Devices: 1\r\nroot@toka.pro:~# free -m\r\n             total       used       free     shared    buffers     cached\r\nMem:          1024        252        771         58          0        169\r\n-/+ buffers/cache:         82        941\r\nSwap:          512         68        443\r\nroot@toka.pro:~# cat /proc/meminfo\r\nMemTotal:        1048576 kB\r\nMemFree:          793792 kB\r\nCached:           172064 kB\r\nBuffers:               0 kB\r\nActive:            93472 kB\r\nInactive:          90004 kB\r\nActive(anon):      32580 kB\r\nInactive(anon):    37488 kB\r\nActive(file):      60892 kB\r\nInactive(file):    52516 kB\r\nUnevictable:           0 kB\r\nMlocked:               0 kB\r\nSwapTotal:        524288 kB\r\nSwapFree:         454312 kB\r\nDirty:                24 kB\r\nWriteback:             0 kB\r\nAnonPages:         70068 kB\r\nShmem:             58656 kB\r\nSlab:              12640 kB\r\nSReclaimable:       4748 kB\r\nSUnreclaim:         7892 kB\r\nelapse@elapse-PC:~$  dmidecode -t memory可以查看到物理内存信息,包括主板可插几根内存,已插内存代数,频率,容量等\r\nelapse@elapse-PC:~$  sudo dmidecode -t memory\r\n# dmidecode 3.2\r\nGetting SMBIOS data from sysfs.\r\nSMBIOS 3.1.1 present.\r\n\r\nHandle 0x0026, DMI type 16, 23 bytes\r\nPhysical Memory Array\r\n	Location: System Board Or Motherboard\r\n	Use: System Memory\r\n	Error Correction Type: None\r\n	Maximum Capacity: 256 GB\r\n	Error Information Handle: 0x0025\r\n	Number Of Devices: 4\r\n\r\nHandle 0x002D, DMI type 17, 40 bytes\r\nMemory Device\r\n	Array Handle: 0x0026\r\n	Error Information Handle: 0x002C\r\n	Total Width: Unknown\r\n	Data Width: Unknown\r\n	Size: No Module Installed\r\n	Form Factor: Unknown\r\n	Set: None\r\n	Locator: DIMM 0\r\n	Bank Locator: P0 CHANNEL A\r\n	Type: Unknown\r\n	Type Detail: Unknown\r\n	Speed: Unknown\r\n	Manufacturer: Unknown\r\n	Serial Number: Unknown\r\n	Asset Tag: Not Specified\r\n	Part Number: Unknown\r\n	Rank: Unknown\r\n	Configured Memory Speed: Unknown\r\n	Minimum Voltage: Unknown\r\n	Maximum Voltage: Unknown\r\n	Configured Voltage: Unknown\r\n\r\nHandle 0x002F, DMI type 17, 40 bytes\r\nMemory Device\r\n	Array Handle: 0x0026\r\n	Error Information Handle: 0x002E\r\n	Total Width: Unknown\r\n	Data Width: Unknown\r\n	Size: No Module Installed\r\n	Form Factor: Unknown\r\n	Set: None\r\n	Locator: DIMM 1\r\n	Bank Locator: P0 CHANNEL A\r\n	Type: Unknown\r\n	Type Detail: Unknown\r\n	Speed: Unknown\r\n	Manufacturer: Unknown\r\n	Serial Number: Unknown\r\n	Asset Tag: Not Specified\r\n	Part Number: Unknown\r\n	Rank: Unknown\r\n	Configured Memory Speed: Unknown\r\n	Minimum Voltage: Unknown\r\n	Maximum Voltage: Unknown\r\n	Configured Voltage: Unknown\r\n\r\nHandle 0x0031, DMI type 17, 40 bytes\r\nMemory Device\r\n	Array Handle: 0x0026\r\n	Error Information Handle: 0x0030\r\n	Total Width: Unknown\r\n	Data Width: Unknown\r\n	Size: No Module Installed\r\n	Form Factor: Unknown\r\n	Set: None\r\n	Locator: DIMM 0\r\n	Bank Locator: P0 CHANNEL B\r\n	Type: Unknown\r\n	Type Detail: Unknown\r\n	Speed: Unknown\r\n	Manufacturer: Unknown\r\n	Serial Number: Unknown\r\n	Asset Tag: Not Specified\r\n	Part Number: Unknown\r\n	Rank: Unknown\r\n	Configured Memory Speed: Unknown\r\n	Minimum Voltage: Unknown\r\n	Maximum Voltage: Unknown\r\n	Configured Voltage: Unknown\r\n\r\nHandle 0x0033, DMI type 17, 40 bytes\r\nMemory Device\r\n	Array Handle: 0x0026\r\n	Error Information Handle: 0x0032\r\n	Total Width: 64 bits\r\n	Data Width: 64 bits\r\n	Size: 8192 MB\r\n	Form Factor: DIMM\r\n	Set: None\r\n	Locator: DIMM 1\r\n	Bank Locator: P0 CHANNEL B\r\n	Type: DDR4\r\n	Type Detail: Synchronous Unbuffered (Unregistered)\r\n	Speed: 2133 MT/s\r\n	Manufacturer: Unknown\r\n	Serial Number: D4C17584\r\n	Asset Tag: Not Specified\r\n	Part Number: STK4U2133D15081C\r\n	Rank: 1\r\n	Configured Memory Speed: 2133 MT/s\r\n	Minimum Voltage: 1.2 V\r\n	Maximum Voltage: 1.2 V\r\n	Configured Voltage: 1.2 V\r\n\r\nelapse@elapse-PC:~$\r\n\r\n											</code></pre>\r\n\r\n											<li>查看硬盘（磁盘）：</li>\r\n											<pre><code>\r\nroot@hotf-net:~# fdisk -l\r\nDisk /dev/vda: 20 GiB, 21474836480 bytes, 41943040 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nDisklabel type: dos\r\nDisk identifier: 0xeec04523\r\n\r\nDevice     Boot Start      End  Sectors Size Id Type\r\n/dev/vda1  *     2048 41940991 41938944  20G 83 Linux\r\n\r\n\r\nDisk /dev/vdb: 20 GiB, 21474836480 bytes, 41943040 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nroot@hotf-net:~# 以上表示本机有vda（20GB,已分区使用）、vdb（20GB，未分区未使用）两块硬盘\r\n											</code></pre>\r\n<li>分区并挂载硬盘（磁盘）：</li>\r\n											<pre><code>\r\nroot@hotf-net:~# 进入vdb磁盘，对vdb磁盘进行分区\r\nroot@hotf-net:~# fdisk /dev/vdb\r\n欢迎使用 fdisk (util-linux 2.25.2)。\r\n更改将停留在内存中，直到您决定将更改写入磁盘。\r\n使用写入命令前请三思。\r\n\r\n命令(输入 m 获取帮助)：m\r\n\r\n帮助：\r\n\r\n  DOS (MBR)\r\n   a   开关 可启动 标志\r\n   b   编辑嵌套的 BSD 磁盘标签\r\n   c   开关 dos 兼容性标志\r\n\r\n  常规\r\n   d   删除分区\r\n   l   列出已知分区类型\r\n   n   添加新分区\r\n   p   打印分区表\r\n   t   更改分区类型\r\n   v   检查分区表\r\n\r\n  杂项\r\n   m   打印此菜单\r\n   u   更改 显示/记录 单位\r\n   x   更多功能(仅限专业人员)\r\n\r\n  保存并退出\r\n   w   将分区表写入磁盘并退出\r\n   q   退出而不保存更改\r\n\r\n  新建空磁盘标签\r\n   g   新建一份 GPT 分区表\r\n   G   新建一份空 GPT (IRIX) 分区表\r\n   o   新建一份的空 DOS 分区表\r\n   s   新建一份空 Sun 分区表\r\n\r\n命令(输入 m 获取帮助)：n               #这里输入m可以查看命令，n不查看帮助命令\r\n分区类型\r\n   p   主分区 (1个主分区，0个扩展分区，3空闲)\r\n   e   扩展分区 (逻辑分区容器)\r\n选择 (默认 p)：p                        #回车直接建主分区\r\n分区号 (1-4，默认 1)： 1                #输入1，建立第一分区\r\nFirst sector (2048-41943039, default 2048):             #直接回车\r\nLast sector, +sectors or +size{K,M,G,T,P} (2048-41943039, default 41943039):  \r\n                                                        #这里注意直接回车将分所有容量，不然要输入大小\r\n\r\nCreated a new partition 1 of type \'Linux\' and of size 20 GiB.\r\n\r\n命令(输入 m 获取帮助)： w               # w为保存退出，q退出而不保存更改\r\nThe partition table has been altered.\r\nCalling ioctl() to re-read partition table.\r\nSyncing disks.                          # 到此分区完成，接下来挂载！！！\r\nroot@hotf-net:~# 再查看当前硬盘状态，是否已改变？？\r\nroot@hotf-net:~# fdisk -l\r\nDisk /dev/vda: 20 GiB, 21474836480 bytes, 41943040 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nDisklabel type: dos\r\nDisk identifier: 0xeec04523\r\n\r\nDevice     Boot Start      End  Sectors Size Id Type\r\n/dev/vda1  *     2048 41940991 41938944  20G 83 Linux\r\n\r\n\r\nDisk /dev/vdb: 20 GiB, 21474836480 bytes, 41943040 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nDisklabel type: dos\r\nDisk identifier: 0x41c95590\r\n\r\nDevice     Boot Start      End  Sectors Size Id Type\r\n/dev/vdb1        2048 41943039 41940992  20G 83 Linux\r\nroot@hotf-net:~# 格式化刚才新建的分区，将/dev/vdb1格式化为ext4类型\r\nroot@hotf-net:~# mkfs.ext4 /dev/vdb1\r\nmke2fs 1.44.1 (24-Mar-2018)\r\nCreating filesystem with 5242624 4k blocks and 1310720 inodes\r\nFilesystem UUID: 04578bcb-96c1-477d-9f38-875bd0e5aef9\r\nSuperblock backups stored on blocks: \r\n        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, \r\n        4096000\r\n\r\nAllocating group tables: done                            \r\nWriting inode tables: done                            \r\nCreating journal (32768 blocks): done\r\nWriting superblocks and filesystem accounting information: done   \r\n\r\nroot@hotf-net:~# 创建挂载目录\r\nroot@hotf-net:~# mkdir /data\r\nroot@hotf-net:~# 挂载/dev/vdb1到/data\r\nroot@hotf-net:~# mount /dev/vdb1 /data\r\nroot@hotf-net:~# df -h\r\nFilesystem      Size  Used Avail Use% Mounted on\r\nudev            967M     0  967M   0% /dev\r\ntmpfs           200M  5.2M  195M   3% /run\r\n/dev/vda1        20G  9.7G  9.0G  52% /\r\ntmpfs           997M     0  997M   0% /dev/shm\r\ntmpfs           5.0M     0  5.0M   0% /run/lock\r\ntmpfs           997M     0  997M   0% /sys/fs/cgroup\r\ntmpfs           200M     0  200M   0% /run/user/0\r\n/dev/vdb1        20G   45M   19G   1% /data\r\nroot@hotf-net:~# 看，已挂载成,现在可以用新的硬盘了，但重启后还要重新挂载！！\r\nroot@hotf-net:~# 所以要配置开机自动挂载\r\nroot@hotf-net:~# vim /etc/fstab\r\n#加入如下行,保存\r\n/dev/vdb1       /data      ext4    defaults   0   0\r\nroot@hotf-net:~# 更兼容式的自动挂载是用UUID来代替/dev/vdb1\r\nroot@hotf-net:~# 找到分区的UUID（先查看硬盘分区的UUID）\r\nroot@hotf-net:~# blkid\r\n/dev/vda1: UUID=\"7cef075a-e1dc-43f2-82cf-7b135e22a302\" TYPE=\"ext4\" PARTUUID=\"eec04523-01\"\r\n/dev/vdb1: UUID=\"04578bcb-96c1-477d-9f38-875bd0e5aef9\" TYPE=\"ext4\" PARTUUID=\"41c95590-01\"\r\nroot@hotf-net:~# vim /etc/fstab\r\n# 用UUID代替“/dev/sdb1”这样才更有兼容性\r\nUUID=\"04578bcb-96c1-477d-9f38-875bd0e5aef9\" /data       ext4  defaults   0    0\r\nroot@hotf-net:~# OK，可以重启看下是否真的会自动挂载了!!!\r\n											</code></pre>\r\n<p>记一次4TB硬盘只分一个区</p>\r\n<pre><code>\r\nroot@elapse-PC:/home/elapse# parted /dev/sda\r\nGNU Parted 3.3\r\n使用 /dev/sda\r\n欢迎使用 GNU Parted！输入 \'help\' 来查看命令列表。\r\n(parted) p                                                                \r\n型号：ATA WDC WD40EJRX-89A (scsi)\r\n磁盘 /dev/sda: 4001GB\r\n扇区大小 (逻辑/物理)：512B/4096B\r\n分区表：gpt\r\n磁盘标志：\r\n\r\n编号  起始点  结束点  大小    文件系统  名称     标志\r\n 1    1049kB  4001GB  4001GB            primary\r\n\r\n(parted) help                                                             \r\n  align-check TYPE N                       check partition N for TYPE(min|opt) alignment\r\n  help [COMMAND]                           打印通用求助信息，或 COMMAND 的帮助\r\n  mklabel,mktable LABEL-TYPE               创建新的磁盘卷标 (分区表)\r\n  mkpart 分区类型 [文件系统类型] 起始点 结束点 创建一个分区\r\n  name 编号 名称                           将指定“编号”的分区命名为“名称”\r\n  print [devices|free|list,all|数字]        显示分区表、可用设备、剩余空间、所有分区或特殊分区\r\n  quit                                     退出程序\r\n  rescue 起始点 终止点                      挽救临近“起始点”、“终止点”的遗失的分区\r\n  resizepart NUMBER END                    改变 NUMBER 的大小\r\n  rm NUMBER                                删除编号为 NUMBER 的分区\r\n  select 设备                              选择要编辑的设备\r\n  disk_set 旗标 状态                       变更已选设备上的旗标\r\n  disk_toggle [旗标]                       切换已选设备上的旗标状态\r\n  set 编号 旗标 状态                       改变指定“编号”分区的旗标\r\n  toggle [编号 [旗标]]                     切换“编号”分区上的“旗标”状态\r\n  unit 单位                                设置缺省的“单位”\r\n  version                                  显示目前 GNU Parted 的版本与版权信息\r\n(parted) p                                                                \r\n型号：ATA WDC WD40EJRX-89A (scsi)\r\n磁盘 /dev/sda: 4001GB\r\n扇区大小 (逻辑/物理)：512B/4096B\r\n分区表：gpt\r\n磁盘标志：\r\n\r\n编号  起始点  结束点  大小    文件系统  名称     标志\r\n 1    1049kB  4001GB  4001GB            primary\r\n\r\n(parted) mklabel gpt\r\n警告: 现有 /dev/sda 上的磁盘卷标将被销毁，而所有在这个磁盘上的数据将会丢失。您要继续吗？\r\n是/Yes/否/No? Yes\r\n(parted) p                                                                \r\n型号：ATA WDC WD40EJRX-89A (scsi)\r\n磁盘 /dev/sda: 4001GB\r\n扇区大小 (逻辑/物理)：512B/4096B\r\n分区表：gpt\r\n磁盘标志：\r\n\r\n编号  起始点  结束点  大小  文件系统  名称  标志\r\n\r\n(parted) mkpart \r\n分区名称？  []? luck                                                      \r\n文件系统类型？  [ext2]? ext4                                              \r\n起始点？ 0%                                                               \r\n结束点？ 100%  \r\n===================多个分区时,不想用百分比来计算,可以直接如下从1开始,记录不能从零,从零开始的起始点会导致分区不对齐等问题===========================\r\n起始点？ 1                                                                  \r\n结束点？ 4001GB                  \r\n===================================================================================================================================                                                     \r\n(parted) p                                                                \r\n型号：ATA WDC WD40EJRX-89A (scsi)\r\n磁盘 /dev/sda: 4001GB\r\n扇区大小 (逻辑/物理)：512B/4096B\r\n分区表：gpt\r\n磁盘标志：\r\n\r\n编号  起始点  结束点  大小    文件系统  名称  标志\r\n 1    1049kB  4001GB  4001GB  ext4      luck\r\n\r\n(parted) quit                                                             \r\n信息: 你可能需要 /etc/fstab。\r\n\r\nroot@elapse-PC:/home/elapse# fdisk -l                              \r\nDisk /dev/sda：3.65 TiB，4000787030016 字节，7814037168 个扇区\r\nDisk model: WDC WD40EJRX-89A\r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 4096 字节\r\nI/O 大小(最小/最佳)：4096 字节 / 4096 字节\r\n磁盘标签类型：gpt\r\n磁盘标识符：494FB406-4C3D-4AC1-8D62-F949B6718098\r\n\r\n设备        起点       末尾       扇区  大小 类型\r\n/dev/sda1   2048 7814035455 7814033408  3.7T Linux 文件系统\r\n\r\n\r\nDisk /dev/sdc：931.53 GiB，1000204886016 字节，1953525168 个扇区\r\nDisk model: TOSHIBA HDWD110 \r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 4096 字节\r\nI/O 大小(最小/最佳)：4096 字节 / 4096 字节\r\n磁盘标签类型：dos\r\n磁盘标识符：0xcbe496c9\r\n\r\n设备       启动       起点       末尾       扇区   大小 Id 类型\r\n/dev/sdc1  *          2048  243273727  243271680   116G  7 HPFS/NTFS/exFAT\r\n/dev/sdc2        578820096 1585455103 1006635008   480G  7 HPFS/NTFS/exFAT\r\n/dev/sdc3       1585455104 1953523711  368068608 175.5G  f W95 扩展 (LBA)\r\n/dev/sdc5       1585457152 1953523711  368066560 175.5G  7 HPFS/NTFS/exFAT\r\n\r\n\r\nDisk /dev/sdb：119.25 GiB，128035676160 字节，250069680 个扇区\r\nDisk model: TOSHIBA THNSNJ12\r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 512 字节\r\nI/O 大小(最小/最佳)：512 字节 / 512 字节\r\n磁盘标签类型：gpt\r\n磁盘标识符：519C49BC-E3D7-4059-889C-EFC9B64DA55C\r\n\r\n设备          起点      末尾      扇区   大小 类型\r\n/dev/sdb1     2048   1050623   1048576   512M EFI 系统\r\n/dev/sdb2  1050624 250068991 249018368 118.8G Linux 文件系统\r\nroot@elapse-PC:/home/elapse#\r\nroot@elapse-PC:/home/elapse# df -h\r\n文件系统        容量  已用  可用 已用% 挂载点\r\nudev             12G     0   12G    0% /dev\r\ntmpfs           2.3G  1.6M  2.3G    1% /run\r\n/dev/sdb2       117G  105G  5.6G   95% /\r\ntmpfs            12G  350M   11G    4% /dev/shm\r\ntmpfs           5.0M  4.0K  5.0M    1% /run/lock\r\ntmpfs            12G     0   12G    0% /sys/fs/cgroup\r\n/dev/sdb1       511M  212M  300M   42% /boot/efi\r\n/dev/sdc5       176G  173G  3.5G   99% /media/elapse/尾部\r\n/dev/sdc2       481G  469G   12G   98% /media/elapse/幸运星\r\ntmpfs           2.3G   32K  2.3G    1% /run/user/1000\r\nroot@elapse-PC:/home/elapse# mkdir /luck\r\nroot@elapse-PC:/home/elapse# fdisk -l\r\nDisk /dev/sda：3.65 TiB，4000787030016 字节，7814037168 个扇区\r\nDisk model: WDC WD40EJRX-89A\r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 4096 字节\r\nI/O 大小(最小/最佳)：4096 字节 / 4096 字节\r\n磁盘标签类型：gpt\r\n磁盘标识符：494FB406-4C3D-4AC1-8D62-F949B6718098\r\n\r\n设备        起点       末尾       扇区  大小 类型\r\n/dev/sda1   2048 7814035455 7814033408  3.7T Linux 文件系统\r\n\r\n\r\nDisk /dev/sdc：931.53 GiB，1000204886016 字节，1953525168 个扇区\r\nDisk model: TOSHIBA HDWD110 \r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 4096 字节\r\nI/O 大小(最小/最佳)：4096 字节 / 4096 字节\r\n磁盘标签类型：dos\r\n磁盘标识符：0xcbe496c9\r\n\r\n设备       启动       起点       末尾       扇区   大小 Id 类型\r\n/dev/sdc1  *          2048  243273727  243271680   116G  7 HPFS/NTFS/exFAT\r\n/dev/sdc2        578820096 1585455103 1006635008   480G  7 HPFS/NTFS/exFAT\r\n/dev/sdc3       1585455104 1953523711  368068608 175.5G  f W95 扩展 (LBA)\r\n/dev/sdc5       1585457152 1953523711  368066560 175.5G  7 HPFS/NTFS/exFAT\r\n\r\n\r\nDisk /dev/sdb：119.25 GiB，128035676160 字节，250069680 个扇区\r\nDisk model: TOSHIBA THNSNJ12\r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 512 字节\r\nI/O 大小(最小/最佳)：512 字节 / 512 字节\r\n磁盘标签类型：gpt\r\n磁盘标识符：519C49BC-E3D7-4059-889C-EFC9B64DA55C\r\n\r\n设备          起点      末尾      扇区   大小 类型\r\n/dev/sdb1     2048   1050623   1048576   512M EFI 系统\r\n/dev/sdb2  1050624 250068991 249018368 118.8G Linux 文件系统\r\nroot@elapse-PC:/home/elapse# mount /dev/sda1 /luck\r\nroot@elapse-PC:/home/elapse# df -h\r\n文件系统        容量  已用  可用 已用% 挂载点\r\nudev             12G     0   12G    0% /dev\r\ntmpfs           2.3G  1.6M  2.3G    1% /run\r\n/dev/sdb2       117G  105G  5.6G   95% /\r\ntmpfs            12G  350M   11G    4% /dev/shm\r\ntmpfs           5.0M  4.0K  5.0M    1% /run/lock\r\ntmpfs            12G     0   12G    0% /sys/fs/cgroup\r\n/dev/sdb1       511M  212M  300M   42% /boot/efi\r\n/dev/sdc5       176G  173G  3.5G   99% /media/elapse/尾部\r\n/dev/sdc2       481G  469G   12G   98% /media/elapse/幸运星\r\ntmpfs           2.3G   32K  2.3G    1% /run/user/1000\r\n/dev/sda1       3.6T   89M  3.4T    1% /luck\r\nroot@elapse-PC:/home/elapse# blkid\r\n/dev/sdb2: UUID=\"1660799e-0c0d-4074-9b76-78913c95458a\" TYPE=\"ext4\" PARTUUID=\"8a22825f-46d1-4679-9112-6bdba0cb6047\"\r\n/dev/sda1: UUID=\"37f2860b-5e55-45b8-b3c7-ab8f72cabeb6\" TYPE=\"ext4\" PARTLABEL=\"luck\" PARTUUID=\"90e29142-7cd3-4f1d-a374-f611ed7f2d07\"\r\n/dev/sdc1: LABEL=\"Win 10Old\" UUID=\"3C52F87652F8366C\" TYPE=\"ntfs\" PARTUUID=\"cbe496c9-01\"\r\n/dev/sdc2: LABEL=\"M-eM-9M-8M-hM-?M-^PM-fM-^XM-^_\" UUID=\"2B74982AED7F572A\" TYPE=\"ntfs\" PARTUUID=\"cbe496c9-02\"\r\n/dev/sdc5: LABEL=\"M-eM-0M-&gt;M-iM-^CM-(\" UUID=\"90D62590D625781C\" TYPE=\"ntfs\" PARTUUID=\"cbe496c9-05\"\r\n/dev/sdb1: LABEL=\"^LM-f^AM-H^D\" UUID=\"C545-4EC0\" TYPE=\"vfat\" PARTLABEL=\"EFI System Partition\" PARTUUID=\"d61f6124-b6bf-40c8-8995-8941ac477e68\"\r\nroot@elapse-PC:/home/elapse# vim /etc/fstab \r\n# /etc/fstab: static file system information.\r\n#\r\n# Use \'blkid\' to print the universally unique identifier for a\r\n# device; this may be used with UUID= as a more robust way to name devices\r\n# that works even if disks are added and removed. See fstab(5).\r\n#\r\n# <file system=\"\"> <mount point=\"\">   <type>  <options>       <dump>  <pass>\r\n# / was on /dev/sda2 during installation\r\nUUID=1660799e-0c0d-4074-9b76-78913c95458a /               ext4    errors=remount-ro 0       0\r\n# /boot/efi was on /dev/sda1 during installation\r\nUUID=C545-4EC0  /boot/efi       vfat    umask=0077          0       0\r\n/swapfile                                 none             swap    sw              0       0\r\nUUID=\"37f2860b-5e55-45b8-b3c7-ab8f72cabeb6\"  /luck         ext4  defaults   0    0\r\nUUID=\"2B74982AED7F572A\"             /media/elapse/幸运星   ntfs  defaults   0    0\r\nUUID=\"90D62590D625781C\"             /media/elapse/尾部     ntfs  defaults   0    0\r\n\r\nroot@elapse-PC:/home/elapse# df -h\r\n文件系统        容量  已用  可用 已用% 挂载点\r\nudev             12G     0   12G    0% /dev\r\ntmpfs           2.3G  1.6M  2.3G    1% /run\r\n/dev/sdb2       117G  105G  5.6G   95% /\r\ntmpfs            12G  350M   11G    4% /dev/shm\r\ntmpfs           5.0M  4.0K  5.0M    1% /run/lock\r\ntmpfs            12G     0   12G    0% /sys/fs/cgroup\r\n/dev/sdb1       511M  212M  300M   42% /boot/efi\r\n/dev/sdc5       176G  173G  3.5G   99% /media/elapse/尾部\r\n/dev/sdc2       481G  469G   12G   98% /media/elapse/幸运星\r\ntmpfs           2.3G   32K  2.3G    1% /run/user/1000\r\n/dev/sda1       3.6T   89M  3.4T    1% /luck\r\nroot@elapse-PC:/home/elapse# \r\n\r\n</pass></dump></options></type></mount></file></code></pre>\r\n\r\n											<li>查看分区容量情况：</li><pre><code>root@hotf-net:~# df -h\r\nFilesystem      Size  Used Avail Use% Mounted on\r\nudev            967M     0  967M   0% /dev\r\ntmpfs           200M  5.1M  195M   3% /run\r\n/dev/vda1        20G  9.7G  8.9G  53% /\r\ntmpfs           997M     0  997M   0% /dev/shm\r\ntmpfs           5.0M     0  5.0M   0% /run/lock\r\ntmpfs           997M     0  997M   0% /sys/fs/cgroup\r\n/dev/vdb1        20G   45M   19G   1% /data\r\ntmpfs           200M     0  200M   0% /run/user/0\r\nroot@hotf-net:~# 这里可以看到分区及硬盘挂载情况									</code></pre>\r\n\r\n											<li>测试VPS主机磁盘IO的性能,也是区分是否为固态硬盘重要依据：</li>\r\n											<pre><code>\r\nroot@toka.pro:~# time dd if=/dev/zero bs=1024k of=tstfile count=1024\r\n记录了1024+0 的读入\r\n记录了1024+0 的写出\r\n1073741824 bytes (1.1 GB, 1.0 GiB) copied, 8.19455 s, 131 MB/s\r\n\r\nreal    0m8.219s\r\nuser    0m0.000s\r\nsys     0m2.544s\r\nroot@toka.pro:~# dd if=tstfile bs=1024k of=/dev/null count=1024\r\n录了1024+0 的读入\r\n记录了1024+0 的写出\r\n1073741824 bytes (1.1 GB, 1.0 GiB) copied, 0.257606 s, 4.2 GB/s\r\nroot@toka.pro:~# dd if=tstfile of=/dev/null bs=1M count=1024\r\n记录了1024+0 的读入\r\n记录了1024+0 的写出\r\n1073741824 bytes (1.1 GB, 1.0 GiB) copied, 0.299709 s, 3.6 GB/s\r\nroot@toka.pro:~# \r\nroot@toka.pro:~# dd if=/dev/zero of=test bs=64k count=4k oflag=dsync\r\n记录了4096+0 的读入\r\n记录了4096+0 的写出\r\n268435456 bytes (268 MB, 256 MiB) copied, 5.91183 s, 45.4 MB/s\r\nroot@toka.pro:~# dd if=/dev/zero of=test bs=8k count=256k conv=fdatasync\r\n记录了262144+0 的读入\r\n记录了262144+0 的写出\r\n2147483648 bytes (2.1 GB, 2.0 GiB) copied, 3.79961 s, 565 MB/s\r\nroot@toka.pro:~# 这台固态硬盘，普通硬盘在 10.2 MB/s、44.9 MB/s左右\r\n											</code></pre>\r\n										</ol>\r\n									<h5>二、修改密码及配制密钥登录</h5>\r\n										<ol>\r\n											<li>修改密码：passwd</li>\r\n											<li>配置密钥登录：</li>\r\n											<pre><code>\r\nroot@toka.pro:~# mkdir ~/.ssh\r\nroot@toka.pro:~# chmod 700 ~/.ssh\r\nroot@toka.pro:~# 把用SecureCRT创建的RSA公钥Identity.pub上传到服务器,再把公钥加入authorized_keys中（或者用ssh-keygen -t rsa 生成公私钥）\r\nroot@toka.pro:~# ssh-keygen -i -f Identity.pub &gt;&gt; ~/.ssh/authorized_keys \r\nroot@toka.pro:~# chmod 600 ~/.ssh/authorized_keys\r\nroot@toka.pro:~# /etc/init.d/ssh restart\r\nroot@toka.pro:~# 重启SSH,试下用私钥登录(CentOS系列：/etc/init.d/sshd restart)，如还不能成功用私钥登录，请再按以下修改ssh配置\r\nroot@toka.pro:~# vim /etc/ssh/sshd_config\r\n        # PermitRootLogin prohibit-password\r\n        # 把上面那一行改成如下,允许ROOT远程\r\n        PermitRootLogin yes      \r\n	TCPKeepAlive yes         #保持连接\r\n	ClientAliveInterval 60   #每一分问一次客户端在不在\r\n	ClientAliveCountMax 3    #客户端3次没回应才断开(手动增加)\r\n	RSAAuthentication yes    #RSA认证\r\n	PubkeyAuthentication yes  #开启公钥验证\r\n	#验证文件路径，这个可以不更改它,因为上面用的就是这个目录\r\n	AuthorizedKeysFile    %h/.ssh/authorized_keys  #公钥存放路径，默认不用修改\r\n	PasswordAuthentication no   #一定要测试私钥可以登录后才能关闭常规的密码登录,不然将再也远程登录不了\r\nroot@toka.pro:~# /etc/init.d/ssh restart \r\nroot@(CentOS-7.6):~# systemctl restart sshd.service\r\n											</code></pre>\r\n<li>Linux生成密钥：</li>\r\n<p>\r\n执行ssh-keygen -t rsa <br>\r\n一路回车，什么都不输入才能创建免密码登录，成功创建公钥、私钥(id_rsa)，位于 /root/.ssh/目录下的 id_rsa 和 id_rsa.pub\r\n</p>\r\n<pre><code>\r\nelapse@luck:~$ ssh-keygen -t rsa\r\nGenerating public/private rsa key pair.\r\nEnter file in which to save the key (/home/elapse/.ssh/id_rsa): \r\n/home/elapse/.ssh/id_rsa already exists.\r\nOverwrite (y/n)? y\r\nEnter passphrase (empty for no passphrase): \r\nEnter same passphrase again: \r\nYour identification has been saved in /home/elapse/.ssh/id_rsa\r\nYour public key has been saved in /home/elapse/.ssh/id_rsa.pub\r\nThe key fingerprint is:\r\nSHA256:MItWiGVFbP1SQ1w0U+cheGaKnrBFwvm5hzxNv8FrXkk elapse@luck\r\nThe key\'s randomart image is:\r\n+---[RSA 3072]----+\r\n|    o++..o.o*o...|\r\n|   + .o+..+. *.o.|\r\n|  . ..+ +oo.=   .|\r\n|     o =.=.o     |\r\n|    o . S.* o  E |\r\n|   .   . B o +. .|\r\n|          o   +o |\r\n|             +.  |\r\n|            o.   |\r\n+----[SHA256]-----+\r\nelapse@luck:~$ \r\n</code></pre>									</ol>\r\n\r\n									<h5>三、配制bash高亮及当前系统位置提示</h5>\r\n										<ol>\r\n											<li>配制高亮bash：</li>\r\n											<blockquote>\r\n											  \r\n											  <pre><code>\r\nroot@toka.pro:~# vim ~/.bashrc\r\n	###使以下几行生效,去掉以下几行头部“#”就可以了###\r\n	export LS_OPTIONS=\\\"--color=auto\\\"\r\n	eval \"`dircolors`\"\r\n	alias ls=\\\"ls $LS_OPTIONS\\\"\r\n	alias ll=\\\"ls $LS_OPTIONS -l\\\"\r\n	alias l=\\\"ls $LS_OPTIONS -lA\\\"\r\n						                      </code></pre>\r\n						                      <p>保存退出,重新登录后就可看到效果</p>\r\n						                    </blockquote>\r\n										\r\n											<li>配制vim高亮语法与默认编码：</li>\r\n											<pre><code>\r\nroot@toka.pro:~# 在当前家目录下添加或修改.vimrc\r\nroot@toka.pro:~# vim ~/.vimrc\r\n	syntax on\r\n	set number\r\n	set fileencodings=utf-8,ucs-bom,gb18030,gbk,gb2312,cp936\r\n	set termencoding=utf-8\r\n	set encoding=utf-8	\r\nroot@toka.pro:~# 保存退出,如果还没有高亮语法的话,确认安装了vim-enhanced，再在/etc/profile末尾加入此句\r\nroot@toka.pro:~# vim /etc/profile\r\n	export TERM=xterm-color       #这样就可以高亮显示了\r\n											</code></pre>\r\n\r\n											<li>修改系统提示：</li>\r\n											<pre><code>\r\nroot@toka.pro:~# 修改hostname\r\nroot@toka.pro:~# vim /etc/hostname\r\n    ###修改为hotf###\r\n    hotf \r\nroot@toka.pro:~# 记得要修改/etc/hosts,（因为不修改可能会导致解析错误等等）\r\nroot@toka.pro:~# vim /etc/hosts\r\n    ###记得要把127.0.1.1 这行中旧的hostname改为现在新的###\r\n    ###不然会出现解析错误等问题（如Nginx中不能正确识别网站的虚拟目录设置）\r\n    127.0.1.1    hotf\r\nroot@toka.pro:~# 重启之后以上两项修改正式生效\r\nroot@toka.pro:~# vim ~/.bashrc\r\n	###把PS1这一行改成如下###\r\n	PS1=\'\\[\\e[31m\\]\\u\\[\\e[36m\\]@\\[\\e[35m\\]\\h\\[\\e[32m\\]:\\[\\e[34m\\]\\w\\[\\e[33m\\]\\$\\[\\e[m\\] \' \r\nroot@toka.pro:~# 保存退出,重新登录生效\r\n											</code></pre>\r\n										</ol>\r\n\r\n									<h5>四、中文环境与中国时间</h5>\r\n									<blockquote>\r\n										<ol>\r\n											<li>查系统所支持的区域是否有中文：</li>\r\n											<pre><code>\r\nroot@hotf:~# locale -a|grep zh\r\nzh_CN.gb18030\r\nzh_CN.gbk\r\nzh_CN.utf8\r\nroot@hotf:~# 如果有以上zh_CN字样输出，证明已经支持中文了\r\nroot@hotf:~# 如果没有任何输出，则需要重新安装中文语言包\r\n											</code></pre>\r\n\r\n											<li>安装必要的中文字体包：</li>\r\n											<pre><code>\r\nroot@hotf:~# 安装ttf-arphic-uming scim-tables-zh im-switch xfonts-intl-chinese  fonts-noto  ttf-wqy-microhei 中其中一个字体包就可					\r\nroot@hotf:~# apt-get install ttf-wqy-microhei\r\n											</code></pre>\r\n\r\n											<li>更新对应的locales文：</li>\r\n											<pre><code>\r\nroot@hotf:~# dpkg-reconfigure locales\r\nroot@hotf:~# 选择zh_CN.UTF-8安装\r\n											</code></pre>\r\n\r\n											<li>设置默认为中文UTF-8：</li>\r\n											<pre><code>\r\nroot@hotf:~# vim /etc/default/locale \r\n	###设置默认为中文UTF-8\r\n	LANG=\"zh_CN.UTF-8\"  \r\nroot@hotf:~# 保存退出     \r\n											</code></pre>\r\n\r\n											<li>修改时间时区：</li>\r\n											<pre><code>\r\nroot@hotf:~# dpkg-reconfigure tzdata \r\nroot@hotf:~# 首先选择区：Asia(亚洲)\r\nroot@hotf:~# 接着选择时地区：shanghai(上海)\r\nroot@hotf:~# date\r\n2016年 12月 15日 星期四 00:38:09 CST\r\nroot@hotf:~# 时间不对，同步时间\r\nroot@hotf:~# apt-get install ntpdate\r\nroot@hotf:~# ntpdate-debian\r\n15 Dec 16:42:10 ntpdate[5693]: step time server 210.23.25.77 offset 57601.167265 sec\r\nroot@hotf:~# date\r\n2016年 12月 15日 星期四 16:42:15 CST\r\nroot@hotf:~# 时间同步过来了\r\n\r\n											</code></pre>\r\n										</ol>\r\n									</blockquote>\r\n\r\n									<h5><br></h5>\r\n<h5>五、增加SWAP空間大小</h5>\r\n<li>增加ｓｗａｐ交換空間：</li>\r\n<ol>\r\n<pre><code>\r\nroot@elapse.date:~# mkdir /swap\r\nroot@elapse.date:~# cd /swap/\r\nroot@elapse.date:/swap# 下面這條命令中的count大小爲swap大小，這裏是6G\r\nroot@elapse.date:/swap# dd if=/dev/zero of=swapfile bs=1024 count=6144000\r\n记录了6144000+0 的读入\r\n记录了6144000+0 的写出\r\n6291456000 bytes (6.3 GB, 5.9 GiB) copied, 59.5233 s, 106 MB/s\r\nroot@elapse.date:/swap# 把生成的文件转换成 Swap 文件 \r\nroot@elapse.date:/swap# mkswap -f swapfile\r\nmkswap: swapfile：不安全的权限 0644，建议使用 0600。\r\n正在设置交换空间版本 1，大小 = 5.9 GiB (6291451904  个字节)\r\n无标签，UUID=fc65ef64-e5b2-46bb-a933-175e5f6dc6da\r\nroot@elapse.date:/swap# 激活 Swap 文件\r\nroot@elapse.date:/swap# swapon swapfile\r\nswapon: /swap/swapfile：不安全的权限 0644，建议使用 0600。\r\nroot@elapse.date:/swap# 查看下是否加到swqp空間裏了\r\nroot@elapse.date:/swap# free -m\r\n              total        used        free      shared  buff/cache   available\r\nMem:           3828        1143         177           2        2506        2438\r\nSwap:          5999           0        5999\r\nroot@elapse.date:/swap# 添加成功\r\nroot@elapse.date:/swap# 如要千載這個swap文件使用如下命令\r\nroot@elapse.date:/swap# swapoff swapfile\r\nroot@elapse.date:/swap#								</code></pre>\r\n</ol>\r\n<li>保持这个swap空間重啓後也能生效</li>\r\n<ol>\r\n<pre><code>\r\nroot@elapse.date:~# vim /etc/fstab\r\n＃添加如下行\r\n/swap/swapfile       /swap                swap       defaults              0 0\r\n \r\n</code></pre>\r\n</ol>\r\n<h5><code>\r\n\r\n<h5><code>六、安装必装软件</code></h5><code>\r\n										<ol>\r\n											<li>apt-get install vim rar unrar </li>\r\n											<li>apt-get install build-essential</li>\r\n											<li>apt-get install libtool cmake libncurses5-dev</li>\r\n										</ol>\r\n										<p>接下来安装自己所需要的服务就可，如LAMP,<a href=\"javascript:void(0)\">LNMP</a>,VPN等\r\n										</p><p>……</p></code></code></h5>                                                                                                                                                                                                                                                            '),(2,'                                								<h5>查看Linux下的硬盘：</h5>\r\n								<pre><span style=\"white-space: pre-wrap;\">root@Toka:~# fdisk -l\r\nDisk /dev/sda: 119.2 GiB, 128035676160 bytes, 250069680 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nDisklabel type: dos\r\nDisk identifier: 0x44e5be3f\r\n\r\n设备       启动     Start    末尾    扇区   Size Id 类型\r\n/dev/sda1  *         2048 230152191 230150144 109.8G 83 Linux\r\n/dev/sda2       230154238 250068991  19914754   9.5G  5 扩展\r\n/dev/sda5       230154240 250068991  19914752   9.5G 82 Linux 交换 / Solaris\r\n\r\n\r\nDisk /dev/sdb: 119.2 GiB, 128035676160 bytes, 250069680 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nDisklabel type: dos\r\nDisk identifier: 0x0bf0152e\r\n\r\n\r\nDisk /dev/sdc: 465.8 GiB, 500107862016 bytes, 976773168 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nDisklabel type: dos\r\nDisk identifier: 0xff56d139\r\n\r\n设备       启动 Start    末尾    扇区 Size Id 类型\r\n/dev/sdc1  *     2048 186650623 186648576  89G  7 HPFS/NTFS/exFAT\r\nroot@Toka:~# </span><br></pre>		\r\n								<p>这里可以看到有三块硬盘：Disk /dev/sda: 119.2 GiB，Disk /dev/sdb: 119.2 GiB，Disk /dev/sdc: 465.8 GiB,<br>其中&nbsp;/dev/sdb还没有分区，而&nbsp;/dev/sda这一块已分区成了三个区，/dev/sdc这一块只分了一个89G的区，还有465.8 - 89 GB未分区<br>\r\n							    而我们现在就是要先把sdb这一块硬盘分区并使用起来</p>\r\n                 <pre><code>\r\nroot@Toka:~# fdisk /dev/sdb\r\n\r\nWelcome to fdisk (util-linux 2.27.1).                                           欢迎使用 fdisk \r\nChanges will remain in memory only, until you decide to write them.             更改将停留在内存中，直到您决定将更改写入磁盘。\r\nBe careful before using the write command.                                      使用写入命令前请三思。\r\n\r\n命令(输入 m 获取帮助)：m\r\n\r\n帮助：\r\n\r\n  DOS (MBR)\r\n   a   toggle a bootable flag                                        开关 可启动 标志\r\n   b   edit nested BSD disklabel                                     编辑嵌套的 BSD 磁盘标签\r\n   c   toggle the dos compatibility flag                             开关 dos 兼容性标志\r\n\r\n  Generic                                                      常规\r\n   d   delete a partition                                            删除分区\r\n   l   list known partition types                                    列出已知分区类型\r\n   n   add a new partition                                           添加新分区\r\n   p   print the partition table                                     打印分区表\r\n   t   change a partition type                                       更改分区类型\r\n   v   verify the partition table                                    检查分区表\r\n\r\n  Misc                                                         杂项\r\n   m   print this menu                                               打印此菜单\r\n   u   change display/entry units                                    更改 显示/记录 单位\r\n   x   extra functionality (experts only)                            更多功能(仅限专业人员)\r\n\r\n  Save &amp; Exit                                                  保存并退出\r\n   w   write table to disk and exit                                  将分区表写入磁盘并退出\r\n   q   quit without saving changes                                   退出而不保存更改\r\n\r\n  Create a new label                                           新建空磁盘标签\r\n   g    create a new empty GPT partition table                       新建一份 GPT 分区表\r\n   G   create a new empty SGI (IRIX) partition table                 新建一份空 GPT (IRIX) 分区表\r\n   o   create a new empty DOS partition table                        新建一份的空 DOS 分区表\r\n   s   create a new empty Sun partition table                        新建一份空 Sun 分区表\r\n\r\n\r\n命令(输入 m 获取帮助)：n               #这里输入m可以查看命令，n不查看帮助命令\r\n分区类型\r\n   p   主分区 (1个主分区，0个扩展分区，3空闲)\r\n   e   扩展分区 (逻辑分区容器)\r\n选择 (默认 p)：p                         #回车直接建主分区\r\n分区号 (1-4，默认 1)： 1                 #输入1，建立第一分区\r\nFirst sector (2048-16777215, default 2048):             #直接回车\r\nLast sector, +sectors or +size{K,M,G,T,P} (2048-16777215, default 16777215):  \r\n                                        #这里注意直接回车将分所有容量，不然要输入大小\r\nCreated a new partition 1 of type \'Linux\' and of size 8 GiB.\r\n\r\n命令(输入 m 获取帮助)： w                # w为保存退出，q退出而不保存更改\r\nThe partition table has been altered.\r\nCalling ioctl() to re-read partition table.\r\nSyncing disks.                        \r\n\r\n							    </code></pre>	\r\n							    <p>到此分区完成，接下来挂载分区来使用！！！</p>\r\n							    <pre><code>\r\nroot@Toka:~# 再查看当前硬盘状态,看现的分区状况\r\nroot@Toka:~# fdisk -l\r\nDisk /dev/sda: 119.2 GiB, 128035676160 bytes, 250069680 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nDisklabel type: dos\r\nDisk identifier: 0x44e5be3f\r\n\r\n设备       启动     Start    末尾    扇区   Size Id 类型\r\n/dev/sda1  *         2048 230152191 230150144 109.8G 83 Linux\r\n/dev/sda2       230154238 250068991  19914754   9.5G  5 扩展\r\n/dev/sda5       230154240 250068991  19914752   9.5G 82 Linux 交换 / Solaris\r\n\r\n\r\nDisk /dev/sdb: 119.2 GiB, 128035676160 bytes, 250069680 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nDisklabel type: dos\r\nDisk identifier: 0x0bf0152e\r\n\r\n设备       启动 Start    末尾    扇区   Size Id 类型\r\n/dev/sdb1        2048 250069679 250067632 119.2G 83 Linux\r\n\r\n\r\nDisk /dev/sdc: 465.8 GiB, 500107862016 bytes, 976773168 sectors\r\nUnits: sectors of 1 * 512 = 512 bytes\r\nSector size (logical/physical): 512 bytes / 512 bytes\r\nI/O size (minimum/optimal): 512 bytes / 512 bytes\r\nDisklabel type: dos\r\nDisk identifier: 0xff56d139\r\n\r\n设备       启动 Start    末尾    扇区 Size Id 类型\r\n/dev/sdc1  *     2048 186650623 186648576  89G  7 HPFS/NTFS/exFAT\r\n\r\nroot@Toka:~# 在上面可以看到<span style=\"background-color: transparent; color: inherit; font-size: inherit;\">sdb</span><span style=\"background-color: transparent; color: inherit; font-size: inherit;\">直接分成了一个区了</span><span style=\"background-color: transparent; color: inherit; font-size: inherit;\">sdb1</span><span style=\"background-color: transparent; color: inherit; font-size: inherit;\"><br></span>						    	</code></pre>	\r\n						    	<p>接下来还要格式化刚才新建的分区(<span style=\"background-color: transparent; color: inherit; font-family: Menlo, Monaco, Consolas, \" courier=\"\" new\",=\"\" monospace;=\"\" font-size:=\"\" inherit;=\"\" white-space:=\"\" pre-wrap;\"=\"\">/dev/sdb1</span>)，并挂载好就可以使用了</p>\r\n						    	<pre><code>\r\nroot@Toka:~# 将/dev/sdb1格式化为ext4类型       \r\nroot@Toka:~# mkfs.ext4 /dev/sdb1 \r\nmke2fs 1.42.13 (17-May-2015)\r\n/dev/sdb1 contains a ntfs file system labelled \'68\'\r\n无论如何也要继续? (y,n) y\r\nDiscarding device blocks: 完成                            \r\nCreating filesystem with 31258454 4k blocks and 7815168 inodes\r\nFilesystem UUID: 3d7ecf8a-aeaf-4979-aeac-6cf40184714f\r\nSuperblock backups stored on blocks: \r\n        32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, \r\n        4096000, 7962624, 11239424, 20480000, 23887872\r\n\r\nAllocating group tables: 完成                            \r\n正在写入inode表: 完成                            \r\nCreating journal (32768 blocks): 完成\r\nWriting superblocks and filesystem accounting information: 完成   \r\n\r\nroot@Toka:~# 创建挂载目录(/data),并将/dev/sdb1挂载到/data\r\nroot@Toka:~# mkdir /data\r\nroot@Toka:~# mount /dev/sdb1 /data\r\nroot@Toka:~# 挂载好，查看下是否挂载成功\r\nroot@Toka:~# df -h\r\n文件系统        容量  已用  可用 已用% 挂载点\r\nudev            4.6G     0  4.6G    0% /dev\r\ntmpfs           950M  9.5M  940M    1% /run\r\n/dev/sda1       108G  4.0G   99G    4% /\r\ntmpfs           4.7G  204K  4.7G    1% /dev/shm\r\ntmpfs           5.0M  4.0K  5.0M    1% /run/lock\r\ntmpfs           4.7G     0  4.7G    0% /sys/fs/cgroup\r\ntmpfs           950M   44K  950M    1% /run/user/1000\r\ntmpfs           950M  8.0K  950M    1% /run/user/108\r\ntmpfs           950M     0  950M    0% /run/user/0\r\n/dev/sdb1       118G   60M  112G    1% /data                        #i注意是否有这行\r\nroot@Toka:~# 上面可以看到已经成功挂载，现在就可以使用了！！！\r\n						    	</code></pre>\r\n						    	<p>一般来说经过上面的步骤，已经可以正常使用新的硬盘了！  <br>\r\n						    	但是如果哪一天你不小心重启了你的服务器，那么就会发现在/data里面并没有数据!!!  <br>\r\n						        别慌,这只是因为重启后，系统没有自动挂载/dev/sdb这一块硬盘的原因，所以还要设置开机自动挂载！！！</p>\r\n						        <pre><code>     \r\nroot@Toka:~# vim /etc/fstab\r\n  # /etc/fstab: static file system information.\r\n  #\r\n  # Use \'blkid\' to print the universally unique identifier for a\r\n  # device; this may be used with UUID= as a more robust way to name devices\r\n  # that works even if disks are added and removed. See fstab(5).\r\n  #\r\n  # <file system=\"\"> <mount point=\"\">   <type>  <options>       <dump>  <pass>\r\n  # / was on /dev/vda1 during installation\r\n  UUID=fa712cf1-bdc1-4c06-a3ec-dafa0d38429b /               ext4    errors=remount-ro 0\r\n           1\r\n  # swap was on /dev/vda5 during installation\r\n  UUID=8634a363-7476-405c-bec3-23d87c7b49d6 none            swap    sw              0  \r\n         0\r\n  /dev/sr0        /media/cdrom0   udf,iso9660 user,noauto     0       0\r\n  # 下而这一行就是我们添加的自动挂载/dev/sdb1\r\n  /dev/sdb1       /data           ext4   defaults   0   0\r\nroot@Toka:~# 保存退出，这样就配置好了开机自动挂载硬盘了！！！\r\n						    	</pass></dump></options></type></mount></file></code></pre>\r\n						    	<p>是不是感觉技术派的Linux派特别给力呢？！！！</p>                            \r\n<p>记录一次4T硬盘分区(用gpt分区类型,不再用mbr,因为mbr只能最大支持单个分区为2TB)</p>\r\n<pre><code>\r\nroot@elapse-PC:/home/elapse# parted /dev/sda\r\nGNU Parted 3.3\r\n使用 /dev/sda\r\n欢迎使用 GNU Parted！输入 \'help\' 来查看命令列表。\r\n(parted) p                                                                \r\n型号：ATA WDC WD40EJRX-89A (scsi)\r\n磁盘 /dev/sda: 4001GB\r\n扇区大小 (逻辑/物理)：512B/4096B\r\n分区表：gpt\r\n磁盘标志：\r\n\r\n编号  起始点  结束点  大小    文件系统  名称     标志\r\n 1    1049kB  4001GB  4001GB            primary\r\n\r\n(parted) help                                                             \r\n  align-check TYPE N                       check partition N for TYPE(min|opt) alignment\r\n  help [COMMAND]                           打印通用求助信息，或 COMMAND 的帮助\r\n  mklabel,mktable LABEL-TYPE               创建新的磁盘卷标 (分区表)\r\n  mkpart 分区类型 [文件系统类型] 起始点 结束点 创建一个分区\r\n  name 编号 名称                           将指定“编号”的分区命名为“名称”\r\n  print [devices|free|list,all|数字]        显示分区表、可用设备、剩余空间、所有分区或特殊分区\r\n  quit                                     退出程序\r\n  rescue 起始点 终止点                      挽救临近“起始点”、“终止点”的遗失的分区\r\n  resizepart NUMBER END                    改变 NUMBER 的大小\r\n  rm NUMBER                                删除编号为 NUMBER 的分区\r\n  select 设备                              选择要编辑的设备\r\n  disk_set 旗标 状态                       变更已选设备上的旗标\r\n  disk_toggle [旗标]                       切换已选设备上的旗标状态\r\n  set 编号 旗标 状态                       改变指定“编号”分区的旗标\r\n  toggle [编号 [旗标]]                     切换“编号”分区上的“旗标”状态\r\n  unit 单位                                设置缺省的“单位”\r\n  version                                  显示目前 GNU Parted 的版本与版权信息\r\n(parted) p                                                                \r\n型号：ATA WDC WD40EJRX-89A (scsi)\r\n磁盘 /dev/sda: 4001GB\r\n扇区大小 (逻辑/物理)：512B/4096B\r\n分区表：gpt\r\n磁盘标志：\r\n\r\n编号  起始点  结束点  大小    文件系统  名称     标志\r\n 1    1049kB  4001GB  4001GB            primary\r\n\r\n(parted) mklabel gpt\r\n警告: 现有 /dev/sda 上的磁盘卷标将被销毁，而所有在这个磁盘上的数据将会丢失。您要继续吗？\r\n是/Yes/否/No? Yes\r\n(parted) p                                                                \r\n型号：ATA WDC WD40EJRX-89A (scsi)\r\n磁盘 /dev/sda: 4001GB\r\n扇区大小 (逻辑/物理)：512B/4096B\r\n分区表：gpt\r\n磁盘标志：\r\n\r\n编号  起始点  结束点  大小  文件系统  名称  标志\r\n\r\n(parted) mkpart \r\n分区名称？  []? luck                                                      \r\n文件系统类型？  [ext2]? ext4                                              \r\n起始点？ 0%                                                               \r\n结束点？ 100%                                                             \r\n(parted) p                                                                \r\n型号：ATA WDC WD40EJRX-89A (scsi)\r\n磁盘 /dev/sda: 4001GB\r\n扇区大小 (逻辑/物理)：512B/4096B\r\n分区表：gpt\r\n磁盘标志：\r\n\r\n编号  起始点  结束点  大小    文件系统  名称  标志\r\n 1    1049kB  4001GB  4001GB  ext4      luck\r\n\r\n(parted) quit                                                             \r\n信息: 你可能需要 /etc/fstab。\r\n\r\nroot@elapse-PC:/home/elapse# fdisk -l                              \r\nDisk /dev/sda：3.65 TiB，4000787030016 字节，7814037168 个扇区\r\nDisk model: WDC WD40EJRX-89A\r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 4096 字节\r\nI/O 大小(最小/最佳)：4096 字节 / 4096 字节\r\n磁盘标签类型：gpt\r\n磁盘标识符：494FB406-4C3D-4AC1-8D62-F949B6718098\r\n\r\n设备        起点       末尾       扇区  大小 类型\r\n/dev/sda1   2048 7814035455 7814033408  3.7T Linux 文件系统\r\n\r\n\r\nDisk /dev/sdc：931.53 GiB，1000204886016 字节，1953525168 个扇区\r\nDisk model: TOSHIBA HDWD110 \r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 4096 字节\r\nI/O 大小(最小/最佳)：4096 字节 / 4096 字节\r\n磁盘标签类型：dos\r\n磁盘标识符：0xcbe496c9\r\n\r\n设备       启动       起点       末尾       扇区   大小 Id 类型\r\n/dev/sdc1  *          2048  243273727  243271680   116G  7 HPFS/NTFS/exFAT\r\n/dev/sdc2        578820096 1585455103 1006635008   480G  7 HPFS/NTFS/exFAT\r\n/dev/sdc3       1585455104 1953523711  368068608 175.5G  f W95 扩展 (LBA)\r\n/dev/sdc5       1585457152 1953523711  368066560 175.5G  7 HPFS/NTFS/exFAT\r\n\r\n\r\nDisk /dev/sdb：119.25 GiB，128035676160 字节，250069680 个扇区\r\nDisk model: TOSHIBA THNSNJ12\r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 512 字节\r\nI/O 大小(最小/最佳)：512 字节 / 512 字节\r\n磁盘标签类型：gpt\r\n磁盘标识符：519C49BC-E3D7-4059-889C-EFC9B64DA55C\r\n\r\n设备          起点      末尾      扇区   大小 类型\r\n/dev/sdb1     2048   1050623   1048576   512M EFI 系统\r\n/dev/sdb2  1050624 250068991 249018368 118.8G Linux 文件系统\r\nroot@elapse-PC:/home/elapse# df -h\r\n文件系统        容量  已用  可用 已用% 挂载点\r\nudev             12G     0   12G    0% /dev\r\ntmpfs           2.3G  1.6M  2.3G    1% /run\r\n/dev/sdb2       117G  105G  5.6G   95% /\r\ntmpfs            12G  372M   11G    4% /dev/shm\r\ntmpfs           5.0M  4.0K  5.0M    1% /run/lock\r\ntmpfs            12G     0   12G    0% /sys/fs/cgroup\r\n/dev/sdb1       511M  212M  300M   42% /boot/efi\r\n/dev/sdc5       176G  173G  3.5G   99% /media/elapse/尾部\r\n/dev/sdc2       481G  469G   12G   98% /media/elapse/幸运星\r\ntmpfs           2.3G   28K  2.3G    1% /run/user/1000\r\nroot@elapse-PC:/home/elapse# mkfs.ext\r\nmkfs.ext2  mkfs.ext3  mkfs.ext4  \r\nroot@elapse-PC:/home/elapse# mkfs.ext4 /dev/sda1\r\nmke2fs 1.45.5 (07-Jan-2020)\r\n创建含有 976754176 个块（每块 4k）和 244195328 个inode的文件系统\r\n文件系统UUID：37f2860b-5e55-45b8-b3c7-ab8f72cabeb6\r\n超级块的备份存储于下列块： \r\n	32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208, \r\n	4096000, 7962624, 11239424, 20480000, 23887872, 71663616, 78675968, \r\n	102400000, 214990848, 512000000, 550731776, 644972544\r\n\r\n正在分配组表： 完成                            \r\n正在写入inode表： 完成                            \r\n创建日志（262144 个块） 完成\r\n写入超级块和文件系统账户统计信息： 已完成     \r\n\r\nroot@elapse-PC:/home/elapse# fdisk -l\r\nDisk /dev/sda：3.65 TiB，4000787030016 字节，7814037168 个扇区\r\nDisk model: WDC WD40EJRX-89A\r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 4096 字节\r\nI/O 大小(最小/最佳)：4096 字节 / 4096 字节\r\n磁盘标签类型：gpt\r\n磁盘标识符：494FB406-4C3D-4AC1-8D62-F949B6718098\r\n\r\n设备        起点       末尾       扇区  大小 类型\r\n/dev/sda1   2048 7814035455 7814033408  3.7T Linux 文件系统\r\n\r\n\r\nDisk /dev/sdc：931.53 GiB，1000204886016 字节，1953525168 个扇区\r\nDisk model: TOSHIBA HDWD110 \r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 4096 字节\r\nI/O 大小(最小/最佳)：4096 字节 / 4096 字节\r\n磁盘标签类型：dos\r\n磁盘标识符：0xcbe496c9\r\n\r\n设备       启动       起点       末尾       扇区   大小 Id 类型\r\n/dev/sdc1  *          2048  243273727  243271680   116G  7 HPFS/NTFS/exFAT\r\n/dev/sdc2        578820096 1585455103 1006635008   480G  7 HPFS/NTFS/exFAT\r\n/dev/sdc3       1585455104 1953523711  368068608 175.5G  f W95 扩展 (LBA)\r\n/dev/sdc5       1585457152 1953523711  368066560 175.5G  7 HPFS/NTFS/exFAT\r\n\r\n\r\nDisk /dev/sdb：119.25 GiB，128035676160 字节，250069680 个扇区\r\nDisk model: TOSHIBA THNSNJ12\r\n单元：扇区 / 1 * 512 = 512 字节\r\n扇区大小(逻辑/物理)：512 字节 / 512 字节\r\nI/O 大小(最小/最佳)：512 字节 / 512 字节\r\n磁盘标签类型：gpt\r\n磁盘标识符：519C49BC-E3D7-4059-889C-EFC9B64DA55C\r\n\r\n设备          起点      末尾      扇区   大小 类型\r\n/dev/sdb1     2048   1050623   1048576   512M EFI 系统\r\n/dev/sdb2  1050624 250068991 249018368 118.8G Linux 文件系统\r\nroot@elapse-PC:/home/elapse# \r\n\r\n</code></pre>'),(3,'<p>安装工具</p>\r\n<pre><code>\r\nroot@Toka:~# apt-get install libncurses5-dev\r\nroot@Toka:~# Redhat和其他Linux版本对应的是ncurses-devel,这里安装的母鸡是Debian\r\n</code></pre>\r\n<p>再安装cmake</p>	\r\n<pre><code>	\r\nroot@Toka:~# wget https://cmake.org/files/v3.7/cmake-3.7.2.tar.gz\r\nroot@Toka:~# tar -zxvf cmake-3.7.0.tar.gz\r\nroot@Toka:~# cd cmake-3.7.0\r\nroot@Toka:~# ./bootstrap\r\nroot@Toka:~# make\r\nroot@Toka:~# make install \r\n</code></pre>\r\n<p>下载MariaDB：<a href=\"https://mirrors.tuna.tsinghua.edu.cn/mariadb//mariadb-10.1.19/source/mariadb-10.1.19.tar.gz\" target=\"_blank\">mariadb-10.1.19.tar.gz</a> 或 <a href=\"https://downloads.mariadb.org/interstitial/mariadb-10.1.20/bintar-linux-glibc_214-x86_64/mariadb-10.1.20-linux-glibc_214-x86_64.tar.gz\" target=\"_blank\">mariadb-10.1.20-linux-glibc_214-x86_64.tar.gz</a>这里以mariadb-10.1.19.tar.gz为示例安装</p>\r\n\r\n<pre><code>	\r\nroot@Toka:~# wget https://mirrors.tuna.tsinghua.edu.cn/mariadb//mariadb-10.1.19/source/mariadb-10.1.19.tar.gz\r\nroot@Toka:~# tar -zxvf mariadb-10.1.19.tar.gz\r\nroot@Toka:~# cd mariadb-10.1.19 \r\nroot@Toka:~# cmake \\\r\n-DCMAKE_INSTALL_PREFIX=/usr/local/mysql \\\r\n-DSYSCONFDIR=/etc/mysql \\\r\n-DMYSQL_USER=mysql \\\r\n-DWITH_MYISAM_STORAGE_ENGINE=1 \\\r\n-DWITH_INNOBASE_STORAGE_ENGINE=1 \\\r\n-DWITH_ARCHIVE_STORAGE_ENGINE=1 \\\r\n-DWITH_MEMORY_STORAGE_ENGINE=1 \\\r\n-DWITH_READLINE=1 \\\r\n-DMYSQL_UNIX_ADDR=/var/run/mysqld/mysqld.sock \\\r\n-DMYSQL_TCP_PORT=3306 \\\r\n-DENABLED_LOCAL_INFILE=1 \\\r\n-DENABLE_DOWNLOADS=1 \\\r\n-DWITH_PARTITION_STORAGE_ENGINE=1 \\\r\n-DEXTRA_CHARSETS=all \\\r\n-DDEFAULT_CHARSET=utf8 \\\r\n-DDEFAULT_COLLATION=utf8_general_ci \\\r\n-DWITH_DEBUG=0 \\\r\n-DMYSQL_MAINTAINER_MODE=0 \\\r\n-DWITH_SSL:STRING=bundled \\\r\n-DWITH_ZLIB:STRING=bundled \\\r\n-DWITHOUT_MROONGA_STORAGE_ENGINE=1\r\n\r\n出错：\r\n/usr/bin/ld: cannot find -lz\r\ncollect2: error: ld returned 1 exit status\r\nstorage/tokudb/PerconaFT/ft/CMakeFiles/ft.dir/build.make:1382: recipe for target \'storage/tokudb/PerconaFT/ft/libft.so\' failed\r\nmake[2]: *** [storage/tokudb/PerconaFT/ft/libft.so] Error 1\r\n-DWITH_ZLIB=/usr/local/src/zlib-1.2.8\r\n\r\nroot@Toka:~# 按上面错误提示可知缺少zlib1g，安zlib1g-dev解决\r\nroot@Toka:~# apt-get install zlib1g-dev\r\n\r\nroot@Toka:~# 重新再次安装\r\n\r\nroot@Toka:~# cmake \\\r\n-DCMAKE_INSTALL_PREFIX=/usr/local/mysql \\\r\n-DSYSCONFDIR=/etc/mysql \\\r\n-DMYSQL_USER=mysql \\\r\n-DWITH_MYISAM_STORAGE_ENGINE=1 \\\r\n-DWITH_INNOBASE_STORAGE_ENGINE=1 \\\r\n-DWITH_ARCHIVE_STORAGE_ENGINE=1 \\\r\n-DWITH_MEMORY_STORAGE_ENGINE=1 \\\r\n-DWITH_READLINE=1 \\\r\n-DMYSQL_UNIX_ADDR=/var/run/mysqld/mysqld.sock \\\r\n-DMYSQL_TCP_PORT=3306 \\\r\n-DENABLED_LOCAL_INFILE=1 \\\r\n-DENABLE_DOWNLOADS=1 \\\r\n-DWITH_PARTITION_STORAGE_ENGINE=1 \\\r\n-DEXTRA_CHARSETS=all \\\r\n-DDEFAULT_CHARSET=utf8 \\\r\n-DDEFAULT_COLLATION=utf8_general_ci \\\r\n-DWITH_DEBUG=0 \\\r\n-DMYSQL_MAINTAINER_MODE=0 \\\r\n-DWITH_SSL:STRING=bundled \\\r\n-DWITH_ZLIB:STRING=bundled \\\r\n-DWITHOUT_MROONGA_STORAGE_ENGINE=1\r\n\r\n警告：Warning: Bison executable not found in PATH\r\nroot@Toka:~# apt-get install bison \r\nroot@Toka:~# 解决后，重新再次安装\r\n\r\nroot@Toka:~# cmake \\\r\n-DCMAKE_INSTALL_PREFIX=/usr/local/mysql \\\r\n-DSYSCONFDIR=/etc/mysql \\\r\n-DMYSQL_USER=mysql \\\r\n-DWITH_MYISAM_STORAGE_ENGINE=1 \\\r\n-DWITH_INNOBASE_STORAGE_ENGINE=1 \\\r\n-DWITH_ARCHIVE_STORAGE_ENGINE=1 \\\r\n-DWITH_MEMORY_STORAGE_ENGINE=1 \\\r\n-DWITH_READLINE=1 \\\r\n-DMYSQL_UNIX_ADDR=/var/run/mysqld/mysqld.sock \\\r\n-DMYSQL_TCP_PORT=3306 \\\r\n-DENABLED_LOCAL_INFILE=1 \\\r\n-DENABLE_DOWNLOADS=1 \\\r\n-DWITH_PARTITION_STORAGE_ENGINE=1 \\\r\n-DEXTRA_CHARSETS=all \\\r\n-DDEFAULT_CHARSET=utf8 \\\r\n-DDEFAULT_COLLATION=utf8_general_ci \\\r\n-DWITH_DEBUG=0 \\\r\n-DMYSQL_MAINTAINER_MODE=0 \\\r\n-DWITH_SSL:STRING=bundled \\\r\n-DWITH_ZLIB:STRING=bundled \\\r\n-DWITHOUT_MROONGA_STORAGE_ENGINE=1\r\n\r\n这下完好，不警告：\r\n-- Configuring done\r\n-- Generating done\r\n-- Build files have been written to: /usr/local/src/mariadb-10.1.19\r\n可以放心进行下一步安装了！！\r\n\r\nroot@Toka:~# make\r\n[100%] Built target my_safe_process\r\nroot@Toka:~# 没报错，继续\r\nroot@Toka:~# make install\r\n</code></pre>\r\n<p>经过以上安装大功告成！！！<br>\r\n不过还要添加mysql环境变量，不然每次打mysql命令时都要打绝对路径才能生效。</p>\r\n<pre><code>	\r\nroot@Toka:~#  echo -e \'\\n export PATH=$PATH:/usr/local/mysql/bin \\n\' &gt;&gt; ~/.bashrc &amp;&amp; source ~/.bashrc\r\n</code></pre>\r\n<p>接下来创建mysql用户和组</p>\r\n<pre><code>	\r\nroot@Toka:~#  groupadd mysql\r\nroot@Toka:~#  useradd -r -g mysql -s /bin/false mysql\r\n</code></pre>\r\n<p>接下来简单配置一下，才可以用</p>\r\n<pre><code>	\r\nroot@Toka:~#  chown -R mysql:mysql /usr/local/mysql/data\r\nroot@Toka:~#  mkdir /var/run/mysqld\r\nroot@Toka:~#  chown -R mysql:mysql /var/run/mysqld/\r\nroot@Toka:~#  cd /usr/local/mysql\r\nroot@Toka:~#  mkdir /etc/mysql\r\nroot@Toka:~#  cp support-files/my-small.cnf /etc/mysql/my.cnf\r\nroot@Toka:~#  修改配置文件：\r\nroot@Toka:~#  vim /etc/mysql/my.cnf\r\n# 在[client]下添加以下行\r\ndefault-character-set = utf8\r\n# 在[mysqld]下添加以下行\r\ncharacter-set-server = utf8\r\nroot@Toka:~# 初始化数据库\r\nroot@Toka:~# scripts/mysql_install_db --user=mysql\r\nroot@Toka:~# 先启动mysql\r\nroot@Toka:~# /usr/local/mysql/support-files/mysql.server start\r\nroot@Toka:~# 再执行修改密码：\r\nroot@Toka:~# /usr/local/mysql/bin/mysql_secure_installation\r\n提示：Enter current password for root (enter for none):  \r\n直接回车，因为我们刚安装还没有密码\r\n提示：Set root password? [Y/n]\r\n输入：y\r\n提示：New password:\r\n输入新密码\r\n提示：Re-enter new password:\r\n重新输入刚才的密码\r\n提示：Remove anonymous users? [Y/n]\r\n输入：y\r\n提示：Disallow root login remotely? [Y/n]\r\n输入：n\r\n提示：Remove test database and access to it? [Y/n]\r\n输入：y\r\n提示：Reload privilege tables now? [Y/n]\r\n输入：y\r\nAll done!  If you\'ve completed all of the above steps, your MariaDB installation should now be secure.\r\nThanks for using MariaDB!\r\n\r\nroot@Toka:~# 再执行如下修改root用户可远程登录\r\nroot@Toka:~# mysql -h localhost -u root -p\r\nmysql -h localhost -u root -p\r\nMariaDB [(none)]&gt; use mysql\r\nMariaDB [mysql]&gt; update user set host=\'%\' where user=\'root\' and host=\'localhost\';\r\nMariaDB [mysql]&gt; select host from user where user=\'root\';\r\n+-----------+\r\n| host      |\r\n+-----------+\r\n| %         |\r\n| 127.0.0.1 |\r\n| ::1       |\r\n| debian    |\r\n+-----------+\r\n4 rows in set (0.00 sec)\r\nMariaDB [(none)]&gt; FLUSH PRIVILEGES;\r\nMariaDB [(none)]&gt; exit;\r\n\r\nroot@Toka:~# 至此数据库安装完成!!\r\n</code></pre>\r\n<p>安装MariaDB到此全部完成</p>\r\n<p>日常重启控制命令： <br>\r\n        启动：/usr/local/mysql/support-files/mysql.server start    <br>\r\n        停止：/usr/local/mysql/support-files/mysql.server stop   <br>\r\n        重启：/usr/local/mysql/support-files/mysql.server restart    <br>\r\n</p>\r\n<p>\r\nMariaDB官网：<a href=\"https://downloads.mariadb.org/ \" target=\"_blank\">https://downloads.mariadb.org/ </a>    <br>\r\n参考：<br>&nbsp; &nbsp; &nbsp; &nbsp; <a href=\"https://mariadb.com/kb/zh-cn/installing-mariadb-binary-tarballs/ \" target=\"_blank\">https://mariadb.com/kb/zh-cn/installing-mariadb-binary-tarballs/ </a>    <br>&nbsp; &nbsp; &nbsp; &nbsp;<a href=\" http://opso.coding.me/2016/03/29/mariadb-install/ \" target=\"_blank\"> http://opso.coding.me/2016/03/29/mariadb-install/ </a>     <br>&nbsp; &nbsp; &nbsp; &nbsp;<a href=\" http://cloudline.iteye.com/blog/867772 \" target=\"_blank\"> http://cloudline.iteye.com/blog/867772 </a>                <br>\r\n</p>\r\n<pre><code>	\r\n=====================================================================================\r\n MySql主从配置：\r\n=====================================================================================\r\n  1.1、版本一致\r\n  ##1.2、初始化表，并在后台启动mysql\r\n  ##1.3、修改root的密码\r\n-------------------------------------------------------------------------------------\r\n修改主服务器master:\r\nvim /usr/local/mysql/my.cnf\r\n #服务器唯一ID，默认是1，一般取IP最后一段\r\n server-id=154\r\n\r\n #启用二进进制日志\r\n log-bin=mysql-bin\r\n # binlog-do-db = testdb   #只记录testdb库变化,多个库用‘,’分隔\r\n # binlog-ignore-db=mysql  #忽略mysql库变化，多个库用‘,’分隔\r\n # expire_logs_days =7     #binlog日志只保留7天内的数据\r\n-------------------------------------------------------------------------------------\r\n\r\n修改从服务器slave:\r\nvim /usr/local/mysql/my.cnf\r\n #服务器唯一ID，默认是1，一般取IP最后一段\r\n server-id=135\r\n #启用二进进制日志\r\n log-bin=mysql-bin\r\n #log-slave-updates                      #级联复制(A-&gt;B-&gt;C)\r\n # expire_logs_days =7                   #binlog日志只保留7天内的数据\r\n # replicate-ignore-db=mysql           #不同步mysql库，多个库用‘,’分隔\r\n # replicate-do-db = testdb            #只同步testdb库，多个库用‘,’分隔\r\n # replicate-do-table = test_tb        #只同步test_tb表，多个表用‘,’分隔\r\n # replicate-ignore-table = test_tb    #不同步test_tb表，多个表用‘,’分隔\r\n # replicate-wild-do-table = test_tb   #同表，可以加通配符（replicate-wild-do-table=db_name.%） 只复制哪个库的哪个表\r\n # replicate-wild-ignore-table = test  #不同步的表，通配符来规则范围（replicate-wild-ignore-table=mysql.%）忽略哪个库的哪个表\r\n\r\n重启两台服务器的mysql\r\n/usr/local/mysql/support-files/mysql.server restart\r\n--------------------------------------------------------------------------------------\r\n在主服务器上建立帐户并授权slave:\r\n   #/usr/local/mysql/bin/mysql -uroot -p\r\n   mysql&gt; GRANT REPLICATION SLAVE ON *.* to \'mysync\'@\'%\' identified by \'syncpasswd\'; \r\n    ##一般不用root帐号，“%”表示所有客户端都可能连，只要帐号，密码正确，此处可用具体客户端IP代替，如192.168.145.226，加强安全。\r\n　 mysql&gt; FLUSH PRIVILEGES;\r\n登录主服务器的mysql，查询master的状态      \r\n\r\nmysql&gt; show master status;          ###记住记住下面这两个值，从服务器中要用到\r\n+------------------+----------+--------------+------------------+-------------------+\r\n| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |\r\n+------------------+----------+--------------+------------------+-------------------+\r\n| mysql-bin.000002 |      607 |              |                  |                   |\r\n+------------------+----------+--------------+------------------+-------------------+\r\n1 row in set (0.00 sec)\r\n注：执行完此步骤后不要再操作主服务器MYSQL，防止主服务器状态值变化\r\n\r\n-----------------------------------------------------------------------------------------------\r\n配置从服务器Slave：\r\nmysql&gt; change master to master_host=\'218.16.120.154\',\r\nmaster_user=\'mysync\',\r\nmaster_password=\'syncpasswdcmb7d\',\r\nmaster_log_file=\'mysql-bin.000002\',\r\nmaster_log_pos=607;\r\nmysql&gt; start slave;                              ##这里是开户从服务(停止为:stop slave)\r\nmysql&gt; show slave status\\G;                      \r\n              Master_Log_File: mysql-bin.000002\r\n          Read_Master_Log_Pos: 607\r\n               Relay_Log_File: debian-relay-bin.000002\r\n                Relay_Log_Pos: 770\r\n        Relay_Master_Log_File: mysql-bin.000002\r\n             Slave_IO_Running: Yes               ###这个必须为YES\r\n            Slave_SQL_Running: Yes               ###这个必须为YES\r\n\r\n-----------------------------------------------------------------------------------------------\r\n如果从服务器配置出错，可以先重围（ reset slave;）再配置就可以了！\r\n到此就主从MySql就配置完成了，可以测试了。\r\n注：MySql每次重启都要重新配置主从同步哦!!\r\n</code></pre>\r\n'),(4,'<p>安装工具cmake</p>\r\n<pre><code>\r\nroot@Toka:~# \r\nroot@Toka:~# wget https://cmake.org/files/v3.7/cmake-3.7.2.tar.gz\r\nroot@Toka:~# tar -zxvf cmake-3.7.0.tar.gz\r\nroot@Toka:~# cd cmake-3.7.0\r\nroot@Toka:~# ./bootstrap\r\nroot@Toka:~# make\r\nroot@Toka:~# make install \r\nroot@Toka:~# #或者直接在线安装cmake\r\nroot@Toka:~# apt-get install cmake\r\n</code></pre>\r\n<p>下载mysql：<a href=\"http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.4-m14.tar.gz\" target=\"_blank\">mysql-5.7.4-m14.tar.gz</a>、<a href=\"http://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.0-dmr.tar.gz\" target=\"_blank\">mysql-8.0.0-dmr.tar.gz</a>、<a href=\"http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.15.tar.gz\" target=\"_blank\">mysql-5.7.15.tar.gz</a></p>	\r\n<pre><code>\r\nroot@Toka:~# wget http://dev.mysql.com/get/Downloads/MySQL-5.7/mysql-5.7.15.tar.gz\r\nroot@Toka:~# tar -zxvf mysql-5.7.15.tar.gz\r\nroot@Toka:~# cd mysql-5.7.15\r\nroot@Toka:~# 下面这条命令中的“.”表示当前目录，不能漏了！！！\r\nroot@Toka:~# cmake .      \r\nCMake Error at cmake/readline.cmake:64 (MESSAGE):\r\n  Curses library not found.  Please install appropriate package,\r\n\r\n      remove CMakeCache.txt and rerun cmake.On Debian/Ubuntu, package name is libncurses5-dev, on Redhat and derivates it is ncurses-devel.\r\nCall Stack (most recent call first):\r\n  cmake/readline.cmake:107 (FIND_CURSES)\r\n  cmake/readline.cmake:181 (MYSQL_USE_BUNDLED_EDITLINE)\r\n  CMakeLists.txt:467 (MYSQL_CHECK_EDITLINE)\r\n\r\n-- Configuring incomplete, errors occurred!\r\n\r\nroot@Toka:~# 上面报错主要提示缺少libncurses5-dev，所以下面安装缺少的libncurses5-dev\r\nroot@Toka:~# apt-get install libncurses5-dev\r\nroot@Toka:~# 重新cmake\r\nroot@Toka:~# cmake .   \r\nConfiguring done\r\nGenerating done\r\nroot@Toka:~# 成功了，继续下面的安装\r\nroot@Toka:~# make\r\nroot@Toka:~# make install \r\n</code></pre>\r\n<p>至此安装完成，但还要做一定的配置就可以使用mysql了</p>\r\n<pre><code>\r\nroot@Toka:~# 创建mysql专属的用户名和组名\r\nroot@Toka:~# groupadd mysql\r\nroot@Toka:~# useradd -r -g mysql mysql\r\nroot@Toka:~# cd /usr/local/mysql\r\nroot@Toka:~# chown -R mysql .\r\nroot@Toka:~# chgrp -R mysql .\r\nroot@Toka:~# scripts/mysql_install_db --user=mysql\r\nroot@Toka:~# chown -R root . \r\nroot@Toka:~# chown -R mysql data\r\n</code></pre>\r\n<p>以下为mysql 5.7版本才需要</p>\r\n<pre><code>\r\nroot@Toka:~#  vim my.cnf\r\n#加入如下行，这样就可以不用密码登录了\r\nskip-grant-tables\r\n#保存退出\r\nroot@Toka:~# 启动mysql\r\nroot@Toka:~# support-files/mysql.server start \r\nroot@Toka:~# bin/mysql -h localhost -u root\r\nmysql&gt; use mysql;\r\nmysql&gt; update user set password=password(\'123456\') where user=\'root\';\r\nmysql&gt; flush privileges;\r\nmysql&gt; exit;\r\nroot@Toka:~# vim my.cnf\r\n#再注销刚才这一行\r\n#skip-grant-tables\r\n#保存退出\r\nroot@Toka:~# support-files/mysql.server restart \r\nroot@Toka:~# bin/mysql -h localhost -u root -p123456\r\nmysql&gt; SET PASSWORD=PASSWORD(\'新的密码\');\r\nmysql&gt; exit;\r\nroot@Toka:~# 至此mysql密码修改完成\r\n</code></pre>\r\n<p>\r\n重新启动mysql:<br>\r\n/usr/local/mysql/support-files/mysql.server restart </p>\r\n<pre><code>\r\nroot@Toka:~# 覆盖系统默认的mysql 低版本的服务，可以讲如下脚本拷入系统启动目录。\r\nroot@Toka:~# cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysql.server\r\nroot@Toka:~# 到此安装完成\r\n</code></pre>\r\n<p>大功告成！！！！</p>\r\n<p>非本机用户还不能登录而出现ERROR 1130的话,要改mysql数据库里的user表<br>如下</p>\r\n<pre><code>\r\nroot@Toka:~# mysql -h localhost -u root\r\nMysql&gt;  use mysql;\r\nMysql&gt;  update mysql.user set host=\'%\' where user=\'root\' and host=\'localhost\';\r\nMysql&gt;  UPDATE `mysql`.`user` SET `password` = PASSWORD( \'kaQWkd,.23Ks\' ) WHERE `user`.`Host` = CAST( 0x25 AS BINARY ) AND `user`.`User` = CAST( 0x726f6f74 AS BINARY ) ;\r\nMysql&gt;  exit;\r\nroot@Toka:~# /usr/local/mysql/support-files/mysql.server restart \r\n</code></pre>'),(5,'<p>VPN的种类有：L2TP、PPTP等 <br>\r\n如标题，本文主要讲L2TP这一类的VPN服务器搭建 <br>\r\n那么现在开始吧！！！\r\n</p>\r\n<ol>\r\n   <li>安装openswan，配置IPSEC</li>\r\n   <pre><code>\r\nroot@Toka:~# 旧版本的Debian可以直接在线安装\r\nroot@Toka:~# apt-get install openswan\r\nroot@Toka:~# 新版本的Debian软件源包里已经不包含openswan了，所以只以源码编译安装！！\r\nroot@Toka:~# 安装openswan必需库\r\nroot@Toka:~# apt-get install libgmp3-dev\r\nroot@Toka:~# apt-get install gawk mawk flex bison\r\nroot@Toka:~# apt-get install iproute2\r\nroot@Toka:~# 安装多线程下载工具\r\nroot@Toka:~# apt-get install axel\r\nroot@Toka:~# 用多线程axel下载器来下载openswan源码\r\nroot@Toka:~# axel https://download.openswan.org/openswan/openswan-2.6.49.1.tar.gz\r\nroot@Toka:~# 解压并安装\r\nroot@Toka:~# tar -zxvf openswan-2.6.49.1.tar.gz\r\nroot@Toka:~# cd openswan-2.6.49.1/\r\nroot@Toka:~# make programs\r\nroot@Toka:~# make install\r\nroot@Toka:~# 安装完成，查看下是否安装成功\r\nroot@Toka:~# ipsec --version\r\nLinux Openswan U2.6.49.1/K(no kernel code presently loaded)\r\nSee `ipsec --copyright\' for copyright information.\r\nroot@Toka:~# 已经安装成功，接下来启动ipsec\r\nroot@Toka:~# service ipsec start\r\nFailed to start ipsec.service: Unit ipsec.service not found.\r\nroot@Toka:~# 以上提示没有ipsec服务，所以只有用绝对路径来启动\r\nroot@Toka:~# /etc/init.d/ipsec start\r\n&lt;27&gt;Oct 14 17:31:51 ipsec_setup: Starting Openswan IPsec U2.6.49.1/K4.9.0-3-amd64...\r\nroot@Toka:~# 启动成功\r\n   </code></pre>\r\n   <p>至些成功安装了，接下来更新IP转发</p>\r\n   <pre><code>\r\nroot@Toka:~# 先备份原有文件\r\nroot@Toka:~# cp /etc/sysctl.conf /etc/sysctl.conf.yl\r\nroot@Toka:~# 配置IP转发\r\nroot@Toka:~# echo \"net.ipv4.ip_forward = 1\" |  tee -a /etc/sysctl.conf\r\nroot@Toka:~# echo \"net.ipv4.conf.all.accept_redirects = 0\" |  tee -a /etc/sysctl.conf\r\nroot@Toka:~# echo \"net.ipv4.conf.all.send_redirects = 0\" |  tee -a /etc/sysctl.conf\r\nroot@Toka:~# echo \"net.ipv4.conf.default.rp_filter = 0\" |  tee -a /etc/sysctl.conf\r\nroot@Toka:~# echo \"net.ipv4.conf.default.accept_source_route = 0\" |  tee -a /etc/sysctl.conf\r\nroot@Toka:~# echo \"net.ipv4.conf.default.send_redirects = 0\" |  tee -a /etc/sysctl.conf\r\nroot@Toka:~# echo \"net.ipv4.icmp_ignore_bogus_error_responses = 1\" |  tee -a /etc/sysctl.conf\r\nroot@Toka:~# for vpn in /proc/sys/net/ipv4/conf/*; \r\n&gt; do \r\n&gt;   echo 0 &gt; $vpn/accept_redirects;\r\n&gt;   echo 0 &gt; $vpn/send_redirects; \r\n&gt; done\r\nroot@Toka:~# IP转发完成\r\n   </code></pre>\r\n   <p>接下来设置IP table <br><span style=\"background-color: rgb(255, 0, 0);\">\r\n   这里请各位注意，不配IP table，VPN服务器安装好连接上去后，客户面是上不了网的！！！</span></p>\r\n   <pre><code>\r\nroot@Toka:~# iptables -t nat -A POSTROUTING -s 172.16.1.1/24 -o eth0 -j MASQUERADE  \r\n   </code></pre>\r\n   <p>配置IPSEC</p>\r\n   <pre><code>\r\nroot@Toka:~# 先备份原来的配置文件\r\nroot@Toka:~# cp /etc/ipsec.conf /etc/ipsec.conf.yl \r\nroot@Toka:~# MYIP=`/sbin/ifconfig -a|grep inet|grep -v 127.0.0.1|grep -v inet6|awk \'{print $2}\'|tr -d \"addr:\"`\r\nroot@Toka:~# echo $MYIP\r\n122.114.228.217 10.122.228.217\r\nroot@Toka:~# 上面MYIP出现双IP，所以还是手动设置为正确的IP，如果\'echo $MYIP\'只出现一个IP4，那就正确\r\nroot@Toka:~# MYIP=\'122.114.228.217\'\r\nroot@Toka:~# 好了，变量MYIP设置完成，接下来直接生成ipsec.conf配置文件\r\nroot@Toka:~# cat &gt;/etc/ipsec.conf &lt;&lt; <eof>EOF\r\n&gt;version 2 # conforms to second version of ipsec.conf specification\r\n&gt; \r\n&gt; config setup\r\n&gt;     dumpdir=/var/run/pluto/\r\n&gt;     #in what directory should things started by setup (notably the Pluto daemon) be allowed to dump core?\r\n&gt; \r\n&gt;     nat_traversal=yes\r\n&gt;     #whether to accept/offer to support NAT (NAPT, also known as \"IP Masqurade\") workaround for IPsec\r\n&gt; \r\n&gt;     virtual_private=%v4:10.0.0.0/8,%v4:192.168.0.0/16,%v4:172.16.0.0/12,%v6:fd00::/8,%v6:fe80::/10\r\n&gt;     #contains the networks that are allowed as subnet= for the remote client. In other words, the address ranges that may live behind a NAT router through which a client connects.\r\n&gt; \r\n&gt;     protostack=netkey\r\n&gt;     #decide which protocol stack is going to be used.\r\n&gt; \r\n&gt;     force_keepalive=yes\r\n&gt;     keep_alive=60\r\n&gt;     # Send a keep-alive packet every 60 seconds.\r\n&gt; \r\n&gt; conn L2TP-PSK-noNAT\r\n&gt;     authby=secret\r\n&gt;     #shared secret. Use rsasig for certificates.\r\n&gt; \r\n&gt;     pfs=no\r\n&gt;     #Disable pfs\r\n&gt; \r\n&gt;     auto=add\r\n&gt;     #the ipsec tunnel should be started and routes created when the ipsec daemon itself starts.\r\n&gt; \r\n&gt;     keyingtries=3\r\n&gt;     #Only negotiate a conn. 3 times.\r\n&gt; \r\n&gt;     ikelifetime=8h\r\n&gt;     keylife=1h\r\n&gt; \r\n&gt;     ike=aes256-sha1,aes128-sha1,3des-sha1\r\n&gt;     phase2alg=aes256-sha1,aes128-sha1,3des-sha1\r\n&gt;     # https://lists.openswan.org/pipermail/users/2014-April/022947.html\r\n&gt;     # specifies the phase 1 encryption scheme, the hashing algorithm, and the diffie-hellman group. The modp1024 is for Diffie-Hellman 2. Why \'modp\' instead of dh? DH2 is a 1028 bit encryption algorithm that modulo\'s a prime number, e.g. modp1028. See RFC 5114 for details or the wiki page on diffie hellmann, if interested.\r\n&gt; \r\n&gt;     type=transport\r\n&gt;     #because we use l2tp as tunnel protocol\r\n&gt; \r\n&gt;     left=$MYIP\r\n&gt;     leftnexthop=$MYIP\r\n&gt;     #fill in server IP above\r\n&gt; \r\n&gt;     leftprotoport=17/1701\r\n&gt;     right=%any\r\n&gt;     rightprotoport=17/%any\r\n&gt; \r\n&gt;     dpddelay=10\r\n&gt;     # Dead Peer Dectection (RFC 3706) keepalives delay\r\n&gt;     dpdtimeout=20\r\n&gt;     #  length of time (in seconds) we will idle without hearing either an R_U_THERE poll from our peer, or an R_U_THERE_ACK reply.\r\n&gt;     dpdaction=clear\r\n&gt;     # When a DPD enabled peer is declared dead, what action should be taken. clear means the eroute and SA with both be cleared.\r\n&gt; EOF\r\nroot@Toka:~# \r\n   </eof></code></pre>\r\n    <p>接下来配置IPSEC连接的公钥</p>\r\n   <pre><code>\r\nroot@Toka:~# 注意，这里把公钥配置为“toka.pro”\r\nroot@Toka:~# cat &gt;/etc/ipsec.secrets  &lt;&lt; <eof>EOF\r\n&gt; $MYIP %any: PSK \"toka.pro\"\r\n&gt; EOF\r\nroot@Toka:~# 接下来重启下服务\r\nroot@Toka:~# /etc/init.d/ipsec restart\r\n&lt;27&gt;Jul 30 23:11:35 ipsec_setup: Stopping Openswan IPsec...\r\n&lt;27&gt;Jul 30 23:11:37 ipsec_setup: Starting Openswan IPsec U2.6.49.1/K4.9.0-3-amd64...\r\nroot@Toka:~# 再认证下，如果出现如下，刚全部ipsec配置正确！！！\r\nroot@Toka:~# ipsec verify\r\nChecking if IPsec got installed and started correctly:\r\n\r\nVersion check and ipsec on-path                         [OK]\r\nOpenswan U2.6.49.1/K4.9.0-3-amd64 (netkey)\r\nSee `ipsec --copyright\' for copyright information.\r\nChecking for IPsec support in kernel                    [OK]\r\n NETKEY: Testing XFRM related proc values\r\n         ICMP default/send_redirects                    [OK]\r\n         ICMP default/accept_redirects                  [NOT DISABLED]\r\n\r\n  Disable /proc/sys/net/ipv4/conf/*/accept_redirects or NETKEY will cause act on or cause sending of bogus ICMP redirects!\r\n\r\n         XFRM larval drop                               [OK]\r\nHardware random device check                            [N/A]\r\nTwo or more interfaces found, checking IP forwarding    [OK]\r\nChecking rp_filter                                      [OK]\r\nChecking that pluto is running                          [OK]\r\n Pluto listening for IKE on udp 500                     [OK]\r\n Pluto listening for IKE on tcp 500                     [NOT IMPLEMENTED]\r\n Pluto listening for IKE/NAT-T on udp 4500              [OK]\r\n Pluto listening for IKE/NAT-T on tcp 4500              [NOT IMPLEMENTED]\r\n Pluto listening for IKE on tcp 10000 (cisco)           [NOT IMPLEMENTED]\r\nChecking NAT and MASQUERADEing                          [TEST INCOMPLETE]\r\nChecking \'ip\' command                                   [OK]\r\nChecking \'iptables\' command                             [OK]\r\n\r\nipsec verify: encountered errors\r\nroot@Toka:~# ipsec安装配置完成\r\n   </eof></code></pre>\r\n\r\n   <li>安装xl2tpd</li>\r\n   <p>安装并配置xl2tpd ppp lsof</p>\r\n   <pre><code>\r\nroot@Toka:~# apt-get install xl2tpd ppp lsof\r\nroot@Toka:~# 配置xl2tpd，先备份原来的配置文件\r\nroot@Toka:~# cp /etc/xl2tpd/xl2tpd.conf /etc/xl2tpd/xl2tpd.conf.yl\r\nroot@Toka:~# cat &gt;/etc/xl2tpd/xl2tpd.conf  &lt;&lt; <eof>EOF\r\n&gt; [global]\r\n&gt; ipsec saref = yes\r\n&gt; saref refinfo = 30\r\n&gt; \r\n&gt; ;debug avp = yes\r\n&gt; ;debug network = yes\r\n&gt; ;debug state = yes\r\n&gt; ;debug tunnel = yes\r\n&gt; \r\n&gt; [lns default]\r\n&gt; ip range = 172.16.1.30-172.16.1.100\r\n&gt; local ip = 172.16.1.1\r\n&gt; refuse pap = yes\r\n&gt; require authentication = yes\r\n&gt; ;ppp debug = yes\r\n&gt; pppoptfile = /etc/ppp/options.xl2tpd\r\n&gt; length bit = yes\r\n&gt; EOF </eof>\r\nroot@Toka:~# 配置PPP\r\nroot@Toka:~# cat &gt;/etc/ppp/options.xl2tpd  &lt;&lt; <eof>EOF\r\n&gt; require-mschap-v2\r\n&gt; ms-dns 119.29.29.29\r\n&gt; ms-dns 4.2.2.1\r\n&gt; auth\r\n&gt; mtu 1000\r\n&gt; mru 1000\r\n&gt; crtscts\r\n&gt; hide-password\r\n&gt; modem\r\n&gt; name l2tpd\r\n&gt; proxyarp\r\n&gt; lcp-echo-interval 0\r\n&gt; lcp-echo-failure 0\r\n&gt; EOF </eof>\r\nroot@Toka:~# 添加VPN账户和密码\r\nroot@Toka:~# cat &gt;/etc/ppp/chap-secrets  &lt;&lt; <eof>EOF\r\n&gt; # Secrets for authentication using CHAP\r\n&gt; # client       server    secret       IP addresses\r\n&gt; # 账号         服务类型   密码        IP\r\n&gt; toka           l2tpd     toka.pro     *\r\n&gt; EOF </eof>\r\nroot@Toka:~# 请记住上面设置了VPN的账号为toka，密码为toka.pro,客户端连接时请不要输错\r\nroot@Toka:~# 至此全部VPN服务器安装配置完成，重启所有服务，然后就可以用客户端连接上了！！\r\nroot@Toka:~# /etc/init.d/ipsec restart\r\nroot@Toka:~# /etc/init.d/xl2tpd restart\r\n   </code></pre>\r\n   <p>大功告成！！至此你需要注意以下三点： <br>\r\n1.客户端连接时所选择的VPN类型为：使用预共享密钥的 L2TP/IPsec  <br>\r\n2.连接时填入服务器地址IP不能错，预共享密钥为上面配置的toka.net,账号toka,密码toka.pro   <br>\r\n3.服务器所在地，最好在国外，因为在国内的服务器也一样的被封锁了访问外国！！！\r\n   </p>\r\n\r\n</ol>'),(6,'                                <p>\r\n默认安装phpMyAdmin，通常只能连一台MySql服务器，\r\n其配置信息是保存在phpMyAdmin的配置文件里的，\r\n当我们需要在多台服务器之间进行切换登陆的时候，\r\n修改起来非常麻烦。遵照下面的配置方法，\r\n我们可以方便的使用phpMyAdmin连接多台MySQL。\r\n</p>\r\n<ol>\r\n<li>登陆phpMyAdmin时输入服务器ip地址、用户名、密码操作步骤</li>\r\n<p>操作步骤: <br>\r\n修改phpMyAdmin目录下的 /libraries/config.default.php\r\n</p>\r\n<pre><code>\r\n$cfg[\'AllowArbitraryServer\'] = true;   ###默认值为false，改成true后可以输入服务器ＩＰ\r\n</code></pre>\r\n<li>登陆phpMyAdmin时只需输入用户名、密码，服务器地址为下拉列表可选，登陆后也可选择其他服务器快速切换。</li>\r\n<p>先修改phpMyAdmin目录下的 /libraries/config.default.php</p>\r\n<pre><code>\r\n$cfg[\'AllowArbitraryServer\'] = false;  \r\n</code></pre>\r\n<p>然后将phpMyAdmin根目录下的config.sample.inc.php 文件重命名为config.inc.php</p>\r\n<p>再修改config.inc.php文件，找到 First server 注释部分，将其添加以下内容</p>\r\n<pre><code>\r\n$hosts[]=[\'host\'=>\'localhost\',\'user\'=>\'root\',\'password\'=>\'root\'];\r\n$hosts[]=[\'host\'=>\'elapse.data\',\'user\'=>\'root\',\'password\'=>\'root2123\'];       //快云\r\n$hosts[]=[\'host\'=>\'vip.gust.cn\',\'user\'=>\'root\',\'password\'=>\'dasdfroo21m\'];    //腾讯云\r\n\r\n###$hosts数组中，host为服务器IP地址，user是Mysql登录用户名,Password是登录密码，对应改成自己的\r\n###这里我配置了三台Mysql服务器\r\nforeach ($hosts as $key => $value) {\r\n	# code...\r\n	/* Authentication type */\r\n	$cfg[\'Servers\'][$key+1][\'auth_type\'] = \'cookie\';\r\n\r\n	/* Server parameters */\r\n	$cfg[\'Servers\'][$key+1][\'host\'] = $value[\'host\'];   //修改host\r\n	$cfg[\'Servers\'][$key+1][\'connect_type\'] = \'tcp\';\r\n	$cfg[\'Servers\'][$key+1][\'compress\'] = false;\r\n	/* Select mysqli if your server has it */\r\n	$cfg[\'Servers\'][$key+1][\'extension\'] = \'mysql\';\r\n	$cfg[\'Servers\'][$key+1][\'AllowNoPassword\'] = true;\r\n	$cfg[\'Servers\'][$key+1][\'user\'] = $value[\'user\'];  //修改用户名\r\n	$cfg[\'Servers\'][$key+1][\'password\'] = $value[\'password\']; //密码\r\n	/* rajk - for blobstreaming */\r\n	$cfg[\'Servers\'][$key+1][\'bs_garbage_threshold\'] = 50;\r\n	$cfg[\'Servers\'][$key+1][\'bs_repository_threshold\'] = \'32M\';\r\n	$cfg[\'Servers\'][$key+1][\'bs_temp_blob_timeout\'] = 600;\r\n	$cfg[\'Servers\'][$key+1][\'bs_temp_log_threshold\'] = \'32M\';\r\n}\r\n\r\n#注意，这里是用循环来遍历数组，你只需改数组，不用改循环里的内容！！\r\n</code></pre>\r\n<p>修改完成后保存文件，重新登陆，\r\n如果可以看到phpMyAdmin登陆界面中出现服务器候选列表，说明修改正确\r\n</p>\r\n<li>登陆phpMyAdmin时只需在服务器地址“下拉列表”中选择就可无需输入用户和密码！</li>\r\n<p>操作步骤：请在方法二完成后，把循环里中$cfg[\'Servers\'][$i][\'auth_type\'] = \'cookie\';\r\n这一行的cookie改成config就完成了！</p>\r\n<p>修改完成后保存文件，重新登陆，\r\n会出现出现服务器候选列表和用户密码框，\r\n但只要你在服务器地址选中你要登录的服务器，用户密码不用管，直接提交就可登录！！\r\n注意，在chrome浏览器中，会出现报错，而且中有服务器候选列表，没有用户密码输入框，\r\n但只要选择你要登录的服务器，也能自动登录，只不过没有登录前有个报错界面难看了点点！</p>\r\n</ol>\r\n                            '),(7,'<p>\r\n首先要知道影响在线人数的因素\r\n</p>\r\n<ol>\r\n    <li>访问量</li>\r\n    <li>网站类型</li>\r\n<p>如果是出文字的网站(如小说站)，1M带宽带动日均5000IP，还勉强。如果是普通网站有图片，有文字、论坛、新闻资讯类型网站 大概1M能带一千IP。考虑到高峰期并发，1M高峰期还会卡。【最低配 这里不说服务器配制，一般来说配制都是足够的，除非你的服务器运行内存少于512M】。\r\n下面根据影响因素计算下1M带宽能同时承受多少人在线(以网络状况良好为前提)</p>\r\n</ol>\r\n\r\n<p>下面根据影响因素计算下1M带宽能同时承受多少人在线</p>\r\n<ol>\r\n    <li>打开网站8秒以内的原则;</li>\r\n    <li>评判的只是：用户从云服务器下载文件的速度;</li>\r\n    <li>页面的尺寸大小为60KB左右;</li>\r\n<p>参考公式：支持连接个人 = 服务器带宽/页面尺寸大小</p>\r\n<p>通过计算大致结果是，1Mbps的带宽(服务器的1M带宽是指服务器出站达到1M/s速度（服务器的上传带宽），跟我们家用的带宽稍有区别)支持的连接数为：17个</p>\r\n</ol>\r\n<p>\r\n因此，(N)M带宽可以支持的同时在线人数大概为N*17个  <br>\r\n所以，1M带宽的云主机，日均3000IP以下应该没问题。当然如果你的每个页面都比较大的话，那就没这么多了。具体多少，可以按照上面的算法算下。\r\n以上计算方法仅供参考！！！\r\n</p>'),(8,'                                                                                                                                                                <p>取得服务器文件<br>\r\ngit clone URL\r\n取得CI4最新代码示例：\r\ngit clone https://github.com/bcit-ci/CodeIgniter4  \r\n</p>\r\n<pre><code>\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git clone https://github.com/bcit-ci/CodeIgniter4 \r\n以上是取得CI4最新代码示例\r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git clone https://github.com/bcit-ci/CodeIgniter4 codeigniter4New\r\n以上是取得CI4并重命名为codeigniter4New \r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git pull\r\n以上是更新你的本地仓库至最新改动\r\n</code></pre>\r\n<h5>一、git设置</h5>\r\n<pre><code>\r\n设置全局用户名与邮箱：\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git config --global user.name \"临来笑笑生\"\r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git config --global user.email \'luck@fmail.pro\'\r\n\r\n查看配置：\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ cat .git/config\r\n[core]\r\n        repositoryformatversion = 0\r\n        filemode = false\r\n        bare = false\r\n        logallrefupdates = true\r\n        symlinks = false\r\n        ignorecase = true\r\n[remote \"origin\"]\r\n        url = https://github.com/bcit-ci/CodeIgniter\r\n        fetch = +refs/heads/*:refs/remotes/origin/*\r\n[branch \"develop\"]\r\n        remote = origin\r\n        merge = refs/heads/develop\r\n[gui]\r\n        wmstate = normal\r\n        geometry = 1061x563+32+32 233 255\r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ \r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ \r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ \r\n\r\n=================================\r\n查看远程仓库命令：\r\nelapse@luck:/var/www/ilapu.com$ git remote -v\r\norigin	http://47.115.44.149:8089/root/new_lapu.git (fetch)\r\norigin	http://47.115.44.149:8089/root/new_lapu.git (push)\r\nelapse@luck:/var/www/ilapu.com$ \r\n直接设置远程地址加上用户名和密码：\r\ngit remote set-url origin https://用户名:密码@github.com/用户名/项目名.git\r\nelapse@luck:/var/www/ilapu.com$ git remote set-url origin http://chenghui:chenghui@47.115.44.149:8089/root/new_lapu.git\r\nelapse@luck:/var/www/ilapu.com$ git remote -v\r\norigin	http://chenghui:chenghui@47.115.44.149:8089/root/new_lapu.git (fetch)\r\norigin	http://chenghui:chenghui@47.115.44.149:8089/root/new_lapu.git (push)\r\nelapse@luck:/var/www/ilapu.com$ \r\n========示例=========\r\ngit remote set-url origin http://chenghui:chenghui@47.115.44.149:8089/Chenchengwang/lapuTP5.git  \r\norigin	http://47.115.44.149:8089/Chenchengwang/lapuTP5.git (push)\r\norigin	http://47.115.44.149:8089/Chenchengwang/lapuTP5.git (fetch)\r\norigin	http://47.115.44.149:8089/Chenchengwang/lapuTP5.git (push)\r\n=================================\r\nelapse@luck:/var/www/lapuTP5$ git remote -v\r\norigin  http://luck:llxxs789@47.112.240.208:8089/root/laputp5.git (fetch)\r\norigin  http://luck:llxxs789@47.112.240.208:8089/root/laputp5.git (push)\r\nelapse@luck:/var/www/lapuTP5$ \r\n</code></pre>\r\n<h5>二、创建git仓库及操作</h5>\r\n<pre><code>\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ mkdir abc\r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ cd abc/\r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code/abc (develop)\r\n$ git init\r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code/abc (develop)\r\n$ git clone https://github.com/bcit-ci/CodeIgniter4\r\n\r\nelapse@Toka MINGW64 /d/Language/PHP/Code/abc (develop)\r\n$\r\n\r\n创建一个新的版本库\r\ngit clone git@git.weixin.qq.com:tutor/luck.git\r\ncd luck\r\ntouch README.md\r\ngit add README.md\r\ngit commit -m \"add README\"\r\ngit push -u origin master\r\n\r\n现有的文件夹或Git版本库\r\ncd existing_folder\r\ngit init\r\ngit remote add origin git@git.weixin.qq.com:tutor/luck.git\r\ngit add .\r\ngit commit\r\ngit push -u origin master\r\n</code></pre>\r\n\r\n<h5>三、Git分支（创建、切换、删除）</h5>\r\n<pre><code> \r\nelapse@luck:/var/www/lapuTP5$ 查看分支\r\nelapse@luck:/var/www/lapuTP5$ git branch \r\n  luck\r\n* master\r\n  product\r\nelapse@luck:/var/www/lapuTP5$ 创建新分支testOne并切换\r\nelapse@luck:/var/www/lapuTP5$ git switch -c testOne\r\n切换到一个新分支 \'testOne\'\r\nelapse@luck:/var/www/lapuTP5$ 查看分支\r\nelapse@luck:/var/www/lapuTP5$ git branch \r\n  luck\r\n  master\r\n  product\r\n* testOne\r\nelapse@luck:/var/www/lapuTP5$ 把新testOne分支推到线上\r\nelapse@luck:/var/www/lapuTP5$ git push --set-upstream origin testOne\r\n总共 0 （差异 0），复用 0 （差异 0）\r\nremote: \r\nremote: To create a merge request for testOne, visit:\r\nremote:   http://47.112.240.208:8089/root/laputp5/merge_requests/new?merge_request%5Bsource_branch%5D=testOne\r\nremote: \r\nremote: 正在同步更新测试服代码...\r\nremote: Ref refs/heads/testOne successfully received.  自动布置测试服什么也没处理：只有分支 master 才会自动布暑到测试服！ \r\nremote: 测试服git代码自动化布置完成！  --临来笑笑生\r\nTo http://47.112.240.208:8089/root/laputp5.git\r\n * [new branch]      testOne -&gt; testOne\r\n分支 \'testOne\' 设置为跟踪来自 \'origin\' 的远程分支 \'testOne\'。\r\nelapse@luck:/var/www/lapuTP5$ 切换到master分支\r\nelapse@luck:/var/www/lapuTP5$ git switch master \r\n切换到分支 \'master\'\r\n您的分支与上游分支 \'origin/master\' 一致。\r\nelapse@luck:/var/www/lapuTP5$ 删除testOne分支\r\nelapse@luck:/var/www/lapuTP5$ git branch -d testOne \r\n已删除分支 testOne（曾为 1329038）。\r\nelapse@luck:/var/www/lapuTP5$ 查看分支\r\nelapse@luck:/var/www/lapuTP5$ git branch \r\n  luck\r\n* master\r\n  product\r\nelapse@luck:/var/www/lapuTP5$ 下面进行分支合并，这里是在Luck分支上把master分支合并过来\r\nelapse@luck:/var/www/lapuTP5$ git pull\r\n已经是最新的。\r\nelapse@luck:/var/www/lapuTP5$ git switch luck \r\n切换到分支 \'luck\'\r\n您的分支与上游分支 \'origin/luck\' 一致。\r\nelapse@luck:/var/www/lapuTP5$ git pull\r\n已经是最新的。\r\nelapse@luck:/var/www/lapuTP5$ git branch \r\n* luck\r\n  master\r\n  product\r\nelapse@luck:/var/www/lapuTP5$ 把master分支合并到当前分支\r\nelapse@luck:/var/www/lapuTP5$ git merge master --squash \r\n删除 extend/Tools/email.class.php\r\n删除 extend/Tools/Wxpay.class.php\r\n删除 extend/Tools/WeChatAuth.class.php\r\n删除 extend/Tools/Push.class.php\r\n删除 extend/Tools/NECaptchaVerifier.class.php\r\n自动合并 extend/Tools/Emchat.php\r\n冲突（内容）：合并冲突于 extend/Tools/Emchat.php\r\n删除 extend/Tools/ConfigParse.class.php\r\n删除 extend/Tools/Alidayu.class.php\r\n删除 application/common/Service/EmMessageService.class.php\r\n删除 application/common/Service/EmMessage.class.php\r\n删除 application/common/Model/UserDevModel.class.php\r\n删除 application/common/Model/EmMessageModel.class.php\r\n删除 application/common/Model/BaseModel.class.php\r\n自动合并 application/api/model/EmMessage.php\r\n冲突（内容）：合并冲突于 application/api/model/EmMessage.php\r\n自动合并 application/api/controller/Group.php\r\n冲突（内容）：合并冲突于 application/api/controller/Group.php\r\n压缩提交 -- 未更新 HEAD\r\n自动合并失败，修正冲突然后提交修正的结果。\r\nelapse@luck:/var/www/lapuTP5$ 从上面看到有几个文件合并有冲突，自动合并失败，要手动解决冲突后git add 冲突文件，才可以进行下一步,这里直接用VSCode进行解决冲突\r\nelapse@luck:/var/www/lapuTP5$ git commit -m \'合并master分支\'\r\n[luck 7815f31] 合并master分支\r\n 23 files changed, 908 insertions(+), 2631 deletions(-)\r\n create mode 100644 application/api/controller/Blacklistapi.php\r\n create mode 100644 application/api/model/GroupMemberDelete.php\r\n delete mode 100755 application/common/Model/BaseModel.class.php\r\n delete mode 100755 application/common/Model/EmMessageModel.class.php\r\n delete mode 100755 application/common/Model/UserDevModel.class.php\r\n delete mode 100755 application/common/Service/EmMessage.class.php\r\n delete mode 100755 application/common/Service/EmMessageService.class.php\r\n delete mode 100755 extend/Tools/Alidayu.class.php\r\n delete mode 100755 extend/Tools/ConfigParse.class.php\r\n delete mode 100755 extend/Tools/NECaptchaVerifier.class.php\r\n delete mode 100755 extend/Tools/Push.class.php\r\n delete mode 100755 extend/Tools/WeChatAuth.class.php\r\n delete mode 100755 extend/Tools/Wxpay.class.php\r\n delete mode 100755 extend/Tools/email.class.php\r\nelapse@luck:/var/www/lapuTP5$ 把分并后的内容推送到远端\r\nelapse@luck:/var/www/lapuTP5$ git push\r\n枚举对象: 37, 完成.\r\n对象计数中: 100% (37/37), 完成.\r\n使用 16 个线程进行压缩\r\n压缩对象中: 100% (19/19), 完成.\r\n写入对象中: 100% (20/20), 10.60 KiB | 2.65 MiB/s, 完成.\r\n总共 20 （差异 11），复用 0 （差异 0）\r\nremote: \r\nremote: To create a merge request for luck, visit:\r\nremote:   http://47.112.240.208:8089/root/laputp5/merge_requests/new?merge_request%5Bsource_branch%5D=luck\r\nremote: \r\nremote: 正在同步更新测试服代码...\r\nremote: Ref refs/heads/luck successfully received.  自动布置测试服什么也没处理：只有分支 master 才会自动布暑到测试服！ \r\nremote: 测试服git代码自动化布置完成！  --临来笑笑生\r\nTo http://47.112.240.208:8089/root/laputp5.git\r\n   ce0f5f9..7815f31  luck -&gt; luck\r\nelapse@luck:/var/www/lapuTP5$ git pull\r\n已经是最新的。\r\nelapse@luck:/var/www/lapuTP5$ 分支合并完成\r\n</code></pre>\r\n\r\n\r\n<h5>三、更改代码的操作</h5>\r\n<pre><code>\r\n更新本地代码到最新版本（需要merge才能合到本地代码中）:\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git fetch\r\n\r\n合并更新后的代码到本地\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git merge\r\n\r\n更新你的本地仓库至最新改动(git fetch和git merge组合)\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git pull\r\n\r\n修改代码后，查看已修改的内容\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git diff --cached\r\n</code></pre>\r\n<h5>四、其它常用命令</h5>\r\n<pre><code>\r\n销毁自己的修改\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git reset --hard\r\n\r\n查看最新版本和上一个版本的差异(一个^表示向前推进一个版本)\r\nelapse@Toka MINGW64 /d/Language/PHP/Code (develop)\r\n$ git diff HEAD HEAD^\r\n</code></pre>\r\n使用手册:  <br>\r\n&nbsp;&nbsp;&nbsp;     <a href=\"http://idannywu.com/git.html\" target=\"_blank\">http://idannywu.com/git.html </a>       <br>          \r\n&nbsp;&nbsp;&nbsp;     <a href=\"https://git-scm.com/book/zh/v2\" target=\"_blank\">https://git-scm.com/book/zh/v2 </a>     <br>\r\n&nbsp;&nbsp;&nbsp;     <a href=\"http://rogerdudler.github.io/git-guide/index.zh.html\" target=\"_blank\">http://rogerdudler.github.io/git-guide/index.zh.html </a>  <br>\r\n&nbsp;&nbsp;&nbsp;     <a href=\"http://wlog.cn/soft/git-quick-start.html\" target=\"_blank\">http://wlog.cn/soft/git-quick-start.html </a>  <br>                                                                                                                                            '),(9,'<p>今天周日，闲着蛋疼，然后就去重装了Windows10企业版的系统，没想到连接VPN时出错“ L2TP连接尝试失败:ERROR因为安全层在初始化与远程计算机的协商时遇到了一个处理错误” <br>\r\n无奈，只有折腾解决方法：</p>\r\n<h5>一、查看VPN所需要服务是否启动</h5>\r\n<p>首先呢，用快捷键“win+e”打开“此电脑”,然后右键此电脑，选择\"管理（G）”，在弹出的新窗口“计算机管理”中的左侧最下面的依次点开“服务和应用管理”=》“服务”，然后把以下几个服务启动并设置自动启动！！</p>\r\n<ol>\r\n   <li>IPsec Policy Agent</li>\r\n   <p>找到并双击就可以打开IPsec Policy Agent的属性，设置启动类型为：自动（延迟启动）；</p>\r\n   <li>Routing and Remote Access</li>\r\n   <p>双击打开Routing and Remote Access的属性，设置启动类型为：自动（延迟启动）；</p>\r\n   <li>Remote Access Connection Manager</li>\r\n   <p>双击打开Remote Access Connection Manager的属性，设置启动类型为：自动（延迟启动）；</p>\r\n</ol>\r\n<h5>二、修改注册表</h5>\r\n<p>用快捷键“win+r”打开运行，输入：regedit  回车就可以打开“注册表编辑器” <br>\r\n然后依次打开： <br>\r\n计算机\\HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\RasMan\\Parameters</p>\r\n<ol>\r\n   <li>双击右侧中的AllowL2TPWeakCrypto，把数值改为：1 （备注：如没有此项则新建DWORD类型并将其设置为 1 的值） </li>\r\n   <li>创建ProhibitIpSec，选择DWORD类型（32位，64位都可以）并将其设置为 1 的值</li>\r\n</ol>\r\n<p>大功告成，重启电脑后连接VPN！！</p>\r\n打开免费VPN：<a href=\"http://www.freevpnonline.com/\" target=\"_blank\">freevpnonline.com</a><br>\r\n找到账号（freevpnonline.com）密码（5201）与共享密钥（freevpnonline.com）进行VPN连接，测试，一下子就连接上了！！哈哈，成功啦，我先去上一下<a href=\"https://www.google.com/\" target=\"_blank\">谷歌</a>压压惊，死X度娘，你可以离我远点了！！！\r\n'),(10,'<h5>一、安装必要的类库和软件</h5>\r\n<p>一般我们都需要先装pcre, zlib，前者为了重写rewrite，后者为了gzip压缩</p>\r\n<pre><code>\r\nroot@Toka:~# 先安装必要用到的软件\r\nroot@Toka:~# apt-get install vim build-essential libtool\r\nroot@Toka:~# 下载pcre, 并解压\r\nroot@Toka:~# cd /usr/local/src\r\nroot@Toka:~# wget ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-8.40.tar.gz\r\nroot@Toka:~# tar -zxvf pcre-8.40.tar.gz\r\nroot@Toka:~# 下载zlib，并解压\r\nroot@Toka:~# wget http://zlib.net/zlib-1.2.11.tar.gz\r\nroot@Toka:~# tar -zxvf zlib-1.2.11.tar.gz\r\nroot@Toka:~# 下载openssl，并解压\r\nroot@Toka:~# wget http://www.openssl.org/source/openssl-1.0.1c.tar.gz\r\nroot@Toka:~# tar -zxvf openssl-1.0.1c.tar.gz\r\nroot@Toka:~# \r\n</code></pre>\r\n<p>pcre和zlib与openssl这个也只解压就好,不要编译安装，编译Nginx时会自动安装</p>\r\n\r\n<h5>二、源码编译安装Nginx</h5>\r\n<p>首先从<a href=\"http://nginx.org\" target=\"_blank\">nginx.org官网</a>最新版本，stable（稳定版）、mainline 版，随意选择，我这里选择的是mainline版本</p>\r\n<pre><code>\r\nroot@Toka:~# wget http://nginx.org/download/nginx-1.13.6.tar.gz\r\nroot@Toka:~# tar -zxvf nginx-1.13.6.tar.gz\r\nroot@Toka:~# cd nginx-1.13.6/\r\nroot@Toka:~# #====================下面这两个扩展主要是为了可以代理www.google.com才加的========================\r\nroot@Toka:~# apt install git\r\nroot@Toka:~# cd /usr/local/src/\r\nroot@Toka:~# git clone https://github.com/yaoweibin/ngx_http_substitutions_filter_module\r\nroot@Toka:~# git clone https://github.com/cuber/ngx_http_google_filter_module\r\nroot@Toka:~# #====================下面两个 -add-module 分别对应上面这两个 ========================\r\nroot@Toka:~# ./configure --sbin-path=/usr/local/nginx/nginx \\\r\n --conf-path=/usr/local/nginx/nginx.conf \\\r\n --pid-path=/usr/local/nginx/nginx.pid \\\r\n --with-http_ssl_module \\\r\n --with-pcre=/usr/local/src/pcre-8.40 \\\r\n --with-zlib=/usr/local/src/zlib-1.2.11 \\\r\n --with-openssl=/usr/local/src/openssl-1.1.0c \\\r\n --with-http_v2_module \\\r\n --add-module=/usr/local/src/ngx_http_substitutions_filter_module \\\r\n --add-module=/usr/local/src/ngx_http_google_filter_module\r\nroot@Toka:~# make  \r\nsed -e \"s|%%PREFIX%%|/usr/local/nginx|\" \\\r\n        -e \"s|%%PID_PATH%%|/usr/local/nginx/nginx.pid|\" \\\r\n        -e \"s|%%CONF_PATH%%|/usr/local/nginx/nginx.conf|\" \\\r\n        -e \"s|%%ERROR_LOG_PATH%%|/usr/local/nginx/logs/error.log|\" \\\r\n        &lt; man/nginx.8 &gt; objs/nginx.8\r\nmake[1]: Leaving directory \'/root/soft/nginx-1.13.6\'\r\nroot@Toka:~# make install\r\nmake -f objs/Makefile install\r\nmake[1]: Entering directory \'/root/soft/nginx-1.13.6\'\r\ntest -d \'/usr/local/nginx\' || mkdir -p \'/usr/local/nginx\'\r\ntest -d \'/usr/local/nginx\' \\\r\n        || mkdir -p \'/usr/local/nginx\'\r\ntest ! -f \'/usr/local/nginx/nginx\' \\\r\n        || mv \'/usr/local/nginx/nginx\' \\\r\n                \'/usr/local/nginx/nginx.old\'\r\ncp objs/nginx \'/usr/local/nginx/nginx\'\r\ntest -d \'/usr/local/nginx\' \\\r\n        || mkdir -p \'/usr/local/nginx\'\r\ncp conf/koi-win \'/usr/local/nginx\'\r\ncp conf/koi-utf \'/usr/local/nginx\'\r\ncp conf/win-utf \'/usr/local/nginx\'\r\ntest -f \'/usr/local/nginx/mime.types\' \\\r\n        || cp conf/mime.types \'/usr/local/nginx\'\r\ncp conf/mime.types \'/usr/local/nginx/mime.types.default\'\r\ntest -f \'/usr/local/nginx/fastcgi_params\' \\\r\n        || cp conf/fastcgi_params \'/usr/local/nginx\'\r\ncp conf/fastcgi_params \\\r\n        \'/usr/local/nginx/fastcgi_params.default\'\r\ntest -f \'/usr/local/nginx/fastcgi.conf\' \\\r\n        || cp conf/fastcgi.conf \'/usr/local/nginx\'\r\ncp conf/fastcgi.conf \'/usr/local/nginx/fastcgi.conf.default\'\r\ntest -f \'/usr/local/nginx/uwsgi_params\' \\\r\n        || cp conf/uwsgi_params \'/usr/local/nginx\'\r\ncp conf/uwsgi_params \\\r\n        \'/usr/local/nginx/uwsgi_params.default\'\r\ntest -f \'/usr/local/nginx/scgi_params\' \\\r\n        || cp conf/scgi_params \'/usr/local/nginx\'\r\ncp conf/scgi_params \\\r\n        \'/usr/local/nginx/scgi_params.default\'\r\ntest -f \'/usr/local/nginx/nginx.conf\' \\\r\n        || cp conf/nginx.conf \'/usr/local/nginx/nginx.conf\'\r\ncp conf/nginx.conf \'/usr/local/nginx/nginx.conf.default\'\r\ntest -d \'/usr/local/nginx\' \\\r\n        || mkdir -p \'/usr/local/nginx\'\r\ntest -d \'/usr/local/nginx/logs\' \\\r\n        || mkdir -p \'/usr/local/nginx/logs\'\r\ntest -d \'/usr/local/nginx/html\' \\\r\n        || cp -R html \'/usr/local/nginx\'\r\ntest -d \'/usr/local/nginx/logs\' \\\r\n        || mkdir -p \'/usr/local/nginx/logs\'\r\nmake[1]: Leaving directory \'/root/soft/nginx-1.13.6\'\r\nroot@Toka:~# 到此nginx安装完成！！\r\n</code></pre>\r\n\r\n<h5>三、源码编译安装PHP</h5>\r\n请稍等，正在整理…………\r\n<h5>三、配置Nginx与PHP</h5>\r\n'),(11,'<p>一、安装依赖包</p><p>二、安装SVN</p><p>三、配置SVN勾子自动更新</p>'),(12,'<p><p>一、能正常用SecureCRT连接的VPS</p>\r\n想要科学上网，你这只VPS肯定是要在国外或者香港的，因为国内的服务器跟你自己电脑一样也是被禁止过滤了好多站点的！！\r\n\r\n<p>二、配置SecureCRT的SOCKS5代理</p>\r\n用SecureCRT正常连接VPS后，选择上个的菜单=&gt; Options =&gt; Session Options  <br>\r\n在弹出的新窗口的左侧选择 Connection =&gt; Port Forwarding  选中 <br>\r\n在右侧中单击“Add…”按纽，新弹出窗口  <br>\r\nName中随便输入个名字，我这里以端口号为名“5858” <br>\r\n两个Port中输入端口，这里输入：5858   <br>\r\n再把“Dynamic forwarding using SOCKS 4 or 5”给勾选上！！ <br>\r\nOK！记得点“OK”，然后断开VPS，再重新连接一下就设置完成了！！</p><p><img src=\"data:image/png;base64,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sLNCscXarG4zWeXatla9zcINk/tbzEazicUTCHh+YQtue3IBSjVrC79bU3zTv4pLzlccOv7P13aLFzzwwhsPxHTkP7Fy8RcbPpl/5birknxtHC6e86Lm4mnPwh6w1xcUXvTev598at3hoHE3/uPxe+ZNSve3df60b8PrX5Vf8fzr//zjXHPBhvt//4e167dcPSEhLaxnOZ8S4HD0+iRUFHah45/VbOaIRGw+n6XTMQmpjmT3ImioqVNyEAQIAgSBnwUBR+amjY9jzM+iAimEQiA9PR3If//990ql0iUivA77zLOPjw8YEsuyXV1dSOfv78/csIHkQZMKkjGXhBzhnIA5Novt+abn8w35IB9cxSh8oc/C1aGrnUbhtB5mK5vN9w9la04e3Wc1G9o1NqNWdfKnohazxdJedfBoYafR75r5U2RsDN8tnbV7X7r7zebMax5Z/bsoqzk8+8owG6v5xCdvNhvkU2elZ0ZXR4dtP164d8/pSWb24Z8qDdxRs7Jlxzf959W3fpry5Eu3TY02drbqsP/c2FFZVdfIC50cFMg11GJsHm3St7Y0C3QdPI5V26lva85785WPcm0p97+4elIY3lHTW0VUCEGrrvjId59u+IGdectjD942USntaqq1SYSGNk0bqqzTNjY2WbUWjpXVru3WG402m4iurNMvBSDlIFCHODIyfNky9bFjPomJYVddVbN+PT0cp9IQFncCjpwSBAgCFxUByshgLMG8CqNXOGLoS45X3SXuzUT+jhQCqampIOiNGzeCqQeWwfvf//7n5+eHaXfw/JkzZ06ePMnhcLKystLS0pCNuZHIiTB9OIVpoXwWf650ro1te6HxhdP603wOf4HfgkeCH8EonE5PJ2N+gxOzX9x4+En741iasiP/fOjGI9H3vPPEPWMCfdpPnc07V26RLbhyXCAbxVosnaqCbcf2dZmib2q4pmzjqj+tPd1hYFlN7IjRix+5d0mEn2zKVZOS9h/75G/LNgvZepbP+NufWxTL3rHl2A95B7lnqxeH17/92IqPc+0fVLWZhVNuuGZWTqxccl3GV59/9/LSH9/mYzBsME9bMSWZ2/ZS7sFjlta5tZ0TQ/H1EarGdp3tVdepi0+dVFVrmxs+/uvprxDP5QtveHH97RnTFij3bPvXfbveEXFYZgsraNEVE0MDfHvzMpXuCdhlUT8476qq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'),(13,'<p></p><p></p><p></p><p>一、能正常用SecureCRT连接的VPS</p>\r\n想要科学上网，你这只VPS肯定是要在国外或者香港的，因为国内的服务器跟你自己电脑一样也是被禁止过滤了好多站点的！！\r\n\r\n<p>二、配置SecureCRT的SOCKS5代理</p>\r\n用SecureCRT正常连接VPS后，选择上个的菜单=&gt; Options =&gt; Session Options  <br>\r\n在弹出的新窗口的左侧选择 Connection =&gt; Port Forwarding  选中 <br>\r\n在右侧中单击“Add…”按纽，新弹出窗口  <br>\r\nName中随便输入个名字，我这里以端口号为名“5858” <br>\r\n两个Port中输入端口，这里输入：5858   <br>\r\n再把“Dynamic forwarding using SOCKS 4 or 5”给勾选上！！ <p></p><p><img src=\"https://toka.pro/static/uploads/summernote/12/81d6c285a906ad30e6b39b44c15edf24.png\" data-filename=\"img\" style=\"width: 663px;\"><br>\r\nOK！记得点“OK”，然后断开VPS，再重新连接一下就设置完成了！！\r\n\r\n\r\n</p><p>三、配置浏览器的SOCKS5</p>\r\n浏览器设置中，火狐是最容易设置的！ <br>\r\n火狐：<br>&nbsp; &nbsp; &nbsp; &nbsp; 设置  接到最下面“网络代理服务器” 点击“设定” <br>&nbsp; &nbsp; &nbsp; &nbsp; 选择“手动设定 Proxy（M）:  <br>&nbsp; &nbsp; &nbsp; &nbsp; 在SOCKS主机填入：127.0.0.1 端口：5858 <p></p><p><img src=\"https://toka.pro/static/uploads/summernote/12/f4ce6f896718144cdcd77c8e1b4ea140.png\" data-filename=\"img\" style=\"width: 891px;\"><br>&nbsp; &nbsp; &nbsp; &nbsp; 确定就设置完成了！！  <br>\r\n    \r\n谷歌： <br>&nbsp; &nbsp; &nbsp; &nbsp; 右键“Google Chrome”，选择属性 <br>&nbsp; &nbsp; &nbsp; &nbsp; 在目标这一行中添加： --proxy-server=\"SOCKS5://127.0.0.1:5858\"   <br>&nbsp; &nbsp; &nbsp; &nbsp;如我的：C:\\Users\\Administrator\\AppData\\Local\\Google\\Chrome\\Application\\chrome.exe --proxy-server=\"SOCKS5://127.0.0.1:5858\"  <br>&nbsp; &nbsp; &nbsp; &nbsp;点击确定，然后双击打开就可以直接用SSH2代理上网了！ <br>开始吃鸡啦，开始科学上网，想上哪个网站就哪个，是不是特别爽，而且特别简单！！</p><p>四、苹果MAC下开启代理：</p><p>&nbsp;1.如需无密码登录，则要配制公钥和私钥</p><p>2.一条命令天启Socks5：&nbsp; while true; do ssh -D 5858 root@107.155.45.83 || true; done</p><p></p><p></p>'),(14,'<p>升级Windows10到开发版Build 17074，没想到虚拟机出错（VMware Workstation 与 Device/Credential Guard 不兼容。在禁用 Device/Credential Guard 后，可以运行 VMware Workstation。有关更多详细信息，请访问http://www.vmware.com/go/turnoff_CG_DG。）</p><p>没法，只好放Google搜索一下！都是说两点：</p><p>1、禁用Hyper-V &nbsp;（这个默认就是关闭的，所以无需操作）</p><p>2、禁用 Credential Guard</p><p>只好按照要求去做第二步关闭Credential Guard：</p><p>“win键+r\"打开运行，输入gpedit.msc，确定打开本地组策略编辑器</p><p>转到<b>本地计算机策略</b>&gt;<b>计算机配置</b>&gt;<b>管理模板 &gt; 系统</b>&gt;<b>Device Guard</b></p><p><b>打开&nbsp;</b>基于虚拟化的安全 设置为“已禁用”</p><p><b>按</b>“win键+X\"，选择“Windows PowerShell(管理员)(A)”</p><p><b>输入命令：bcdedit /set hypervisorlaunchtype off</b></p><p><b>然后重启</b></p><p><b>没想到，还是提示</b></p><p><b><br></b><img src=\"https://toka.pro/static/uploads/summernote/01/774b3d0063a99f95f8d7b8f7a761f553.png\" data-filename=\"img\" style=\"width: 424px;\"><b><br></b>百思不得解！！</p><p>最后再按上面步骤重做一次，但没有直接重启，只是选择关机！！没想到关机后，再打开电源开机，就可以了！！</p><p>这证明是不是重启就是一个坑呢？</p><p>应该正确的姿势是：关机-》再开机！！！ &nbsp; &nbsp;看来要生个孩子，姿势很重要呀！！！</p><p> </p>'),(15,'<p>&nbsp; &nbsp; &nbsp; &nbsp; 气冲冲从工商局回来后，坐电脑前，想起了这个月公司的社保还没扣缴。上电子税务局，直接选择社保申报，飞快点到扣缴费，按下扣款拕！“余额不足，扣款失败”，shit,公司公账没钱了。</p><p>&nbsp; &nbsp; &nbsp; &nbsp;遥想当年，还是个单纯的程序员时，从没想过有一天我连会计做账报税，帮客户代办营业执照，扣缴社保等这些杂活也要做。自从创办了“风创未来网络有限公司”后，一切都变了！</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 再也回不到那个只是单纯的人，单纯的程序员了！无论是见客户接单时，还是为客户去工商局办理营业执照面对那些故意为难你的公务员，都满满的心累感。公务员的不作为就不说了，单论我这个性格，并不适合于人际关系，不然今天也不会在工商局和那些公务员吵起来了。想想这一架吵得真不值得，回来后，阿弟整整关在房门没有和我说一句话！也许他也觉得我太过于浮躁了。</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;浮躁，看着“余额不足，扣款失败”这几个字，不单单是浮躁，更多的是无奈！也许这样就快要成为创业失败者了。上个月因为资金不足，把公司唯一一个员工炒掉后，公司就只有我和我弟弟了。可能早就已是名存实亡？并不是，因为公司主要靠的是我！</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 遥想当初，去注册“风创未来”公司营业执照时，是多么的紧张和担心办不了。当时我还在“房道网”当作一个普通的PHP程序员，又不太敢经常请假去搞这个执照的事。当时大概是在2017年末吧 想着先在春节前办下执照，过完年后再换份技术主管的工作，这样子轻松又有时间做下自己“风创未来”的事。但是后来忘了什么原因导致我年后提前离职了！中途又去面试了好几家公司的职位，但都没有比较适合心意的工作 然后在老乡林秋清这个帮我做兼职会计的鼓动之下 ，初步设想和计划公司的实业经营范围为一开始做代理记账这一块传统行业！</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 其实我创办这家公司，是想用它来从事经营服务器和云服务器这一块的。但当我真正办下“风创未来网络有限公司”后 才突然发学自己连购买个服务器的资金都不足，更何况要购买很多，还要把这些服务器全部都托管到机房里面去！那只能想着从简单，投入成本低的行业先积累客户，最后再做客户转移罗。可以先做技术定制，再从中推广自己的云服务器，这样子成本低，或是做工商代办，代理记账，帮客户从办公司开始，营业执照，记账报税，做技术定制（官网 小程序） 云服务 一条龙服务下来！想法和计划好像挺好的，没有方向上的错误。唯一的就是没有想到自己做自己公司官网所花费的时间太长了 整整两个多月。唉，也许创业时员工多并不是好事，管理上都占去了一定的时间，却没能达到人多做事快的效果。或许这就是请大学实习生的后果吧！</p><p>&nbsp; &nbsp; &nbsp; &nbsp; 时间，这也是一个非常大的成本。如果我还是年轻人，而不是中年大叔的话，我还可以面对更多的失败和重来！但现在的我已三十有余，无论是将来结婚生子都已不远，老爸老妈一直在催这个事，而我自己却深深的明白，还没有这个能力可以担当得起做为别人老公的责任，更没钱担得起孩子他爸。如果再给我半年时间，我可以把公司所需要的代理记账会计软件开发完美初步使用版，那样子我可以安排全力去扩展业务而不用愁心于现有客户的服务质量问题！</p>'),(16,'<p>很多时候，自己源码编译的软件都想设置为开机自动启动，免得机器不小心重启后还要手动去开启服务；特别是mysql、PHP、 Nginx等；</p>\r\n<h4>先建立个开机启动时测试脚本：</h4>\r\n<pre><code>\r\nroot@elapse.date:~# vim testBoot.sh\r\n#!/bin/bash\r\n# =========================================================================\r\n# 测试开机启动\r\n# =========================================================================\r\nLog=/root/reboot.log.txt\r\nDate=\'date +%Y%m%d%H%M%S\'\r\necho \"# ================== `${Date}`=&gt; start ===================\" &gt;&gt; ${Log}\r\necho \'=======================完美的一天========================\' &gt;&gt; ${Log}\r\n# 保存退出!\r\nroot@elapse.date:~# 复制脚本到　/etc/init.d/　目录下\r\nroot@elapse.date:~# cp testBoot.sh /etc/init.d/\r\nroot@elapse.date:~# 给脚本加可执行权限\r\nroot@elapse.date:~# chmod +x /etc/init.d/testBoot.sh\r\nroot@elapse.date:~# 增加开机启动\r\nroot@elapse.date:~# update-rc.d testBoot.sh defaults\r\n警告：insserv: warning: script \'testBoot.sh\' missing LSB tags and overrides\r\nroot@elapse.date:~# 因为testBoot.sh不符合debian开机自启文件的内容规范，debian要求文件头部有启动信息。\r\nroot@elapse.date:~# 参考同目录下的/etc/init.d/skeleton文件头\r\nroot@elapse.date:~# 把如下，头回入到testBoot.sh里面\r\nroot@elapse.date:~# vim /etc/init.d/testBoot.sh\r\n#!/bin/bash\r\n# =========================================================================\r\n# 测试开机启动\r\n# =========================================================================\r\n\r\n### BEGIN INIT INFO\r\n# Provides:          skeleton\r\n# Required-Start:    $remote_fs $syslog\r\n# Required-Stop:     $remote_fs $syslog\r\n# Default-Start:     2 3 4 5\r\n# Default-Stop:      0 1 6\r\n# Short-Description: 这是测试开机启动\r\n# Description:       详细描述此开机测试脚本\r\n### END INIT INFO\r\n\r\nLog=/root/reboot.log.txt\r\nDate=\'date +%Y%m%d%H%M%S\'\r\necho \"# ================== `${Date}`=&gt; start ===================\" &gt;&gt; ${Log}\r\necho \'=======================完美的一天========================\' &gt;&gt; ${Log}\r\n# 保存退出!\r\nroot@elapse.date:~# 先删除刚才开机启动\r\nroot@elapse.date:~# update-rc.d -f testBoot.sh remove\r\nroot@elapse.date:~# 再增加开机启动，是不是就不再有这个警告了？！\r\nroot@elapse.date:~# update-rc.d testBoot.sh defaults\r\nroot@elapse.date:~# 果然不再有警告了！重启试下脚本是否有开机自动启动了\r\nroot@elapse.date:~# reboot\r\n</code>\r\n</pre>\r\n查看是否生成了/root/reboot.log.txt文件！！有生成，测证明增加开机启动成功，因为以上开机启动测试脚本主要是生成一个便于我们查看是否开机启动的日志\r\n\r\n\r\n\r\n\r\n'),(17,'<p></p><p><a href=\"http://blog.sina.com.cn/s/blog_13f88c2ed0102yq5w.html\">转自：公号 张凯律师</a></p>\r\n<p>2010年春天，我和十几位律师、记者一起研讨山西毒疫苗事件。\r\n我把研讨会记录放在我的博客里，第二天，文章被删，为了表示抗议，我把这个事记录在了博客里。</p>\r\n<img src=\"https://elapse.date/static/uploads/summernote/11/2fb38446f97885af3bf062d5177b2dfb.jpg\" data-filename=\"img\"> \r\n<p></p><p>之后，律师和记者分头行动，一系列维权过程我都写在博客里，但文章很快被外星人劫持了。</p><p>那一年，我见了很多当事人，他们的孩子在打完疫苗之后，有的忽然抽搐，有的死了……。</p><p>但是，人的生病和死亡可能有很多种原因，他们只能说明在时间上有先后关系，但是谁能说清楚是否存在实质因果关系呢？</p><p>很多部门就是这么搪塞他们的。</p><p>疫苗的保存要求在2–8度，当时有证据表明：很多疫苗直接在高温下保存和运输。</p><p>高温下的疫苗只是无效，还是变质为有毒物质？谁都说不清。</p><p>当时毒疫苗事件发生在山西，八年后的今天，疫苗受害主要在山东。</p><p>这一东一西，惹动了人们的愤怒。</p><p>山西疫苗事件距今天已经八年时间了，这八年，我经历了人生各种起落和变故。</p><p>就像坐在一艘大船里，自己完全无力左右命运，只能跟着大船起起落落。</p><p>然而，我们何尝不都在一艘大船里，看起来船决定着我们的命运。<br></p><p>事实是：船里的每一个人，决定着船的命运。</p><p><br></p><p>1</p><p><br></p><p>我的同学今天给我留言，让我写写毒疫苗的文章，因为他的孩子打了报道的问题疫苗，他不知道这疫苗进入孩子的血液里会发生什么。</p><p>我还记得他嘲讽我：不懂得赚钱，每天总是关心自己改变不了的事情，闲的蛋疼。</p><p>我的同学就很会赚钱，平时不问西东，念叨着什么岁月静好。 八年前山西毒疫苗的事情他根本不知道，似乎也不需要知道。山东的事终于轮到他了。</p><p>他也真的急了，一下午给我发来好多这个事件的文章，问我是不是真的。</p><p>我说：“不传谣，不信谣”。这正是他曾经发给我的微信。</p><p>2009年，我帮助毒奶粉受害者。</p><p>2010年帮助毒疫苗家庭。</p><p>我的这位同学说：你什么都改变不了，倒是把自己搭进去了。识时务者为俊杰。</p><p>他说的是真的，而且他也是俊杰。所以，我不为自己辩护。</p><p>2009年，我代理毒奶粉的受害人，到法院起诉，法院不立案。</p><p>2010年，毒疫苗的受害人到法院起诉，法院也不立案。受害人就到卫生部抗议，最后被拘留了，于是行政诉讼，我拿着他们的诉状到法院，依然不立案。我和法官吵起来，最后被轰出去了，这事发生在北京的一个法院。</p><p>行政拘留不算太重的处罚，最多十五天。但据说有人因此被判刑，理由是：寻衅滋事，刑期两年。</p><p>确实，我什么也没有改变。</p><p>我常常感觉到：这样的处境，律师是最没用的，有时候，我们只是给当事人带来一些心灵的安慰而已。</p><p><span style=\"background-color: rgb(255, 0, 0);\">今天网上才传出消息：过去管奶粉的领导，并没有卸任，现在管疫苗了。</span></p><p><span style=\"background-color: rgb(255, 0, 0);\">网友质问：管不好奶粉的人，能管好疫苗吗？</span></p><p><span style=\"background-color: rgb(255, 0, 0);\">疫苗问题没有解决，管疫苗的人也没有解决，但提问题的人都被解决了。</span></p><p>当年披露山西毒疫苗的记者王克勤被报社下岗，总编包月阳被免职。还有当年的那些律师，我都不想多说了。</p><p>最近读哈耶克，这位先知般的思想家，指出了人类通往奴役的路，他说：“观念的转变和人类意志的力量，塑造了今天的世界”。</p><p>如果他说的是真的，那么：今天的中国的样子，就是中国人观念塑造的，中国人普遍有什么样的想法，就有什么样的中国。</p><p>换句话说，中国人，有什么样的观念，就会有什么样的疫苗。</p><p>我那位同学的想法，基本是国人的普遍想法。</p><p>平时我懒得理他，他也懒得理我，同一个世界，不同的梦想。</p><p>而这次，这位同学或许才意识到，我们是在同一条船上。不仅仅我与这位同学，这次大富豪刘强东与八年前那些衣服都穿不整齐的农民，也站在了同一条船上。</p><p>平时我的这位同学一门心思赚钱，哪里管什么洪水滔天。但这次他发现了船在漏水，可能自己也会溺水，总应该想想怎么把船修好吧？</p><p>况且他平时很“爱国”，微信朋友圈几乎没有“负面”信息，最近又在朋友圈里转发人报文章，吆喝着要和美国把贸易战打到底，说什么：美国亡我之心不死。</p><p>这位同学最后发信说：“要好好赚钱，让儿子移民”。</p><p>我回复：“真怂”。</p><p><br></p><p>2</p><p><br></p><p>一个大胆的假设：</p><p>如果2010年，那些做报道的记者、律师不是被打压，而是得到荣誉。</p><p>如果那年的的疫苗事件，责任官员得到惩处，法院大胆的开庭审理，受害人得到高额赔偿。</p><p>如果那些自发组织起来的NGO组织，可以自由的发挥他们的功效。</p><p>那今天会怎么样呢？</p><p>不用太聪明也会知道：会产生更杰出的记者、律师、官员……</p><p>法官会充满荣誉感，他们会骄傲的说：八年前那个案子是我判的……</p><p>NGO组织会自豪的把八年前他们的功绩写在自己的宣传册里，对来访的人夸耀自己在疫苗事件中所做的贡献……</p><p>但，这一切都只是假设。</p><p>如果把我的这些假设翻译成政治或法律词汇，就是：新 闻 自 由、司 法 独 立、主 权 在 民……</p><p>这些已经被历史无数次的验证过的价值，难道我们还需要别出心裁，另辟新道吗？</p><p>问题疫苗难道真的只是疫苗问题吗？</p><p><br></p><p>3</p><p><br></p><p>爱国青年说：“任何国家都有问题。”</p><p>是的，他们说的没错，但解决问题的方式却大不相同。</p><p>八年前，我们把毒疫苗的帖子删干净了，以为疫苗问题解决了。</p><p>但问题疫苗只是换了一个省。而且，这或许只是刚刚开始。</p><p>《南方都市报》刊发的调查报告《疫苗之殇》中披露，中国是世界疫苗事故最多、最惨的国家，每年至少都会有超过1000个孩子患上各种疫苗后遗症，或死或残。</p><p>美国也曾经有过疫苗危机，大家都争着要往美国这艘船上跳，看看他们是怎么对待船客呢？</p><p>几年前，美国麻州一家药厂出现违规，导致全国脑炎爆发，76人死亡，该厂负责人被控二级谋杀，药厂倒闭，赔偿2亿美金。</p><p>1988年，美国通过《国家疫苗伤害补偿程序》。确立了为接种疫苗造成伤害的无过错补偿制度，受害人无需诉讼就可获得初步赔偿。</p><p>我们得到赔偿的概率有多大呢？</p><p>这要解释什么是无过错补偿。简单的说：双方举证方式不同。</p><p>2013年湖南广东四川有4名婴儿注射乙肝疫苗后死亡。家属向医院提出索赔，院方称：尚不能确定死因与疫苗有关。也就是说：家属需要证明孩子的死是疫苗导致的。</p><p>想想，这样的证明有多难？孩子打了疫苗，孩子也死了，但这可以证明是疫苗导致的吗？不可以。</p><p>医院会说：孩子中午还吃饭了呢？你怎么知道不是吃饭死的？医生可以拿出一大堆病例说明：吃饭也是可以死人的。</p><p>你是一个几年才会接种一次疫苗的人，你的诉讼对手是精通疫苗医学的机构。你怎么可能讲过他？</p><p>你当然可以申请鉴定，但是疫苗有多假，鉴定就可以有多假。</p><p>美国确定的的无过错补偿责任正好相反，上面的案子为例，按照美国的法律，院方需要证明：孩子的死与疫苗没有关系，如果院方不能证明，就要赔偿。</p><p>依据上述的美国法律，也是先行赔付。先赔钱，然后再打官司，一般而言，孩子疫苗后，只要不是明显的意外死亡或其他疾病导致死亡，都会推定为疫苗导致。</p><p>而赔偿的数额呢？</p><p>在山西毒疫苗事件中，唯一获得法院立案的尚彩玲，打了三年官司，最终和疫苗厂家达成和解协议：厂家补偿十万元，尚彩玲放弃诉讼和上访权利。</p><p>从1988年至2000年法案实施12年间，全美有1500多人得到11亿多美元的基金救济。平均每人约500万人民币。</p><p>从数字来看，我们孩子比美国孩子疫苗致残、致死的数额多出十多倍。而赔偿，我们比美国少十几倍。</p><p>看了这样的数字，不知道那些整日喊着：“厉害了，我的国”的人会怎么想。</p><p><br></p><p>4</p><p><br></p><p>不能再写下去了，再写一下就又变成“别有用心”的人了。但希望这篇文章不要被删，谁家没个孩子，谁能避免被狗咬一口呢？</p><p>当年为疫苗受害者呼吁的律师，现在多半已经不干这事了。他们在哪里，自行谷歌吧。</p><p>我回到了北京，北京司法局还没有给我年检，所以不能执业，既然大家都在一艘船上，谁认识局长，帮我和他聊聊。把这么优秀的律师逼成一个靠文章打赏的人，实在违背社会主义核心价值观。</p><p>张凯律师记于2018年7月23日</p>\r\n<hr>\r\n<p>那律师被失踪了。今天在其他网站上看到的：</p><p>有那么一个地方正义不再正义了，英雄，那些真的猛士，时时流泪又流血。爆料\"地沟油\"的洛阳电视台记者李翔身中10余刀被惨杀；\"中国药品打假第一人\"高敬德在北京被派出所接走，3天后离奇死亡；\"皮革奶\"风波，中央电视台主持赵普因告诫\"不要再吃老酸奶和果冻\"而被淡出将近半年；爆料毕节五名流浪儿童被冻死的记者李元龙也不知去向；爆料\"三聚氰胺\"事件，中国乳业打假第一人蒋卫锁遇害；六年前记者王克勤发现了疫苗问题，并发表了长篇调查报告。然后，他被下岗了；而报道疫苗问题的总编辑包月阳，后来被免职了……一个个血腥的事件，令我们如此揪心，胸闷至心痛。</p><p><br></p><p>对于这种非正常的社会现象，我一直在纳闷，我们这个社会到底是哪一股势力如此之强大，强大到可以无视社会正义，可以蔑视汹汹的民意，敢冒天下之大不韪，保护恶人，捂盖坏事？我更不知道，这股力量悠悠的底气，到底是谁赋予的，竟然强大到可以逆天，不惜站到民众对立面上来。</p><p>我不敢揣测，恕我胆怯，我要苟延残喘，还要苟活于这个世界，毕竟我有家有室，只能选择呼吁，坚守良知，理性爱国，沉稳做事。我知道，更多的人与一样，选择沉默，选择等待。然而，我们沉默恰恰是对邪恶的纵容，等待来的结果恰恰是李翔和蒋卫锁之死，而孙咸泽等人反而升官发大财，我们却变成了这个社会邪恶势力的帮凶，不知道个个脸上有着血污……</p><p>我们这个社会啊，如今真的谈不上什么进步的，做好人的成本太高，做英雄的代价太大。社会的新闻导向，越来越畸形化或无厘头化。理想在新闻联播上得到\"高富帅\"般丰满，现实在网络新闻里顷刻\"低矮挫\"般骨感。这一厢，打开电视看新闻联播了，什么拍了35次掌，手拍麻了；流了5次泪，泪流干了；1000次生在中国，1000次死在中国，简直爱死中国了……一片歌舞升平，中华盛世景象；那一厢，打开电脑看社会新闻了，诸如什么乳业打假第一人蒋卫锁遇害了，发布毕节5流浪儿童冻死的李元龙被当地警方控制了，云南彝良农妇因跪访总理被拘留了，爆料重庆官员不雅照曝光的朱瑞峰似遭到报复……貌似我们的国家，已然听不进一点真实的声音，对待自己的人民，特别是说真心话、办良心事的人越来越发狠。徒徒地要求人们永远生活在新闻联播的新闻通稿中，生活在谎言中，像猪一样，被安排，被幸福，最后被屠戮……</p><p>到底哪一个中国是真实的？</p><p>面对全球只有中国大陆才会发生怪象！我只是想问：我们的政府扮演了怎么样的角色？对于蒋卫锁之死，公权力是否意识到打假英雄的危险，并提供了安全保护？是谁打死了他？幕后操作者是谁？当地公权力有责任吗？社会不能为讲真话的人提供保护，那么公权力到底在保护谁？这一切都是我要等待的答案。对于孙咸泽之流的升迁，公权力是否意识到让这些人担任国家食药监总局药品安全总监具有多么大的危害性！如果在韩国，他应该下跪，在日本，他应该切腹，在朝鲜，他会被炮决！</p><p>我也相信，很多人和我一样，也在等待这个答案！因为大家都渴望生活在真相之中，哪怕真相是无比肮脏，无比丑陋，无比冷酷……只要是打假英雄，只要是揭黑人士，我们整个社会都有责任保护他们，而且政府首当其冲，因为这些人代表着这个社会良知，是我们这个社会正能量的化身。他们的被迫害，甚至被谋害，这是对正义公然的挑衅！这是对良知野蛮的强暴！</p><p>纵观我大中华连牛奶问题都解决不了，连儿童的疫苗安全问题都解决不了，祖国的儿童喝奶靠进口，打着毒疫苗，还叫嚣着把日本灭了，在此我表示很担忧！纵观我大中华连英雄都没有去保护好，坏人纷纷升迁，让他们流泪又流血，还叫嚣着中华民族复兴，我表示非常担忧！</p><p>疫苗事件，在我周围的同事和朋友都不敢乱讨论，因为怕……　我不知道是否大家都在装哑巴？没装哑巴的人都会被失踪吗？？我不知道，也许下一个失踪的人是…………<br></p><p><br></p>\r\n<hr>\r\n以上全部为转载，与本网站无关！！转载出处新浪：<a href=\"http://blog.sina.com.cn/s/blog_13f88c2ed0102yq5w.html\" target=\"_blank\">http://blog.sina.com.cn/s/blog_13f88c2ed0102yq5w.html</a>'),(18,'                                                                <p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">到现在为止，我们的象棋游戏能支持玩家与云库引擎正常地交替下棋了！但现在的游戏没有细致的规则限制，玩家可以不按照中国象棋的规则行棋。本节我们需要限制用户的行棋动作，遵循象棋游戏的通用规则。</p><h2 id=\"\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">本节概要</h2><ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><li style=\"outline: 0px !important;\">中国象棋游戏规范介绍</li><li style=\"outline: 0px !important;\">实现可行着法枚举工具类</li><li style=\"outline: 0px !important;\">实现着法合法性检查工具类</li><li style=\"outline: 0px !important;\">应用着法合法性检查</li></ul><h2 id=\"-1\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">中国象棋游戏规范</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><a href=\"https://gitbook.cn/gitchat/column/5e9d67352b34772795873df4/topic/docs/%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B%E6%B8%B8%E6%88%8F%E8%A7%84%E8%8C%83\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">中国象棋游戏规范</a></p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">知道大家都不爱看文档，所以我简单地把行棋的规则和一般的输赢判断规则列举一下。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">着法合法性检查规则：</p><ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><li style=\"outline: 0px !important;\">车走直线、马踩日，炮打翻山、象飞田，兵卒过河左右走，仕象不离老将边；</li><li style=\"outline: 0px !important;\">行棋着法不能吃已方棋子；</li><li style=\"outline: 0px !important;\">车只能在一条线上走子，直到遇到第一个障碍棋子，如果棋子是敌方的，可以吃掉它；</li><li style=\"outline: 0px !important;\">马走一个日字，但有「蹩腿」的行动限制；</li><li style=\"outline: 0px !important;\">象走一个田字，不能过河界，且有被「填心」的行动限制；</li><li style=\"outline: 0px !important;\">炮可以在一条直线上走子，直至遇到第一个障碍棋子，如果越过障碍棋子后在直线上遇到的第一个棋子是敌方棋子，可以吃掉它；</li><li style=\"outline: 0px !important;\">兵卒在冲过对方的河界之前，只能一次向前行走一步，过了敌方河界以后，可以向前方或左右方向行走一步；</li><li style=\"outline: 0px !important;\">一步着法过后，不能造成双方的老将对面，即两方老将都在同一列，且中间无格挡棋子；</li></ul><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">胜负检查判定方法：</p><ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><li style=\"outline: 0px !important;\">如果无论已方走什么可行着法都无法解除对方下一步对已方老将的攻击，则表示已方已经输了；</li><li style=\"outline: 0px !important;\">如果对方行棋后，已方无合法的着法可走，则表示已方已经输了；</li><li style=\"outline: 0px !important;\">如果一方在进棋过程中反复捉对方的将或大子，造成了三次以上的连续重复局面，则判长捉和长将方为负；</li><li style=\"outline: 0px !important;\">如果超过 60 个回合无吃子，则判和棋；</li></ul><h2 id=\"-2\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">准备工作</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">为了实现中国象棋游戏的规则检查，我们有些准备工作要先做一下：</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">第一件事，我们要增强一下 dart 的基本算法方法集，建立一个自己的 math-ex 工具集。我们在 lib/common 文件夹下新建一个 math-ext.dart 文件，实现两个方法：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">abs(value) => value > 0 ? value : -value;\r\n\r\n// 二分查找，没有找到 dart 的标准库的实现，就自己实现一个了\r\nint binarySearch(List<int> array, int start, int end, int key) {\r\n  //\r\n  if (start > end) return -1;\r\n\r\n  if (array[start] == key) return start;\r\n  if (array[end] == key) return end;\r\n\r\n  final middle = start + (end - start) ~/ 2;\r\n  if (array[middle] == key) return middle;\r\n\r\n  if (key < array[middle]) {\r\n    return binarySearch(array, start + 1, middle - 1, key);\r\n  }\r\n\r\n  return binarySearch(array, middle + 1, end - 1, key);\r\n}\r\n</int></code></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">第二件事，在进行着法检查的过程中，我们时常要假定这步棋已经走出，再看局面是否是合法的，例如会不会千万老将会面，会不会千万自己的老将可能被对方直接攻击。这些尝试操作需要改动棋子的位置布署，所以我们希望在一个 clone 的临时棋盘上进行这种验证操作。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 Phase 类中，我们添加一个名叫 clone 的构造方法，它可以基于现有 Phase 对象克隆一个相同的临时 Phase 对象：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">// 克隆一个一模一样的 phase 对象，修改其内容时不影响原来的 Phase 对象\r\nPhase.clone(Phase other) {\r\n  //\r\n  _pieces = List<string>();\r\n\r\n  other._pieces.forEach((piece) => _pieces.add(piece));\r\n\r\n  _side = other._side;\r\n\r\n  halfMove = other.halfMove;\r\n  fullMove = other.fullMove;\r\n}\r\n</string></code></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">此外，我们还需要给 Phase 类添加一个 testMove 的方法，规则检查时会做假设性行棋，然后判断局面是否会有老将对面等 Case，直接改动棋子分布数组而不用关心招法的合法性：</p><blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">这件事不能直接调用 Phase 的 move 方法，move 方法中会进行着法合法性检查，如果假设性行棋调用合法性检测，这就陷入了逻辑循环。</p></blockquote><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">  // 在判断行棋合法性等环节，要在克隆的棋盘上进行行棋假设，然后检查效果\r\n  // 这种情况下不验证、不记录、不翻译\r\n  void moveTest(Move move, {turnSide = false}) {\r\n    // 修改棋盘\r\n    _pieces[move.to] = _pieces[move.from];\r\n    _pieces[move.from] = Piece.Empty;\r\n\r\n    // 交换走棋方\r\n    if (turnSide) _side = Side.oppo(_side);\r\n  }\r\n</code></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">准备工作完成了，我们来检查玩家的着法合法性！</p><h2 id=\"-3\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">着法合法性检查</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">深呼吸一轮，我们要开始飘过一片逻辑海洋！</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们在 lib/cchess 文件夹下新建 steps-enum.dart，这个类里面放置着法枚举工具类 StepsEnumerator 的实现：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'../common/math.ext.dart\';\r\nimport \'cc-base.dart\';\r\nimport \'phase.dart\';\r\n\r\n// 枚举当前局面下所有合符象棋规则的着法\r\nclass StepsEnumerator {\r\n  //\r\n  static List<move> enumSteps(Phase phase) {\r\n    //\r\n    final steps = <move>[];\r\n\r\n    for (var row = 0; row < 10; row++) {\r\n      //\r\n      for (var col = 0; col < 9; col++) {\r\n        //\r\n        final from = row * 9 + col;\r\n        final piece = phase.pieceAt(from);\r\n\r\n        if (Side.of(piece) != phase.side) continue;\r\n\r\n        var pieceSteps;\r\n\r\n        if (piece == Piece.RedKing || piece == Piece.BlackKing) { // 将的着法\r\n          pieceSteps = enumKingSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedAdvisor || piece == Piece.BlackAdvisor) { // 仕的着法\r\n          pieceSteps = enumAdvisorSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedBishop || piece == Piece.BlackBishop) { // 象的着法\r\n          pieceSteps = enumBishopSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedKnight || piece == Piece.BlackKnight) { // 马的着法\r\n          pieceSteps = enumKnightSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedRook || piece == Piece.BlackRook) { // 车的着法\r\n          pieceSteps = enumRookSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedCanon || piece == Piece.BlackCanon) { // 炮的着法\r\n          pieceSteps = enumCanonSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedPawn || piece == Piece.BlackPawn) { // 兵的着法\r\n          pieceSteps = enumPawnSteps(phase, row, col, from);\r\n        } else {\r\n          continue;\r\n        }\r\n\r\n        steps.addAll(pieceSteps);\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 将的着法枚举\r\n  static List<move> enumKingSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final offsetList = [\r\n      [-1, 0],\r\n      [0, -1],\r\n      [1, 0],\r\n      [0, 1]\r\n    ];\r\n\r\n    final redRange = [66, 67, 68, 75, 76, 77, 84, 85, 86];\r\n    final blackRange = [3, 4, 5, 12, 13, 14, 21, 22, 23];\r\n    final range = (phase.side == Side.Red ? redRange : blackRange);\r\n\r\n    final steps = <move>[];\r\n\r\n    for (var i = 0; i < 4; i++) {\r\n      //\r\n      final offset = offsetList[i];\r\n      final to = (row + offset[0]) * 9 + col + offset[1];\r\n\r\n      if (!posOnBoard(to) || Side.of(phase.pieceAt(to)) == phase.side) {\r\n        continue;\r\n      }\r\n\r\n      if (binarySearch(range, 0, range.length - 1, to) > -1) {\r\n        steps.add(Move(from, to));\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 士的着法枚举\r\n  static List<move> enumAdvisorSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final offsetList = [\r\n      [-1, -1],\r\n      [1, -1],\r\n      [-1, 1],\r\n      [1, 1]\r\n    ];\r\n\r\n    final redRange = [66, 68, 76, 84, 86];\r\n    final blackRange = [3, 5, 13, 21, 23];\r\n    final range = phase.side == Side.Red ? redRange : blackRange;\r\n\r\n    final steps = <move>[];\r\n\r\n    for (var i = 0; i < 4; i++) {\r\n      //\r\n      final offset = offsetList[i];\r\n      final to = (row + offset[0]) * 9 + col + offset[1];\r\n\r\n      if (!posOnBoard(to) || Side.of(phase.pieceAt(to)) == phase.side) {\r\n        continue;\r\n      }\r\n\r\n      if (binarySearch(range, 0, range.length - 1, to) > -1) {\r\n        steps.add(Move(from, to));\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 象的着法枚举\r\n  static List<move> enumBishopSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final heartOffsetList = [\r\n      [-1, -1],\r\n      [1, -1],\r\n      [-1, 1],\r\n      [1, 1]\r\n    ];\r\n\r\n    final offsetList = [\r\n      [-2, -2],\r\n      [2, -2],\r\n      [-2, 2],\r\n      [2, 2]\r\n    ];\r\n\r\n    final redRange = [47, 51, 63, 67, 71, 83, 87];\r\n    final blackRange = [2, 6, 18, 22, 26, 38, 42];\r\n    final range = phase.side == Side.Red ? redRange : blackRange;\r\n\r\n    final steps = <move>[];\r\n\r\n    for (var i = 0; i < 4; i++) {\r\n      //\r\n      final heartOffset = heartOffsetList[i];\r\n      final heart = (row + heartOffset[0]) * 9 + (col + heartOffset[1]);\r\n\r\n      if (!posOnBoard(heart) || phase.pieceAt(heart) != Piece.Empty) {\r\n        continue;\r\n      }\r\n\r\n      final offset = offsetList[i];\r\n      final to = (row + offset[0]) * 9 + (col + offset[1]);\r\n\r\n      if (!posOnBoard(to) || Side.of(phase.pieceAt(to)) == phase.side) {\r\n        continue;\r\n      }\r\n\r\n      if (binarySearch(range, 0, range.length - 1, to) > -1) {\r\n        steps.add(Move(from, to));\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 马的着法枚举\r\n  static List<move> enumKnightSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final offsetList = [\r\n      [-2, -1],\r\n      [-1, -2],\r\n      [1, -2],\r\n      [2, -1],\r\n      [2, 1],\r\n      [1, 2],\r\n      [-1, 2],\r\n      [-2, 1]\r\n    ];\r\n    final footOffsetList = [\r\n      [-1, 0],\r\n      [0, -1],\r\n      [0, -1],\r\n      [1, 0],\r\n      [1, 0],\r\n      [0, 1],\r\n      [0, 1],\r\n      [-1, 0]\r\n    ];\r\n\r\n    final steps = <move>[];\r\n\r\n    for (var i = 0; i < 8; i++) {\r\n      //\r\n      final offset = offsetList[i];\r\n      final nr = row + offset[0], nc = col + offset[1];\r\n\r\n      if (nr < 0 || nr > 9 || nc < 0 || nc > 9) continue;\r\n\r\n      final to = nr * 9 + nc;\r\n      if (!posOnBoard(to) || Side.of(phase.pieceAt(to)) == phase.side) {\r\n        continue;\r\n      }\r\n\r\n      final footOffset = footOffsetList[i];\r\n      final fr = row + footOffset[0], fc = col + footOffset[1];\r\n      final foot = fr * 9 + fc;\r\n\r\n      if (!posOnBoard(foot) || phase.pieceAt(foot) != Piece.Empty) {\r\n        continue;\r\n      }\r\n\r\n      steps.add(Move(from, to));\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 车的着法枚举\r\n  static List<move> enumRookSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final steps = <move>[];\r\n\r\n    // to left\r\n    for (var c = col - 1; c >= 0; c--) {\r\n      final to = row * 9 + c;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (target == Piece.Empty) {\r\n        steps.add(Move(from, to));\r\n      } else {\r\n        if (Side.of(target) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n        break;\r\n      }\r\n    }\r\n\r\n    // to top\r\n    for (var r = row - 1; r >= 0; r--) {\r\n      final to = r * 9 + col;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (target == Piece.Empty) {\r\n        steps.add(Move(from, to));\r\n      } else {\r\n        if (Side.of(target) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n        break;\r\n      }\r\n    }\r\n\r\n    // to right\r\n    for (var c = col + 1; c < 9; c++) {\r\n      final to = row * 9 + c;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (target == Piece.Empty) {\r\n        steps.add(Move(from, to));\r\n      } else {\r\n        if (Side.of(target) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n        break;\r\n      }\r\n    }\r\n\r\n    // to down\r\n    for (var r = row + 1; r < 10; r++) {\r\n      final to = r * 9 + col;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (target == Piece.Empty) {\r\n        steps.add(Move(from, to));\r\n      } else {\r\n        if (Side.of(target) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n        break;\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 炮的着法枚举\r\n  static List<move> enumCanonSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final steps = <move>[];\r\n    // to left\r\n    var overPiece = false;\r\n\r\n    for (var c = col - 1; c >= 0; c--) {\r\n      final to = row * 9 + c;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (!overPiece) {\r\n        if (target == Piece.Empty) {\r\n          steps.add(Move(from, to));\r\n        } else {\r\n          overPiece = true;\r\n        }\r\n      } else {\r\n        if (target != Piece.Empty) {\r\n          if (Side.of(target) != phase.side) {\r\n            steps.add(Move(from, to));\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // to top\r\n    overPiece = false;\r\n\r\n    for (var r = row - 1; r >= 0; r--) {\r\n      final to = r * 9 + col;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (!overPiece) {\r\n        if (target == Piece.Empty) {\r\n          steps.add(Move(from, to));\r\n        } else {\r\n          overPiece = true;\r\n        }\r\n      } else {\r\n        if (target != Piece.Empty) {\r\n          if (Side.of(target) != phase.side) {\r\n            steps.add(Move(from, to));\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // to right\r\n    overPiece = false;\r\n\r\n    for (var c = col + 1; c < 9; c++) {\r\n      final to = row * 9 + c;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (!overPiece) {\r\n        if (target == Piece.Empty) {\r\n          steps.add(Move(from, to));\r\n        } else {\r\n          overPiece = true;\r\n        }\r\n      } else {\r\n        if (target != Piece.Empty) {\r\n          if (Side.of(target) != phase.side) {\r\n            steps.add(Move(from, to));\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // to bottom\r\n    overPiece = false;\r\n\r\n    for (var r = row + 1; r < 10; r++) {\r\n      final to = r * 9 + col;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (!overPiece) {\r\n        if (target == Piece.Empty) {\r\n          steps.add(Move(from, to));\r\n        } else {\r\n          overPiece = true;\r\n        }\r\n      } else {\r\n        if (target != Piece.Empty) {\r\n          if (Side.of(target) != phase.side) {\r\n            steps.add(Move(from, to));\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 兵的着法枚举\r\n  static List<move> enumPawnSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    var to = (row + (phase.side == Side.Red ? -1 : 1)) * 9 + col;\r\n\r\n    final steps = <move>[];\r\n\r\n    if (posOnBoard(to) && Side.of(phase.pieceAt(to)) != phase.side) {\r\n      steps.add(Move(from, to));\r\n    }\r\n\r\n    if ((phase.side == Side.Red && row < 5) || (phase.side == Side.Black && row > 4)) {\r\n      //\r\n      if (col > 0) {\r\n        to = row * 9 + col - 1;\r\n        if (posOnBoard(to) && Side.of(phase.pieceAt(to)) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n      }\r\n\r\n      if (col < 8) {\r\n        to = row * 9 + col + 1;\r\n        if (posOnBoard(to) && Side.of(phase.pieceAt(to)) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  static posOnBoard(int pos) => pos > -1 && pos < 90;\r\n}\r\n</move></move></move></move></move></move></move></move></move></move></move></move></move></move></move></move></code></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这是一个很长的工具，应用它可以列举当前局面下，行棋方可能走的全部着法，但不包含避免老将对面、避免行棋后对方可以直接攻击已方老将等逻辑。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">接着，我们在 lib/cchess 文件夹下新建 steps-validate.dart 文件，将在这个工具类中放置某一着法是否合法的检查逻辑：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'../common/math.ext.dart\';\r\nimport \'cc-base.dart\';\r\nimport \'cc-rules.dart\';\r\nimport \'phase.dart\';\r\n\r\n// 着法合法性验证\r\nclass StepValidate {\r\n  //\r\n  static bool validate(Phase phase, Move move) {\r\n    //\r\n    if (Side.of(phase.pieceAt(move.to)) == phase.side) return false;\r\n\r\n    final piece = phase.pieceAt(move.from);\r\n\r\n    var valid = false;\r\n\r\n    if (piece == Piece.RedKing || piece == Piece.BlackKing) { // 将\r\n      valid = validateKingStep(phase, move);\r\n    } else if (piece == Piece.RedAdvisor || piece == Piece.BlackAdvisor) { // 仕\r\n      valid = validateAdvisorStep(phase, move);\r\n    } else if (piece == Piece.RedBishop || piece == Piece.BlackBishop) { // 象\r\n      valid = validateBishopStep(phase, move);\r\n    } else if (piece == Piece.RedKnight || piece == Piece.BlackKnight) { // 马\r\n      valid = validateKnightStep(phase, move);\r\n    } else if (piece == Piece.RedRook || piece == Piece.BlackRook) { // 车\r\n      valid = validateRookStep(phase, move);\r\n    } else if (piece == Piece.RedCanon || piece == Piece.BlackCanon) { // 炮\r\n      valid = validateCanonStep(phase, move);\r\n    } else if (piece == Piece.RedPawn || piece == Piece.BlackPawn) { // 兵\r\n      valid = validatePawnStep(phase, move);\r\n    }\r\n\r\n    if (!valid) return false;\r\n\r\n    if (ChessRules.willBeChecked(phase, move)) return false;\r\n\r\n    if (ChessRules.willKingsMeeting(phase, move)) return false;\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validateKingStep(Phase phase, Move move) {\r\n    //\r\n    final adx = abs(move.tx - move.fx), ady = abs(move.ty - move.fy);\r\n\r\n    final isUpDownMove = (adx == 0 && ady == 1);\r\n    final isLeftRightMove = (adx == 1 && ady == 0);\r\n\r\n    if (!isUpDownMove && !isLeftRightMove) return false;\r\n\r\n    final redRange = [66, 67, 68, 75, 76, 77, 84, 85, 86];\r\n    final blackRange = [3, 4, 5, 12, 13, 14, 21, 22, 23];\r\n    final range = (phase.side == Side.Red) ? redRange : blackRange;\r\n\r\n    return binarySearch(range, 0, range.length - 1, move.to) >= 0;\r\n  }\r\n\r\n  static bool validateAdvisorStep(Phase phase, Move move) {\r\n    //\r\n    final adx = abs(move.tx - move.fx), ady = abs(move.ty - move.fy);\r\n\r\n    if (adx != 1 || ady != 1) return false;\r\n\r\n    final redRange = [66, 68, 76, 84, 86], blackRange = [3, 5, 13, 21, 23];\r\n    final range = (phase.side == Side.Red) ? redRange : blackRange;\r\n\r\n    return binarySearch(range, 0, range.length - 1, move.to) >= 0;\r\n  }\r\n\r\n  static bool validateBishopStep(Phase phase, Move move) {\r\n    //\r\n    final adx = abs(move.tx - move.fx), ady = abs(move.ty - move.fy);\r\n\r\n    if (adx != 2 || ady != 2) return false;\r\n\r\n    final redRange = [47, 51, 63, 67, 71, 83, 87], blackRange = [2, 6, 18, 22, 26, 38, 42];\r\n    final range = (phase.side == Side.Red) ? redRange : blackRange;\r\n\r\n    if (binarySearch(range, 0, range.length - 1, move.to) < 0) return false;\r\n\r\n    if (move.tx > move.fx) {\r\n      if (move.ty > move.fy) {\r\n        final heart = (move.fy + 1) * 9 + move.fx + 1;\r\n        if (phase.pieceAt(heart) != Piece.Empty) return false;\r\n      } else {\r\n        final heart = (move.fy - 1) * 9 + move.fx + 1;\r\n        if (phase.pieceAt(heart) != Piece.Empty) return false;\r\n      }\r\n    } else {\r\n      if (move.ty > move.fy) {\r\n        final heart = (move.fy + 1) * 9 + move.fx - 1;\r\n        if (phase.pieceAt(heart) != Piece.Empty) return false;\r\n      } else {\r\n        final heart = (move.fy - 1) * 9 + move.fx - 1;\r\n        if (phase.pieceAt(heart) != Piece.Empty) return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validateKnightStep(Phase phase, Move move) {\r\n    //\r\n    final dx = move.tx - move.fx, dy = move.ty - move.fy;\r\n    final adx = abs(dx), ady = abs(dy);\r\n\r\n    if (!(adx == 1 && ady == 2) && !(adx == 2 && ady == 1)) return false;\r\n\r\n    if (adx > ady) {\r\n      if (dx > 0) {\r\n        final foot = move.fy * 9 + move.fx + 1;\r\n        if (phase.pieceAt(foot) != Piece.Empty) return false;\r\n      } else {\r\n        final foot = move.fy * 9 + move.fx - 1;\r\n        if (phase.pieceAt(foot) != Piece.Empty) return false;\r\n      }\r\n    } else {\r\n      if (dy > 0) {\r\n        final foot = (move.fy + 1) * 9 + move.fx;\r\n        if (phase.pieceAt(foot) != Piece.Empty) return false;\r\n      } else {\r\n        final foot = (move.fy - 1) * 9 + move.fx;\r\n        if (phase.pieceAt(foot) != Piece.Empty) return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validateRookStep(Phase phase, Move move) {\r\n    //\r\n    final dx = move.tx - move.fx, dy = move.ty - move.fy;\r\n\r\n    if (dx != 0 && dy != 0) return false;\r\n\r\n    if (dy == 0) {\r\n      if (dx < 0) {\r\n        for (int i = move.fx - 1; i > move.tx; i--) {\r\n          if (phase.pieceAt(move.fy * 9 + i) != Piece.Empty) return false;\r\n        }\r\n      } else {\r\n        for (int i = move.fx + 1; i < move.tx; i++) {\r\n          if (phase.pieceAt(move.fy * 9 + i) != Piece.Empty) return false;\r\n        }\r\n      }\r\n    } else {\r\n      if (dy < 0) {\r\n        for (int i = move.fy - 1; i > move.ty; i--) {\r\n          if (phase.pieceAt(i * 9 + move.fx) != Piece.Empty) return false;\r\n        }\r\n      } else {\r\n        for (int i = move.fy + 1; i < move.ty; i++) {\r\n          if (phase.pieceAt(i * 9 + move.fx) != Piece.Empty) return false;\r\n        }\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validateCanonStep(Phase phase, Move move) {\r\n    //\r\n    final dx = move.tx - move.fx, dy = move.ty - move.fy;\r\n\r\n    if (dx != 0 && dy != 0) return false;\r\n\r\n    if (dy == 0) {\r\n      //\r\n      if (dx < 0) {\r\n        //\r\n        var overPiece = false;\r\n\r\n        for (int i = move.fx - 1; i > move.tx; i--) {\r\n          //\r\n          if (phase.pieceAt(move.fy * 9 + i) != Piece.Empty) {\r\n            //\r\n            if (overPiece) return false;\r\n\r\n            if (phase.pieceAt(move.to) == Piece.Empty) return false;\r\n            overPiece = true;\r\n          }\r\n        }\r\n\r\n        if (!overPiece && phase.pieceAt(move.to) != Piece.Empty) return false;\r\n        //\r\n      } else {\r\n        //\r\n        var overPiece = false;\r\n\r\n        for (int i = move.fx + 1; i < move.tx; i++) {\r\n          //\r\n          if (phase.pieceAt(move.fy * 9 + i) != Piece.Empty) {\r\n            //\r\n            if (overPiece) return false;\r\n\r\n            if (phase.pieceAt(move.to) == Piece.Empty) return false;\r\n            overPiece = true;\r\n          }\r\n        }\r\n\r\n        if (!overPiece && phase.pieceAt(move.to) != Piece.Empty) return false;\r\n      }\r\n    } else {\r\n      //\r\n      if (dy < 0) {\r\n        //\r\n        var overPiece = false;\r\n\r\n        for (int i = move.fy - 1; i > move.ty; i--) {\r\n          //\r\n          if (phase.pieceAt(i * 9 + move.fx) != Piece.Empty) {\r\n            //\r\n            if (overPiece) return false;\r\n\r\n            if (phase.pieceAt(move.to) == Piece.Empty) return false;\r\n            overPiece = true;\r\n          }\r\n        }\r\n\r\n        if (!overPiece && phase.pieceAt(move.to) != Piece.Empty) return false;\r\n        //\r\n      } else {\r\n        //\r\n        var overPiece = false;\r\n\r\n        for (int i = move.fy + 1; i < move.ty; i++) {\r\n          //\r\n          if (phase.pieceAt(i * 9 + move.fx) != Piece.Empty) {\r\n            //\r\n            if (overPiece) return false;\r\n\r\n            if (phase.pieceAt(move.to) == Piece.Empty) return false;\r\n            overPiece = true;\r\n          }\r\n        }\r\n\r\n        if (!overPiece && phase.pieceAt(move.to) != Piece.Empty) return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validatePawnStep(Phase phase, Move move) {\r\n    //\r\n    final dy = move.ty - move.fy;\r\n    final adx = abs(move.tx - move.fx), ady = abs(move.ty - move.fy);\r\n\r\n    if (adx > 1 || ady > 1 || (adx + ady) > 1) return false;\r\n\r\n    if (phase.side == Side.Red) {\r\n      //\r\n      if (move.fy > 4 && adx != 0) return false;\r\n      if (dy > 0) return false;\r\n      //\r\n    } else {\r\n      //\r\n      if (move.fy < 5 && adx != 0) return false;\r\n      if (dy < 0) return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n</code></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这个工具类按不同棋子地行棋规则检查用户的着法是否合规，而且还包含避免老将对面、避免行棋后对方可以直接攻击已方老将等逻辑。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">接下来，我们在 lib/cchess 文件夹下新建 cc-rules.dart 文件，在其中提供当前是否有将军，是否已经被杀死等逻辑检查：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'cc-base.dart\';\r\nimport \'phase.dart\';\r\nimport \'step-enum.dart\';\r\nimport \'steps-validate.dart\';\r\n\r\nclass ChessRules {\r\n  // 是否被对方将军\r\n  static checked(Phase phase) {\r\n    //\r\n    final myKingPos = findKingPos(phase);\r\n\r\n    final oppoPhase = Phase.clone(phase);\r\n    oppoPhase.trunSide();\r\n\r\n    final oppoSteps = StepsEnumerator.enumSteps(oppoPhase);\r\n\r\n    for (var step in oppoSteps) {\r\n      if (step.to == myKingPos) return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  // 应用指定着法后，是否被将军\r\n  static willBeChecked(Phase phase, Move move) {\r\n    //\r\n    final tempPhase = Phase.clone(phase);\r\n    tempPhase.moveTest(move);\r\n\r\n    return checked(tempPhase);\r\n  }\r\n\r\n  // 应用指定着法后，是否会造成老将对面\r\n  static willKingsMeeting(Phase phase, Move move) {\r\n    //\r\n    final tempPhase = Phase.clone(phase);\r\n    tempPhase.moveTest(move);\r\n\r\n    for (var col = 3; col < 6; col++) {\r\n      //\r\n      var foundKingAlready = false;\r\n\r\n      for (var row = 0; row < 10; row++) {\r\n        //\r\n        final piece = tempPhase.pieceAt(row * 9 + col);\r\n\r\n        if (!foundKingAlready) {\r\n          if (piece == Piece.RedKing || piece == Piece.BlackKing) foundKingAlready = true;\r\n          if (row > 2) break;\r\n        } else {\r\n          if (piece == Piece.RedKing || piece == Piece.BlackKing) return true;\r\n          if (piece != Piece.Empty) break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  // 是否已经被对方杀死\r\n  static bool beKilled(Phase phase) {\r\n    //\r\n    List<move> steps = StepsEnumerator.enumSteps(phase);\r\n\r\n    for (var step in steps) {\r\n      if (StepValidate.validate(phase, step)) return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  // 寻找已方的老将位置\r\n  static int findKingPos(Phase phase) {\r\n    //\r\n    for (var i = 0; i < 90; i++) {\r\n      //\r\n      final piece = phase.pieceAt(i);\r\n\r\n      if (piece == Piece.RedKing || piece == Piece.BlackKing) {\r\n        if (phase.side == Side.of(piece)) return i;\r\n      }\r\n    }\r\n\r\n    return -1;\r\n  }\r\n}\r\n</move></code></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">好大的几片代码，让人有点窒息！好在逻辑还算清晰、且与 Flutter 本身没啥关系。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">艰巨的规则逻辑实现的差不多了，我们看看如果在玩家走棋的过程中应用这些着法检查。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们回到 Phase 类，之前已经预留了着法合法性检查的 validateMove 方法定义，现在来实现它：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">// 验证移动棋子的着法是否合法\r\nbool validateMove(int from, int to) {\r\n  // 移动的棋子的选手，应该是当前方\r\n  if (Side.of(_pieces[from]) != _side) return false;\r\n  return (StepValidate.validate(this, Move(from, to)));\r\n}\r\n</code></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">看看，一两句代码的事！当复杂的问题被透彻解决了之后，剩下的事件总是这样！</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">运行产品试试，现在不合棋规的走法，都是不被接受的了！</p><h2 id=\"-4\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">本节回顾</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">本小节中，我们先是像大家介绍了中国象棋游戏的规范知识，如有需要详细地学习中国象棋游戏规范，可以参考我们提供的<a href=\"https://gitbook.cn/gitchat/column/5e9d67352b34772795873df4/topic/docs/%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B%E6%B8%B8%E6%88%8F%E8%A7%84%E8%8C%83\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">详细文档-中国象棋游戏规范</a>；</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">接着，我们依据中国象棋游戏规范实现了着法枚举工具类，列表玩家当着可以走的所有着法。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">然后，我们根据游戏规范文档来验证某种着法是不是在合法的范围内。例如「马蹩腿」、「象填心」规则的检查。此外，行棋后必须避免老将对面、必须避免自己的老将被对方的棋子直接威胁。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">最后，我们在 Phase 类中使用着法合法性检查工具类对玩家的棋子移动进行了限制。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">象棋软件中的开发中，「着法枚举」和「着法合法性检查」都是重要的基础工作，这两部分的可靠实现，是象棋游戏能正常运行的基石。这部分代码其实可以很容易地从 Dart 语言转换成其它语言，真心希望棋软开发者能把它有效利用起来！</p>                                                        '),(19,'<p><img src=\"http://xdiary.up/static/uploads/1593503239_dc077be9bec263291792.jpg\" data-filename=\"img\" style=\"width: 800px;\"><br></p>'),(20,'                                                                                                                                                                <p><img src=\"http://xdiary.up/static/uploads/1593503251_3859c13b9d7407630730.jpg\" data-filename=\"img\" style=\"width: 887px;\"></p><p>ddddddddddddd--------dddddddd</p><p><img src=\"http://xdiary.up/static/uploads/1593504633_8b7887cace15b92ff13e.jpg\" data-filename=\"img\" style=\"width: 800px;\"><br></p>                                                                                                                                            '),(21,'<p>dddddasdfa<img src=\"http://xdiary.up/static/uploads/1593510875_186617479739cc6b9355.jpg\" data-filename=\"img\" style=\"width: 670px;\"></p>'),(22,'                                                                <div><b>为何选择 Flutter 作为前端</b></div>\r\n<div>前端太多框架了，我们为什么需要学习一种新的？</div>\r\n<div>简单点，肯定是选择跨平台的解决方案，做一套应用，可以在 iOS、Android、WEB、MacOS、Windows、Linux 多端运行<br></div>\r\n<div>调试期间的热加载，不需要每次都编译代码，能极大地提升开始发效率；</div>\r\n<div>更先进的界面布局理念，上手后做同样的界面花费的代价低于 iOS 或是 Android；</div>\r\n<div><br></div>\r\n<div>这是一个以Flutter写一个“将帅象棋”的中国象棋APP.<br></div>\r\n<div>\r\n    <p>\r\n        先为XUbunt安装Flutter:\r\n    </p>\r\n    到官网这里选择最新版（1.20.4 ）\r\n    <pre><code>\r\n    elapse@elapse-PC:~$ wget https://storage.googleapis.com/flutter_infra/releases/stable/linux/flutter_linux_1.20.4-stable.tar.xz\r\n    tar \r\n    elapse@elapse-PC:~$ tar xf flutter_linux_1.20.4-stable.tar.xz \r\n    elapse@elapse-PC:~$ mv flutter /home/elapse/soft/flutter\r\n</code>\r\n</pre>\r\n    <p>设置Flutter环境变量</p>\r\n    可以直接在/etc/profile末尾在里面添加‘PATH=\"$PATH:/home/elapse/soft/flutter/bin\" ’ ,\r\n    但我看到XUbuntu的/etc/profile文件里面并没有直接给PATH设置值，\r\n    但看到了“for i in /etc/profile.d/*.sh; do”这一行，\r\n    说明包含/etc/profile.d/文件夹下面的所有sh结尾的文件，\r\n    所以我在/etc/profile.d/文件夹下面，\r\n    新建一个“flutter.sh”文件来设置Flutter的环境变量\r\n    flutter.sh文件如下：\r\n<pre><code>\r\n# Flutter的源码路径\r\nFLUTTER_HOME=/home/elapse/soft/flutter\r\nexport PATH=\"$PATH:$FLUTTER_HOME/bin\"\r\n\r\n#flutter国内用户镜像环境\r\nexport PUB_HOSTED_URL=https://pub.flutter-io.cn\r\nexport FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn\r\n\r\n#java下载地址: https://download.oracle.com/otn-pub/java/jdk/15.0.2%2B7/0d1cfde4252546c6931946de8db48ee2/jdk-15.0.2_linux-x64_bin.tar.gz\r\nJAVA_HOME=/home/elapse/soft/jdk-15.0.2/\r\nexport PATH=\"$PATH:$JAVA_HOME/bin\"\r\n\r\n</code>\r\n</pre>\r\n更新环境变量（重新启动计算机），使其生效后，再确认 flutter 命令可以执行：\r\n<pre><code>\r\nelapse@elapse-PC:/etc/profile.d$ source /etc/profile\r\nelapse@elapse-PC:/etc/profile.d$ echo $PATH\r\n/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin:/home/elapse/soft/flutter/bin\r\nelapse@elapse-PC:/etc/profile.d$ which flutter\r\n/home/elapse/soft/flutter/bin/flutter\r\nelapse@elapse-PC:/etc/profile.d$ \r\n</code>\r\n</pre>\r\n提前下载二进制开发文件:\r\n<pre><code>\r\n   \r\n    elapse@elapse-PC:/etc/profile.d$ flutter precache\r\n    Downloading Android Maven dependencies...                          29.4s\r\n    elapse@elapse-PC:/etc/profile.d$ \r\n    \r\n    \r\n    elapse@elapse-PC:/etc/profile.d$ flutter doctor\r\n    \r\n      ╔════════════════════════════════════════════════════════════════════════════╗\r\n      ║                 Welcome to Flutter! - https://flutter.dev                  ║\r\n      ║                                                                            ║\r\n      ║ The Flutter tool uses Google Analytics to anonymously report feature usage ║\r\n      ║ statistics and basic crash reports. This data is used to help improve      ║\r\n      ║ Flutter tools over time.                                                   ║\r\n      ║                                                                            ║\r\n      ║ Flutter tool analytics are not sent on the very first run. To disable      ║\r\n      ║ reporting, type \'flutter config --no-analytics\'. To display the current    ║\r\n      ║ setting, type \'flutter config\'. If you opt out of analytics, an opt-out    ║\r\n      ║ event will be sent, and then no further information will be sent by the    ║\r\n      ║ Flutter tool.                                                              ║\r\n      ║                                                                            ║\r\n      ║ By downloading the Flutter SDK, you agree to the Google Terms of Service.  ║\r\n      ║ Note: The Google Privacy Policy describes how data is handled in this      ║\r\n      ║ service.                                                                   ║\r\n      ║                                                                            ║\r\n      ║ Moreover, Flutter includes the Dart SDK, which may send usage metrics and  ║\r\n      ║ crash reports to Google.                                                   ║\r\n      ║                                                                            ║\r\n      ║ Read about data we send with crash reports:                                ║\r\n      ║ https://flutter.dev/docs/reference/crash-reporting                         ║\r\n      ║                                                                            ║\r\n      ║ See Google\'s privacy policy:                                               ║\r\n      ║ https://policies.google.com/privacy                                        ║\r\n      ╚════════════════════════════════════════════════════════════════════════════╝\r\n    \r\n    \r\n    Doctor summary (to see all details, run flutter doctor -v):\r\n    [✓] Flutter (Channel stable, 1.20.4, on Linux, locale zh_CN.UTF-8)\r\n     \r\n    [✓] Android toolchain - develop for Android devices (Android SDK version 29.0.3)\r\n    [✓] Android Studio (version 3.6)\r\n    [✓] VS Code (version 1.49.0)\r\n    [!] Connected device\r\n        ! No devices available\r\n    \r\n    ! Doctor found issues in 1 category.\r\n    elapse@elapse-PC:/etc/profile.d$ \r\n</code>\r\n</pre>\r\n至此开发环境算是完成了，还要安装（开发工具：VSCode 1.48.0、Android Studio），这个不再做安装记录。\r\n</div>\r\n<div><b>确认使用的开发环境如下：</b></div>\r\n<div>系统：Xubuntu 20.04 LTS</div>\r\n<div>Flutter：&nbsp;1.20.2</div>\r\n<div>主力开发工具：VSCode 1.48.0、Android Studio</div>\r\n<div>环境可以用自己喜欢的，但都差不了多少,只是在打包和发布 iOS 应用的时候，你需要使用 mac 电脑配合 xcode 一起工作。</div>\r\n<div><br></div>\r\n<div>如果你还没有配置好 <a href=\"https://flutter.cn/docs/get-started/install\" target=\"_blank\">Flutter 开发环境</a>，请参考<a href=\"https://flutter.cn/docs/get-started/install\" target=\"_blank\">此文档</a>；</div>\r\n<div><a href=\"https://code.visualstudio.com\" target=\"_blank\">VSCode </a>配置好必要插件后，是极理想的 Flutter 开发利器，你可以从这里<a href=\"https://code.visualstudio.com\" target=\"_blank\">下载它</a>。</div>\r\n<div>此文档引导你完成 Flutter 插件及环境的安装。</div>\r\n<div>如果你使用 <a href=\"https://flutter.cn/docs/get-started/editor?tab=androidstudio\" target=\"_blank\">Android Studio\r\n        开发</a>也没有问题，<a href=\"https://flutter.cn/docs/get-started/editor?tab=androidstudio\" target=\"_blank\">此文档</a>引导你完成\r\n    Android Studio 的插件配置。</div>\r\n<div>无论你在 Windows 下还是使用一其它什么软件环境或版，请使用以下命令行指确认自己的 Flutter 开发环境：</div>\r\n<pre><code>\r\nelapse@elapse-PC:~$ flutter doctor\r\nDoctor summary (to see all details, run flutter doctor -v):\r\n[✓] Flutter (Channel stable, 1.20.2, on Linux, locale zh_CN.UTF-8)\r\n \r\n[✓] Android toolchain - develop for Android devices (Android SDK version 29.0.3)\r\n[✓] Android Studio (version 3.6)\r\n[✓] VS Code (version 1.48.0)\r\n[!] Connected device\r\n    ! No devices available\r\n\r\n! Doctor found issues in 1 category.\r\nelapse@elapse-PC:~$ \r\n\r\n</code>\r\n</pre>\r\n打开VSCode后，通过快捷键：Ctrl+Shit+p 键打开后选择”Flutter New Project“来创建一个Flutter项目，<p></p>\r\n<p>输入项目名”chinese_chess“,回车后会让你选择保存项目的路径。选择好保存路径后，VSCode会自动打到当前项目。</p>\r\n<p><br></p>\r\n<p><b>项目创建好后应该为其添加版本控制</b></p>\r\n<p>先去<a href=\"https://github.com/\" target=\"_blank\">Git创建好账号</a>，创建好项目。</p>\r\n<p>之后再在本地项目把代码初始化到Git上面（我的git项目地址：<span style=\"font-family: monospace; font-size: 12px;\"><a href=\"https://rocketgit.com/user/elapse/chinese_chess\" target=\"_blank\">https://rocketgit.com/user/elapse/chinese_chess</a></span>）</p>\r\n<p>在VSCode中用快捷键” Ctrl+` “打开命令窗口:</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git init\r\n已初始化空的 Git 仓库于 /home/elapse/Language/Flutter/chinese_chess/.git/\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'初始化项目\'\r\n[master （根提交） 355a429] 初始化项目\r\n 62 files changed, 1633 insertions(+)\r\n create mode 100644 .gitignore\r\n create mode 100644 .metadata\r\n create mode 100644 README.md\r\n create mode 100644 android/.gitignore\r\n create mode 100644 android/app/build.gradle\r\n create mode 100644 android/app/src/debug/AndroidManifest.xml\r\n create mode 100644 android/app/src/main/AndroidManifest.xml\r\n create mode 100644 android/app/src/main/kotlin/com/example/chinese_chess/MainActivity.kt\r\n create mode 100644 android/app/src/main/res/drawable/launch_background.xml\r\n create mode 100644 android/app/src/main/res/mipmap-hdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/mipmap-mdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/mipmap-xhdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/mipmap-xxhdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/mipmap-xxxhdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/values/styles.xml\r\n create mode 100644 android/app/src/profile/AndroidManifest.xml\r\n create mode 100644 android/build.gradle\r\n create mode 100644 android/gradle.properties\r\n create mode 100644 android/gradle/wrapper/gradle-wrapper.properties\r\n create mode 100644 android/settings.gradle\r\n create mode 100644 ios/.gitignore\r\n create mode 100644 ios/Flutter/AppFrameworkInfo.plist\r\n create mode 100644 ios/Flutter/Debug.xcconfig\r\n create mode 100644 ios/Flutter/Release.xcconfig\r\n create mode 100644 ios/Runner.xcodeproj/project.pbxproj\r\n create mode 100644 ios/Runner.xcodeproj/project.xcworkspace/contents.xcworkspacedata\r\n create mode 100644 ios/Runner.xcodeproj/project.xcworkspace/xcshareddata/IDEWorkspaceChecks.plist\r\n create mode 100644 ios/Runner.xcodeproj/project.xcworkspace/xcshareddata/WorkspaceSettings.xcsettings\r\n create mode 100644 ios/Runner.xcodeproj/xcshareddata/xcschemes/Runner.xcscheme\r\n create mode 100644 ios/Runner.xcworkspace/contents.xcworkspacedata\r\n create mode 100644 ios/Runner.xcworkspace/xcshareddata/IDEWorkspaceChecks.plist\r\n create mode 100644 ios/Runner.xcworkspace/xcshareddata/WorkspaceSettings.xcsettings\r\n create mode 100644 ios/Runner/AppDelegate.swift\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Contents.json\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-1024x1024@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-20x20@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-20x20@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-20x20@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-29x29@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-29x29@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-29x29@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-40x40@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-40x40@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-40x40@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-60x60@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-60x60@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-76x76@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-76x76@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-83.5x83.5@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/Contents.json\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/LaunchImage.png\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/LaunchImage@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/LaunchImage@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/README.md\r\n create mode 100644 ios/Runner/Base.lproj/LaunchScreen.storyboard\r\n create mode 100644 ios/Runner/Base.lproj/Main.storyboard\r\n create mode 100644 ios/Runner/Info.plist\r\n create mode 100644 ios/Runner/Runner-Bridging-Header.h\r\n create mode 100644 lib/main.dart\r\n create mode 100644 pubspec.lock\r\n create mode 100644 pubspec.yaml\r\n create mode 100644 test/widget_test.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git remote add origin https://rocketgit.com/user/elapse/chinese_chess\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push -u origin master\r\nUsername for \'https://github.com\': luck@elapse.date\r\nPassword for \'https://luck@elapse.date@github.com\': \r\n枚举对象: 88, 完成.\r\n对象计数中: 100% (88/88), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (69/69), 完成.\r\n写入对象中: 100% (88/88), 53.76 KiB | 5.97 MiB/s, 完成.\r\n总共 88 （差异 3），复用 0 （差异 0）\r\nremote: Resolving deltas: 100% (3/3), done.\r\nTo https://github.com/vagicc/chinese_chess.git\r\n * [new branch]      master -&gt; master\r\n分支 \'master\' 设置为跟踪来自 \'origin\' 的远程分支 \'master\'。\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ \r\n\r\n</code>\r\n</pre>项目初始化完成后，第一眇先修改APP在设备安装后的名字：<p></p>\r\n<p><b>Android</b>：android/app/src/main/AndroidManifest.xml&nbsp;</p>\r\n<p>修改文件中：android:label=\"将帅象棋\"&nbsp;</p>\r\n<p><b>IOS</b>：ios/Runner/Info.plist</p>\r\n<p>修改文件：<key>CFBundleName</key> 中下一行的string里的值，修改后如下</p>\r\n<div style=\"color: rgb(213, 206, 217); background-color: rgb(34, 34, 34); font-family: \" droid=\"\" sans=\"\" mono\",=\"\" monospace,=\"\" \"droid=\"\" fallback\"=\"\" ;=\"\" font-size:=\"\" 14px;=\"\" line-height:=\"\" 19px;=\"\" white-space:=\"\" pre;\"=\"\">\r\n    <div> &lt;<span style=\"color: #f92672;\">key</span>&gt;CFBundleName\r\n        <!--<span style=\"color: #f92672;\"-->key&gt;</div>\r\n</div>\r\n<p><span style=\"background-color: rgb(34, 34, 34); color: rgb(213, 206, 217); font-family: \" droid=\"\" sans=\"\" mono\",=\"\" monospace,=\"\" \"droid=\"\" fallback\"=\"\" ;=\"\" font-size:=\"\" 14px;=\"\" white-space:=\"\" pre;\"=\"\"> &lt;</span><span style=\"background-color: rgb(34, 34, 34); font-family: \" droid=\"\" sans=\"\" mono\",=\"\" monospace,=\"\" \"droid=\"\" fallback\"=\"\" ;=\"\" font-size:=\"\" 14px;=\"\" white-space:=\"\" pre;=\"\" color:=\"\" rgb(249,=\"\" 38,=\"\" 114);\"=\"\">string</span><span style=\"background-color: rgb(34, 34, 34); color: rgb(213, 206, 217); font-family: \" droid=\"\" sans=\"\" mono\",=\"\" monospace,=\"\" \"droid=\"\" fallback\"=\"\" ;=\"\" font-size:=\"\" 14px;=\"\" white-space:=\"\" pre;\"=\"\">&gt;将帅象棋\r\n        <!--</span--><span style=\"background-color: rgb(34, 34, 34); font-family: \" droid=\"\" sans=\"\" mono\",=\"\" monospace,=\"\" \"droid=\"\" fallback\"=\"\" ;=\"\" font-size:=\"\" 14px;=\"\" white-space:=\"\" pre;=\"\" color:=\"\" rgb(249,=\"\" 38,=\"\" 114);\"=\"\">string</span><span style=\"background-color: rgb(34, 34, 34); color: rgb(213, 206, 217); font-family: \" droid=\"\" sans=\"\" mono\",=\"\" monospace,=\"\" \"droid=\"\" fallback\"=\"\" ;=\"\" font-size:=\"\" 14px;=\"\" white-space:=\"\" pre;\"=\"\">&gt;\r\n        </span></span></p>\r\n<p>如此APP安装后的名字就改成了”将帅象棋“。</p>\r\n<p>预先定义自己的颜色类：</p>\r\n<p>在项目的根目录下，lib 是我们 flutter 代码的集中地。我们创建 lib/common 文件夹，并在其下创建 color-consts.dart 文件：</p>\r\n<pre><code>\r\nimport \'package:flutter/material.dart\';\r\n\r\nclass ColorConsts {\r\n  // Logo 的颜色，一般都是品牌色\r\n  static const LogoColor = Color(0xFF6D000D);\r\n\r\n  // 主色，App 定调的颜色，一般从 Logo 中提升\r\n  static const Primary = Color(0xFF461220);\r\n  // 辅助色\r\n  static const Secondary = Color(0x99461220);\r\n\r\n  // 深色背景\r\n  static const DarkBackground = Colors.brown;\r\n  // 浅色背景\r\n  static const LightBackground = Color(0xFFEEE0CB);\r\n\r\n  // 棋盘颜色\r\n  static const BoardBackground = Color(0xFFEBC38D);\r\n\r\n  static const DarkTextPrimary = Colors.white;\r\n  static const DarkTextSecondary = Color(0x99FFFFFF);\r\n\r\n  // 棋盘线颜色\r\n  static const BoardLine = Color(0x996D000D);\r\n\r\n  // 棋盘上的路数、河界提示文字颜色\r\n  static const BoardTips = Color(0x666D000D);\r\n\r\n  static const LightLine = Color(0x336D000D);\r\n\r\n  // 棋盘上的移动位置指示\r\n  static const FocusPosition = Color(0x99FFFFFF);\r\n  static const BlurPosition = Color(0x99FFFFFF);\r\n\r\n  // 黑棋子颜色\r\n  static const BlackPieceColor = Color.fromARGB(0xFF, 0x00, 0x00, 0x00);\r\n  static const BlackPieceBorderColor = Color.fromARGB(0xFF, 0x22, 0x22, 0x22);\r\n\r\n  // 红棋子颜色\r\n  static const RedPieceColor = Color.fromARGB(0xFF, 0x7B, 0x00, 0x00);\r\n  static const RedPieceBorderColor = Color.fromARGB(0xFF, 0x66, 0x00, 0x00);\r\n\r\n  // 棋子文字颜色\r\n  static const PieceTextColor = Color.fromARGB(0xCC, 0xFF, 0xFF, 0xFF);\r\n}\r\n\r\n</code></pre>\r\n<p>在这儿我们定义了一组可以使用的颜色常量，实际项目推进中，颜色常量是一点一点地根据当时的需求添加进来的。</p>\r\n<p><br></p>\r\n<p>提交我们的代码到 git 仓库：</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'增加颜色\'\r\n[master edd1e70] 增加颜色\r\n 1 file changed, 45 insertions(+)\r\n create mode 100644 lib/common/color-consts.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': vagi\r\nPassword for \'https://vagi@rocketgit.com\': \r\n枚举对象: 7, 完成.\r\n对象计数中: 100% (7/7), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (4/4), 完成.\r\n写入对象中: 100% (5/5), 945 字节 | 945.00 KiB/s, 完成.\r\n总共 5 （差异 1），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 2408:8256:684:8dfe:998c:3cd8:41b5:d73d.\r\nremote: RocketGit: Info: date/time: 2020-08-22 12:32:24 (UTC), debug id 679e6d.\r\nTo https://rocketgit.com/user/vagi/chinese_chess\r\n   1fbba4d..edd1e70  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ \r\n</code>\r\n</pre>\r\n到此本小节已完。下节继续！！                                                        '),(23,'                                                                                                                                                                                                <p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这一节作为将这一系列课程真正的开始！当然我们肯定不是要创建什么 HelloWord 的啦。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">象棋游戏在 AppStore 中的游戏主要分类是什么 — Board 类！Board 是棋类游戏的主要关注点。这一节开始，我们将以上一节创建的项目 chessroad 为基础，使用 Canvas 绘制的我们的棋盘 Board。</p><h2 id=\"\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">本节目标</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">为了适应各种各样的屏幕，我们绘制棋盘没有使用图片资源，全部使用 Canvas 绘图方式完成。我们将要绘制的棋盘是这样的：</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><img src=\"https://images.gitbook.cn/G9tkI9.png\" alt=\"棋盘效果\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">棋盘绘制亦然包含许多的细节，为了让一节的篇幅不至于太长，我们这一节的绘制工作只包含棋盘，不包含棋子！</p><h2 id=\"-1\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">中国象棋棋盘</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在开始棋盘绘制之前，我们要了解一下中国象棋的棋盘。棋盘有一基本特性，这些特性在我们绘图时将体现到：</p><ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><li style=\"outline: 0px !important;\">棋盘由 10 条横线、9 条纵线组成，棋子放在纵横线交叉的点位上；</li><li style=\"outline: 0px !important;\">棋盘中间有一条「河界」，部分纵线是没有贯通「河界」的（有的象棋软件中线没有贯通）；</li><li style=\"outline: 0px !important;\">棋盘上下两侧的九宫（「将」可以移动的范围）从左上角到右下角、以及从右上角到左下角有斜线，作为「仕」移动的引导线。</li><li style=\"outline: 0px !important;\">两边的「炮」和「兵/卒」初始位置处有位置指示标志；</li><li style=\"outline: 0px !important;\">棋盘的上下两侧有指示纵线（象棋术语中叫「路数」）的数字。</li><li style=\"outline: 0px !important;\">代表红方的「路数」用中文数字「一」到「九」表示；</li><li style=\"outline: 0px !important;\">代表黑方的路数用阿拉伯数字「1」到「9」表示；</li><li style=\"outline: 0px !important;\">对于两方棋手来说，象棋的「路数」是从右边数超的， 相对于棋手所坐的方向，最右侧一路是第一路、最左侧是第九路。这符合中国人传统的文字从右向左书写的习惯</li></ul><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">了解这些信息后，我们开始准备绘制棋盘！</p><h2 id=\"-2\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">绘制并显示棋盘</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们使用 vscode 打开之前创建的“chinese_chess”项目，在项目根目下，我们建立一个 lib/board 文件夹，在其中新建 board-widget.dart 文件。在这个文件的中，我们添加一个新的 Widget 的实现类 BoardWidget：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-1\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">class BoardWidget extends StatelessWidget {\r\n    ...\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">对于棋盘的实现，我们的想法是这样的：</p><ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><li style=\"outline: 0px !important;\">用 Container 指定背景色的方式来实现代表棋盘底的「木板」</li><li style=\"outline: 0px !important;\">用 CustomPaint 来绘制棋盘上的线、位置坐标</li><li style=\"outline: 0px !important;\">棋盘上下边沿的「路数」指示文字，以及中间的「河界」文字，由布局方式添加上去</li></ul><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">代表棋盘的 BoardWiget 将来会被用在不同的场景，例如「对战」或「阅读棋盘」。考虑到目前的手机有多种不同纵横比的屏幕，我们有必要将 BoardWidget 实现成一个「适用性」强的组件 — 至少对屏幕的尺寸变化有很强的适应能力：</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这里我们需要考虑到 BoardWidget 的宽度 (width) 应该是由它的创建者（父组件）指定的。由于棋盘中的格式都是小正方形开，棋盘的宽度一确认，其高度也就确定了。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">有了这些思考和了解，我们在 BoardWidget 中开始创建代表棋盘「木板」的 Container：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-2\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'package:flutter/material.dart\';\r\nimport \'../common/color-consts.dart\';\r\n\r\nclass BoardWidget extends StatelessWidget {\r\n\r\n  // 棋盘内边界 + 棋盘上的路数指定文字高度\r\n  static const Padding = 5.0, DigitsHeight = 36.0;\r\n\r\n  // 棋盘的宽高\r\n  final double width, height;\r\n\r\n  BoardWidget({@required this.width}) :\r\n    height = (width - Padding * 2) / 9 * 10 + (Padding + DigitsHeight) * 2;\r\n\r\n  Widget build(BuildContext context) {\r\n    //\r\n    return Container(\r\n      width: width,\r\n      height: height,\r\n      decoration: BoxDecoration(\r\n        borderRadius: BorderRadius.circular(5),\r\n        color: ColorConsts.BoardBackground,\r\n      ),\r\n      child: null,\r\n    );\r\n  }\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在上边的代码中，我们添加了两个常量：</p><ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><li style=\"outline: 0px !important;\">Padding 表示了棋盘边界到棋子之间的距离</li><li style=\"outline: 0px !important;\">DigitsHeight 表示了为棋盘上下边沿的「路数」数字显示预留的高度</li></ul><blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">特别说明：<br style=\"outline: 0px !important;\">有时候我们贴出的代码为了简洁，没有添加需要的部分 import 语句，你需要我自行添加。<br style=\"outline: 0px !important;\">在 vscode 中，如果一个类型或方法没有被 import 引入，会在其下显示红色波浪线。<br style=\"outline: 0px !important;\">当你定位到这一行代码，并按&nbsp;<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">Cmd+.</code>时，vscode 会自动地给出你导入文件建议，选中并回车即可完成必要包的导入。</p></blockquote><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们只有「木板」的棋盘就算是准备好了。为了能从手机上看到这个简陋的棋盘，我们需要搭建一个简单的对战页面：</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">新建 lib/routes 文件夹，在其下创建 battle-page.dart 文件：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-4\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'package:flutter/material.dart\';\r\nimport \'../board/board-widget.dart\';\r\n\r\nclass BattlePage extends StatelessWidget {\r\n  // 棋盘的纵横方向的边距\r\n  static const BoardMarginV = 10.0, BoardMarginH = 10.0;\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    //\r\n    final windowSize = MediaQuery.of(context).size;\r\n    final boardHeight = windowSize.width - BoardMarginH * 2;\r\n\r\n    return Scaffold(\r\n      appBar: AppBar(title: Text(\'Battle\')),\r\n      body: Container(\r\n        margin: const EdgeInsets.symmetric(\r\n          horizontal: BoardMarginH,\r\n          vertical: BoardMarginV,\r\n        ),\r\n        child: BoardWidget(width: boardHeight),\r\n      ),\r\n    );\r\n  }\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">上边的 BattlePage 代码为我们的 BoardWidget 提供了必要的舞台：</p><ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><li style=\"outline: 0px !important;\">我们使用 MediaQuery 查询了窗口的尺寸， 得到了 BoardWidget 的适当宽度</li><li style=\"outline: 0px !important;\">BoardWidget 被放在外层的另一个 Container 中，这个 Container 定义了左右上下的边边距。不要小看这两个边距值，将来在做屏幕适合的时候，动动这两个值就行了，BoardWidget 都不用一丝丝修改。</li></ul><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">打开 Flutter自动为我们创建的 main.dart 文件，删除原有的代码，添加以下的代码：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-5\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'package:flutter/material.dart\';\r\nimport \'routes/battle-page.dart\';\r\n\r\nvoid main() {\r\n  // runApp(MyApp());\r\n  runApp(ChessApp());\r\n}\r\n\r\nclass ChessApp extends StatelessWidget {\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    return MaterialApp(\r\n      title: \'中国象棋\',\r\n      theme: ThemeData(\r\n        primarySwatch: Colors.lime,\r\n        visualDensity: VisualDensity.adaptivePlatformDensity,\r\n      ),\r\n      debugShowCheckedModeBanner: false, //禁止显示 App 右上角的一个「Debug」字样的条幅\r\n      home: BattlePage(),\r\n    );\r\n  }\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">上边的代码中，我们指定了 BattlePage 页面为我们启动后的默认页面，在这之前还为 App 指定了主体颜色。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">由于我们修改了默认 App 的类名称，所以我们需要在 test/widget_test.dart 中将“MyApp”修改为“<span style=\"background-color: transparent; color: inherit; font-family: Menlo, Monaco, Consolas, \" courier=\"\" new\",=\"\" monospace;=\"\" font-size:=\"\" inherit;=\"\" white-space:=\"\" pre-wrap;\"=\"\">ChessApp”</span>，将原来的如下代码：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-6\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">...\r\nawait tester.pumpWidget(MyApp());\r\n...\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">修改为：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-7\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">...\r\nawait tester.pumpWidget(ChessApp());<br>...\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 vscode 上按<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">F5</code>运行代码，你将看代表我们棋盘的「木板」显示在画面上了，这离我们显示棋盘的目标近了一点点！</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><img src=\"https://images.gitbook.cn/S4QSk2.png\" alt=\"代码棋盘的小木板显示出来\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\"></p><h2 id=\"-3\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">绘制棋盘上的网格</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">现在，我们开始创建 CustomPaint 组件，在 lib/board 文件夹下，我们新建一个 board-painter.dart 文件，我们要在其中实现 BoardPainter 类：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-9\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'package:flutter/material.dart\';\r\n\r\nimport \'board-widget.dart\';\r\n\r\nclass BoardPainter extends CustomPainter {\r\n  // 棋盘的宽度， 横盘上线格的总宽度，每一个格子的边长\r\n  final double width, gridWidth, squareSide;\r\n  final thePaint = Paint();\r\n\r\n  BoardPainter({@required this.width})\r\n      : gridWidth = (width - BoardWidget.Padding * 2) * 8 / 9,\r\n        squareSide = (width - BoardWidget.Padding * 2) / 9;\r\n\r\n  @override\r\n  void paint(Canvas canvas, Size size) {\r\n    //\r\n  }\r\n\r\n  @override\r\n  bool shouldRepaint(CustomPainter oldDelegate) {\r\n    return false;\r\n  }\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 BoardWidget 类中，我们为代码「木板」的 Container 设置一个 CustomPaint 的 child，并将 CustomPaint 的 painter 指向 BoardPainter 对象:</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-10\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">...\r\n\r\nclass BoardWidget extends StatelessWidget {\r\n  //\r\n  ...\r\n\r\n  Widget build(BuildContext context) {\r\n    //\r\n    return Container(\r\n      width: width,\r\n      height: height,\r\n      decoration: BoxDecoration(\r\n        borderRadius: BorderRadius.circular(5),\r\n        color: ColorConsts.BoardBackground,\r\n      ),\r\n      child: CustomPaint(\r\n        painter: BoardPainter(width: width),\r\n      ),\r\n    );\r\n  }\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">现在，我们把 CustomPaint 对象和 BoardPainter 关联起来了，只是这个 Painter 还什么都没有绘制。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们下来就开始绘制基本的网格吧：</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们在 BoardPainter 类中添加一个 static 方法 doPaint：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-11\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">  static doPaint(\r\n    Canvas canvas,\r\n    Paint paint,\r\n    double gridWidth,\r\n    double squareSide, {\r\n    double offsetX,\r\n    double offsetY,\r\n  }) {\r\n    //\r\n  }\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><p style=\"margin-bottom: 1.1em; font-size: 1em; line-height: 1.45; outline: 0px !important;\">之所以使用一个静态方法来包裹所有的绘制动作，是考虑到这个绘制动作可能被重用。</p><p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">将来在分享局面图片时，需要将棋盘绘制在内存画布上时，那会儿就可以直接在此类之外通过静态方法调用这绘制代码了。</p></blockquote><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">接着，我们在 BoardPainter 类的 paint 方法中调用 doPaint 方法：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-12\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"> @override\r\n void paint(Canvas canvas, Size size) {\r\n   doPaint(\r\n     canvas,\r\n     thePaint,\r\n     gridWidth,\r\n     squareSide,\r\n     offsetX: BoardWidget.Padding + squareSide / 2,\r\n     offsetY: BoardWidget.Padding + BoardWidget.DigitsHeight + squareSide / 2,\r\n  );\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">真正在 doPaint 方法中绘制棋盘，我分需要分几步走：</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">第一步，我们绘制外框和纵横线：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-13\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">  static doPaint(\r\n    Canvas canvas,\r\n    Paint paint,\r\n    double gridWidth,\r\n    double squareSide, {\r\n    double offsetX,\r\n    double offsetY,\r\n  }) {\r\n    paint.color = ColorConsts.BoardLine;\r\n    paint.style = PaintingStyle.stroke;\r\n\r\n    var left = offsetX, top = offsetY;\r\n\r\n    //棋盘外框\r\n    paint.strokeWidth = 2;\r\n    canvas.drawRect(\r\n      Rect.fromLTWH(left, top, gridWidth, squareSide * 9),\r\n      paint,\r\n    );\r\n\r\n    paint.strokeWidth = 1; //设置线宽为1\r\n\r\n    //8根横线\r\n    for (var i = 1; i &lt; 9; i++) {\r\n      canvas.drawLine(\r\n        Offset(left, top + squareSide * i),\r\n        Offset(left + gridWidth, top + squareSide * i),\r\n        paint,\r\n      );\r\n    }\r\n\r\n    //上下各6根短竖线\r\n    for (var i = 0; i &lt; 8; i++) {\r\n      // if (i == 4) continue; //中间拉通的线已经画过\r\n\r\n      /* 上边短竖线 */\r\n      canvas.drawLine(\r\n        Offset(left + squareSide * i, top),\r\n        Offset(left + squareSide * i, top + squareSide * 4),\r\n        paint,\r\n      );\r\n\r\n      /* 下边短竖线 */\r\n      canvas.drawLine(\r\n        Offset(left + squareSide * i, top + squareSide * 5),\r\n        Offset(left + squareSide * i, top + squareSide * 9),\r\n        paint,\r\n      );\r\n    }\r\n\r\n    //中轴线,可要可不要，我这边不要\r\n    // paint.strokeWidth = 1;\r\n    // canvas.drawLine(\r\n    //   Offset(left + gridWidth / 2, top),\r\n    //   Offset(left + gridWidth / 2, top + squareSide * 9),\r\n    //   paint,\r\n    // );\r\n\r\n  ...\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">第二步，我们绘制上下两个九宫中的四根斜线：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-14\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">  static doPaint(\r\n    Canvas canvas,\r\n    Paint paint,\r\n    double gridWidth,\r\n    double squareSide, {\r\n    double offsetX,\r\n    double offsetY,\r\n  }) {\r\n\r\n   ...\r\n\r\n   //将与帅周围的线-九宫中的斜线\r\n    canvas.drawLine(\r\n      Offset(left + squareSide * 3, top),\r\n      Offset(left + squareSide * 5, top + squareSide * 2),\r\n      paint,\r\n    );\r\n    canvas.drawLine(\r\n      Offset(left + squareSide * 3, top + squareSide * 2),\r\n      Offset(left + squareSide * 5, top),\r\n      paint,\r\n    );\r\n    canvas.drawLine(\r\n      Offset(left + squareSide * 3, top + squareSide * 7),\r\n      Offset(left + squareSide * 5, top + squareSide * 9),\r\n      paint,\r\n    );\r\n    canvas.drawLine(\r\n      Offset(left + squareSide * 3, top + squareSide * 9),\r\n      Offset(left + squareSide * 5, top + squareSide * 7),\r\n      paint,\r\n    );\r\n\r\n  ...\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">第三步，我们绘制标定炮和兵卒起始位置的标识，我们用小圆圈来做标识，靠边的兵卒位置则用半圆圈来标示：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-15\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">  static doPaint(\r\n    Canvas canvas,\r\n    Paint paint,\r\n    double gridWidth,\r\n    double squareSide, {\r\n    double offsetX,\r\n    double offsetY,\r\n  }) {\r\n\r\n   ...\r\n\r\n   /* 炮、兵架位置指示 */\r\n    final positions = [\r\n      // 炮架位置指示\r\n      Offset(left + squareSide, top + squareSide * 2),\r\n      Offset(left + squareSide * 7, top + squareSide * 2),\r\n      Offset(left + squareSide, top + squareSide * 7),\r\n      Offset(left + squareSide * 7, top + squareSide * 7),\r\n      // 部分兵架位置指示\r\n      Offset(left + squareSide * 2, top + squareSide * 3),\r\n      Offset(left + squareSide * 4, top + squareSide * 3),\r\n      Offset(left + squareSide * 6, top + squareSide * 3),\r\n      Offset(left + squareSide * 2, top + squareSide * 6),\r\n      Offset(left + squareSide * 4, top + squareSide * 6),\r\n      Offset(left + squareSide * 6, top + squareSide * 6),\r\n    ];\r\n    positions.forEach((pos) {\r\n      canvas.drawCircle(pos, 5, paint);\r\n    });\r\n\r\n    //兵架靠左边位置指示\r\n    final leftPositons = [\r\n      Offset(left, top + squareSide * 3),\r\n      Offset(left, top + squareSide * 6),\r\n    ];\r\n    leftPositons.forEach((pos) {\r\n      var rect = Rect.fromCenter(center: pos, width: 10, height: 10);\r\n      canvas.drawArc(rect, -pi / 2, pi, true, paint);\r\n    });\r\n    //兵架靠右边位置指示\r\n    final rightPositions = [\r\n      Offset(left + squareSide * 8, top + squareSide * 3),\r\n      Offset(left + squareSide * 8, top + squareSide * 6),\r\n    ];\r\n    rightPositions.forEach((pos) {\r\n      var rect = Rect.fromCenter(center: pos, width: 10, height: 10);\r\n      canvas.drawArc(rect, pi / 2, pi, true, paint);\r\n    });\r\n\r\n  ...\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">由于画炮和兵卒位置的时候要画圆圈，我们需要用到常量值「pi」，所以记得要引入dart 的 math 库：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-16\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'dart:math\'\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">好一段艰苦的工作，不过终于完成了！整个 BoardPainter 的代码是这样的：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-17\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'dart:math\';\r\n\r\nimport \'package:chinese_chess/common/color-consts.dart\';\r\nimport \'package:flutter/material.dart\';\r\nimport \'board-widget.dart\';\r\n\r\nclass BoardPainter extends CustomPainter {\r\n  //棋盘的宽度， 横盘上线格的总宽度，每一个格子的边长\r\n  final double width, gridWidth, squareSide;\r\n  final thePaint = Paint(); //画笔\r\n\r\n  BoardPainter({@required this.width})\r\n      : gridWidth = (width - BoardWidget.Padding * 2) / 9 * 8, //计算横盘上线格的总宽度\r\n        squareSide = (width - BoardWidget.Padding * 2) / 9; //计算每一个格子的边长\r\n\r\n  static doPaint(\r\n    Canvas canvas,\r\n    Paint paint,\r\n    double gridWidth,\r\n    double squareSide, {\r\n    double offsetX,\r\n    double offsetY,\r\n  }) {\r\n    paint.color = ColorConsts.BoardLine;\r\n    paint.style = PaintingStyle.stroke;\r\n\r\n    var left = offsetX, top = offsetY;\r\n\r\n    //棋盘外框\r\n    paint.strokeWidth = 2;\r\n    canvas.drawRect(\r\n      Rect.fromLTWH(left, top, gridWidth, squareSide * 9),\r\n      paint,\r\n    );\r\n\r\n    paint.strokeWidth = 1; //设置线宽为1\r\n\r\n    //8根横线\r\n    for (var i = 1; i &lt; 9; i++) {\r\n      canvas.drawLine(\r\n        Offset(left, top + squareSide * i),\r\n        Offset(left + gridWidth, top + squareSide * i),\r\n        paint,\r\n      );\r\n    }\r\n\r\n    //上下各6根短竖线\r\n    for (var i = 0; i &lt; 8; i++) {\r\n      // if (i == 4) continue; //中间拉通的线已经画过\r\n\r\n      /* 上边短竖线 */\r\n      canvas.drawLine(\r\n        Offset(left + squareSide * i, top),\r\n        Offset(left + squareSide * i, top + squareSide * 4),\r\n        paint,\r\n      );\r\n\r\n      /* 下边短竖线 */\r\n      canvas.drawLine(\r\n        Offset(left + squareSide * i, top + squareSide * 5),\r\n        Offset(left + squareSide * i, top + squareSide * 9),\r\n        paint,\r\n      );\r\n    }\r\n\r\n    //中轴线,可要可不要，我这边不要\r\n    // paint.strokeWidth = 1;\r\n    // canvas.drawLine(\r\n    //   Offset(left + gridWidth / 2, top),\r\n    //   Offset(left + gridWidth / 2, top + squareSide * 9),\r\n    //   paint,\r\n    // );\r\n\r\n    //将与帅周围的线-九宫中的斜线\r\n    canvas.drawLine(\r\n      Offset(left + squareSide * 3, top),\r\n      Offset(left + squareSide * 5, top + squareSide * 2),\r\n      paint,\r\n    );\r\n    canvas.drawLine(\r\n      Offset(left + squareSide * 3, top + squareSide * 2),\r\n      Offset(left + squareSide * 5, top),\r\n      paint,\r\n    );\r\n    canvas.drawLine(\r\n      Offset(left + squareSide * 3, top + squareSide * 7),\r\n      Offset(left + squareSide * 5, top + squareSide * 9),\r\n      paint,\r\n    );\r\n    canvas.drawLine(\r\n      Offset(left + squareSide * 3, top + squareSide * 9),\r\n      Offset(left + squareSide * 5, top + squareSide * 7),\r\n      paint,\r\n    );\r\n\r\n    /* 炮、兵架位置指示 */\r\n    final positions = [\r\n      // 炮架位置指示\r\n      Offset(left + squareSide, top + squareSide * 2),\r\n      Offset(left + squareSide * 7, top + squareSide * 2),\r\n      Offset(left + squareSide, top + squareSide * 7),\r\n      Offset(left + squareSide * 7, top + squareSide * 7),\r\n      // 部分兵架位置指示\r\n      Offset(left + squareSide * 2, top + squareSide * 3),\r\n      Offset(left + squareSide * 4, top + squareSide * 3),\r\n      Offset(left + squareSide * 6, top + squareSide * 3),\r\n      Offset(left + squareSide * 2, top + squareSide * 6),\r\n      Offset(left + squareSide * 4, top + squareSide * 6),\r\n      Offset(left + squareSide * 6, top + squareSide * 6),\r\n    ];\r\n    positions.forEach((pos) {\r\n      canvas.drawCircle(pos, 5, paint);\r\n    });\r\n\r\n    //兵架靠左边位置指示\r\n    final leftPositons = [\r\n      Offset(left, top + squareSide * 3),\r\n      Offset(left, top + squareSide * 6),\r\n    ];\r\n    leftPositons.forEach((pos) {\r\n      var rect = Rect.fromCenter(center: pos, width: 10, height: 10);\r\n      canvas.drawArc(rect, -pi / 2, pi, true, paint);\r\n    });\r\n    //兵架靠右边位置指示\r\n    final rightPositions = [\r\n      Offset(left + squareSide * 8, top + squareSide * 3),\r\n      Offset(left + squareSide * 8, top + squareSide * 6),\r\n    ];\r\n    rightPositions.forEach((pos) {\r\n      var rect = Rect.fromCenter(center: pos, width: 10, height: 10);\r\n      canvas.drawArc(rect, pi / 2, pi, true, paint);\r\n    });\r\n  }\r\n\r\n  @override\r\n  void paint(Canvas canvas, Size size) {\r\n    doPaint(\r\n      canvas,\r\n      thePaint,\r\n      gridWidth,\r\n      squareSide,\r\n      offsetX: BoardWidget.Padding + squareSide / 2,\r\n      offsetY: BoardWidget.Padding + BoardWidget.DigitsHeight + squareSide / 2,\r\n    );\r\n  }\r\n\r\n  @override\r\n  bool shouldRepaint(CustomPainter oldDelegate) {\r\n    return false;\r\n    // throw UnimplementedError();\r\n  }\r\n}\r\n\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">成果是显著的，在 vscode 中按<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">F5</code>，看看效果吧？</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><img src=\"https://images.gitbook.cn/si1H05.png\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\"></p><h2 id=\"-4\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">棋盘上的路数和河界文字</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">离这一节的目标，还差一点点了！</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们来添加棋盘上的「路数」指示和棋盘中间的「河界」文字吧。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 lib/board 文件夹下，我们新建一个文件 words-on-board.dart 文件，在其中建立一个名叫 WordsOnBoard 的 StatelessWidget 类：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-19\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><widget><widget><widget><widget>import \'package:flutter/material.dart\';\r\nimport \'../common/color-consts.dart\';\r\n\r\nclass WordsOnBoard extends StatelessWidget {\r\n  static const DigitsFontSize = 18.0;\r\n  const WordsOnBoard({Key key}) : super(key: key);\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    // 棋盘上的路数指示，红方用大写，黑方用全角的小写字母\r\n    final blackColumns = \'123456789\', redColumns = \'九八七六五四三二一\';\r\n    final bChildren = <widget>[], rChildren = <widget>[];\r\n\r\n    final digitsStyle = TextStyle(fontSize: DigitsFontSize);\r\n    final rivierTipsStyle = TextStyle(fontSize: 28.0);\r\n\r\n    for (var i = 0; i &lt; 9; i++) {\r\n      bChildren.add(Text(blackColumns[i], style: digitsStyle));\r\n      rChildren.add(Text(redColumns[i], style: digitsStyle));\r\n\r\n      //每一个数字后边添加一个 Expanded，用于平分布局空间\r\n      if (i &lt; 8) {\r\n        bChildren.add(Expanded(child: SizedBox()));\r\n        rChildren.add(Expanded(child: SizedBox()));\r\n      }\r\n    }\r\n\r\n    final riverTips = Row(\r\n      children: <widget>[\r\n        Expanded(child: SizedBox()),\r\n        Text(\'楚河\', style: rivierTipsStyle),\r\n        Expanded(child: SizedBox(), flex: 2),\r\n        Text(\'汉界\', style: rivierTipsStyle),\r\n        Expanded(child: SizedBox()),\r\n      ],\r\n    );\r\n\r\n    // 放置上、中、下三部分到一个列布局模式中，上和中、中和下之间使用 Expanded 对象平分垂直方向多出来的布局空间\r\n    return DefaultTextStyle(\r\n      child: Column(\r\n        children: <widget>[\r\n          Row(children: bChildren),\r\n          Expanded(child: SizedBox()),\r\n          riverTips,\r\n          Expanded(child: SizedBox()),\r\n          Row(children: rChildren),\r\n        ],\r\n      ),\r\n      style: TextStyle(color: ColorConsts.BoardTips),\r\n    );\r\n  }\r\n}\r\n\r\n\r\n</widget></widget></widget></widget></widget></widget></widget></widget></code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在这个 Widget 中，我们将棋盘顶部的黑棋「路数」指示、底部的红棋「路数」指示以及棋盘中间的「楚河」、「汉界」文字添加到一个 Column 布局中，三者之间使用 Expanded 来撑开空白空间。</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们需要将这个布局作为 child 对象添加到绘制棋盘的 CustomPaint 对象身上，这样它将显示在棋盘 CustomPaint 之上，在 BoardWidget 中为 CustomPaint 添加 child，如下边代码所示：</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-20\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">Widget build(BuildContext context) {\r\n   //\r\n   return Container(\r\n     width: width,\r\n     height: height,\r\n     decoration: BoxDecoration(\r\n       borderRadius: BorderRadius.circular(5),\r\n       color: ColorConsts.BoardBackground,\r\n    ),\r\n     child: CustomPaint(\r\n       painter: BoardPainter(width: width),\r\n       child: Container(\r\n         margin: EdgeInsets.symmetric(\r\n           vertical: Padding,\r\n           // 因为棋子是放在交叉线上的，不是放置在格子内，所以棋子左右各有一半在格线之外\r\n           // 这里先依据横盘的宽度计算出一个格子的边长，再依此决定垂直方向的边距\r\n           horizontal: (width - Padding * 2) / 9 / 2 + Padding - WordsOnBoard.DigitsFontSize / 2,\r\n        ),\r\n         child: WordsOnBoard(),\r\n      ),\r\n    ),\r\n  );\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">到此，我们绘制棋盘的任务就完成了，按&nbsp;<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">F5</code>查看一下我们的成果吧！</p><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><img src=\"https://elapse.date/static/uploads/1598163458_f1607b0b6a8b52da28d6.jpg\" data-filename=\"img\" style=\"width: 720px;\">将我们的代码提交 git 仓库，本节的目标完成了！</p><pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"bash language-bash hljs\" id=\"code-22\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" padding:=\"\" 0.5em;=\"\" color:=\"\" rgb(56,=\"\" 58,=\"\" 66);=\"\" background:=\"\" rgb(250,=\"\" 250,=\"\" 250);=\"\" white-space:=\"\" pre;=\"\" display:=\"\" block;=\"\" overflow-x:=\"\" auto;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">elapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'绘棋盘\'\r\n[master 63f3063] 绘棋盘\r\n 6 files changed, 284 insertions(+), 2 deletions(-)\r\n create mode 100644 lib/board/board-painter.dart\r\n create mode 100644 lib/board/board-widget.dart\r\n create mode 100644 lib/board/words-on-board.dart\r\n create mode 100644 lib/routes/battle-page.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git push\r\n枚举对象: 17, 完成.\r\n对象计数中: 100% (17/17), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (10/10), 完成.\r\n写入对象中: 100% (12/12), 3.94 KiB | 3.94 MiB/s, 完成.\r\n总共 12 （差异 3），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 27.47.6.229.\r\nremote: RocketGit: Info: date/time: 2020-08-23 06:10:10 (UTC), debug id e54754.\r\nremote: RocketGit: Info: refs/heads/master:\r\nremote: RocketGit: Info: Because you do not have \'push\' rights, your push was\r\nremote: RocketGit: Info: transformed into a merge request and awaits approval.\r\nTo https://rocketgit.com/user/vagi/chinese_chess\r\n   edd1e70..63f3063  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': vagi\r\nPassword for \'https://vagi@rocketgit.com\': \r\n总共 0 （差异 0），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 27.47.6.229.\r\nremote: RocketGit: Info: date/time: 2020-08-23 06:12:50 (UTC), debug id 6e3df1.\r\nTo https://rocketgit.com/user/vagi/chinese_chess\r\n   edd1e70..63f3063  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><h2 id=\"-5\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">本节回顾</h2><p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在这一小节中，我们学习和完成了以下的任务：</p><ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><li style=\"outline: 0px !important;\">学习中国象棋棋盘的基本知识</li><li style=\"outline: 0px !important;\">规划使用CustomPaint绘制棋盘的方案</li><li style=\"outline: 0px !important;\">动态计算并绘制棋盘上的网格</li><li style=\"outline: 0px !important;\">通过为 CustomPaint 添加 child 的方式，布局棋盘上的「河界、路数」文字</li></ul>                                                                                                                                                                        '),(24,'<p>上一节我们完成的棋盘的布署和绘制，棋子自然是接下来的重要内容了!</p>\r\n<p>CustomPaint 可以将绘制内容分成背景和前景两款部分，上一节中，我们在 CustomPaint 中将 painter 指向了我们的 BoardPainter 对象，它正是用来指定背景 Painter 的。</p>\r\n<p>本节提要</p>\r\n<p>思考棋子与棋盘的关联</p>\r\n<p>讨论象棋「局面」的表示方式</p>\r\n<p>使用 Canvas 绘制各个棋子</p>\r\n<p>规划局面的管理工具类</p>\r\n<p>应用三方字体美化棋子</p>\r\n<p>布署棋子组件</p>\r\n<p>CustomPaint 还可以指定一个 CustomPainter 类型的 foregroundPainter 对象，用于在背景之上绘制前景内容。我们正是要用它来绘制棋盘上的棋子。</p>\r\n<p>在 lib/board 文件夹下，我们新建一个名叫 pieces-painter.dart 的文件：</p>\r\n<pre><code>\r\nimport \'package:flutter/material.dart\';\r\nimport \'board-widget.dart\';\r\n\r\nclass PiecesPainter extends CustomPainter {\r\n  //棋盘的宽度， 横盘上线格的总宽度，每一个格子的边长\r\n  final double width, gridWidth, squareSide;\r\n  final thePaint = Paint();\r\n\r\n  PiecesPainter({@required this.width})\r\n      : gridWidth = (width - BoardWidget.Padding * 2) / 9 * 8, //计算总宽度\r\n        squareSide = (width - BoardWidget.Padding * 2) / 9; //计算每个格子的边长\r\n\r\n  @override\r\n  void paint(Canvas canvas, Size size) {\r\n    //\r\n  }\r\n\r\n  @override\r\n  bool shouldRepaint(CustomPainter oldDelegate) {\r\n    //\r\n    return true;\r\n    // throw UnimplementedError();\r\n  }\r\n}\r\n\r\n</code><font color=\"#000000\" face=\"Source Sans Pro, Helvetica Neue, Helvetica, Arial, sans-serif\"><span style=\"white-space: normal;\">\r\n</span></font></pre>\r\n<p>由于棋盘上的网格宽度、棋盘小格子的尺寸等信息，在棋盘的网格和棋子绘制中是统一的，因此我们对之前的代码做一点面向对象的重构 — 把相同的逻辑抽到到一个基类中去。</p>\r\n<p>在 lib/board 文件夹下新建一个 painter-base.dart 文件，建立 BoardPainter 和 PiecesPainter 的共同父类 PainterBase 类：<br></p>\r\n<pre><code>\r\nimport \'package:flutter/material.dart\';\r\nimport \'board-widget.dart\';\r\n\r\n//创建共同使用的基类\r\nabstract class PainterBase extends CustomPainter {\r\n  //棋盘的宽度， 横盘上线格的总宽度，每一个格子的边长\r\n  final double width, gridWidth, squareSide;\r\n  final thePaint = Paint();\r\n\r\n  PainterBase({@required this.width})\r\n      : gridWidth = (width - BoardWidget.Padding * 2) / 9 * 8, //计算总宽度\r\n        squareSide = (width - BoardWidget.Padding * 2) / 9; //计算每个格子的边长\r\n\r\n}\r\n</code>\r\n</pre>\r\n修改 BoardPainter 类，使其继承自 PainterBase，删除掉已经提升到父类中的 Fields 定义，并修改构造方法的实现代码：\r\n<pre><code>\r\nclass BoardPainter extends PainterBase {\r\n  BoardPainter({@required double width}) : super(width: width);\r\n  ...\r\n}\r\n</code>\r\n</pre>\r\n<p>\r\n    与此类似，使 PiecesPainter 类也继承自 PainterBase 类：\r\n</p>\r\n<pre><code>\r\n\r\nclass PiecesPainter extends PainterBase {\r\n  PiecesPainter({@required double width}) : super(width: width);\r\n  ...\r\n}\r\n</code></pre>\r\n<p><span style=\"color: inherit; font-family: inherit; font-size: 30px;\">棋盘局面表示</span></p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在绘制棋子的之前，有一个问题我们需要优先考虑：棋盘上的棋子位置是活动的，我们如何表示当前局面的棋子分布？为了应对这个问题，我们需要建立一组模型，用以表示棋盘上的棋子类型、颜色、位置分布等数据。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们建立 lib/cchess 文件夹，将与中国象棋逻辑相关的实现代码限制在此文件夹范围内。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 cchess 文件夹下，我们建立cc-base.dart 文件，在其中先建立代表棋盘两方的 Side 类和代表棋盘中的棋子的 Piece 类：</p>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">cc 代表 Chinese Chess，以后遇到的 cc 都遵循这个约定。</p>\r\n\r\n</blockquote>\r\n<pre><code>\r\nclass Side {\r\n  static const Unknown = \'-\';\r\n  static const Red = \'w\'; //中国象棋理论按国际象棋：\'w\'是国际象棋中的 white 侧，在中国象棋中没有白方，指代红方\r\n  static const Black = \'b\'; //表示黑方\r\n\r\n  /* 返回哪一方 */\r\n  static String of(String piece) {\r\n    /* \r\n    中国象棋用大写字母代表红方的棋子，用小定字母代码黑方的框\r\n    RNBAKCP 依次代码的棋子为：车马象仕将炮兵\r\n    */\r\n    if (\'RNBAKCP\'.contains(piece)) return Red;\r\n    if (\'rnbakcp\'.contains(piece)) return Black;\r\n    return Unknown;\r\n  }\r\n\r\n  /* 判断是否同一方 */\r\n  static bool sameSide(String p1, String p2) {\r\n    return of(p1) == of(p2);\r\n  }\r\n\r\n  /* 交换红黑下棋方 */\r\n  static String oppo(String side) {\r\n    if (side == Red) return Black;\r\n    if (side == Black) return Red;\r\n    return side;\r\n  }\r\n}\r\n\r\n/* 棋子类 */\r\nclass Piece {\r\n  static const Empty = \' \';\r\n\r\n  static const RedRook = \'R\'; //红\"车\"\r\n  static const RedKnight = \'N\'; //红“马”\r\n  static const RedBishop = \'B\'; //红”相“\r\n  static const RedAdvisor = \'A\'; //红”仕“\r\n  static const RedKing = \'K\'; //红”帅“\r\n  static const RedCanon = \'C\'; //红”炮“\r\n  static const RedPawn = \'P\'; //红”兵“\r\n\r\n  static const BlackRook = \'r\'; //黑”车“\r\n  static const BlackKnight = \'n\'; //黑”马“\r\n  static const BlackBishop = \'b\'; //黑”象“\r\n  static const BlackAdvisor = \'a\'; //黑”士“\r\n  static const BlackKing = \'k\'; //黑”将“\r\n  static const BlackCanon = \'c\'; //黑”炮“\r\n  static const BlackPawn = \'p\'; //黑”卒“\r\n\r\n  static const Names = {\r\n    Empty: \'\',\r\n\r\n    //红方\r\n    RedRook: \'车\',\r\n    RedKnight: \'马\',\r\n    RedBishop: \'相\',\r\n    RedAdvisor: \'仕\',\r\n    RedKing: \'帅\',\r\n    RedCanon: \'炮\',\r\n    RedPawn: \'兵\',\r\n\r\n    //黑方\r\n    BlackRook: \'车\',\r\n    BlackKnight: \'马\',\r\n    BlackBishop: \'象\',\r\n    BlackAdvisor: \'士\',\r\n    BlackKing: \'将\',\r\n    BlackCanon: \'炮\',\r\n    BlackPawn: \'卒\',\r\n  };\r\n\r\n  static bool isRed(String c) =&gt; \'RNBAKCP\'.contains(c);\r\n  static bool isBlack(String c) =&gt; \'rnbakcp\'.contains(c);\r\n}\r\n</code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 Side 类中，行棋的两方我们各用一个字符表示：\'b\' 表示黑方，\'w\' 表示红方，用 \'-\' 表示未知行棋方。</p>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">由于中国象棋通用引擎协议—UCCI 中很多规定沿袭了国际象棋的引擎协议，所以使用 \'w\'\r\n        表示红方，这是沿袭了国际象棋对 White 方的表示。</p>\r\n</blockquote>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 Piece 类中，我们各用一个字母来表示棋盘上的棋子。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">多数情况下，我们用车、马、相、士、将、炮、兵的英文单词首字母表示对应的棋子。有一个例外，那就是代表「马」的单词 Knight 和代表「将」的单词 King 都是以 \'K\' 开头，所以约定了用 \'N\'\r\n    或 \'n\' 来代表「马」，\'K\'或\'k\'代表「将」或「帅」。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">此外，棋软开发者还约定，黑棋用小写字母表示，红棋用对应的大写字母表示。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这样一来，棋盘上 10 横 9 纵共 90 个交叉点，我们就可以用一个数组来表示棋盘上的棋子分布了。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">「棋子分布」加上「当前轮谁走棋」两个信息，共同构成了一个象棋的「局面」信息。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们在 lib/cchess 文件夹下新建一个 phase.dart 文件，表示象棋的局面：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-5\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'cc-base.dart\';\r\n\r\n/* 局面类 */\r\nclass Phase {\r\n  String _side; //当前行棋艺方\r\n\r\n  List _pieces; //10行9列（中国象棋的棋子放在纵线交叉点上，棋盘上总共有10行9列的交叉点位，一共90个位置）\r\n\r\n  get side =&gt; _side;\r\n\r\n  trunSide() =&gt; _side = Side.oppo(_side); //交换行棋\r\n\r\n  /* 查询10行9列的某个位置上的棋子 */\r\n  String pieceAt(int index) =&gt; _pieces[index];\r\n}\r\n</code>\r\n</pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">结合局面信息，我们就可以回到我们的 PiecesPainter 中，进行棋子的绘制动作了。</p>\r\n<h2 id=\"-3\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">绘制棋子</h2>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在基类 PainterBase 中，我们已经计算好了网格的尺寸，这些尺寸是根据 BoardWidget 提供的宽度自动计算出来的。为了让棋子也随着棋盘的大小同步变动，我们约定：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"text language-text\" id=\"code-6\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">棋子的宽度 = 棋盘一个格子的宽度 * 90%\r\n</code>\r\n</pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 PiecesPainter 类中，我们添加表示棋子宽度的字段 pieceSide，此外再添加表示局面的 Phase 实例：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-7\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'package:flutter/material.dart\';\r\nimport \'painter-base.dart\';\r\nimport \'../cchess/phase.dart\';\r\n\r\nclass PiecesPainter extends PainterBase {\r\n  final Phase phase; //表示棋局面\r\n  double pieceSide; //棋子的大小\r\n  PiecesPainter({@required double width, @required this.phase})\r\n      : super(width: width) {\r\n    pieceSide = squareSide * 0.9; //计算棋子的大小\r\n  }\r\n\r\n  @override\r\n  void paint(Canvas canvas, Size size) {\r\n    //\r\n  }\r\n\r\n  @override\r\n  bool shouldRepaint(CustomPainter oldDelegate) {\r\n    //\r\n    return true;\r\n    // throw UnimplementedError();\r\n  }\r\n}\r\n</code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">现在绘制棋子需要的一切数据就绪，我们开始绘制工作吧。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们在 PiecesPainter 类中添加静态方法 doPaint：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-8\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"> static doPaint(\r\n    Canvas canvas,\r\n    Paint paint, {\r\n    Phase phase,\r\n    double gridWidth,\r\n    double squareSide,\r\n    double pieceSide,\r\n    double offsetX,\r\n    double offsetY,\r\n  }) {}\r\n</code></pre>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">在这里使用静态方法的原因，前文已有表述，主要考虑到将来需要在内存画布绘制棋盘时重用此方法。\r\n    </p>\r\n</blockquote>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">接着，我们在 PiecesPainter 类的 paint 方法中调用 doPaint 方法：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-9\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"> @override\r\n void paint(Canvas canvas, Size size) {\r\n   //\r\n   doPaint(\r\n     canvas,\r\n     thePaint,\r\n     phase: phase,\r\n     gridWidth: gridWidth,\r\n     squareSide: squareSide,\r\n     pieceSide: pieceSide,\r\n     offsetX: BoardWidget.Padding + squareSide / 2,\r\n     offsetY: BoardWidget.Padding + BoardWidget.DigitsHeight + squareSide / 2,\r\n  );\r\n}\r\n</code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">绘制一个棋子的工作大致有以下几个步骤：</p>\r\n<ol style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <li style=\"outline: 0px !important;\">绘制棋子棋子大小相同的圆形阴影，阴隐要放在其它绘图之下；</li>\r\n    <li style=\"outline: 0px !important;\">区分棋子的颜色，填充指定大小的圆</li>\r\n    <li style=\"outline: 0px !important;\">区分棋子的颜色在代表棋子的圆外添加一个圆圈边框</li>\r\n    <li style=\"outline: 0px !important;\">在棋盘的圆圈中间，区分颜色写上代表棋子的文字</li>\r\n</ol>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">有了代表棋子分布的数组，我们的绘制工作就是对棋盘上存在于指定位置的棋子，分别执行一轮上述的棋子绘制动作。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">为了让绘制动作逻辑更清晰，我们将绘制动作分解成两步：</p>\r\n<ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <li style=\"outline: 0px !important;\">第一步我们确定各个棋子以及其所应出现的位置，并把它们添加到一个列表中</li>\r\n    <li style=\"outline: 0px !important;\">第二步我们对已标定位置的每一个棋子棋子执行绘图动作</li>\r\n</ul>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">开始前还有一点准备工作：我们在 PiecesPainter 之上添加一个绘制专用的 Stub 类：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-10\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">/* 绘制 */\r\nclass PiecePaintStub {\r\n  final String piece;\r\n  final Offset pos; //棋子位置\r\n  PiecePaintStub({this.piece, this.pos});\r\n}\r\n</code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">然后我们执行绘制动作的第一步 — 计算好各棋子位置：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-11\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><piecepaintstub>static doPaint(\r\n    Canvas canvas,\r\n    Paint paint, {\r\n    Phase phase, //局面\r\n    double gridWidth, //横盘上线格的总宽度\r\n    double squareSide, //每个格子的边长\r\n    double pieceSide,\r\n    double offsetX,\r\n    double offsetY,\r\n  }) {\r\n    final left = offsetX, top = offsetY;\r\n\r\n    /* \r\n    在 Flutter 中绘制阴影，需要先将阴影对象添加到一个 Path 中\r\n    我们绘制棋子时，可以将每个棋子的阴影路径一次性添加到 Path 中，然后一次绘制所有棋子的阴隐\r\n    */\r\n    final shadowPath = Path();\r\n    final piecesToDraw = <piecepaintstub>[];\r\n\r\n    for (var row = 0; row &lt; 10; i++) {\r\n      for (var column = 0; column &lt; 9; i++) {\r\n        final piece = phase.pieceAt(row * 9 + column);\r\n        if (piece == Piece.Empty) continue; //坐标上为空，没有棋子\r\n\r\n        var pos = Offset(left + squareSide * column,\r\n            top + squareSide * row); //根据行列位置，计算棋子的位置\r\n\r\n        piecesToDraw.add(PiecePaintStub(piece: piece, pos: pos));\r\n\r\n        /* 为每一个棋盘上存在的棋子绘制一个圆形阴影 */\r\n        shadowPath.addOval(\r\n          Rect.fromCenter(center: pos, width: pieceSide, height: pieceSide),\r\n        );\r\n      }\r\n    }\r\n\r\n    canvas.drawShadow(shadowPath, Colors.black, 2, true); //绘制黑色的厚度为 2dp 的棋子阴影</piecepaintstub><piecepaintstub><br></piecepaintstub><piecepaintstub>    ...\r\n  }\r\n</piecepaintstub></piecepaintstub></code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这一步部，我们将每个棋子的位置计算好，并添加到一个叫 piecesToDraw 的列表中了。顺便地，还把所有棋子的位置的阴影路径添加了一个 Path 之中，并进行了一次性的棋子阴影绘制。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">现在我们执行绘制动作的第二步 — 棋子绘制：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-12\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">static doPaint(\r\n    Canvas canvas,\r\n    Paint paint, {\r\n    Phase phase, //局面\r\n    double gridWidth, //横盘上线格的总宽度\r\n    double squareSide, //每个格子的边长\r\n    double pieceSide,\r\n    double offsetX,\r\n    double offsetY,\r\n  }) {\r\n    //\r\n    ...\r\n\r\n    paint.style = PaintingStyle.fill;\r\n\r\n    final textStyle = TextStyle(\r\n      color: ColorConsts.PieceTextColor,\r\n      fontSize: pieceSide * 0.8, //棋的字为棋子的大小80%\r\n      height: 1.0,\r\n    );\r\n\r\n    /* 逐个绘制棋子 */\r\n    piecesToDraw.forEach((pps) {\r\n      paint.color = Piece.isRed(pps.piece)\r\n          ? ColorConsts.RedPieceBorderColor\r\n          : ColorConsts.BlackPieceBorderColor; //判断是画红色的棋子还是黑色\r\n\r\n      canvas.drawCircle(pps.pos, pieceSide / 2, paint); //绘制棋子的圆边界\r\n\r\n      paint.color = Piece.isRed(pps.piece)\r\n          ? ColorConsts.RedPieceColor\r\n          : ColorConsts.BlackPieceColor;\r\n\r\n      canvas.drawCircle(pps.pos, pieceSide * 0.8 / 2, paint); //绘制棋子的内部圆\r\n\r\n      final textSpan = TextSpan(text: Piece.Names[pps.piece], style: textStyle);\r\n      final textPainter = TextPainter(\r\n        text: textSpan,\r\n        textDirection: TextDirection.ltr,\r\n      )..layout();\r\n\r\n      final metric =\r\n          textPainter.computeLineMetrics()[0]; //计算字体的 Metrics，包含相应字体的 Baseline\r\n\r\n      final textSize = textPainter.size; //测量文字的尺寸\r\n\r\n      //从顶上算，文字的 Baseline 在 2/3 高度线上\r\n      final textOffset = pps.pos -\r\n          Offset(textSize.width / 2, metric.baseline - textSize.height / 3);\r\n\r\n      textPainter.paint(canvas, textOffset);\r\n    });\r\n  }\r\n</code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">对于第一步已标定好位置并添加到 piecesToDraw 列表的每个棋子，这里进行了循环绘制工作，步骤和前文所述一致。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">棋子绘绘制部分的工作就绪了。我们需要对 BoardWidget 进行必要的调整，以呈现一个初始棋盘的样子。</p>\r\n<h2 id=\"-4\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">棋盘初始局面</h2>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这里有一个问题需要思考：棋盘局面的初始状态从何而来？</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这是我们将来要面对的问题！目前我们简单地使用用一个预置的棋盘数组，来暂回避一下这个问题！</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 Phase 类中，我们添加一个命名为 defaultPhase 命名构造方法，在这个构造方法，我们手工布局一个初始的象棋开局棋子局面：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-13\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">...\r\n\r\nclass Phase {\r\n  //\r\n  ...\r\n\r\n  Phase.defaultPhase() {\r\n    //\r\n    _side = Side.Red;\r\n    _pieces = List<string>(90);\r\n\r\n    // 从上到下，棋盘第一行\r\n    _pieces[0 * 9 + 0] = Piece.BlackRook;\r\n    _pieces[0 * 9 + 1] = Piece.BlackKnight;\r\n    _pieces[0 * 9 + 2] = Piece.BlackBishop;\r\n    _pieces[0 * 9 + 3] = Piece.BlackAdvisor;\r\n    _pieces[0 * 9 + 4] = Piece.BlackKing;\r\n    _pieces[0 * 9 + 5] = Piece.BlackAdvisor;\r\n    _pieces[0 * 9 + 6] = Piece.BlackBishop;\r\n    _pieces[0 * 9 + 7] = Piece.BlackKnight;\r\n    _pieces[0 * 9 + 8] = Piece.BlackRook;\r\n\r\n    // 从上到下，棋盘第三行\r\n    _pieces[2 * 9 + 1] = Piece.BlackCanon;\r\n    _pieces[2 * 9 + 7] = Piece.BlackCanon;\r\n\r\n    // 从上到下，棋盘第四行\r\n    _pieces[3 * 9 + 0] = Piece.BlackPawn;\r\n    _pieces[3 * 9 + 2] = Piece.BlackPawn;\r\n    _pieces[3 * 9 + 4] = Piece.BlackPawn;\r\n    _pieces[3 * 9 + 6] = Piece.BlackPawn;\r\n    _pieces[3 * 9 + 8] = Piece.BlackPawn;\r\n\r\n    // 从上到下，棋盘第十行\r\n    _pieces[9 * 9 + 0] = Piece.RedRook;\r\n    _pieces[9 * 9 + 1] = Piece.RedKnight;\r\n    _pieces[9 * 9 + 2] = Piece.RedBishop;\r\n    _pieces[9 * 9 + 3] = Piece.RedAdvisor;\r\n    _pieces[9 * 9 + 4] = Piece.RedKing;\r\n    _pieces[9 * 9 + 5] = Piece.RedAdvisor;\r\n    _pieces[9 * 9 + 6] = Piece.RedBishop;\r\n    _pieces[9 * 9 + 7] = Piece.RedKnight;\r\n    _pieces[9 * 9 + 8] = Piece.RedRook;\r\n\r\n    // 从上到下，棋盘第八行\r\n    _pieces[7 * 9 + 1] = Piece.RedCanon;\r\n    _pieces[7 * 9 + 7] = Piece.RedCanon;\r\n\r\n    // 从上到下，棋盘第七行\r\n    _pieces[6 * 9 + 0] = Piece.RedPawn;\r\n    _pieces[6 * 9 + 2] = Piece.RedPawn;\r\n    _pieces[6 * 9 + 4] = Piece.RedPawn;\r\n    _pieces[6 * 9 + 6] = Piece.RedPawn;\r\n    _pieces[6 * 9 + 8] = Piece.RedPawn;\r\n\r\n    // 其它位置全部填空\r\n    for (var i = 0; i &lt; 90; i++) {\r\n      _pieces[i] ??= Piece.Empty;\r\n    }\r\n  }\r\n\r\n  ...\r\n}\r\n</string></code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 BoardWidget 中，我们将 CustomPaint 的 foregroundPainter 指为我们的 PiecesPainter 类的实例；在 PiecesPainter\r\n    类的创建过程，我直接创建一个 Phase 类的实例，如下边的代码所示：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-14\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">import \'package:flutter/material.dart\';\r\nimport \'../common/color-consts.dart\';\r\nimport \'board-painter.dart\';\r\nimport \'words-on-board.dart\';\r\nimport \'pieces-painter.dart\';\r\nimport \'../cchess/phase.dart\';\r\n\r\nclass BoardWidget extends StatelessWidget {\r\n  static const Padding = 5.0, DigitsHeight = 36.0; //棋盘内边界 + 棋盘上的路数指定文字高度\r\n  final double width, height; //棋盘宽与高\r\n\r\n  /* 由于横盘上的小格子都是正方形，因素宽度确定后，棋盘的高度也就确定了 */\r\n  BoardWidget({@required this.width})\r\n      : height = (width - Padding * 2) / 9 * 10 + (Padding + DigitsHeight) * 2;\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    return Container(\r\n      width: width,\r\n      height: height,\r\n      decoration: BoxDecoration(\r\n        borderRadius: BorderRadius.circular(5),\r\n        color: ColorConsts.BoardBackground,\r\n      ),\r\n      child: CustomPaint(\r\n        painter: BoardPainter(width: width), //背景一层绘制横盘上的线格\r\n        /* 前景一层绘制棋子 */\r\n        foregroundPainter: PiecesPainter(\r\n          width: width,\r\n          phase: Phase.defaultPhase(),\r\n        ),\r\n        /* CustomPaint 的 child 用于布置其上的子组件，这里放置是我们的「河界」、「路数」等文字信息 */\r\n        child: Container(\r\n          margin: EdgeInsets.symmetric(\r\n            vertical: Padding,\r\n            horizontal: (width - Padding * 2) / 9 / 2 +\r\n                Padding -\r\n                WordsOnBoard.DigitsFontSize / 2,\r\n          ),\r\n          child: WordsOnBoard(),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n}\r\n\r\n</code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">到这里，我们检查一下开发成果，在 vscode 中按<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">F5</code>键运行产品看看效果：</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><img src=\"https://elapse.date/static/uploads/1598277711_38d53f363676b684ddd4.jpg\" data-filename=\"img\" style=\"width: 720px;\"></p>\r\n<h2 id=\"-5\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">使用中国风字体</h2>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">到目前为止，其它都还好，只是有一样：</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">现在我们在图片看到的文字都是系统默认的字体，有点呆板！我们需要找到一个适合象棋棋子显示的美观字体，然后用它来绘制棋子和棋盘上的「路数」、「河界」等提示性文字。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这件事件做起来不难：但首先我们需要找到自己喜欢的字体，并将其添加到我们的项目中。</p>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <p style=\"margin-bottom: 1.1em; font-size: 1em; line-height: 1.45; outline: 0px !important;\">\r\n        出于演示目的，我直接在网络上下载了「方正启体」，你们可以从<a href=\"https://www.apppk.cn/books/flutter_cchess/qiti.ttf\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">这里</a>下载它。\r\n    </p>\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">请大家支持正版，保持知识产权！</p>\r\n</blockquote>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们在项目根目录下，新建一个 fonts 文件夹，并将你的字体文件复制到此文件夹下。然后在项目根目录下的 pubspec.yaml 文件中添加你的自定义字体：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"yaml language-yaml\" id=\"code-16\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">name: chessroad\r\ndescription: A new Flutter project.\r\n\r\nversion: 1.0.0+1\r\n\r\nenvironment:\r\nsdk: \"&gt;=2.1.0 &lt;3.0.0\"\r\n\r\ndependencies:\r\n  flutter:\r\n    sdk: flutter\r\n\r\n  cupertino_icons: ^0.1.2\r\n\r\ndev_dependencies:\r\n  flutter_test:\r\n    sdk: flutter\r\n\r\nflutter:\r\n\r\n  uses-material-design: true\r\n\r\n   # assets:\r\n   # - images/a_dot_burr.jpeg\r\n   # - images/a_dot_ham.jpeg\r\n\r\n  fonts:\r\n    - family: QiTi\r\n      fonts:\r\n        - asset: fonts/qiti.ttf\r\n</code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">添加 yaml 配置后，即可使用自定义的字体。</p>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">记住：只有被注册到 pubspec.yaml\r\n        中的资源，进行应用打包时才会自动地包含在应用包内。</p>\r\n</blockquote>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们在 PiecesPainter 类的 doPaint 方法中找到棋子上的文字的样式定义，修改前是这样的：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-17\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">...\r\nfinal textStyle = TextStyle(\r\n  color: ColorConsts.PieceTextColor,\r\n  fontSize: pieceSide * 0.8,\r\n  height: 1.0,\r\n);\r\n...\r\n</code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">添加 fontFamily 之后，修改为：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-18\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">...\r\nfinal textStyle = TextStyle(\r\n  color: ColorConsts.PieceTextColor,\r\n  fontSize: pieceSide * 0.8,\r\n  fontFamily: \'QiTi\',\r\n  height: 1.0,\r\n);\r\n...\r\n</code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">棋子的字体修改完之后，别忘了棋盘上的「路数」数字和「河界」提示文字的字体。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在 WordsOnBoard 类的实现代码中，我们找到以下这一段：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-19\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">   return DefaultTextStyle(\r\n     child: Column(\r\n       children: <widget>[\r\n         Row(children: bChildren),\r\n         Expanded(child: SizedBox()),\r\n         riverTips,\r\n         Expanded(child: SizedBox()),\r\n         Row(children: rChildren),\r\n      ],\r\n    ),\r\n     style: TextStyle(color: ColorConsts.BoardTips),\r\n  );\r\n</widget></code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">在默认文字模式中，添加对 fontMamily 的指定，修改后的样子：</p>\r\n<pre style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" padding:=\"\" 10px=\"\" 20px;=\"\" margin-bottom:=\"\" 1.1em;=\"\" line-height:=\"\" 1.45;=\"\" word-break:=\"\" break-word;=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.05);=\"\" border-width:=\"\" 0px;=\"\" border-style:=\"\" initial;=\"\" border-color:=\"\" border-radius:=\"\" 5px;=\"\" position:=\"\" relative;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><code class=\"dart language-dart\" id=\"code-20\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">   return DefaultTextStyle(\r\n     child: Column(\r\n       children: <widget>[\r\n         Row(children: bChildren),\r\n         Expanded(child: SizedBox()),\r\n         riverTips,\r\n         Expanded(child: SizedBox()),\r\n         Row(children: rChildren),\r\n      ],\r\n    ),\r\n     style: TextStyle(color: ColorConsts.BoardTips, fontFamily: \'QiTi\'),\r\n  );\r\n</widget></code></pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">添加字体后，需要重新运行一下产品。现在看看是不是美观多了？</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><img src=\"https://elapse.date/static/uploads/1598279129_b1e38cdca841d76f9421.jpg\" data-filename=\"img\" style=\"width: 720px;\"><br></p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">将代码提交到 git，然后休息一下！</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'绘制棋子\'\r\n[master 8c71acb] 绘制棋子\r\n 89 files changed, 2873 insertions(+)\r\n create mode 100644 .gitignore\r\n create mode 100644 .metadata\r\n create mode 100644 FETCH_HEAD\r\n create mode 100644 HEAD\r\n create mode 100644 android/.gitignore\r\n create mode 100644 android/app/build.gradle\r\n create mode 100644 android/app/src/debug/AndroidManifest.xml\r\n create mode 100644 android/app/src/main/AndroidManifest.xml\r\n create mode 100644 android/app/src/main/kotlin/com/example/chinese_chess/MainActivity.kt\r\n create mode 100644 android/app/src/main/res/drawable/launch_background.xml\r\n create mode 100644 android/app/src/main/res/mipmap-hdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/mipmap-mdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/mipmap-xhdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/mipmap-xxhdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/mipmap-xxxhdpi/ic_launcher.png\r\n create mode 100644 android/app/src/main/res/values/styles.xml\r\n create mode 100644 android/app/src/profile/AndroidManifest.xml\r\n create mode 100644 android/build.gradle\r\n create mode 100644 android/gradle.properties\r\n create mode 100644 android/gradle/wrapper/gradle-wrapper.properties\r\n create mode 100644 android/settings.gradle\r\n create mode 100644 config\r\n create mode 100644 description\r\n create mode 100644 fonts/chess.ttf\r\n create mode 100755 hooks/applypatch-msg.sample\r\n create mode 100755 hooks/commit-msg.sample\r\n create mode 100755 hooks/fsmonitor-watchman.sample\r\n create mode 100755 hooks/post-update.sample\r\n create mode 100755 hooks/pre-applypatch.sample\r\n create mode 100755 hooks/pre-commit.sample\r\n create mode 100755 hooks/pre-merge-commit.sample\r\n create mode 100755 hooks/pre-push.sample\r\n create mode 100755 hooks/pre-rebase.sample\r\n create mode 100755 hooks/pre-receive.sample\r\n create mode 100755 hooks/prepare-commit-msg.sample\r\n create mode 100755 hooks/update.sample\r\n create mode 100644 info/exclude\r\n create mode 100644 ios/.gitignore\r\n create mode 100644 ios/Flutter/AppFrameworkInfo.plist\r\n create mode 100644 ios/Flutter/Debug.xcconfig\r\n create mode 100644 ios/Flutter/Release.xcconfig\r\n create mode 100644 ios/Runner.xcodeproj/project.pbxproj\r\n create mode 100644 ios/Runner.xcodeproj/project.xcworkspace/contents.xcworkspacedata\r\n create mode 100644 ios/Runner.xcodeproj/project.xcworkspace/xcshareddata/IDEWorkspaceChecks.plist\r\n create mode 100644 ios/Runner.xcodeproj/project.xcworkspace/xcshareddata/WorkspaceSettings.xcsettings\r\n create mode 100644 ios/Runner.xcodeproj/xcshareddata/xcschemes/Runner.xcscheme\r\n create mode 100644 ios/Runner.xcworkspace/contents.xcworkspacedata\r\n create mode 100644 ios/Runner.xcworkspace/xcshareddata/IDEWorkspaceChecks.plist\r\n create mode 100644 ios/Runner.xcworkspace/xcshareddata/WorkspaceSettings.xcsettings\r\n create mode 100644 ios/Runner/AppDelegate.swift\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Contents.json\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-1024x1024@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-20x20@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-20x20@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-20x20@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-29x29@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-29x29@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-29x29@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-40x40@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-40x40@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-40x40@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-60x60@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-60x60@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-76x76@1x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-76x76@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/AppIcon.appiconset/Icon-App-83.5x83.5@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/Contents.json\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/LaunchImage.png\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/LaunchImage@2x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/LaunchImage@3x.png\r\n create mode 100644 ios/Runner/Assets.xcassets/LaunchImage.imageset/README.md\r\n create mode 100644 ios/Runner/Base.lproj/LaunchScreen.storyboard\r\n create mode 100644 ios/Runner/Base.lproj/Main.storyboard\r\n create mode 100644 ios/Runner/Info.plist\r\n create mode 100644 ios/Runner/Runner-Bridging-Header.h\r\n create mode 100644 lib/board/board-painter.dart\r\n create mode 100644 lib/board/board-widget.dart\r\n create mode 100644 lib/board/painter-base.dart\r\n create mode 100644 lib/board/pieces-painter.dart\r\n create mode 100644 lib/board/words-on-board.dart\r\n create mode 100644 lib/cchess/cc-base.dart\r\n create mode 100644 lib/cchess/phase.dart\r\n create mode 100644 lib/common/color-consts.dart\r\n create mode 100644 lib/main.dart\r\n create mode 100644 lib/routes/battle-page.dart\r\n create mode 100644 objects/pack/tmp_pack_HxlCBe\r\n create mode 100644 pubspec.lock\r\n create mode 100644 pubspec.yaml\r\n create mode 100644 test/widget_test.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 125, 完成.\r\n对象计数中: 100% (125/125), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (98/98), 完成.\r\n写入对象中: 100% (124/124), 5.17 MiB | 41.00 KiB/s, 完成.\r\n总共 124 （差异 4），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 2408:8256:686:75d1:4ca8:d3c7:9e54:8d1 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-08-25 01:41:53 (UTC), debug id bd5235.\r\nremote: Resolving deltas: 100% (4/4), done.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   2cb5c8c..8c71acb  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$\r\n</code>\r\n</pre>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\"><br></p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">我们将才干了一个大活，需要给自己一点犒赏！</p>\r\n<h2 id=\"-6\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">本节回顾</h2>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">本节课程中，我们解决了两个主要的问题，一个是如何管理棋盘的局面 — 棋子的位置管理。另一个是如何在指定的位置绘制棋子。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">除此之外，我们还导入了第三方字体，以美化棋子上的文字效果。</p>\r\n<p style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">这一具有几个需要提示大家特别注意：</p>\r\n<ul style=\"margin-bottom: 1.1em;  font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" font-size:=\"\" 17px;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <li style=\"outline: 0px !important;\">使用 Canvas 可以绘制自定义的阴影，在调用 Canvas 绘制前，你需要将它们添加到一个表示阴影的 Path 对象中，因此多个棋子的阴影可以一次性绘制。\r\n    </li>\r\n    <li style=\"outline: 0px !important;\">如果你希望给一颗棋子绘制阴影，那么应该先绘制阴影效果，之后在阴影之上绘制棋子，这个层次关系不能错。</li>\r\n    <li style=\"outline: 0px !important;\">Canvas 并不能直接绘制文本，它需要借助 TextPainter 类来配置文字风格、并布局文字。</li>\r\n    <li style=\"outline: 0px !important;\">如果要将文字绘制到指定的区域，需要理解文字 BaseLine 的知识。</li>\r\n</ul>\r\n<p></p>'),(25,'                                                                                                                                                                                                                                                                <div>上一节，我们的棋盘棋子都非常漂亮地呈现在屏幕上了，但还不支持走棋动作。这一节，我们要记让棋子可以支持行棋动作，这将依赖于手势检测 Feature。</div>\r\n<div><br></div>\r\n<div>检测到用户点击后，我们将结合棋类游戏的棋子移动方案，处理移动棋子和吃子逻辑。</div>\r\n<div><br></div>\r\n<div>本节提要</div>\r\n<div>检测棋盘点击事件</div>\r\n<div>将点击坐标换算成棋盘上的棋子位置</div>\r\n<div>谁是棋盘点击事件的接管者</div>\r\n<div>处理行棋和吃子逻辑</div>\r\n<div>检测棋盘点击</div>\r\n<div>在 Flutter 中，要检测用户的点击、长按、拖拽等操作是很简单的事情，只需要用 GestureDetector 包裹你想要查检测手势的 Widget 即可。</div>\r\n<div><br></div>\r\n<div>我们修改一下 BoardWidget 的 build 方法，用 GestureDetector 包裹我们的棋盘，将它修改成下边这样：\r\n<pre><code>\r\n@override\r\n  Widget build(BuildContext context) {\r\n    final boardContainer = Container(\r\n      width: width,\r\n      height: height,\r\n      decoration: BoxDecoration(\r\n        borderRadius: BorderRadius.circular(5),\r\n        color: ColorConsts.BoardBackground,\r\n      ),\r\n      child: CustomPaint(\r\n        painter: BoardPainter(width: width), //背景一层绘制横盘上的线格\r\n        /* 前景一层绘制棋子 */\r\n        foregroundPainter: PiecesPainter(\r\n          width: width,\r\n          phase: Phase.defaultPhase(),\r\n        ),\r\n        /* CustomPaint 的 child 用于布置其上的子组件，这里放置是我们的「河界」、「路数」等文字信息 */\r\n        child: Container(\r\n          margin: EdgeInsets.symmetric(\r\n            vertical: Padding,\r\n            horizontal: (width - Padding * 2) / 9 / 2 +\r\n                Padding -\r\n                WordsOnBoard.DigitsFontSize / 2,\r\n          ),\r\n          child: WordsOnBoard(),\r\n        ),\r\n      ),\r\n    );\r\n\r\n    /* 用 GestureDetector 组件包裹我们的 board 组件，用于检测 board 上的点击事件 */\r\n    return GestureDetector(\r\n      child: boardContainer,\r\n      onTapUp: (details) {\r\n        print(\"点击了，坐标：\");\r\n        print(details.localPosition);\r\n      },\r\n    );\r\n  }\r\n</code>\r\n</pre>\r\n</div>\r\n\r\n<div>上边的代码中，我们仅仅是把原来的构造 widget 的代码赋值给了 boardContainer 变量，然后用 GestureDetector 包裹了代表 Widget 的变量 boardContainer。</div>\r\n<div><br></div>\r\n<div>Board 的点击事件，我们关心的不是哪个坐标点被用户点击了，关心的应该是棋盘上的哪位交叉点被用户点击了。这些知识是 BoardWiget 内部的，因为棋盘知道自己的格子多大、边界在哪。因此我们在 GestureDetector的 onTapUp 回调中，将坐标点解释成相应的棋盘上的交叉位置的索引。</div>\r\n<div><br></div>\r\n<div>我们将 GestureDetector 的 onTapUp 回调方法的内容由下边的样子：\r\n<pre><code>\r\n  ...\r\n  return GestureDetector(\r\n      child: boardContainer,\r\n      onTapUp: (details) {\r\n        print(\"点击了，坐标：\");\r\n        print(details.localPosition);\r\n      },\r\n    );\r\n...\r\n</code>\r\n</pre>\r\n</div>\r\n<div>\r\n修改为：\r\n<pre><code>\r\n  return GestureDetector(\r\n      child: boardContainer,\r\n      onTapUp: (details) {\r\n        final gridWidth = (width - Padding * 2) / 9 * 8; //棋盘线(网格)总宽\r\n        final squareSide = (width - Padding * 2) / 9; //棋盘每个格子的边长\r\n\r\n        /* 点击的坐标 */\r\n        final dx = details.localPosition.dx, dy = details.localPosition.dy;\r\n\r\n        /* 把点击的坐标转换成棋盘上的行、列 */\r\n        final row = (dy - Padding - DigitsHeight) ~/ squareSide;\r\n        final column = (dx - Padding) ~/ squareSide;\r\n\r\n        if (row &lt; 0 || row &gt; 9) {\r\n          print(\'点击了棋盘外上边或下边，并没有点击棋盘交叉点\');\r\n          return;\r\n        }\r\n\r\n        if (column &lt; 0 || column &gt; 8) {\r\n          print(\'点击了棋盘线外的左边或者右边，并没有点到棋盘下棋艺的交叉点\');\r\n          return;\r\n        }\r\n        print(\'点了棋盘行row：$row,棋盘的列：$column\');\r\n      },\r\n    );\r\n</code>\r\n</pre>\r\n</div>\r\n<div>接管棋盘上的点击事件<br></div>\r\n<div>现在需要考虑的一个问题：Board 上的点击事件应该由谁来接管呢？</div>\r\n<div><br></div>\r\n<div>Board 上的用户行棋点击事件，应该是 Board 创建者关心的事情。因此，点击事件的回调应该由外部传入。我们为 BoardWidget 添加一个回调，并修改 BoardWiget 的构造函数。</div>\r\n<div><br></div>\r\n<div>具体操作为 — 在 BoardWidget 头部找到以下部分代码：\r\n<pre><code>\r\nclass BoardWidget extends StatelessWidget {\r\n\r\n  ...\r\n\r\n  final double width, height; //棋盘宽与高\r\n\r\n  /* 由于横盘上的小格子都是正方形，因素宽度确定后，棋盘的高度也就确定了 */\r\n  BoardWidget({@required this.width})\r\n      : height = (width - Padding * 2) / 9 * 10 + (Padding + DigitsHeight) * 2;\r\n\r\n  ...\r\n}\r\n</code>\r\n</pre>\r\n</div>\r\n<div>\r\n添加回调成员，更新构造方法，将它修改为：<br>\r\n<pre><code>\r\nclass BoardWidget extends StatelessWidget {\r\n  //\r\n  ...\r\n\r\n  final double width, height; //棋盘宽与高\r\n\r\n  final Function(BuildContext, int) onBoardTap;\r\n\r\n  /* 由于横盘上的小格子都是正方形，因素宽度确定后，棋盘的高度也就确定了 */\r\n  BoardWidget({@required this.width, @required this.onBoardTap})\r\n      : height = (width - Padding * 2) / 9 * 10 + (Padding + DigitsHeight) * 2;\r\n\r\n  ...\r\n}\r\n</code>\r\n</pre>\r\n</div>\r\n<div>\r\n接着，我们在 GestureDetector 的 onTapUp 回调中，将用户点击棋盘交叉点位的事件，回调 onBoardTap 方法。修改后 BoardWidget 的 build 方法代码如下：<br>\r\n<pre><code>\r\n@override\r\n  Widget build(BuildContext context) {\r\n\r\n    ...\r\n\r\n    /* 用 GestureDetector 组件包裹我们的 board 组件，用于检测 board 上的点击事件 */\r\n    return GestureDetector(\r\n      child: boardContainer,\r\n      onTapUp: (details) {\r\n        final gridWidth = (width - Padding * 2) / 9 * 8; //棋盘线(网格)总宽\r\n        final squareSide = (width - Padding * 2) / 9; //棋盘每个格子的边长\r\n\r\n        /* 点击的坐标 */\r\n        final dx = details.localPosition.dx, dy = details.localPosition.dy;\r\n\r\n        /* 把点击的坐标转换成棋盘上的行、列 */\r\n        final row = (dy - Padding - DigitsHeight) ~/ squareSide;\r\n        final column = (dx - Padding) ~/ squareSide;\r\n\r\n        if (row &lt; 0 || row &gt; 9) {\r\n          print(\'点击了棋盘外上边或下边，并没有点击棋盘交叉点\');\r\n          return;\r\n        }\r\n\r\n        if (column &lt; 0 || column &gt; 8) {\r\n          print(\'点击了棋盘线外的左边或者右边，并没有点到棋盘下棋艺的交叉点\');\r\n          return;\r\n        }\r\n\r\n        print(\'点了棋盘行row：\' +\r\n            (row + 1).toString() +\r\n            \',棋盘的列：\' +\r\n            (column + 1).toString());\r\n\r\n        onBoardTap(context, row * 9 + column); //点击棋盘的回调\r\n      },\r\n    );\r\n  }\r\n</code>\r\n</pre>\r\n</div>\r\n<div>代码中的「row * 9 + column」是棋盘位置表示的一个基本约定。它表示的意思是：<br></div>\r\n<div><br></div>\r\n<div>从上到下、从左到右，第 row 行 column 列的棋子，在棋盘局面 Phase 类的棋子列表 List<string>(90) 中的存放索引值是 row * 9 + column。</string></div>\r\n<div><br></div>\r\n<div>关于棋盘上的行列和 Phase 中的棋子列表索引的转换关系是比较重要的，这种转换在后边的代码中还会多次出现，请大家注意！</div>\r\n<div><br></div>\r\n<div>处理行棋逻辑</div>\r\n<div>为了反映棋盘变动状态，首先我们将 BattlePage 由 StatelessWidget 的修改为 StatefulWidget。</div>\r\n<div><br></div>\r\n<div>要在 vscode 中，如果需要将一个 StatelessWidget 修改为 StatefulWidget，可以先将光标移动到 BattlePage 类声明语句上，然后按「Cmd+.」，在弹出的菜单中点 「Convert to\r\n    StatefulWidget」 菜单项。</div>\r\n<div><br></div>\r\n<div>之前，我们为 BoardWidget 的默认构造方法添加了onBoardTap 的回调参数。现在 BattlePage 的 State 类 _BattlePageState 中，我们添加一个 onBoardTap 方法，并在\r\n    BoardWidget 的构造方法中，将它传递给 BoardWidget。这样 BoardWidget 的点击事件就会被传递给 BattlePage 的 onBoardTap 方法了，这是合理的！</div>\r\n<div><br></div>\r\n<div>\r\n完成这一步后，完整的 battle-page.dart 文件的代码是这样的：\r\n<pre><code>\r\nimport \'package:flutter/material.dart\';\r\nimport \'../board/board-widget.dart\';\r\n\r\nclass BattlePage extends StatefulWidget {\r\n  static const BoardMarginV = 10.0, BoardMarginH = 10.0;\r\n  @override\r\n  _BattlePageState createState() =&gt; _BattlePageState();\r\n}\r\n\r\nclass _BattlePageState extends State<battlepage> {\r\n  /* 由 BattlePage 的 State 类来处理棋盘的点击事件 */\r\n  onBoardTap(BuildContext context, int pos) {\r\n    //\r\n    print(\'棋盘的index: $pos\');\r\n  }\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    final windowSize = MediaQuery.of(context).size;\r\n    final boardHeight = windowSize.width - BattlePage.BoardMarginH * 2;\r\n\r\n    return Scaffold(\r\n      appBar: AppBar(\r\n        title: Text(\'棋盘\'),\r\n      ),\r\n      body: Container(\r\n        margin: const EdgeInsets.symmetric(\r\n          horizontal: BattlePage.BoardMarginH,\r\n          vertical: BattlePage.BoardMarginV,\r\n        ),\r\n        child: BoardWidget(width: boardHeight, onBoardTap: onBoardTap),\r\n      ),\r\n    );\r\n  }\r\n}\r\n</battlepage></code>\r\n</pre>\r\n</div>\r\n<div>回顾一下前边的棋盘绘制逻辑，我们会发现，棋盘上的棋子分布情况是由 Phase 类持有的。<br></div>\r\n<div><br></div>\r\n<div>用户点击棋盘行棋，如果想要将行棋动作反映到棋子分布位置的调整上，肯定是要修改 Phase 类的棋子存放列表 List<string> _pieces; 对象。</string></div>\r\n<div><br></div>\r\n<div>之前，我们在 PiecesPainter 类中直接用 Phase.defaultPhase() 构造了一个象棋的初始局面。但回到一个游戏整体的宏观面上，我们应考虑的问题是：Phase 对象应该被谁来持有呢？</div>\r\n<div><br></div>\r\n<div>到目标为止，BoardWidget 的持有者 BattlePage 应该敢是 Phase 的持有者，目前这是一个「直觉」的选择。</div>\r\n<div><br></div>\r\n<div>如果我们我们由 BattlePage 持有 Phase 对象，那使用过程是什么样子的呢？</div>\r\n<div><br></div>\r\n<div>第一步，我们在 BattlePage 里创建 Phase 实例</div>\r\n<div>第二步，我们将 Phase 实例传递给 BoardWidget</div>\r\n<div>第三步，BoardWidget 将 Phase 实例传递给 PiecesPainter</div>\r\n<div>这样做能通，但感觉 Phase 传递的路径有点长，并且这个传递链接上的 BoardWidget 其实是没有必要知道 Phase 是什么东西的。</div>\r\n<div><br></div>\r\n<div>应对这个问题，我们可以新建一个 Battle 类，并将其做成一个全局可以访问的单例对象，BoardWidget 可以在创建 PiecesPainter 时直接通过单例方式访问棋盘数据！</div>\r\n<div><br></div>\r\n<div>\r\n   我们新建 lib/game 文件夹，在其中创建一个 battle.dart 文件，实现一个单例模式的 Battle 类型，文件内容如下：\r\n<pre><code>\r\nimport \'../cchess/phase.dart\';\r\n\r\n/* 集中管理横盘上的棋子、对战结果、引擎调用等事务 */\r\nclass Battle {\r\n  static Battle _instance;\r\n\r\n  static get shared {\r\n    _instance ??= Battle();\r\n    return _instance;\r\n  }\r\n\r\n  Phase _phase;\r\n\r\n  init() {\r\n    _phase = Phase.defaultPhase();\r\n  }\r\n\r\n  get phase =&gt; _phase;\r\n}\r\n</code>\r\n</pre>\r\n</div>\r\n \r\n<div>\r\n接下来，我们在 _BattlePageState 中覆盖 initState 方法，在其中对 Battle 进行初始化：<br>\r\n<pre><code>\r\n...\r\nclass _BattlePageState extends State<battlepage> {\r\n  @override\r\n  void initState() {\r\n    super.initState();\r\n    Battle.shared.init(); //使用默认“新局”初始化棋子分布\r\n  }\r\n...\r\n}\r\n\r\n</battlepage></code>\r\n</pre>\r\n</div>\r\n \r\n<div>\r\n然后，我们在 BoadWidget 中修改 CustomPainter 的创建部分代码，将其修改为下边的样子：<br>\r\n<pre><code>\r\nclass BoardWidget extends StatelessWidget {\r\n ...\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    final boardContainer = Container(\r\n      width: width,\r\n      height: height,\r\n      decoration: BoxDecoration(\r\n        borderRadius: BorderRadius.circular(5),\r\n        color: ColorConsts.BoardBackground,\r\n      ),\r\n      child: CustomPaint(\r\n        painter: BoardPainter(width: width), //背景一层绘制横盘上的线格\r\n        /* 前景一层绘制棋子 */\r\n        foregroundPainter: PiecesPainter(\r\n          width: width,\r\n          // phase: Phase.defaultPhase(),\r\n          phase: Battle.shared.phase, //管理棋子分布的 Phase 对象，从 Battle 单例中获取\r\n        ),\r\n        /* CustomPaint 的 child 用于布置其上的子组件，这里放置是我们的「河界」、「路数」等文字信息 */\r\n        child: Container(\r\n          margin: EdgeInsets.symmetric(\r\n            vertical: Padding,\r\n            horizontal: (width - Padding * 2) / 9 / 2 +\r\n                Padding -\r\n                WordsOnBoard.DigitsFontSize / 2,\r\n          ),\r\n          child: WordsOnBoard(),\r\n        ),\r\n      ),\r\n    );\r\n   ...\r\n</code>\r\n</pre>\r\n</div>\r\n \r\n<div>现在好了，BoardWidget 不用知道 Phase 的细节了，它管理好自己的棋盘绘制、坐标翻译和点击事件上报就完事了。<br></div>\r\n<div><br></div>\r\n<div>在继续我们的棋盘事件处理流程前。我们有个象棋软件的常识要向大家介绍一下：</div>\r\n<div><br></div>\r\n<div>当我们点击自己一方的某个棋子时，被点中的棋子会有被「选中」的效果，这是给玩家的一个「状态可知」的交互反馈。</div>\r\n<div>我们选中棋子后再点击目的地移动棋子后，移动前、后的位置都有指示效果</div>\r\n<div>当前位置以及移动前的位置</div>\r\n<div><br></div>\r\n<div>\r\n为此，我们为 Battle 类添加两成员变量 _focusIndex 和 _blurIndex，用于标记当前位置和前一个位置，在 init 方法中对它们进行初始化，并为其添加修改和访问方法，修改后的 Phase 类代码如下：\r\n<pre><code>\r\nimport \'../cchess/phase.dart\';\r\n\r\n/* 集中管理横盘上的棋子、对战结果、引擎调用等事务 */\r\nclass Battle {\r\n  static Battle _instance;\r\n  Phase _phase;\r\n  int _focusIndex, _blurIndex;\r\n\r\n  static get shared {\r\n    _instance ??= Battle();\r\n    return _instance;\r\n  }\r\n\r\n  init() {\r\n    _phase = Phase.defaultPhase();\r\n    _focusIndex = _blurIndex = -1;\r\n  }\r\n\r\n  /* \r\n  点击选中一个棋子，使用 _focusIndex 来标记此位置\r\n  棋子绘制时，将在这个位置绘制棋子的选中效果\r\n  */\r\n  select(int pos) {\r\n    _focusIndex = pos;\r\n    _blurIndex = -1;\r\n  }\r\n\r\n  /* \r\n  从 from 到 to 位置移动棋子，使用 _focusIndex 和 _blurIndex 来标记 from 和 to 位置\r\n  棋子绘制时，将在这两个位置分别绘制棋子的移动前的位置和当前位置\r\n  */\r\n  move(int from, int to) {\r\n    _blurIndex = from;\r\n    _focusIndex = to;\r\n  }\r\n\r\n  /* 清除棋子的选中和移动前的位置指示 */\r\n  clear() {\r\n    _focusIndex = _blurIndex = -1;\r\n  }\r\n\r\n  get phase =&gt; _phase;\r\n  get focusIndex =&gt; _focusIndex;\r\n  get blurIndex =&gt; _blurIndex;\r\n}\r\n</code>\r\n</pre>\r\n</div>\r\n<div>这里 Battle 类中可以访问或修改两个位置标记变量的值 _focusIndex 和 _blurIndex，但 move 方法中并未真正修改 Phase 中的棋子列表。<br></div>\r\n<div><br></div>\r\n<div>我们需要先将棋子的选择与移动标记的绘制工作处理一下。</div>\r\n<div><br></div>\r\n<div>\r\n在 PiecesPainter 类中，我们添加两个成员变量 focusIndex 和 blurIndex，并修改构造方法，要求 PiecesPainter 的持有者传入这两个参数：\r\n<pre><code>\r\nclass PiecesPainter extends PainterBase {\r\n  final Phase phase; //表示棋局面\r\n  double pieceSide; //棋子的大小\r\n  final int focusIndex, blurIndex; //棋盘上的棋子移动、选择位置指示\r\n\r\n  PiecesPainter({\r\n    @required double width,\r\n    @required this.phase,\r\n    this.focusIndex = -1,\r\n    this.blurIndex = -1,\r\n  }) : super(width: width) {\r\n    pieceSide = squareSide * 0.9; //计算棋子的大小\r\n  }\r\n\r\n  ...\r\n}\r\n</code>\r\n</pre>\r\n</div>\r\n \r\n<div>\r\n回到 BoardWidget 的 CustomPaint 构造方法中，我们将 focusIndex 和 blurIndex 作为构造参数传递给 PiecesPainter 类：\r\n<pre><code>\r\n...\r\n\r\nclass BoardWidget extends StatelessWidget {\r\n\r\n  ...\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    final boardContainer = Container(\r\n      width: width,\r\n      height: height,\r\n      decoration: BoxDecoration(\r\n        borderRadius: BorderRadius.circular(5),\r\n        color: ColorConsts.BoardBackground,\r\n      ),\r\n      child: CustomPaint(\r\n        painter: BoardPainter(width: width), //背景一层绘制横盘上的线格\r\n        /* 前景一层绘制棋子 */\r\n        foregroundPainter: PiecesPainter(\r\n          width: width,\r\n          phase: Battle.shared.phase, //管理棋子分布的 Phase 对象，从 Battle 单例中获取\r\n          focusIndex: Battle.shared.focusIndex, //将棋盘上的选中棋子位置传给painter\r\n          blurIndex: Battle.shared.blurIndex, //将棋盘上要移动棋子位置传给painter\r\n        ),\r\n        /* CustomPaint 的 child 用于布置其上的子组件，这里放置是我们的「河界」、「路数」等文字信息 */\r\n        child: Container(\r\n          margin: EdgeInsets.symmetric(\r\n            vertical: Padding,\r\n            horizontal: (width - Padding * 2) / 9 / 2 +\r\n                Padding -\r\n                WordsOnBoard.DigitsFontSize / 2,\r\n          ),\r\n          child: WordsOnBoard(),\r\n        ),\r\n      ),\r\n    );\r\n\r\n    ...\r\n  }\r\n}\r\n</code>\r\n</pre>\r\n</div>\r\n\r\n<div>\r\n接着，对 PiecesPainter 的 doPaint 方法我们添加两个对应参数：\r\n<pre><code>\r\nstatic doPaint(\r\n    Canvas canvas,\r\n    Paint paint, {\r\n    Phase phase, //局面\r\n    double gridWidth, //横盘上线格的总宽度\r\n    double squareSide, //每个格子的边长\r\n    double pieceSide,\r\n    double offsetX,\r\n    double offsetY,\r\n    int focusIndex = -1,\r\n    int blurIndex = -1,\r\n  }) {\r\n   ...\r\n  }\r\n</code>\r\n</pre>\r\n</div>\r\n<div>\r\n对应的，我们在 PiecesPainter 的 paint 方法中修改对 doPaint 方法的调用代码：<br>\r\n<pre><code>\r\n@override\r\n  void paint(Canvas canvas, Size size) {\r\n    //\r\n    doPaint(\r\n      canvas,\r\n      thePaint,\r\n      phase: phase,\r\n      gridWidth: gridWidth, //总宽度\r\n      squareSide: squareSide, //每一个格子的边长\r\n      pieceSide: pieceSide, //棋子的大小\r\n      offsetX: BoardWidget.Padding + squareSide / 2,\r\n      offsetY: BoardWidget.Padding + BoardWidget.DigitsHeight + squareSide / 2,\r\n      focusIndex: focusIndex,\r\n      blurIndex: blurIndex,\r\n    );\r\n  }\r\n</code>\r\n</pre>\r\n</div>\r\n<div>接下来的事情，当然就是在 doPaint 方法中添加位置指示的绘制代码。<br></div>\r\n<div>\r\n在 PiecesPainter 的 doPaint 方法尾部添加对选择和移动位置指示的绘制代码：\r\n<pre><code>\r\nclass PiecesPainter extends PainterBase {\r\n  ...\r\n  static doPaint(\r\n    Canvas canvas,\r\n    Paint paint, {\r\n    Phase phase, //局面\r\n    double gridWidth, //横盘上线格的总宽度\r\n    double squareSide, //每个格子的边长\r\n    double pieceSide,\r\n    double offsetX,\r\n    double offsetY,\r\n    int focusIndex = -1,\r\n    int blurIndex = -1,\r\n  }) {\r\n    /* 绘制棋子的选定效果 */\r\n    if (focusIndex != -1) {\r\n      final int row = focusIndex ~/ 9, column = focusIndex % 9;\r\n\r\n      paint.color = ColorConsts.FocusPosition;\r\n      paint.style = PaintingStyle.stroke;\r\n      paint.strokeWidth = 2;\r\n\r\n      canvas.drawCircle(\r\n        Offset(left + column * squareSide, top + row * squareSide),\r\n        pieceSide / 2,\r\n        paint,\r\n      );\r\n    }\r\n\r\n    /* 绘制棋子移动效果 */\r\n    if (blurIndex != -1) {\r\n      final int row = blurIndex ~/ 9, column = blurIndex % 9;<br>\r\n      paint.color = ColorConsts.BlurPosition;\r\n      paint.style = PaintingStyle.fill;\r\n\r\n      canvas.drawCircle(\r\n        Offset(left + column * squareSide, top + row * squareSide),\r\n        pieceSide / 2 * 0.8,\r\n        paint,\r\n      );\r\n    }\r\n  }\r\n</code>\r\n</pre>\r\n</div>\r\n<div>棋盘的位置指示位置绘制就这样了，现在开始接近最本质的内容了 — 修改棋盘上的棋子位置。<br></div>\r\n<div><br></div>\r\n<div>\r\n让我们回到 _BattlePageState 类的 onBoardTap 方法，我们给其中添加棋子选中、移动的基本逻辑：\r\n<pre><code>\r\nclass _BattlePageState extends State<battlepage> {\r\n\r\n  ...\r\n\r\n  /* 由 BattlePage 的 State 类来处理棋盘的点击事件 */\r\n  onBoardTap(BuildContext context, int pos) {\r\n    //\r\n    print(\'棋盘的index: $pos\');\r\n\r\n    final phase = Battle.shared.phase;\r\n\r\n    /* 现在只限定红方能行棋 */\r\n    if (phase.side != Side.Red) return;\r\n\r\n    final tapedPiece = phase.pieceAt(pos); //查询选中的坐标的的棋子\r\n\r\n    /* 之前是否有选择棋子，以及是否选中的是红方 */\r\n    if (Battle.shared.focusIndex != -1 &amp;&amp;\r\n        Side.of(phase.pieceAt(Battle.shared.focusIndex)) == Side.Red) {\r\n      if (Battle.shared.focusIndex == pos) return; //当前点击的棋子和之前已经选择的是同一个位置\r\n\r\n      //之前已经选择的棋子和现在点击的棋子是同一边的，说明是选择另外一个棋子\r\n      final focusPiece = phase.pieceAt(Battle.shared.focusIndex);\r\n      if (Side.sameSide(focusPiece, tapedPiece)) {\r\n        Battle.shared.select(pos); //设置新的选中棋子\r\n      } else if (Battle.shared.move(Battle.shared.focusIndex, pos)) {\r\n        print(\'现在点击的棋子和上一次选择棋子不同边，要么是吃子，要么是移动棋子到空白处\');\r\n      }\r\n      //\r\n    } else {\r\n      print(\'之前未选择棋子，现在点击就是选择棋子\');\r\n      if (tapedPiece != Piece.Empty) Battle.shared.select(pos);\r\n    }\r\n  }\r\n\r\n  ...\r\n}\r\n</battlepage></code>\r\n</pre>\r\n</div>\r\n<div>onBoardTap 方法中存在一些细腻的逻辑，却并不是复杂的东西，大家可以看下代码上的注释文字。<br></div>\r\n<div><br></div>\r\n<div>棋子的移动动作计划是在 Battle 类的 move 方法中进行的，但棋子列表是由 Phase 类持有的。为了尽可能地降低逻辑耦合，我们在 Phase 类中执行真正的棋子移动操作，后边 Battle 将在 move 方法中调用\r\n    Phase 类的 move 方法。</div>\r\n<div><br></div>\r\n<div>\r\n我们先在 Phase 类中添加 move 方法的实现：\r\n<pre><code>\r\n...\r\n\r\nclass Phase {\r\n\r\n  ...\r\n\r\n  bool move(int from, int to) {\r\n    if (!validateMove(from, to)) return false;\r\n\r\n    //修改棋盘\r\n    _pieces[to] = _pieces[from];\r\n    _pieces[from] = Piece.Empty;\r\n\r\n    // _side = Side.oppo(_side); //交换走棋方\r\n\r\n    return true;\r\n  }\r\n\r\n  /// 验证移动棋子的着法是否合法\r\n  bool validateMove(int from, int to) {\r\n    // TODO:\r\n    return true;\r\n  }\r\n  ...\r\n}\r\n</code>\r\n</pre>\r\n</div>\r\n<div>\r\n接下来的事情就简单了，我们将 Battle 类的 move 方法修改为下边的样子：\r\n<pre><code>\r\n...\r\n\r\nclass Battle {\r\n\r\n  ...\r\n\r\n  /* \r\n  从 from 到 to 位置移动棋子，使用 _focusIndex 和 _blurIndex 来标记 from 和 to 位置\r\n  棋子绘制时，将在这两个位置分别绘制棋子的移动前的位置和当前位置\r\n  */\r\n  move(int from, int to) {\r\n    if (!_phase.move(from, to)) return false;\r\n\r\n    /* 移动棋子时，更新这两个标志位置，然后的绘制会把它们展示在界面上 */\r\n    _blurIndex = from;\r\n    _focusIndex = to;\r\n\r\n    return true;\r\n  }\r\n\r\n  ...\r\n}\r\n</code>\r\n</pre>\r\n</div>\r\n<div>数据层面的棋子移动逻辑都完成了！<br></div>\r\n<div>\r\n最后一步让界面呈现棋盘数据状态的改动 — 我们在 _BattlePageState 的 onBoardTap 方法尾部添加一行代码：\r\n<pre><code>\r\nsetState(() {}); //更新状态，重新绘制棋子\r\n</code>\r\n</pre>\r\n</div>\r\n<div>现在又到了检验成果的时间了，在 vscode 中按 F5，试试在棋盘上点击棋子走棋看看？<br></div>\r\n<div><br></div>\r\n<div>\r\n提交代码到 git 仓库吧，本节目标达成！\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'处理行棋\'\r\n[master 7d14a21] 处理行棋\r\n 5 files changed, 201 insertions(+), 12 deletions(-)\r\n create mode 100644 lib/game/battle.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 21, 完成.\r\n对象计数中: 100% (21/21), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (10/10), 完成.\r\n写入对象中: 100% (12/12), 4.59 KiB | 4.59 MiB/s, 完成.\r\n总共 12 （差异 4），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 112.94.53.74 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-08-25 05:56:00 (UTC), debug id 51e2e5.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   8c71acb..7d14a21  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ \r\n</code>\r\n</pre>\r\n</div> \r\n<div><br></div>\r\n<div>本节回顾</div>\r\n<div>本节课程中，我们首先使用 GestureDetector 组件来检查用户在组件上的点击事件。通过 onTapUp 事件回调，我们可以获取点击事件的位置信息，接着将这个位置信息转换成了棋盘上的棋子位置。</div>\r\n<div><br></div>\r\n<div>接下来，我们将棋盘事件的接收者抽象出来，由棋盘组件的创建者在创建棋盘时一并传入棋盘组件。发生点击棋盘事件时，向接收者调用回调方法。</div>\r\n<div><br></div>\r\n<div>很关键的一步，我们实现了 Battle 类，将在其中管理了 Phase 类的对象以及棋盘上的选定棋子移动棋子的位置指示。</div>\r\n<div><br></div>\r\n<div>Phase 类的实例决定了棋盘上的某个棋子所在的具体位置，我们在其中实现了棋子的移动、咋子等逻辑。</div>                                                                                                                                                                                                                                '),(26,'                                                                                                <p>到目前，我们的「棋路-中国象棋」游戏已经有些眉目了！</p>\r\n<p>\r\n    为了不至于太紧张，在做了一大堆复杂工作后，现在是做点轻松且有成效的工作的时间了！本节让我们来给象棋游戏添加基本的界面元素！</p>\r\n<h2>本节提要</h2>\r\n<ul>\r\n    <li>添加游戏主菜单页</li>\r\n    <li>布局对战页面</li>\r\n    <li>配置全屏/竖屏模式</li>\r\n    <li>讨论不同屏幕的适配</li>\r\n</ul>\r\n<p>我们将在游戏中使用全屏界面，考虑到目前手机中有大量的刘海屏存在，所以我们再 ChessApp\r\n    中定义一个状态栏高度的命名常量，游戏的每个页面在\r\n    StatusBar 的高度范围内都放置内容：</p>\r\n<pre><code>class ChessApp extends StatelessWidget {\r\n  //\r\n  static const StatusBarHeight = 28.0;\r\n  ...\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<h2 id=\"-1\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\">添加游戏主菜单页</h2>\r\n<p>我们先为游戏添加一个开始菜单页面：在 lib/routes 文件夹下，我们创建一个新的文件\r\n    main-menu.dart，在其中创建我们的开始菜单 Widget：\r\n</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-1\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">import \'package:flutter/material.dart\';\r\nimport \'../common/color-consts.dart\';\r\nimport \'../main.dart\';\r\nimport \'battle-page.dart\';\r\n\r\nclass MainMenu extends StatelessWidget {\r\n  //\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    //\r\n    final nameStyle = TextStyle(\r\n      fontSize: 64,\r\n      color: Colors.black,\r\n    );\r\n\r\n    final menuItemStyle = TextStyle(\r\n      fontSize: 28,\r\n      color: ColorConsts.Primary,\r\n    );\r\n\r\n    // 标题及菜单项的布局\r\n    final menuItems = Center(\r\n      child: Column(\r\n        children: <widget>[\r\n          Expanded(child: SizedBox(), flex: 4),\r\n          Text(\'中国象棋\', style: nameStyle, textAlign: TextAlign.center),\r\n          Expanded(child: SizedBox()),\r\n          FlatButton(child: Text(\'单机对战\', style: menuItemStyle), onPressed: () {}),\r\n          Expanded(child: SizedBox()),\r\n          FlatButton(child: Text(\'挑战云主机\', style: menuItemStyle),onPressed: () {},),\r\n          Expanded(child: SizedBox()),\r\n          FlatButton(child: Text(\'排行榜\', style: menuItemStyle), onPressed: () {}),\r\n          Expanded(child: SizedBox(), flex: 3),\r\n          Text(\'用心娱乐，为爱传承\', \r\n               style: TextStyle(color: Colors.black54, fontSize: 16)),\r\n          Expanded(child: SizedBox()),\r\n        ],\r\n      ),\r\n    );\r\n\r\n    // 页面整体\r\n    return Scaffold(\r\n      backgroundColor: ColorConsts.LightBackground,\r\n      body: Stack(\r\n        children: <widget>[\r\n          menuItems,\r\n          // 为了在页面左上角显示设置按钮，我们使用了基于绝对位置的 Stack 布局\r\n          Positioned(\r\n            top: ChessRoadApp.StatusBarHeight,\r\n            left: 10,\r\n            child: IconButton(\r\n              icon: Icon(Icons.settings, color: ColorConsts.Primary),\r\n              onPressed: () {},\r\n            ),\r\n          ),\r\n        ],\r\n      ),\r\n    );\r\n  }\r\n}\r\n</widget></widget></code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>这个类的实现比较简单，基本上一行一行的菜单项，代码一目了然！</p>\r\n<p>我们回到 main.dart 文件中来修改一下启动逻辑，让程序一启动就显示 MainMenu\r\n    页面，这很简单，只需要把原来的 ChessRoadApp 的\r\n    build 方法中的 BattlePage 更换为 MainMenu 就完了！</p>\r\n<p>用系统默认字体来显示应用的名称或菜单，界面看起来会比较呆板，这里先不放图（真心不好看）。我们前文已经在 App\r\n    中引入了美观且「中国风」的字体 —\r\n    方正启体，现在可以再次派上用场了！</p>\r\n<p>为了不在每个用到文字的地方都单独指定字体名称，有一个小技巧：我们可以为全局指定默认的字体：</p>\r\n<p>在 ChessroadApp 类的 build 方法中可以设置应用的主题，我们在其主题设置中添加 fontFamily\r\n    的设置，这样一来应用的全局字体就设置好了，修改后的 main.dart 代码如下：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-2\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">import \'./routes/main-menu.dart\';\r\nimport \'package:flutter/material.dart\';\r\n\r\nvoid main() =&gt; runApp(ChessRoadApp());\r\n\r\nclass ChessRoadApp extends StatelessWidget {\r\n  //\r\n  static const StatusBarHeight = 28.0;\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    //\r\n    return MaterialApp(\r\n      theme: ThemeData(primarySwatch: Colors.brown, fontFamily: \'QiTi\'),\r\n      debugShowCheckedModeBanner: false,\r\n      home: MainMenu(),\r\n    );\r\n  }\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>现在试试在 vscode 中按&nbsp;<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\">F5</code>&nbsp;看看效果：</p>\r\n<p><img src=\"https://images.gitbook.cn/mQE0TC.png\" alt=\"新登场的开始菜单\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\"></p>\r\n<p>页面挺美观的，但会不会太安静和朴素了？</p>\r\n<p>在后续的章节中，我们将为页面添加更丰富的视觉元素和适当的动画效果！</p>\r\n<p>现在点击菜单项的话，会发现什么都没发生，因为我们还没有配置正确的页面导航逻辑。我们找到在 MainMenu\r\n    中找到以下代码：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-4\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">FlatButton(child: Text(\'挑战云主机\', style: menuItemStyle), onPressed: () {}),\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>将其修改为：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-5\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">FlatButton(\r\n  child: Text(\'挑战云主机\', style: menuItemStyle),\r\n  onPressed: () {\r\n    Navigator.of(context).push(\r\n      MaterialPageRoute(builder: (context) =&gt; BattlePage())，\r\n    );\r\n  },\r\n),\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>现在运行产品可以发现，点击「挑战云主机」菜单，已经可以进入到先前我们一直正在构建的 BattlePage 了。</p>\r\n<h2 id=\"-2\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\">布置对战页</h2>\r\n<p>主菜单的简单 UI 已经正确呈现了，现在我们来调整 BattlePage 的页面布置。</p>\r\n<p>我们先在 _BattlePageState 类中添加 createPageHeader\r\n    方法，像它的名称指示的那样，它用来显示对战页面顶部区域：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-6\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">...\r\n\r\nclass _BattlePageState extends State<battlepage> {\r\n\r\n  ...\r\n\r\n  // 标题、活动状态、顶部按钮等\r\n  Widget createPageHeader() {\r\n    //\r\n    final titleStyle = TextStyle(fontSize: 28, color: ColorConsts.DarkTextPrimary);\r\n    final subTitleStyle = TextStyle(fontSize: 16, color: ColorConsts.DarkTextSecondary);\r\n\r\n    return Container(\r\n      margin: EdgeInsets.only(top: ChessRoadApp.StatusBarHeight),\r\n      child: Column(\r\n        children: <widget>[\r\n          Row(\r\n            children: <widget>[\r\n              IconButton(\r\n                icon: Icon(Icons.arrow_back, color: ColorConsts.DarkTextPrimary),\r\n                onPressed: () {},\r\n              ),\r\n              Expanded(child: SizedBox()),\r\n              Text(\'单机对战\', style: titleStyle),\r\n              Expanded(child: SizedBox()),\r\n              IconButton(\r\n                icon: Icon(Icons.settings, color: ColorConsts.DarkTextPrimary),\r\n                onPressed: () {},\r\n              ),\r\n            ],\r\n          ),\r\n          Container(\r\n            height: 4.0,\r\n            width: 180.0,\r\n            margin: EdgeInsets.only(bottom: 10),\r\n            decoration: BoxDecoration(\r\n              color: ColorConsts.BoardBackground,\r\n              borderRadius: BorderRadius.circular(2),\r\n            ),\r\n          ),\r\n          Container(\r\n            padding: EdgeInsets.symmetric(horizontal: 16),\r\n            child: Text(\'[游戏状态]\', maxLines: 1, style: subTitleStyle),\r\n          ),\r\n        ],\r\n      ),\r\n    );\r\n  }\r\n\r\n  ...\r\n}\r\n</widget></widget></battlepage></code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>接着，我们在 _BattlePageState 类中创建 createBoard 方法，这个方法创建 Board\r\n    包裹相关的逻辑：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-7\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">...\r\n\r\nclass _BattlePageState extends State<battlepage> {\r\n\r\n  ...\r\n\r\n  Widget createBoard() {\r\n    //\r\n    final windowSize = MediaQuery.of(context).size;\r\n\r\n    return Container(\r\n      margin: EdgeInsets.symmetric(\r\n        horizontal: BattlePage.BoardMarginH,\r\n        vertical: BattlePage.BoardMarginV,\r\n      ),\r\n      decoration: BoxDecoration(\r\n        borderRadius: BorderRadius.circular(5),\r\n        color: ColorConsts.BoardBackground,\r\n      ),\r\n      child: BoardWidget(\r\n        // 棋盘的宽度已经扣除了部分边界\r\n        width: windowSize.width - BattlePage.BoardMarginH * 2,\r\n        onBoardTap: onBoardTap,\r\n      ),\r\n    );\r\n  }\r\n\r\n  ...\r\n}\r\n</battlepage></code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>之后，我们继续在 _BattlePageState 中创建 createOperatorBar\r\n    方法，这个方法将在棋盘下边放置一个操作条：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-8\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">...\r\nclass _BattlePageState extends State<battlepage> {\r\n\r\n  ...\r\n\r\n  // 操作菜单栏\r\n  Widget createOperatorBar() {\r\n    //\r\n    final buttonStyle = TextStyle(color: ColorConsts.Primary, fontSize: 20);\r\n\r\n    return Container(\r\n      decoration: BoxDecoration(\r\n        borderRadius: BorderRadius.circular(5),\r\n        color: ColorConsts.BoardBackground,\r\n      ),\r\n      margin: EdgeInsets.symmetric(horizontal: BattlePage.BoardMarginH),\r\n      padding: EdgeInsets.symmetric(vertical: 2),\r\n      child: Row(children: <widget>[\r\n        Expanded(child: SizedBox()),\r\n        FlatButton(child: Text(\'新对局\', style: buttonStyle), onPressed: () {}),\r\n        Expanded(child: SizedBox()),\r\n        FlatButton(child: Text(\'悔棋\', style: buttonStyle), onPressed: () {}),\r\n        Expanded(child: SizedBox()),\r\n        FlatButton(child: Text(\'分析局面\', style: buttonStyle), onPressed: () {}),\r\n        Expanded(child: SizedBox()),\r\n      ]),\r\n    );\r\n  }\r\n\r\n  ...\r\n}\r\n</widget></battlepage></code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>到这里，我们创建了新的 BattlePage 的 Header，创建了 Board，创建了\r\n    OperatorBar，剩下的工作只是组装一下这些基础组件：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-9\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">...\r\nclass _BattlePageState extends State<battlepage> {\r\n\r\n  ...\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    //\r\n    final header = createPageHeader();\r\n    final board = createBoard();\r\n    final operatorBar = createOperatorBar();\r\n\r\n    // 整体页面从上到下，依次排列\r\n    return Scaffold(\r\n      backgroundColor: ColorConsts.DarkBackground,\r\n      body: Column(children: <widget>[header, board, operatorBar]),\r\n    );\r\n  }\r\n}\r\n</widget></battlepage></code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>现在在 vscode 中按&nbsp;<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\">F5</code>&nbsp;试试，BattlePage\r\n    页面是不是「有头有脸」了，感觉完全是涅槃重生了！</p>\r\n<p><img src=\"https://images.gitbook.cn/QVip4s.png\" alt=\"美美的对战页面\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\"></p>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" outline:=\"\">\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">BattlePage 页面的底部，将来会放置行棋过程的着法列表，现在先空着。</p>\r\n</blockquote>\r\n<p>现在 BattlePage 页面左上角的 Back 按钮点击后还不能返回 MainMenu 页面，我们在\r\n    createPageHeader 方法中找到下边的代码：\r\n</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-11\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">IconButton(\r\n  icon: Icon(Icons.arrow_back, color: ColorConsts.DarkTextPrimary),\r\n  onPressed: () {},\r\n),\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>将期修改为：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-12\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">IconButton(\r\n  icon: Icon(Icons.arrow_back, color: ColorConsts.DarkTextPrimary),\r\n  // 返回前一页\r\n  onPressed: () =&gt; Navigator.of(context).pop(),\r\n),\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>可以运行程序试试，当左上角的 Back 按钮被点击后，将返回到 MainMenu 页面。</p>\r\n<h2 id=\"-3\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\">让游戏全屏呈现</h2>\r\n<p>我们希望象棋游戏的页面能全屏显示，因此我们没有创建 Scafold 中的\r\n    AppBar。即使如此，页面顶部依然还显示了系统的任务栏（时间、信号那一条）。</p>\r\n<p>要让 App 界面全屏呈现，我们可以在 main.dart 文件的 main 方法中添加两句代码。</p>\r\n<p>我们在 main.dart 文件中找到下边的代码：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-13\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">void main() =&gt; runApp(ChessApp());\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>将其修改为下边的样子：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-14\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">void main() {\r\n  //\r\n  runApp(ChessApp());\r\n\r\n  // 不显示状态栏\r\n\r\n  if (Platform.isAndroid) {\r\n    SystemChrome.setSystemUIOverlayStyle(\r\n      SystemUiOverlayStyle(statusBarColor: Colors.transparent),\r\n    );\r\n  }\r\n\r\n  SystemChrome.setEnabledSystemUIOverlays([]);\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>我们的象棋游戏只支持竖屏方式运行，因此我们需要限制运行游戏时的屏幕旋转动作，因此我们还需要在&nbsp;<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\">runApp(ChessApp());</code>代码行之下，增加下边的限制屏旋转的代码，修改以后的\r\n    main 方法代码如下：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-16\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">void main() {\r\n  //\r\n  runApp(ChessRoadApp());\r\n\r\n  // 仅支持竖屏\r\n  SystemChrome.setPreferredOrientations(\r\n    [DeviceOrientation.portraitUp, DeviceOrientation.portraitDown],\r\n  );\r\n\r\n  // 不显示状态栏\r\n  if (Platform.isAndroid) {\r\n    SystemChrome.setSystemUIOverlayStyle(\r\n      SystemUiOverlayStyle(statusBarColor: Colors.transparent),\r\n    );\r\n  }\r\n\r\n  SystemChrome.setEnabledSystemUIOverlays([]);\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>保存并运行程序，看看我们的杰作！</p>\r\n<p><img src=\"https://images.gitbook.cn/ZqJP5v.png\" alt=\"新登场的开始菜单\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\"></p>\r\n<h2 id=\"-4\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\">适应更多纵横比的屏幕</h2>\r\n<p>到这里，我们的主菜单页面和对战页面基本成型了，老实说：美美的！</p>\r\n<p>但还有一个问题不可忽略，那就是不同屏幕比例的界面兼容问题。</p>\r\n<p>\r\n    如果每一个设备都拥有相同的屏幕宽度、长度，我们移动开发人员就幸福了！可现实是，用户的设备千差万别，我们必须考虑到用户实际运行的设备是五花八门的，需要为各个页面考虑屏幕兼容问题。</p>\r\n<p>对于主菜单 MainMenu 这样的简单页面，我们使用 Column\r\n    模式来布局就有很大的弹性！在垂直方向的各个菜单项之间放置 Expanded\r\n    组件，按约定比例分配多余的空间。多数情况下都能很好地解决问题。</p>\r\n<p>而对于我们的 BattlePage 而言，问题要复杂一些。具体来说，我们的游戏垂直方向布局了\r\n    Header、Board、OperatorBar\r\n    三大组件。棋盘占据了屏幕的中上部分的大多数空间，并且横向占用了全部的屏幕宽度。</p>\r\n<p>由于不同屏幕有不同的纵横比，此页面可能出现以下 3 种情况：</p>\r\n<ul>\r\n    <li>Case 1：屏幕比较狭长，垂直放置 Header、中间的 Board 和下边的 OperatorBar 后，底部会空出一定空间；</li>\r\n    <li>Case 2：屏幕长宽比适中，垂直放下 Header、中间的 Board 和下边的 OperatorBar 后，刚好用完了屏幕空间；</li>\r\n    <li>Case 3：屏幕稍宽/显短，垂直方向放不下Header、Board 和 OperatorBar 三个部分的内容；</li>\r\n</ul>\r\n<p>目前市场上最常见屏幕纵横比在 16:9 左右，我们以16:9 为基准，判定用户屏幕为是 Case 1、Case 2\r\n    还是 Case 3：</p>\r\n<ul>\r\n    <li>Case 1：纵横比大于16:9 的屏幕，我们定义为狭长屏；</li>\r\n    <li>Case 2：纵横比为16:9 的横屏为长宽比适中；</li>\r\n    <li>Case 3：纵横屏小于16:9 的屏幕，我们定义为稍宽/显短的屏幕；</li>\r\n</ul>\r\n<p>对于判断的 3 种类型的屏幕，我们的应对方式如下：</p>\r\n<ul>\r\n    <li>对于常见的狭长屏幕，我们在底部空出的空间放置「棋谱」内容，显示走棋的着法列表</li>\r\n    <li>对于长宽比适中的屏幕，我们仅在底部放置一个按钮，点按按钮后弹出「棋谱」内容</li>\r\n    <li>对于稍宽/显短的屏幕，我们同步缩小棋盘的宽度和高度，确保能将内容放置完整</li>\r\n</ul>\r\n<p>我们现在动手来处理屏幕适配问题。我们先将 BattlePage 类顶部原有的两个常量定义删除：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-17\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">static const BoardMarginV = 10.0, BoardMarginH = 10.0;\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>在原有位置，添加两个静态常量：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-18\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">static double boardMargin = 10.0, screenPaddingH = 10.0;\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>我们在 _BattlePageState 类中添加一个 calcScreenPaddingH\r\n    方法，它用来根据屏幕的纵横比，确定在棋盘左右放置多少尺寸的填充：\r\n</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-19\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">  void calcScreenPaddingH() {\r\n    //\r\n    // 当屏幕的纵横比小于16/9时，限制棋盘的宽度\r\n    final windowSize = MediaQuery.of(context).size;\r\n    double height = windowSize.height, width = windowSize.width;\r\n\r\n    if (height / width &lt; 16.0 / 9.0) {\r\n      width = height * 9 / 16;\r\n      // 横盘宽度之外的空间，分左右两边，由 screenPaddingH 来持有，布局时添加到 BoardWidget 外围水平边距\r\n      BattlePage.screenPaddingH = (windowSize.width - width) / 2 - BattlePage.boardMargin;\r\n    }\r\n  }\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" outline:=\"\">\r\n    <p style=\"margin-bottom: 1.1em; font-size: 1em; line-height: 1.45; outline: 0px !important;\">\r\n        以于屏幕相对较短的手机，我们在屏幕两侧让出一定的间距，只在中间的纵横比16:9的区域内显示内容。</p>\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">\r\n        由于棋盘的纵横比是固定的（接近10:9），当我们在棋盘两侧添加填充距离时，棋盘的高度就相应地变小了，棋盘看起来就呈现出左右居中的效果。</p>\r\n</blockquote>\r\n<p>修改 _BattlePageState 类的 build 方法，在方法的开头添加对\r\n    calcScreenPaddingH 方法的调用：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-20\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\"> @override\r\n Widget build(BuildContext context) {\r\n   // 在 Build 方法中计算宽度\r\n   calcScreenPaddingH();\r\n   ...\r\n }\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>接着，我们修改 _BattlePageState 的 createBoard 方法，使用上\r\n    calcScreenPaddingH 方法的计算结果：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-21\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">  Widget createBoard() {\r\n    //\r\n    return Container(\r\n      margin: EdgeInsets.symmetric(\r\n        horizontal: BattlePage.screenPaddingH,\r\n        vertical: BattlePage.boardMargin,\r\n      ),\r\n      child: BoardWidget(\r\n        // 这里将 screenPaddingH 作为边距，放置在 BoardWidget 左右，这样棋盘将水平居中显示\r\n        width: MediaQuery.of(context).size.width - BattlePage.screenPaddingH * 2,\r\n        onBoardTap: onBoardTap,\r\n      ),\r\n    );\r\n  }\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>对应的，我们也修改一下 createOperatorBar 方法，使用上 calcScreenPaddingH\r\n    计算的结果：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-22\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">  Widget createOperatorBar() {\r\n    //\r\n    final buttonStyle = TextStyle(color: ColorConsts.Primary, fontSize: 20);\r\n\r\n    return Container(\r\n      decoration: BoxDecoration(\r\n        borderRadius: BorderRadius.circular(5),\r\n        color: ColorConsts.BoardBackground,\r\n      ),\r\n      margin: EdgeInsets.symmetric(horizontal: BattlePage.screenPaddingH),\r\n      padding: EdgeInsets.symmetric(vertical: 2),\r\n      child: Row(children: <widget>[\r\n        Expanded(child: SizedBox()),\r\n        FlatButton(child: Text(\'新对局\', style: buttonStyle), onPressed: () {}),\r\n        Expanded(child: SizedBox()),\r\n        FlatButton(child: Text(\'悔棋\', style: buttonStyle), onPressed: () {}),\r\n        Expanded(child: SizedBox()),\r\n        FlatButton(child: Text(\'分析局面\', style: buttonStyle), onPressed: () {}),\r\n        Expanded(child: SizedBox()),\r\n      ]),\r\n    );\r\n  }\r\n</widget></code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>\r\n    如前文所述，对于不风纵横比的屏幕，我们在屏幕将布局不一样的内容。对于狭长屏，我们在底部布局一个表示着法列表的「棋谱」区域。其它情况下，我们放置一个按钮，点击后弹出一个对话框展示「棋谱」内容。</p>\r\n<p>现在我们在 _BattlePageState 类中添加 buildFooter 系列方法：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-23\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">// 对于底部的空间的弹性处理\r\nWidget buildFooter() {\r\n  //\r\n  final size = MediaQuery.of(context).size;\r\n\r\n  final manualText = \'&lt;暂无棋谱&gt;\';\r\n\r\n  if (size.height / size.width &gt; 16 / 9) {\r\n    // 长屏幕显示着法列表\r\n    return buildManualPanel(manualText);\r\n  } else {\r\n    // 短屏幕显示一个按钮，点击它后弹出着法列表\r\n    return buildExpandableManaulPanel(manualText);\r\n  }\r\n}\r\n\r\n// 长屏幕显示着法列表\r\nWidget buildManualPanel(String text) {\r\n  //\r\n  final manualStyle = TextStyle(\r\n    fontSize: 18,\r\n    color: ColorConsts.DarkTextSecondary,\r\n    height: 1.5,\r\n  );\r\n\r\n  return Expanded(\r\n    child: Container(\r\n      margin: EdgeInsets.symmetric(vertical: 16),\r\n      child: SingleChildScrollView(child: Text(text, style: manualStyle)),\r\n    ),\r\n  );\r\n}\r\n\r\n// 短屏幕显示一个按钮，点击它后弹出着法列表\r\nWidget buildExpandableManaulPanel(String text) {\r\n  //\r\n  final manualStyle = TextStyle(fontSize: 18, height: 1.5);\r\n\r\n  return Expanded(\r\n    child: IconButton(\r\n      icon: Icon(Icons.expand_less, color: ColorConsts.DarkTextPrimary),\r\n      onPressed: () =&gt; showDialog(\r\n        context: context,\r\n        barrierDismissible: false,\r\n        builder: (BuildContext context) {\r\n          return AlertDialog(\r\n            title: Text(\'棋谱\', style: TextStyle(color: ColorConsts.Primary)),\r\n            content: SingleChildScrollView(child: Text(text, style: manualStyle)),\r\n            actions: <widget>[\r\n              FlatButton(\r\n                child: Text(\'好的\'),\r\n                onPressed: () =&gt; Navigator.of(context).pop(),\r\n              ),\r\n            ],\r\n          );\r\n        },\r\n      ),\r\n    ),\r\n  );\r\n}\r\n</widget></code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>再调整一下 _BattlePageState 类的 build 方法，将 buildFooter\r\n    添加到界面布局代码中去：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-24\" style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" white-space:=\"\" pre;=\"\" outline:=\"\">@override\r\nWidget build(BuildContext context) {\r\n  //\r\n  calcScreenPaddingH();\r\n\r\n  final header = createPageHeader();\r\n  final board = createBoard();\r\n  final operatorBar = createOperatorBar();\r\n  final footer = buildFooter();\r\n\r\n  // 在原有从上到下布局中，添加底部着法列表\r\n  return Scaffold(\r\n    backgroundColor: ColorConsts.DarkBackground,\r\n    body: Column(children: <widget>[header, board, operatorBar, footer]),\r\n  );\r\n}\r\n</widget></code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre>\r\n<p>现在在 vscode 中按 `F5` 运行产品看看效果，先在 iphone11上看看：</p>\r\n<p><img src=\"https://gitbook.cn/gitchat/column/5e9d67352b34772795873df4/topic/assets/snipaste_2020-03-16_21-34-25.png\" alt=\"iPhone 11 Pro 上的运行效果\" style=\"max-width: 100%; zoom: 0.33; outline: 0px !important;\"></p>\r\n<p>在 Android 设备上看看：</p>\r\n<p><img src=\"https://images.gitbook.cn/qyqEI9.png\" alt=\"Android 上的运行效果\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\"></p>\r\n<p>在 iPad 上运行产品看看：</p>\r\n<p><img src=\"https://images.gitbook.cn/5WAj6a.png\" alt=\"iPad 上的运行效果\" style=\"max-width: 100%; zoom: 0.33; outline: 0px !important;\"></p>\r\n<p>从上边的不同设备的截图可以看到，我们的屏幕适应策略是有成效的。真是不容易的工作，效果还挺不错！</p>\r\n<p>将代码提交到 git 仓库，本节任务完成！</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'添加基本界面\'\r\n[master d55e6ca] 添加基本界面\r\n 3 files changed, 310 insertions(+), 17 deletions(-)\r\n create mode 100644 lib/routes/main-menu.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 12, 完成.\r\n对象计数中: 100% (12/12), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (7/7), 完成.\r\n写入对象中: 100% (7/7), 4.37 KiB | 4.37 MiB/s, 完成.\r\n总共 7 （差异 3），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 27.47.5.58 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-08-26 15:25:11 (UTC), debug id f88fa5.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   8acf2c1..d55e6ca  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$\r\n</code>\r\n</pre>\r\n<h2 id=\"-5\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\"=\"\" ,=\"\" \"microsoft=\"\" yahei\"=\"\" sans-serif;=\"\" color:=\"\" rgb(32,=\"\" 35,=\"\" 38);=\"\" margin:=\"\" 1.6em=\"\" 0px;=\"\" font-size:=\"\" 20px;=\"\" outline:=\"\">本节回顾</h2>\r\n<p>本节课程中，我们添加了开始菜单，使用 Expaneded 组件实现了弹性布局。</p>\r\n<p>\r\n    接着我们布置了一个很美观的象棋对战页面，它包含了象棋游戏中的标准页面中的的有要素，例如标题，状态栏、棋盘、操作栏，详细信息等。这种版式将来会在其它页面得到复用。\r\n</p>\r\n<p>最重要的的一个环节，我们讨论了如果通过布局方案解决不同手机纵横比的问题。我们以纵横 16:9\r\n    为基准，讨论了细长屏幕以及偏宽的屏幕的应用对方式。这样的解决方法不能算作是技术方案，更多的应该算是设计解决方案！</p>\r\n<p>\r\n    现实世界中，没有一种理论或方法永远有效的；就像手机屏幕有尺寸、纵横比总不会一致一样！在设计中，这些被称为设计限制因素。设计不是艺术创作，是在「指尖跳舞蹈」—\r\n    在多种限制因素下寻找平衡方案的游戏！</p>                                                                                    '),(27,'                                                                <p>\r\n    象棋游戏总是需要人和电脑之间进行对战的，毕竟象棋就是一种双向对抗游戏！一般来说，象棋人机对战需要实现一套人工智能的算法来为电脑侧的 NPC 提供着法选择。</p>\r\n<p>中国象棋当然需要人机对战，人和手机 AI 对战的部分，我们将在后续章节中详细介绍！</p>\r\n<p>\r\n    但在这之前，我们来点狠货 — 让人来挑战我们的云端服器 — 象棋云库。相对于普通人类玩家，象棋云库是强大的，它几乎是一个不可战胜的对手！</p>\r\n<p>\r\n    会有些复杂的工作，也没什么好担心的，直面挑战吧！</p>\r\n<h2>\r\n    本节概要</h2>\r\n<ul>\r\n    <li>象棋云库知识</li>\r\n    <li>象棋局面的 FEN 表示</li>\r\n    <li>引擎着法表示方式</li>\r\n    <li>封装云库引擎</li>\r\n    <li>实现与云库的人机对战</li>\r\n</ul>\r\n<h2>\r\n    象棋云库</h2>\r\n<p>\r\n    在人与云端主机的对战中，我们会用到<a href=\"https://www.chessdb.cn/\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">象棋云库</a>，它是是一个什么样的存在呢？\r\n</p>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); Helvetica Neue\" ,=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <p style=\"margin-bottom: 1.1em; font-size: 1em; line-height: 1.45; outline: 0px !important;\">\r\n        中国象棋云库（简称\"云库\"）是一个基于分布式计算和存储的中国象棋数据库，包含开局库和残局库。</p>\r\n    <p style=\"margin-bottom: 1.1em; font-size: 1em; line-height: 1.45; outline: 0px !important;\">\r\n        不同于传统的棋谱统计方式，云库使用软件对局面进行分析、拆解，克服了软件打分波动及由于搜索剪裁产生的象棋引擎盲区问题。</p>\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">\r\n        云库意在探索象棋开局知识的全新体系，通过学习对弈双方的着法并不断完善，目前已涵盖所有主流开局着法，并在实战中不断优化。</p>\r\n</blockquote>\r\n<p>\r\n    云库提供了一套<a href=\"https://www.chessdb.cn/cloudbook_api.html\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">&nbsp;API\r\n        接口</a>，用于查询某一局面下的优先着法，在开局阶段特别强大。</p>\r\n<p>\r\n    它提供了一套比较简单的 API，而我们将会用到只有其中用于局面查询的那么两三个接口！</p>\r\n<p>\r\n    用云库与人类玩家对战有利于锻炼玩家开局功底，快速提升棋力！</p>\r\n<p>\r\n    与云库对战的过程有几点需要大家先了解的信息：</p>\r\n<ul>\r\n    <li>我们按照棋软常用的局面表示方式（FEN）将局面传递给云库服务器，服务器分析局面返回推荐的着法。</li>\r\n    <li>云库收集的庞大开局库，如果我们当前的局面是云库熟悉的（不脱谱），那么服务器会瞬间返回推荐着法；</li>\r\n    <li>如果我们的局面比较特殊（已脱谱），云库会返回无最佳着法推荐；</li>\r\n    <li>对于云库没着法返回的情况，我们可以请求服务器对局面进行计算，云库服务器将使用知名象棋 AI 引擎 — 「旋风」引擎进行局面计算；</li>\r\n    <li>云库在后端计算局面的应用着法需要一些时间，我们可以等有结果后去查询此局面的推荐着法；</li>\r\n</ul>\r\n<p>\r\n    要实现人与云库对战，这是一个复杂的问题，我们可以把这个复杂的问题进行抽象：</p>\r\n<ul>\r\n    <li>对战需要两方，一方是云库引擎，一方是人类玩家</li>\r\n    <li>两方对战需要一个战场</li>\r\n    <li>对战需要一套规则</li>\r\n</ul>\r\n<p>\r\n    好的，暂时就这些了！我们先来实现对战的一方 — 云库引擎！</p>\r\n<h2 id=\"-2\">\r\n    封装象棋云库引擎</h2>\r\n<p>\r\n    我们建立 lib/engine 文件夹，然后在其下新建 chess-db.dart 文件，用这个类来代理与「象棋云库」的 http 通信工作：</p>\r\n<pre><code>import \'dart:convert\';\r\nimport \'dart:io\';\r\n\r\nclass ChessDB {\r\n  //\r\n  static const Host = \'www.chessdb.cn\'; // 云库服务器\r\n  static const Path = \'/chessdb.php\'; // API 路径\r\n\r\n  // 向云库查询最佳着法\r\n  static Future<string> query(String board) async {\r\n    //\r\n    Uri url = Uri(\r\n      scheme: \'http\',\r\n      host: Host,\r\n      path: Path,\r\n      queryParameters: {\r\n        \'action\': \'queryall\',\r\n        \'learn\': \'1\',\r\n        \'showall\': \'1\',\r\n        \'board\': board,\r\n      },\r\n    );\r\n\r\n    final httpClient = HttpClient();\r\n\r\n    try {\r\n      final request = await httpClient.getUrl(url);\r\n      final response = await request.close();\r\n      return await response.transform(utf8.decoder).join();\r\n      //\r\n    } catch (e) {\r\n      print(\'Error: $e\');\r\n    } finally {\r\n      httpClient.close();\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  // 请求云库在后台计算指定局面的最佳着法\r\n  static Future<string> requestComputeBackground(String board) async {\r\n    //\r\n    Uri url = Uri(\r\n      scheme: \'http\',\r\n      host: Host,\r\n      path: Path,\r\n      queryParameters: {\r\n        \'action\': \'queue\',\r\n        \'board\': board,\r\n      },\r\n    );\r\n\r\n    final httpClient = HttpClient();\r\n\r\n    try {\r\n      final request = await httpClient.getUrl(url);\r\n      final response = await request.close();\r\n      return await response.transform(utf8.decoder).join();\r\n      //\r\n    } catch (e) {\r\n      print(\'Error: $e\');\r\n    } finally {\r\n      httpClient.close();\r\n    }\r\n\r\n    return null;\r\n  }\r\n}\r\n</string></string></code>\r\n</pre>\r\n<p>\r\n    其实 ChessDb 类就是按照「象棋云库」提供的 API 文档，将局面的着法查询和请求后台计算包装成了两个方法。</p>\r\n<p>\r\n    云库查询 API 需要一个表示局面的 board 参数，要求我们按棋软的常规方式 — FEN 标记当前的局面。</p>\r\n<p>\r\n    关于象棋局面的 FEN 表示方式，请参考<a href=\"https://gitbook.cn/gitchat/column/5e9d67352b34772795873df4/topic/docs/FEN-%E5%B1%80%E9%9D%A2%E8%A1%A8%E7%A4%BA\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">这里</a>。\r\n</p>\r\n<p>\r\n    FEN 包含好几断内容，包括棋子分布、到谁走棋等，最后一段是「无吃子步数」和「总回合数」。要获取这两个数字，事情还得着落在 Phase 类身上，我们得在 Phase 的 move 方法被调用时，就记录一下无吃子步数和总回合数。\r\n</p>\r\n<p>\r\n    打开 Phase 类的实现文件，首先添加两个计数步数和回合数的变量：</p>\r\n<pre><code id=\"code-1\">// 无吃子步数、总回合数\r\nint halfMove = 0, fullMove = 0;\r\n</code></pre>\r\n<p>\r\n    接着，我们修改 Phase 的 move 方法，在修改棋子布局前添加步数和回合数的计数，修改后的 move 方法：</p>\r\n<pre><code id=\"code-2\">...\r\n\r\nclass Phase {\r\n\r\n  ...\r\n\r\n\r\n  bool move(int from, int to) {\r\n    //\r\n    if (!validateMove(from, to)) return false;\r\n\r\n    // 记录无吃子步数\r\n    if (_pieces[to] != Piece.Empty) {\r\n      halfMove = 0;\r\n    } else {\r\n      halfMove++;\r\n    }\r\n\r\n    // 和总回合数\r\n    if (fullMove == 0) {\r\n      fullMove++;\r\n    } else if (side == Side.Black) {\r\n      fullMove++;\r\n    }\r\n\r\n    // 修改棋盘\r\n    _pieces[to] = _pieces[from];\r\n    _pieces[from] = Piece.Empty;\r\n\r\n    // 交换走棋方\r\n    _side = Side.oppo(_side);\r\n\r\n    return true;\r\n  }\r\n\r\n  ...\r\n}\r\n</code></pre>\r\n<p>\r\n    然后，我们为 Phase 类添加 toFen 方法：</p>\r\n<pre><code id=\"code-3\">...\r\n\r\nclass Phase {\r\n\r\n  ...\r\n\r\n  // 根据局面数据生成局面表示字符串（FEN）\r\n  String toFen() {\r\n    //\r\n    var fen = \'\';\r\n\r\n    for (var row = 0; row &lt; 10; row++) {\r\n      //\r\n      var emptyCounter = 0;\r\n\r\n      for (var column = 0; column &lt; 9; column++) {\r\n        //\r\n        final piece = pieceAt(row * 9 + column);\r\n\r\n        if (piece == Piece.Empty) {\r\n          //\r\n          emptyCounter++;\r\n          //\r\n        } else {\r\n          //\r\n          if (emptyCounter &gt; 0) {\r\n            fen += emptyCounter.toString();\r\n            emptyCounter = 0;\r\n          }\r\n\r\n          fen += piece;\r\n        }\r\n      }\r\n\r\n      if (emptyCounter &gt; 0) fen += emptyCounter.toString();\r\n\r\n      if (row &lt; 9) fen += \'/\';\r\n    }\r\n\r\n    fen += \' $side\';\r\n\r\n    // 王车易位和吃过路兵标志\r\n    fen += \' - - \';\r\n\r\n    // step counter\r\n    fen += \'$halfMove $fullMove\';\r\n\r\n    return fen;\r\n  }\r\n\r\n  ...\r\n}\r\n</code></pre>\r\n<p>\r\n    好了，表示局面的 FEN 有了。</p>\r\n<p>\r\n    这会儿又有一个小问题出现了：引擎返回的招法用国际象棋 UCS 表示法，用 4 个字符表示一个着法，例如&nbsp;<code style=\" color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">b0c2</code>&nbsp;：\r\n</p>\r\n<p>\r\n    它的着法基于左下角坐标系，用 a ~ i 表示从左到右的 9 列，用 0 ~ 9 表示从下到上 10 行。因此&nbsp;<code style=\" color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">b0c2</code>&nbsp;表示<code style=\" color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">从第 2 列第 1 行移动到第 3 列第 3 行</code>。\r\n</p>\r\n<p>\r\n    之前我们都是用 from … to 这样来表示一个着法，现以我们新建一个类 Move，由它来表示和解释、转换一个招法。</p>\r\n<p>\r\n    打开 cc-base.dart，我们在文件尾部添加一个 Move 类的定义：</p>\r\n<pre><code id=\"code-7\">...\r\n\r\nclass Move {\r\n  //\r\n  static const InvalidIndex = -1;\r\n\r\n  // List<string>(90) 中的索引\r\n  int from, to;\r\n\r\n  // 左上角为坐标原点\r\n  int fx, fy, tx, ty;\r\n\r\n  String captured;\r\n\r\n  // \'step\' is the ucci engine\'s move-string\r\n  String step;\r\n\r\n  Move(this.from, this.to, {this.captured = Piece.Empty}) {\r\n    //\r\n    fx = from % 9;\r\n    fy = from ~/ 9;\r\n\r\n    tx = to % 9;\r\n    ty = to ~/ 9;\r\n\r\n    if (fx &lt; 0 || fx &gt; 8 || fy &lt; 0 || fy &gt; 9) {\r\n      throw \"Error: Invlid Step (from:$from, to:$to)\";\r\n    }\r\n\r\n    step = String.fromCharCode(\'a\'.codeUnitAt(0) + fx) + (9 - fy).toString();\r\n    step += String.fromCharCode(\'a\'.codeUnitAt(0) + tx) + (9 - ty).toString();\r\n  }\r\n\r\n  /// 引擎返回的招法用是 4 个字符表示的，例如 b0c2\r\n  /// 它的着法基于左下角坐标系\r\n  /// 用 a ~ i 表示从左到右的 9 列\r\n  /// 用 0 ~ 9 表示从下到上 10 行\r\n  /// 因此 b0c2 表示从第 2 列第 1 行移动到第 3 列第 3 行\r\n\r\n  Move.fromEngineStep(String step) {\r\n    //\r\n    this.step = step;\r\n\r\n    if (!validateEngineStep(step)) {\r\n      throw \"Error: Invlid Step: $step\";\r\n    }\r\n\r\n    fx = step[0].codeUnitAt(0) - \'a\'.codeUnitAt(0);\r\n    fy = 9 - (step[1].codeUnitAt(0) - \'0\'.codeUnitAt(0));\r\n    tx = step[2].codeUnitAt(0) - \'a\'.codeUnitAt(0);\r\n    ty = 9 - (step[3].codeUnitAt(0) - \'0\'.codeUnitAt(0));\r\n\r\n    from = fx + fy * 9;\r\n    to = tx + ty * 9;\r\n\r\n    captured = Piece.Empty;\r\n  }\r\n\r\n  // 验证引擎返回着法是否是合法的\r\n  static bool validateEngineStep(String step) {\r\n    //\r\n    if (step == null || step.length &lt; 4) return false;\r\n\r\n    final fx = step[0].codeUnitAt(0) - \'a\'.codeUnitAt(0);\r\n    final fy = 9 - (step[1].codeUnitAt(0) - \'0\'.codeUnitAt(0));\r\n    if (fx &lt; 0 || fx &gt; 8 || fy &lt; 0 || fy &gt; 9) return false;\r\n\r\n    final tx = step[2].codeUnitAt(0) - \'a\'.codeUnitAt(0);\r\n    final ty = 9 - (step[3].codeUnitAt(0) - \'0\'.codeUnitAt(0));\r\n    if (tx &lt; 0 || tx &gt; 8 || ty &lt; 0 || ty &gt; 9) return false;\r\n\r\n    return true;\r\n  }\r\n}\r\n</string></code></pre>\r\n<p>\r\n    发现一个小问题：在这之前，我们一直用&nbsp;<code style=\" color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">-1</code>&nbsp;来表示无效的棋盘上的索引值的，现在我们做个小重构，把代码中指示棋盘位置的所有&nbsp;<code style=\" color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">-1</code>&nbsp;都改成\r\n    Move.InvalidIndex，这样能减少魔术代码，提高代码的可读性。</p>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); Helvetica Neue\" ,=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">使用 vscode 的全局查找（默认快捷键为&nbsp;<code style=\" color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">Cmd+Shift+F</code>），在\r\n        PiecesPainter、Battle 和 BattlePage 类中都需要做替换，替换完成后别忘了导入 Move 所在的 cc-base.dar 文件。</p>\r\n</blockquote>\r\n<p>\r\n    接下来，我们基于 ChessDb 代理类来实现 CloudEngine 类，它是对云库引擎的封装类。我们在 lib/engine 文件夹下新建 cloud-engine.dart 文件：</p>\r\n<pre><code id=\"code-11\">import \'../cchess/cc-base.dart\';\r\nimport \'../cchess/phase.dart\';\r\nimport \'chess-db.dart\';\r\n\r\n/// 引擎查询结果包裹\r\n/// type 为 move 时表示正常结果反馈，value 用于携带结果值\r\n/// type 其它可能值至少包含：timeout / nobestmove / network-error / data-error\r\nclass EngineResponse {\r\n  final String type;\r\n  final dynamic value;\r\n  EngineResponse(this.type, {this.value});\r\n}\r\n\r\nclass CloudEngine {\r\n  /// 向云库查询某一个局面的最结着法\r\n  /// 如果一个局面云库没有遇到过，则请求云库后台计算，并等待云库的计算结果\r\n  Future<engineresponse> search(Phase phase, {bool byUser = true}) async {\r\n    //\r\n    final fen = phase.toFen();\r\n    var response = await ChessDB.query(fen);\r\n\r\n    // 发生网络错误，直接返回\r\n    if (response == null) return EngineResponse(\'network-error\');\r\n\r\n    if (!response.startsWith(\'move:\')) {\r\n      //\r\n      print(\'ChessDB.query: $response\\n\');\r\n      //\r\n    } else {\r\n      // 有着法列表返回\r\n      // move:b2a2,score:-236,rank:0,note:? (00-00),winrate:32.85\r\n      final firstStep = response.split(\'|\')[0];\r\n      print(\'ChessDB.query: $firstStep\');\r\n\r\n      final segments = firstStep.split(\',\');\r\n      if (segments.length &lt; 2) return EngineResponse(\'data-error\');\r\n\r\n      final move = segments[0], score = segments[1];\r\n\r\n      final scoreSegments = score.split(\':\');\r\n      if (scoreSegments.length &lt; 2) return EngineResponse(\'data-error\');\r\n\r\n      final moveWithScore = int.tryParse(scoreSegments[1]) != null;\r\n\r\n      // 存在有效着法\r\n      if (moveWithScore) {\r\n        //\r\n        final step = move.substring(5);\r\n\r\n        if (Move.validateEngineStep(step)) {\r\n          return EngineResponse(\r\n            \'move\',\r\n            value: Move.fromEngineStep(step),\r\n          );\r\n        }\r\n      } else {\r\n        // 云库没有遇到过这个局面，请求它执行后台计算\r\n        if (byUser) {\r\n          response = await ChessDB.requestComputeBackground(fen);\r\n          print(\'ChessDB.requestComputeBackground: $response\\n\');\r\n        }\r\n\r\n        // 这里每过2秒就查看它的计算结果\r\n        return Future<engineresponse>.delayed(\r\n          Duration(seconds: 2),\r\n          () =&gt; search(phase, byUser: false),\r\n        );\r\n      }\r\n    }\r\n\r\n    return EngineResponse(\'unknown-error\');\r\n  }\r\n}\r\n</engineresponse></engineresponse></code></pre>\r\n<p>\r\n    在 cloud-engine.dart 文件中，我们先定义了一个简单对象 EngineResponse，用于向引擎使用者提供友好的返回值。接着我们实现了 CloudEngine 类，目前它只有一个有效的方法 — search。\r\n</p>\r\n<p>\r\n    在 search 方法中，我们使用 ChessDb 代理类访问网络，获取云库服务器地当前棋局的着法反馈。</p>\r\n<p>\r\n    如果服务器返回了以「move」打头的文字，表示「云库」有着法返回给我们。</p>\r\n<p>\r\n    如果一个着法携带的「score」值是一个数值，我们认为这是一个有效着法，会包装成 EngineResponse 反馈给引擎的调用者。</p>\r\n<p>\r\n    如果一个着法携带的「score」非数值，则这个着法可能是小白用户提交的学习局面，证明云库对此局面没有预先进行过计算。我们应该被忽略小白招法，请求服务器在后台对此局面使用旋风引擎进行计算，然后我们每过 2\r\n    秒种来查询一次引擎的计算结果是否就绪。</p>\r\n<p>\r\n    引擎还会遇到超时、出错等情况，我们统一出错处理就行了。</p>\r\n<p>\r\n    引擎这边就绪了！现在我们来使用引擎，让它与人对战！</p>\r\n<h2 id=\"-3\">\r\n    使用云库引擎</h2>\r\n<p>\r\n    为了展示对战后台的状态（例如引擎的工作状态），我们在 _BattlePageState 类中添加一个 status 字段，并添加修改此状态的方法：</p>\r\n<pre><code id=\"code-12\">class _BattlePageState extends State<battlepage> {\r\n  //\r\n  String _status = \'\';\r\n\r\n  ...\r\n\r\n  changeStatus(String status) =&gt; setState(() =&gt; _status = status);\r\n\r\n  ...\r\n}\r\n</battlepage></code></pre>\r\n<p>\r\n    这个状态将显示在 BattlePage 的标题之下，目前放了一个固定的字符串 \'[游戏状态]\' 的位置。</p>\r\n<p>\r\n    我们现在要呈现 _status 变量，在 _BattlePageState 类的 createPageHeader 方法中找到以下的代码：</p>\r\n<pre><code id=\"code-13\">child: Text(\'[游戏状态]\', maxLines: 1, style: subTitleStyle),\r\n</code></pre>\r\n<p>\r\n    将它修改成下边的样子：</p>\r\n<pre><code id=\"code-14\">child: Text(_status, maxLines: 1, style: subTitleStyle),\r\n</code></pre>\r\n<p>\r\n    这样，当 _status 被修改后调用 setState，游戏的工作状态将显示在标题之下。</p>\r\n<p>\r\n    象棋对战过程中，两方交替行棋的，直至游戏分出胜负结果。意思是说，没有没有分出胜负之前，游戏双方才交替走棋。为此，我们在 cc-base.dart 文件中添加一个代表对战结果的枚举类型 BattleResult：</p>\r\n<pre><code id=\"code-15\">/// 对战结果：未决、赢、输、和\r\nenum BattleResult { Pending, Win, Lose, Draw }\r\n</code></pre>\r\n<p>\r\n    在 Battle 类中，我们添加一个 scanBattleResult 方法：</p>\r\n<pre><code id=\"code-16\">BattleResult scanBattleResult() {\r\n  // TODO:\r\n  return BattleResult.Pending;\r\n}\r\n</code></pre>\r\n<p>\r\n    这个方法现在先简单地返回对战结果为「未决」。</p>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); Helvetica Neue\" ,=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">真正的象棋对战结果扫描是一件大工程，我们后续文章中再详情说明。</p>\r\n</blockquote>\r\n<p>\r\n    为了驱动引擎走棋，我们在 _BattlePageState 中添加 engineToGo 方法：</p>\r\n<pre><code id=\"code-17\">  engineToGo() async {\r\n    //\r\n    changeStatus(\'对方思考中...\');\r\n\r\n    final response = await CloudEngine().search(Battle.shared.phase);\r\n\r\n    // 引擎返回\'move\'表示有最佳着法可用\r\n    if (response.type == \'move\') {\r\n      //\r\n      final step = response.value;\r\n      Battle.shared.move(step.from, step.to);\r\n\r\n      final result = Battle.shared.scanBattleResult();\r\n\r\n      switch (result) {\r\n        case BattleResult.Pending:\r\n          changeStatus(\'请走棋...\');\r\n          break;\r\n        case BattleResult.Win:\r\n          // todo:\r\n          break;\r\n        case BattleResult.Lose:\r\n          // todo:\r\n          break;\r\n        case BattleResult.Draw:\r\n          // todo:\r\n          break;\r\n      }\r\n      //\r\n    } else {\r\n      //\r\n      changeStatus(\'Error: ${response.type}\');\r\n    }\r\n  }\r\n</code></pre>\r\n<p>\r\n    我们修改 _BattlePageState 的 onBoardTap 方法驱动引擎思考，先找到以下代码：</p>\r\n<pre><code id=\"code-18\">if (Battle.shared.move(Battle.shared.focusIndex, index)) {\r\n  // todo: scan result\r\n}\r\n</code></pre>\r\n<p>\r\n    将它修改为下这的样子：</p>\r\n<pre><code id=\"code-19\">if (Battle.shared.move(Battle.shared.focusIndex, index)) {\r\n  //\r\n  final result = Battle.shared.scanBattleResult();\r\n\r\n  switch (result) {\r\n    case BattleResult.Pending:\r\n      // 玩家走一步棋后，如果游戏还没有结束，则启动引擎走棋\r\n      engineToGo();\r\n      break;\r\n    case BattleResult.Win:\r\n      break;\r\n    case BattleResult.Lose:\r\n      break;\r\n    case BattleResult.Draw:\r\n      break;\r\n  }\r\n}\r\n</code></pre>\r\n<p>\r\n    这到里，可以感受一下我们的开发成果了！在 vscode 中按&nbsp;<code style=\" color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">F5</code>&nbsp;运行产品，试试走几步棋，领略一下云库引擎的高明招法：\r\n</p>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/JTfquJ.gif\" alt=\"与云端主机对战\" style=\"max-width: 100%; outline: 0px !important;\"></p>\r\n<p>\r\n    你已经实现了能人机对战的象棋游戏，而且此游戏的棋力可以秒杀绝大多数的人类棋手！</p>\r\n<p>\r\n    但我们知道，目前还有很多的细节有待完善，比如，你可以拿着棋子乱走一通，完全不管什么规则……</p>\r\n<p>\r\n    将代码提交到 git 仓库，这一节的任务到此完成！</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'使用象棋云库\'\r\n[master 18c7e5e] 使用象棋云库\r\n 6 files changed, 315 insertions(+), 4 deletions(-)\r\n create mode 100644 lib/engine/chess-db.dart\r\n create mode 100644 lib/engine/cloud-engine.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 22, 完成.\r\n对象计数中: 100% (22/22), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (12/12), 完成.\r\n写入对象中: 100% (13/13), 5.51 KiB | 2.75 MiB/s, 完成.\r\n总共 13 （差异 4），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 27.47.4.14 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-08-28 01:49:13 (UTC), debug id 81af08.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   d55e6ca..18c7e5e  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$\r\n</code>\r\n</pre>\r\n<h2 id=\"-4\">\r\n    小节回顾</h2>\r\n<p>\r\n    本小节首先介绍了象棋云库，以及云库提供的 API 接口。为了使用云库 API，我们接着在 Phase 类中实现了将局面转换为 FEN 局面表示字符串的方法。为了能理解云库返回的着法，我们实现了对引擎着法 ICCS 的解析。</p>\r\n<p>\r\n    完成这些工作后，我们封装了云库提供的部分 API 接口，涉及到 Dart 的 html 类的一些基本使用。</p>\r\n<p>\r\n    最后，也是最复杂的一个过程，我们实现了对战局结果的表示，并在玩家移动棋子后调用云库引擎与玩家交替走子。这样就具体了人机对战的交替行棋的基本特征。</p>\r\n<p>\r\n    到此，我们有一个可以对战的象棋游戏了！</p>                                                        '),(28,'                                                                                                                                <p>\r\n    到现在为止，我们的象棋游戏能支持玩家与云库引擎正常地交替下棋了！但现在的游戏没有细致的规则限制，玩家可以不按照中国象棋的规则行棋。本节我们需要限制用户的行棋动作，遵循象棋游戏的通用规则。</p>\r\n<h2 id=\"\">\r\n    本节概要</h2>\r\n<ul>\r\n    <li>中国象棋游戏规范介绍</li>\r\n    <li>实现可行着法枚举工具类</li>\r\n    <li>实现着法合法性检查工具类</li>\r\n    <li>应用着法合法性检查</li>\r\n</ul>\r\n<h2 id=\"-1\">\r\n    中国象棋游戏规范</h2>\r\n<p>\r\n    <a href=\"https://gitbook.cn/gitchat/column/5e9d67352b34772795873df4/topic/docs/%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B%E6%B8%B8%E6%88%8F%E8%A7%84%E8%8C%83\">中国象棋游戏规范</a>\r\n</p>\r\n<p>\r\n    知道大家都不爱看文档，所以我简单地把行棋的规则和一般的输赢判断规则列举一下。</p>\r\n<p>\r\n    着法合法性检查规则：</p>\r\n<ul>\r\n    <li>车走直线、马踩日，炮打翻山、象飞田，兵卒过河左右走，仕象不离老将边；</li>\r\n    <li>行棋着法不能吃已方棋子；</li>\r\n    <li>车只能在一条线上走子，直到遇到第一个障碍棋子，如果棋子是敌方的，可以吃掉它；</li>\r\n    <li>马走一个日字，但有「蹩腿」的行动限制；</li>\r\n    <li>象走一个田字，不能过河界，且有被「填心」的行动限制；</li>\r\n    <li>炮可以在一条直线上走子，直至遇到第一个障碍棋子，如果越过障碍棋子后在直线上遇到的第一个棋子是敌方棋子，可以吃掉它；</li>\r\n    <li>兵卒在冲过对方的河界之前，只能一次向前行走一步，过了敌方河界以后，可以向前方或左右方向行走一步；</li>\r\n    <li>一步着法过后，不能造成双方的老将对面，即两方老将都在同一列，且中间无格挡棋子；</li>\r\n</ul>\r\n<p>\r\n    胜负检查判定方法：</p>\r\n<ul>\r\n    <li>如果无论已方走什么可行着法都无法解除对方下一步对已方老将的攻击，则表示已方已经输了；</li>\r\n    <li>如果对方行棋后，已方无合法的着法可走，则表示已方已经输了；</li>\r\n    <li>如果一方在进棋过程中反复捉对方的将或大子，造成了三次以上的连续重复局面，则判长捉和长将方为负；</li>\r\n    <li>如果超过 60 个回合无吃子，则判和棋；</li>\r\n</ul>\r\n<h2 id=\"-2\">\r\n    准备工作</h2>\r\n<p>\r\n    为了实现中国象棋游戏的规则检查，我们有些准备工作要先做一下：</p>\r\n<p>\r\n    第一件事，我们要增强一下 dart 的基本算法方法集，建立一个自己的 math-ex 工具集。我们在 lib/common 文件夹下新建一个 math-ext.dart 文件，实现两个方法：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-0\">abs(value) =&gt; value &gt; 0 ? value : -value;\r\n\r\n// 二分查找，没有找到 dart 的标准库的实现，就自己实现一个了\r\nint binarySearch(List<int> array, int start, int end, int key) {\r\n  //\r\n  if (start &gt; end) return -1;\r\n\r\n  if (array[start] == key) return start;\r\n  if (array[end] == key) return end;\r\n\r\n  final middle = start + (end - start) ~/ 2;\r\n  if (array[middle] == key) return middle;\r\n\r\n  if (key &lt; array[middle]) {\r\n    return binarySearch(array, start + 1, middle - 1, key);\r\n  }\r\n\r\n  return binarySearch(array, middle + 1, end - 1, key);\r\n}\r\n</int></code></pre>\r\n<p>\r\n    第二件事，在进行着法检查的过程中，我们时常要假定这步棋已经走出，再看局面是否是合法的，例如会不会千万老将会面，会不会千万自己的老将可能被对方直接攻击。这些尝试操作需要改动棋子的位置布署，所以我们希望在一个 clone\r\n    的临时棋盘上进行这种验证操作。</p>\r\n<p>\r\n    在 Phase 类中，我们添加一个名叫 clone 的构造方法，它可以基于现有 Phase 对象克隆一个相同的临时 Phase 对象：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-1\">// 克隆一个一模一样的 phase 对象，修改其内容时不影响原来的 Phase 对象\r\nPhase.clone(Phase other) {\r\n  //\r\n  _pieces = List<string>();\r\n\r\n  other._pieces.forEach((piece) =&gt; _pieces.add(piece));\r\n\r\n  _side = other._side;\r\n\r\n  halfMove = other.halfMove;\r\n  fullMove = other.fullMove;\r\n}\r\n</string></code></pre>\r\n<p>\r\n    此外，我们还需要给 Phase 类添加一个 testMove 的方法，规则检查时会做假设性行棋，然后判断局面是否会有老将对面等 Case，直接改动棋子分布数组而不用关心招法的合法性：</p>\r\n<blockquote>\r\n    <p>这件事不能直接调用 Phase 的 move 方法，move\r\n        方法中会进行着法合法性检查，如果假设性行棋调用合法性检测，这就陷入了逻辑循环。</p>\r\n</blockquote>\r\n<pre><code class=\"dart language-dart\" id=\"code-2\">  // 在判断行棋合法性等环节，要在克隆的棋盘上进行行棋假设，然后检查效果\r\n  // 这种情况下不验证、不记录、不翻译\r\n  void moveTest(Move move, {turnSide = false}) {\r\n    // 修改棋盘\r\n    _pieces[move.to] = _pieces[move.from];\r\n    _pieces[move.from] = Piece.Empty;\r\n\r\n    // 交换走棋方\r\n    if (turnSide) _side = Side.oppo(_side);\r\n  }\r\n</code></pre>\r\n<p>\r\n    准备工作完成了，我们来检查玩家的着法合法性！</p>\r\n<h2 id=\"-3\">\r\n    着法合法性检查</h2>\r\n<p>\r\n    深呼吸一轮，我们要开始飘过一片逻辑海洋！</p>\r\n<p>\r\n    我们在 lib/cchess 文件夹下新建 steps-enum.dart，这个类里面放置着法枚举工具类 StepsEnumerator 的实现：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-3\">import \'../common/math.ext.dart\';\r\nimport \'cc-base.dart\';\r\nimport \'phase.dart\';\r\n\r\n// 枚举当前局面下所有合符象棋规则的着法\r\nclass StepsEnumerator {\r\n  //\r\n  static List<move> enumSteps(Phase phase) {\r\n    //\r\n    final steps = <move>[];\r\n\r\n    for (var row = 0; row &lt; 10; row++) {\r\n      //\r\n      for (var col = 0; col &lt; 9; col++) {\r\n        //\r\n        final from = row * 9 + col;\r\n        final piece = phase.pieceAt(from);\r\n\r\n        if (Side.of(piece) != phase.side) continue;\r\n\r\n        var pieceSteps;\r\n\r\n        if (piece == Piece.RedKing || piece == Piece.BlackKing) { // 将的着法\r\n          pieceSteps = enumKingSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedAdvisor || piece == Piece.BlackAdvisor) { // 仕的着法\r\n          pieceSteps = enumAdvisorSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedBishop || piece == Piece.BlackBishop) { // 象的着法\r\n          pieceSteps = enumBishopSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedKnight || piece == Piece.BlackKnight) { // 马的着法\r\n          pieceSteps = enumKnightSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedRook || piece == Piece.BlackRook) { // 车的着法\r\n          pieceSteps = enumRookSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedCanon || piece == Piece.BlackCanon) { // 炮的着法\r\n          pieceSteps = enumCanonSteps(phase, row, col, from);\r\n        } else if (piece == Piece.RedPawn || piece == Piece.BlackPawn) { // 兵的着法\r\n          pieceSteps = enumPawnSteps(phase, row, col, from);\r\n        } else {\r\n          continue;\r\n        }\r\n\r\n        steps.addAll(pieceSteps);\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 将的着法枚举\r\n  static List<move> enumKingSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final offsetList = [\r\n      [-1, 0],\r\n      [0, -1],\r\n      [1, 0],\r\n      [0, 1]\r\n    ];\r\n\r\n    final redRange = [66, 67, 68, 75, 76, 77, 84, 85, 86];\r\n    final blackRange = [3, 4, 5, 12, 13, 14, 21, 22, 23];\r\n    final range = (phase.side == Side.Red ? redRange : blackRange);\r\n\r\n    final steps = <move>[];\r\n\r\n    for (var i = 0; i &lt; 4; i++) {\r\n      //\r\n      final offset = offsetList[i];\r\n      final to = (row + offset[0]) * 9 + col + offset[1];\r\n\r\n      if (!posOnBoard(to) || Side.of(phase.pieceAt(to)) == phase.side) {\r\n        continue;\r\n      }\r\n\r\n      if (binarySearch(range, 0, range.length - 1, to) &gt; -1) {\r\n        steps.add(Move(from, to));\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 士的着法枚举\r\n  static List<move> enumAdvisorSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final offsetList = [\r\n      [-1, -1],\r\n      [1, -1],\r\n      [-1, 1],\r\n      [1, 1]\r\n    ];\r\n\r\n    final redRange = [66, 68, 76, 84, 86];\r\n    final blackRange = [3, 5, 13, 21, 23];\r\n    final range = phase.side == Side.Red ? redRange : blackRange;\r\n\r\n    final steps = <move>[];\r\n\r\n    for (var i = 0; i &lt; 4; i++) {\r\n      //\r\n      final offset = offsetList[i];\r\n      final to = (row + offset[0]) * 9 + col + offset[1];\r\n\r\n      if (!posOnBoard(to) || Side.of(phase.pieceAt(to)) == phase.side) {\r\n        continue;\r\n      }\r\n\r\n      if (binarySearch(range, 0, range.length - 1, to) &gt; -1) {\r\n        steps.add(Move(from, to));\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 象的着法枚举\r\n  static List<move> enumBishopSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final heartOffsetList = [\r\n      [-1, -1],\r\n      [1, -1],\r\n      [-1, 1],\r\n      [1, 1]\r\n    ];\r\n\r\n    final offsetList = [\r\n      [-2, -2],\r\n      [2, -2],\r\n      [-2, 2],\r\n      [2, 2]\r\n    ];\r\n\r\n    final redRange = [47, 51, 63, 67, 71, 83, 87];\r\n    final blackRange = [2, 6, 18, 22, 26, 38, 42];\r\n    final range = phase.side == Side.Red ? redRange : blackRange;\r\n\r\n    final steps = <move>[];\r\n\r\n    for (var i = 0; i &lt; 4; i++) {\r\n      //\r\n      final heartOffset = heartOffsetList[i];\r\n      final heart = (row + heartOffset[0]) * 9 + (col + heartOffset[1]);\r\n\r\n      if (!posOnBoard(heart) || phase.pieceAt(heart) != Piece.Empty) {\r\n        continue;\r\n      }\r\n\r\n      final offset = offsetList[i];\r\n      final to = (row + offset[0]) * 9 + (col + offset[1]);\r\n\r\n      if (!posOnBoard(to) || Side.of(phase.pieceAt(to)) == phase.side) {\r\n        continue;\r\n      }\r\n\r\n      if (binarySearch(range, 0, range.length - 1, to) &gt; -1) {\r\n        steps.add(Move(from, to));\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 马的着法枚举\r\n  static List<move> enumKnightSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final offsetList = [\r\n      [-2, -1],\r\n      [-1, -2],\r\n      [1, -2],\r\n      [2, -1],\r\n      [2, 1],\r\n      [1, 2],\r\n      [-1, 2],\r\n      [-2, 1]\r\n    ];\r\n    final footOffsetList = [\r\n      [-1, 0],\r\n      [0, -1],\r\n      [0, -1],\r\n      [1, 0],\r\n      [1, 0],\r\n      [0, 1],\r\n      [0, 1],\r\n      [-1, 0]\r\n    ];\r\n\r\n    final steps = <move>[];\r\n\r\n    for (var i = 0; i &lt; 8; i++) {\r\n      //\r\n      final offset = offsetList[i];\r\n      final nr = row + offset[0], nc = col + offset[1];\r\n\r\n      if (nr &lt; 0 || nr &gt; 9 || nc &lt; 0 || nc &gt; 9) continue;\r\n\r\n      final to = nr * 9 + nc;\r\n      if (!posOnBoard(to) || Side.of(phase.pieceAt(to)) == phase.side) {\r\n        continue;\r\n      }\r\n\r\n      final footOffset = footOffsetList[i];\r\n      final fr = row + footOffset[0], fc = col + footOffset[1];\r\n      final foot = fr * 9 + fc;\r\n\r\n      if (!posOnBoard(foot) || phase.pieceAt(foot) != Piece.Empty) {\r\n        continue;\r\n      }\r\n\r\n      steps.add(Move(from, to));\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 车的着法枚举\r\n  static List<move> enumRookSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final steps = <move>[];\r\n\r\n    // to left\r\n    for (var c = col - 1; c &gt;= 0; c--) {\r\n      final to = row * 9 + c;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (target == Piece.Empty) {\r\n        steps.add(Move(from, to));\r\n      } else {\r\n        if (Side.of(target) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n        break;\r\n      }\r\n    }\r\n\r\n    // to top\r\n    for (var r = row - 1; r &gt;= 0; r--) {\r\n      final to = r * 9 + col;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (target == Piece.Empty) {\r\n        steps.add(Move(from, to));\r\n      } else {\r\n        if (Side.of(target) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n        break;\r\n      }\r\n    }\r\n\r\n    // to right\r\n    for (var c = col + 1; c &lt; 9; c++) {\r\n      final to = row * 9 + c;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (target == Piece.Empty) {\r\n        steps.add(Move(from, to));\r\n      } else {\r\n        if (Side.of(target) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n        break;\r\n      }\r\n    }\r\n\r\n    // to down\r\n    for (var r = row + 1; r &lt; 10; r++) {\r\n      final to = r * 9 + col;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (target == Piece.Empty) {\r\n        steps.add(Move(from, to));\r\n      } else {\r\n        if (Side.of(target) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n        break;\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 炮的着法枚举\r\n  static List<move> enumCanonSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    final steps = <move>[];\r\n    // to left\r\n    var overPiece = false;\r\n\r\n    for (var c = col - 1; c &gt;= 0; c--) {\r\n      final to = row * 9 + c;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (!overPiece) {\r\n        if (target == Piece.Empty) {\r\n          steps.add(Move(from, to));\r\n        } else {\r\n          overPiece = true;\r\n        }\r\n      } else {\r\n        if (target != Piece.Empty) {\r\n          if (Side.of(target) != phase.side) {\r\n            steps.add(Move(from, to));\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // to top\r\n    overPiece = false;\r\n\r\n    for (var r = row - 1; r &gt;= 0; r--) {\r\n      final to = r * 9 + col;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (!overPiece) {\r\n        if (target == Piece.Empty) {\r\n          steps.add(Move(from, to));\r\n        } else {\r\n          overPiece = true;\r\n        }\r\n      } else {\r\n        if (target != Piece.Empty) {\r\n          if (Side.of(target) != phase.side) {\r\n            steps.add(Move(from, to));\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // to right\r\n    overPiece = false;\r\n\r\n    for (var c = col + 1; c &lt; 9; c++) {\r\n      final to = row * 9 + c;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (!overPiece) {\r\n        if (target == Piece.Empty) {\r\n          steps.add(Move(from, to));\r\n        } else {\r\n          overPiece = true;\r\n        }\r\n      } else {\r\n        if (target != Piece.Empty) {\r\n          if (Side.of(target) != phase.side) {\r\n            steps.add(Move(from, to));\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    // to bottom\r\n    overPiece = false;\r\n\r\n    for (var r = row + 1; r &lt; 10; r++) {\r\n      final to = r * 9 + col;\r\n      final target = phase.pieceAt(to);\r\n\r\n      if (!overPiece) {\r\n        if (target == Piece.Empty) {\r\n          steps.add(Move(from, to));\r\n        } else {\r\n          overPiece = true;\r\n        }\r\n      } else {\r\n        if (target != Piece.Empty) {\r\n          if (Side.of(target) != phase.side) {\r\n            steps.add(Move(from, to));\r\n          }\r\n          break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  // 兵的着法枚举\r\n  static List<move> enumPawnSteps(\r\n    Phase phase, int row, int col, int from) {\r\n    //\r\n    var to = (row + (phase.side == Side.Red ? -1 : 1)) * 9 + col;\r\n\r\n    final steps = <move>[];\r\n\r\n    if (posOnBoard(to) &amp;&amp; Side.of(phase.pieceAt(to)) != phase.side) {\r\n      steps.add(Move(from, to));\r\n    }\r\n\r\n    if ((phase.side == Side.Red &amp;&amp; row &lt; 5) || (phase.side == Side.Black &amp;&amp; row &gt; 4)) {\r\n      //\r\n      if (col &gt; 0) {\r\n        to = row * 9 + col - 1;\r\n        if (posOnBoard(to) &amp;&amp; Side.of(phase.pieceAt(to)) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n      }\r\n\r\n      if (col &lt; 8) {\r\n        to = row * 9 + col + 1;\r\n        if (posOnBoard(to) &amp;&amp; Side.of(phase.pieceAt(to)) != phase.side) {\r\n          steps.add(Move(from, to));\r\n        }\r\n      }\r\n    }\r\n\r\n    return steps;\r\n  }\r\n\r\n  static posOnBoard(int pos) =&gt; pos &gt; -1 &amp;&amp; pos &lt; 90;\r\n}\r\n</move></move></move></move></move></move></move></move></move></move></move></move></move></move></move></move></code></pre>\r\n<p>\r\n    这是一个很长的工具，应用它可以列举当前局面下，行棋方可能走的全部着法，但不包含避免老将对面、避免行棋后对方可以直接攻击已方老将等逻辑。</p>\r\n<p>\r\n    接着，我们在 lib/cchess 文件夹下新建 steps-validate.dart 文件，将在这个工具类中放置某一着法是否合法的检查逻辑：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-4\">import \'../common/math.ext.dart\';\r\nimport \'cc-base.dart\';\r\nimport \'cc-rules.dart\'\r\nimport \'phase.dart\';\r\n\r\n// 着法合法性验证\r\nclass StepValidate {\r\n  //\r\n  static bool validate(Phase phase, Move move) {\r\n    //\r\n    if (Side.of(phase.pieceAt(move.to)) == phase.side) return false;\r\n\r\n    final piece = phase.pieceAt(move.from);\r\n\r\n    var valid = false;\r\n\r\n    if (piece == Piece.RedKing || piece == Piece.BlackKing) { // 将\r\n      valid = validateKingStep(phase, move);\r\n    } else if (piece == Piece.RedAdvisor || piece == Piece.BlackAdvisor) { // 仕\r\n      valid = validateAdvisorStep(phase, move);\r\n    } else if (piece == Piece.RedBishop || piece == Piece.BlackBishop) { // 象\r\n      valid = validateBishopStep(phase, move);\r\n    } else if (piece == Piece.RedKnight || piece == Piece.BlackKnight) { // 马\r\n      valid = validateKnightStep(phase, move);\r\n    } else if (piece == Piece.RedRook || piece == Piece.BlackRook) { // 车\r\n      valid = validateRookStep(phase, move);\r\n    } else if (piece == Piece.RedCanon || piece == Piece.BlackCanon) { // 炮\r\n      valid = validateCanonStep(phase, move);\r\n    } else if (piece == Piece.RedPawn || piece == Piece.BlackPawn) { // 兵\r\n      valid = validatePawnStep(phase, move);\r\n    }\r\n\r\n    if (!valid) return false;\r\n\r\n    if (ChessRules.willBeChecked(phase, move)) return false;\r\n\r\n    if (ChessRules.willKingsMeeting(phase, move)) return false;\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validateKingStep(Phase phase, Move move) {\r\n    //\r\n    final adx = abs(move.tx - move.fx), ady = abs(move.ty - move.fy);\r\n\r\n    final isUpDownMove = (adx == 0 &amp;&amp; ady == 1);\r\n    final isLeftRightMove = (adx == 1 &amp;&amp; ady == 0);\r\n\r\n    if (!isUpDownMove &amp;&amp; !isLeftRightMove) return false;\r\n\r\n    final redRange = [66, 67, 68, 75, 76, 77, 84, 85, 86];\r\n    final blackRange = [3, 4, 5, 12, 13, 14, 21, 22, 23];\r\n    final range = (phase.side == Side.Red) ? redRange : blackRange;\r\n\r\n    return binarySearch(range, 0, range.length - 1, move.to) &gt;= 0;\r\n  }\r\n\r\n  static bool validateAdvisorStep(Phase phase, Move move) {\r\n    //\r\n    final adx = abs(move.tx - move.fx), ady = abs(move.ty - move.fy);\r\n\r\n    if (adx != 1 || ady != 1) return false;\r\n\r\n    final redRange = [66, 68, 76, 84, 86], blackRange = [3, 5, 13, 21, 23];\r\n    final range = (phase.side == Side.Red) ? redRange : blackRange;\r\n\r\n    return binarySearch(range, 0, range.length - 1, move.to) &gt;= 0;\r\n  }\r\n\r\n  static bool validateBishopStep(Phase phase, Move move) {\r\n    //\r\n    final adx = abs(move.tx - move.fx), ady = abs(move.ty - move.fy);\r\n\r\n    if (adx != 2 || ady != 2) return false;\r\n\r\n    final redRange = [47, 51, 63, 67, 71, 83, 87], blackRange = [2, 6, 18, 22, 26, 38, 42];\r\n    final range = (phase.side == Side.Red) ? redRange : blackRange;\r\n\r\n    if (binarySearch(range, 0, range.length - 1, move.to) &lt; 0) return false;\r\n\r\n    if (move.tx &gt; move.fx) {\r\n      if (move.ty &gt; move.fy) {\r\n        final heart = (move.fy + 1) * 9 + move.fx + 1;\r\n        if (phase.pieceAt(heart) != Piece.Empty) return false;\r\n      } else {\r\n        final heart = (move.fy - 1) * 9 + move.fx + 1;\r\n        if (phase.pieceAt(heart) != Piece.Empty) return false;\r\n      }\r\n    } else {\r\n      if (move.ty &gt; move.fy) {\r\n        final heart = (move.fy + 1) * 9 + move.fx - 1;\r\n        if (phase.pieceAt(heart) != Piece.Empty) return false;\r\n      } else {\r\n        final heart = (move.fy - 1) * 9 + move.fx - 1;\r\n        if (phase.pieceAt(heart) != Piece.Empty) return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validateKnightStep(Phase phase, Move move) {\r\n    //\r\n    final dx = move.tx - move.fx, dy = move.ty - move.fy;\r\n    final adx = abs(dx), ady = abs(dy);\r\n\r\n    if (!(adx == 1 &amp;&amp; ady == 2) &amp;&amp; !(adx == 2 &amp;&amp; ady == 1)) return false;\r\n\r\n    if (adx &gt; ady) {\r\n      if (dx &gt; 0) {\r\n        final foot = move.fy * 9 + move.fx + 1;\r\n        if (phase.pieceAt(foot) != Piece.Empty) return false;\r\n      } else {\r\n        final foot = move.fy * 9 + move.fx - 1;\r\n        if (phase.pieceAt(foot) != Piece.Empty) return false;\r\n      }\r\n    } else {\r\n      if (dy &gt; 0) {\r\n        final foot = (move.fy + 1) * 9 + move.fx;\r\n        if (phase.pieceAt(foot) != Piece.Empty) return false;\r\n      } else {\r\n        final foot = (move.fy - 1) * 9 + move.fx;\r\n        if (phase.pieceAt(foot) != Piece.Empty) return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validateRookStep(Phase phase, Move move) {\r\n    //\r\n    final dx = move.tx - move.fx, dy = move.ty - move.fy;\r\n\r\n    if (dx != 0 &amp;&amp; dy != 0) return false;\r\n\r\n    if (dy == 0) {\r\n      if (dx &lt; 0) {\r\n        for (int i = move.fx - 1; i &gt; move.tx; i--) {\r\n          if (phase.pieceAt(move.fy * 9 + i) != Piece.Empty) return false;\r\n        }\r\n      } else {\r\n        for (int i = move.fx + 1; i &lt; move.tx; i++) {\r\n          if (phase.pieceAt(move.fy * 9 + i) != Piece.Empty) return false;\r\n        }\r\n      }\r\n    } else {\r\n      if (dy &lt; 0) {\r\n        for (int i = move.fy - 1; i &gt; move.ty; i--) {\r\n          if (phase.pieceAt(i * 9 + move.fx) != Piece.Empty) return false;\r\n        }\r\n      } else {\r\n        for (int i = move.fy + 1; i &lt; move.ty; i++) {\r\n          if (phase.pieceAt(i * 9 + move.fx) != Piece.Empty) return false;\r\n        }\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validateCanonStep(Phase phase, Move move) {\r\n    //\r\n    final dx = move.tx - move.fx, dy = move.ty - move.fy;\r\n\r\n    if (dx != 0 &amp;&amp; dy != 0) return false;\r\n\r\n    if (dy == 0) {\r\n      //\r\n      if (dx &lt; 0) {\r\n        //\r\n        var overPiece = false;\r\n\r\n        for (int i = move.fx - 1; i &gt; move.tx; i--) {\r\n          //\r\n          if (phase.pieceAt(move.fy * 9 + i) != Piece.Empty) {\r\n            //\r\n            if (overPiece) return false;\r\n\r\n            if (phase.pieceAt(move.to) == Piece.Empty) return false;\r\n            overPiece = true;\r\n          }\r\n        }\r\n\r\n        if (!overPiece &amp;&amp; phase.pieceAt(move.to) != Piece.Empty) return false;\r\n        //\r\n      } else {\r\n        //\r\n        var overPiece = false;\r\n\r\n        for (int i = move.fx + 1; i &lt; move.tx; i++) {\r\n          //\r\n          if (phase.pieceAt(move.fy * 9 + i) != Piece.Empty) {\r\n            //\r\n            if (overPiece) return false;\r\n\r\n            if (phase.pieceAt(move.to) == Piece.Empty) return false;\r\n            overPiece = true;\r\n          }\r\n        }\r\n\r\n        if (!overPiece &amp;&amp; phase.pieceAt(move.to) != Piece.Empty) return false;\r\n      }\r\n    } else {\r\n      //\r\n      if (dy &lt; 0) {\r\n        //\r\n        var overPiece = false;\r\n\r\n        for (int i = move.fy - 1; i &gt; move.ty; i--) {\r\n          //\r\n          if (phase.pieceAt(i * 9 + move.fx) != Piece.Empty) {\r\n            //\r\n            if (overPiece) return false;\r\n\r\n            if (phase.pieceAt(move.to) == Piece.Empty) return false;\r\n            overPiece = true;\r\n          }\r\n        }\r\n\r\n        if (!overPiece &amp;&amp; phase.pieceAt(move.to) != Piece.Empty) return false;\r\n        //\r\n      } else {\r\n        //\r\n        var overPiece = false;\r\n\r\n        for (int i = move.fy + 1; i &lt; move.ty; i++) {\r\n          //\r\n          if (phase.pieceAt(i * 9 + move.fx) != Piece.Empty) {\r\n            //\r\n            if (overPiece) return false;\r\n\r\n            if (phase.pieceAt(move.to) == Piece.Empty) return false;\r\n            overPiece = true;\r\n          }\r\n        }\r\n\r\n        if (!overPiece &amp;&amp; phase.pieceAt(move.to) != Piece.Empty) return false;\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  static bool validatePawnStep(Phase phase, Move move) {\r\n    //\r\n    final dy = move.ty - move.fy;\r\n    final adx = abs(move.tx - move.fx), ady = abs(move.ty - move.fy);\r\n\r\n    if (adx &gt; 1 || ady &gt; 1 || (adx + ady) &gt; 1) return false;\r\n\r\n    if (phase.side == Side.Red) {\r\n      //\r\n      if (move.fy &gt; 4 &amp;&amp; adx != 0) return false;\r\n      if (dy &gt; 0) return false;\r\n      //\r\n    } else {\r\n      //\r\n      if (move.fy &lt; 5 &amp;&amp; adx != 0) return false;\r\n      if (dy &lt; 0) return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n</code></pre>\r\n<p>\r\n    这个工具类按不同棋子地行棋规则检查用户的着法是否合规，而且还包含避免老将对面、避免行棋后对方可以直接攻击已方老将等逻辑。</p>\r\n<p>\r\n    接下来，我们在 lib/cchess 文件夹下新建 cc-rules.dart 文件，在其中提供当前是否有将军，是否已经被杀死等逻辑检查：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-5\">import \'cc-base.dart\';\r\nimport \'phase.dart\';\r\nimport \'step-enum.dart\';\r\nimport \'steps-validate.dart\';\r\n\r\nclass ChessRules {\r\n  // 是否被对方将军\r\n  static checked(Phase phase) {\r\n    //\r\n    final myKingPos = findKingPos(phase);\r\n\r\n    final oppoPhase = Phase.clone(phase);\r\n    oppoPhase.trunSide();\r\n\r\n    final oppoSteps = StepsEnumerator.enumSteps(oppoPhase);\r\n\r\n    for (var step in oppoSteps) {\r\n      if (step.to == myKingPos) return true;\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  // 应用指定着法后，是否被将军\r\n  static willBeChecked(Phase phase, Move move) {\r\n    //\r\n    final tempPhase = Phase.clone(phase);\r\n    tempPhase.moveTest(move);\r\n\r\n    return checked(tempPhase);\r\n  }\r\n\r\n  // 应用指定着法后，是否会造成老将对面\r\n  static willKingsMeeting(Phase phase, Move move) {\r\n    //\r\n    final tempPhase = Phase.clone(phase);\r\n    tempPhase.moveTest(move);\r\n\r\n    for (var col = 3; col &lt; 6; col++) {\r\n      //\r\n      var foundKingAlready = false;\r\n\r\n      for (var row = 0; row &lt; 10; row++) {\r\n        //\r\n        final piece = tempPhase.pieceAt(row * 9 + col);\r\n\r\n        if (!foundKingAlready) {\r\n          if (piece == Piece.RedKing || piece == Piece.BlackKing) foundKingAlready = true;\r\n          if (row &gt; 2) break;\r\n        } else {\r\n          if (piece == Piece.RedKing || piece == Piece.BlackKing) return true;\r\n          if (piece != Piece.Empty) break;\r\n        }\r\n      }\r\n    }\r\n\r\n    return false;\r\n  }\r\n\r\n  // 是否已经被对方杀死\r\n  static bool beKilled(Phase phase) {\r\n    //\r\n    List<move> steps = StepsEnumerator.enumSteps(phase);\r\n\r\n    for (var step in steps) {\r\n      if (StepValidate.validate(phase, step)) return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  // 寻找已方的老将位置\r\n  static int findKingPos(Phase phase) {\r\n    //\r\n    for (var i = 0; i &lt; 90; i++) {\r\n      //\r\n      final piece = phase.pieceAt(i);\r\n\r\n      if (piece == Piece.RedKing || piece == Piece.BlackKing) {\r\n        if (phase.side == Side.of(piece)) return i;\r\n      }\r\n    }\r\n\r\n    return -1;\r\n  }\r\n}\r\n</move></code></pre>\r\n<p>\r\n    好大的几片代码，让人有点窒息！好在逻辑还算清晰、且与 Flutter 本身没啥关系。</p>\r\n<p>\r\n    艰巨的规则逻辑实现的差不多了，我们看看如果在玩家走棋的过程中应用这些着法检查。</p>\r\n<p>\r\n    我们回到 Phase 类，之前已经预留了着法合法性检查的 validateMove 方法定义，现在来实现它：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-6\">// 验证移动棋子的着法是否合法\r\nbool validateMove(int from, int to) {\r\n  // 移动的棋子的选手，应该是当前方\r\n  if (Side.of(_pieces[from]) != _side) return false;\r\n  return StepValidate.validate(this, Move(from, to));\r\n}\r\n</code></pre>\r\n<p>\r\n    看看，一两句代码的事！当复杂的问题被透彻解决了之后，剩下的事件总是这样！</p>\r\n<p>\r\n    运行产品试试，现在不合棋规的走法，都是不被接受的了！</p>\r\n<p>上传代码到Git:</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'象棋着法检测\'\r\n[master 9bbb010] 象棋着法检测\r\n 10 files changed, 829 insertions(+), 9 deletions(-)\r\n create mode 100644 lib/cchess/cc-rules.dart\r\n create mode 100644 lib/cchess/steps-enum.dart\r\n create mode 100644 lib/cchess/steps-validate.dart\r\n create mode 100644 lib/common/math-ext.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 41, 完成.\r\n对象计数中: 100% (41/41), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (23/23), 完成.\r\n写入对象中: 100% (23/23), 6.73 KiB | 3.36 MiB/s, 完成.\r\n总共 23 （差异 10），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 27.47.4.14 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-08-28 12:13:17 (UTC), debug id 1410f2.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   18c7e5e..9bbb010  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$\r\n</code>\r\n</pre>\r\n\r\n<h2 id=\"-4\">\r\n    本节回顾</h2>\r\n<p>\r\n    本小节中，我们先是像大家介绍了中国象棋游戏的规范知识，如有需要详细地学习中国象棋游戏规范，可以参考我们提供的<a href=\"https://gitbook.cn/gitchat/column/5e9d67352b34772795873df4/topic/docs/%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B%E6%B8%B8%E6%88%8F%E8%A7%84%E8%8C%83\">详细文档-中国象棋游戏规范</a>；\r\n</p>\r\n<p>\r\n    接着，我们依据中国象棋游戏规范实现了着法枚举工具类，列表玩家当着可以走的所有着法。</p>\r\n<p>\r\n    然后，我们根据游戏规范文档来验证某种着法是不是在合法的范围内。例如「马蹩腿」、「象填心」规则的检查。此外，行棋后必须避免老将对面、必须避免自己的老将被对方的棋子直接威胁。</p>\r\n<p>\r\n    最后，我们在 Phase 类中使用着法合法性检查工具类对玩家的棋子移动进行了限制。</p>\r\n<p>\r\n    象棋软件中的开发中，「着法枚举」和「着法合法性检查」都是重要的基础工作，这两部分的可靠实现，是象棋游戏能正常运行的基石。这部分代码其实可以很容易地从 Dart 语言转换成其它语言，真心希望棋软开发者能把它有效利用起来！</p>                                                                                                                '),(29,'                                <p>\r\n    中国象棋游戏的胜负判断非常复杂，以至于象棋游戏的裁判都需要进行等级考试！</p>\r\n<p>\r\n    通常来说，人机对战的胜负判断要比真实比较比赛的裁判简单很多。在人机对战游戏中，我们要实现的逻辑是有限的：</p>\r\n<ul>\r\n    <li>如果 A 方行棋后，无论对方走什么棋，下一步都能吃掉对方的老将，则可判断 A 方获胜</li>\r\n    <li>如果 A 方行棋后，对方无棋可走，则可判断 A 方获胜</li>\r\n    <li>如果 A 方连续将军，造成三个连续的重复局面，则判断 A 方败阵</li>\r\n    <li>无吃子超过 60 个回合，判和棋</li>\r\n</ul>\r\n<p>\r\n    其它的关于「捉、闲」、「一将一闲」这些情况，我们不在 App 中实现。</p>\r\n<h2 id=\"\">\r\n    本节概要</h2>\r\n<ul>\r\n    <li>静态检查游戏结果</li>\r\n    <li>检查长将情况</li>\r\n    <li>检查和棋情况</li>\r\n</ul>\r\n<h2 id=\"-1\">\r\n    开启新对局</h2>\r\n<p>\r\n    在进行对战结果的检查前， 我们先看看如何开启一个新的对局。</p>\r\n<p>\r\n    棋盘走几步之后，想「重新开始一个新的对局」的需求比较强烈，我们优先解决这个强需求。</p>\r\n<p>\r\n    我们在 Phase 类中添加一个新的方法 initDefaultPhase，将原来 defaultPhase 构造方法中所有代码移动到 initDefaultPhase 方法中，在空的 defaultPhase 方法中添加对\r\n    initDefaultPhase 方法的调用，调整后的 Phase 类像下边这样：</p>\r\n<pre><code id=\"code-0\">...\r\n\r\nclass Phase {\r\n\r\n  ...\r\n\r\n  Phase.defaultPhase() {\r\n    initDefaultPhase();\r\n  }\r\n\r\n  void initDefaultPhase() {\r\n    //\r\n    _side = Side.Red;\r\n    _pieces = List<string>(90);\r\n        // 从上到下第一行\r\n    _pieces[0 * 9 + 0] = Piece.BlackRook;\r\n    _pieces[0 * 9 + 1] = Piece.BlackKnight;\r\n    _pieces[0 * 9 + 2] = Piece.BlackBishop;\r\n    _pieces[0 * 9 + 3] = Piece.BlackAdvisor;\r\n    _pieces[0 * 9 + 4] = Piece.BlackKing;\r\n    _pieces[0 * 9 + 5] = Piece.BlackAdvisor;\r\n    _pieces[0 * 9 + 6] = Piece.BlackBishop;\r\n    _pieces[0 * 9 + 7] = Piece.BlackKnight;\r\n    _pieces[0 * 9 + 8] = Piece.BlackRook;\r\n\r\n    // 从上到下第三行\r\n    _pieces[2 * 9 + 1] = Piece.BlackCanon;\r\n    _pieces[2 * 9 + 7] = Piece.BlackCanon;\r\n\r\n    // 从上到下第四行\r\n    _pieces[3 * 9 + 0] = Piece.BlackPawn;\r\n    _pieces[3 * 9 + 2] = Piece.BlackPawn;\r\n    _pieces[3 * 9 + 4] = Piece.BlackPawn;\r\n    _pieces[3 * 9 + 6] = Piece.BlackPawn;\r\n    _pieces[3 * 9 + 8] = Piece.BlackPawn;\r\n\r\n    // 从上到下第十行\r\n    _pieces[9 * 9 + 0] = Piece.RedRook;\r\n    _pieces[9 * 9 + 1] = Piece.RedKnight;\r\n    _pieces[9 * 9 + 2] = Piece.RedBishop;\r\n    _pieces[9 * 9 + 3] = Piece.RedAdvisor;\r\n    _pieces[9 * 9 + 4] = Piece.RedKing;\r\n    _pieces[9 * 9 + 5] = Piece.RedAdvisor;\r\n    _pieces[9 * 9 + 6] = Piece.RedBishop;\r\n    _pieces[9 * 9 + 7] = Piece.RedKnight;\r\n    _pieces[9 * 9 + 8] = Piece.RedRook;\r\n\r\n    // 从上到下第八行\r\n    _pieces[7 * 9 + 1] = Piece.RedCanon;\r\n    _pieces[7 * 9 + 7] = Piece.RedCanon;\r\n\r\n    // 从上到下第七行\r\n    _pieces[6 * 9 + 0] = Piece.RedPawn;\r\n    _pieces[6 * 9 + 2] = Piece.RedPawn;\r\n    _pieces[6 * 9 + 4] = Piece.RedPawn;\r\n    _pieces[6 * 9 + 6] = Piece.RedPawn;\r\n    _pieces[6 * 9 + 8] = Piece.RedPawn;\r\n\r\n    for (var i = 0; i &lt; 90; i++) {\r\n      _pieces[i] ??= Piece.Empty;\r\n    }\r\n  }\r\n\r\n  ...\r\n}\r\n</string></code></pre>\r\n<p>\r\n    在 Battle 类中，我们添加一个 newGame 方法，处理重新开始一个新对局的逻辑：</p>\r\n<pre><code id=\"code-1\">newGame() {\r\n  Battle.shared.phase.initDefaultPhase();\r\n  _focusIndex = _blurIndex = Move.InvalidIndex;\r\n}\r\n</code></pre>\r\n<p>\r\n    回到 _BattlePageState 类中，我们再添加一个也叫 newGame 的方法，由它来调用 Battle 的 newGame 方法：</p>\r\n<pre><code id=\"code-2\">newGame() {\r\n  //\r\n  confirm() {\r\n    Navigator.of(context).pop();\r\n    Battle.shared.newGame();\r\n    setState(() {});\r\n  }\r\n\r\n  cancel() =&gt; Navigator.of(context).pop();\r\n\r\n  // 开始新方法之前需要用户确认\r\n  showDialog(\r\n    context: context,\r\n    builder: (BuildContext context) {\r\n      return AlertDialog(\r\n        title: Text(\'放弃对局？\', style: TextStyle(color: ColorConsts.Primary)),\r\n        content: SingleChildScrollView(child: Text(\'你确定要放弃当前的对局吗？\')),\r\n        actions: <widget>[\r\n          FlatButton(child: Text(\'确定\'), onPressed: confirm),\r\n          FlatButton(child: Text(\'取消\'), onPressed: cancel),\r\n        ],\r\n      );\r\n    },\r\n  );\r\n}\r\n</widget></code></pre>\r\n<p>\r\n    这个方法弹出一个确认对话框，玩家确认的话就将局面回到初始状态。</p>\r\n<p>\r\n    我们用在 _BattlePageState 的 build 方法中找到这一段代码：</p>\r\n<pre><code id=\"code-3\">FlatButton(child: Text(\'新对局\', style: buttonStyle), onPressed: () {})\r\n</code></pre>\r\n<p>\r\n    将 newGame 方法指给「新对局」按钮的 onPressed 属性：</p>\r\n<pre><code id=\"code-4\">FlatButton(child: Text(\'新对局\', style: buttonStyle), onPressed: newGame),\r\n</code></pre>\r\n<p>\r\n    现在可以重新开始新对局了！接着我们来处理胜、负、和的检测问题。</p>\r\n<h2 id=\"-2\">\r\n    对战结果检查</h2>\r\n<p>\r\n    我们先在 Phase 类中添加添加一个 BattleResult 类型的字段：</p>\r\n<pre><code id=\"code-5\">class Phase {\r\n\r\n  ...\r\n\r\n  BattleResult result = BattleResult.Pending; // 结果未决\r\n\r\n  ...\r\n}\r\n</code></pre>\r\n<p>\r\n    接着，我们在 _BattlePageState 中添加三个方法，分别用于展示胜得、失败、和棋：</p>\r\n<pre><code id=\"code-6\">...\r\n\r\nclass _BattlePageState extends State<battlepage> {\r\n\r\n  ...\r\n\r\n  // 显示胜利框\r\n  void gotWin() {\r\n    //\r\n    Battle.shared.phase.result = BattleResult.Win;\r\n\r\n    showDialog(\r\n      context: context,\r\n      barrierDismissible: false,\r\n      builder: (BuildContext context) {\r\n        return AlertDialog(\r\n          title: Text(\'赢了\', style: TextStyle(color: ColorConsts.Primary)),\r\n          content: Text(\'恭喜您取得了伟大的胜利！\'),\r\n          actions: <widget>[\r\n            FlatButton(child: Text(\'再来一盘\'), onPressed: newGame),\r\n            FlatButton(child: Text(\'关闭\'), onPressed: () =&gt; Navigator.of(context).pop()),\r\n          ],\r\n        );\r\n      },\r\n    );\r\n  }\r\n\r\n  // 显示失败框\r\n  void gotLose() {\r\n    //\r\n    Battle.shared.phase.result = BattleResult.Lose;\r\n\r\n    showDialog(\r\n      context: context,\r\n      barrierDismissible: false,\r\n      builder: (BuildContext context) {\r\n        return AlertDialog(\r\n          title: Text(\'输了\', style: TextStyle(color: ColorConsts.Primary)),\r\n          content: Text(\'勇士！坚定战斗，虽败犹荣！\'),\r\n          actions: <widget>[\r\n            FlatButton(child: Text(\'再来一盘\'), onPressed: newGame),\r\n            FlatButton(child: Text(\'关闭\'), onPressed: () =&gt; Navigator.of(context).pop()),\r\n          ],\r\n        );\r\n      },\r\n    );\r\n  }\r\n\r\n  // 显示和棋框\r\n  void gotDraw() {\r\n    //\r\n    Battle.shared.phase.result = BattleResult.Draw;\r\n\r\n    showDialog(\r\n      context: context,\r\n      barrierDismissible: false,\r\n      builder: (BuildContext context) {\r\n        return AlertDialog(\r\n          title: Text(\'和了\', style: TextStyle(color: ColorConsts.Primary)),\r\n          content: Text(\'您用自己的力量捍卫了和平！\'),\r\n          actions: <widget>[\r\n            FlatButton(child: Text(\'再来一盘\'), onPressed: newGame),\r\n            FlatButton(child: Text(\'关闭\'), onPressed: () =&gt; Navigator.of(context).pop()),\r\n          ],\r\n        );\r\n      },\r\n    );\r\n  }\r\n\r\n  ...\r\n}\r\n</widget></widget></widget></battlepage></code></pre>\r\n<p>\r\n    其实就是弹出三个不一样的对话框，告诉用户胜利或失败或和棋了。</p>\r\n<p>\r\n    之后，我们来扫描对战结果。在 Battle 类中，我们来修改 scanBattleResult 方法，修改后应该是下边这样的：</p>\r\n<pre><code id=\"code-7\">...\r\n\r\nclass Battle {\r\n\r\n  ...\r\n\r\n  // 检查对局是否已经有胜负结果了\r\n  BattleResult scanBattleResult() {\r\n    //\r\n    final forPerson = (_phase.side == Side.Red);\r\n\r\n    if (scanLongCatch()) {\r\n      // born \'repeat\' phase by oppo\r\n      return forPerson ? BattleResult.Win : BattleResult.Lose;\r\n    }\r\n\r\n    if (ChessRules.beKilled(_phase)) {\r\n      return forPerson ? BattleResult.Lose : BattleResult.Win;\r\n    }\r\n\r\n    return (_phase.halfMove &gt; 120) ? BattleResult.Draw : BattleResult.Pending;\r\n  }\r\n\r\n  // 是否存在长将长捉\r\n  scanLongCatch() {\r\n    // todo:\r\n    return false;\r\n  }\r\n\r\n  ...\r\n}\r\n</code></pre>\r\n<blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, \" segoe=\"\" ui\",=\"\" \"helvetica=\"\" neue\",=\"\" \"microsoft=\"\" yahei\",=\"\" sans-serif;=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">\r\n    <p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">关于重复局面和长捉 scanLongCatch 的检查比较复杂，我们将这个问往后放。\r\n    </p>\r\n</blockquote>\r\n<p>\r\n    最后，我们修改 _BattlePageState 的 onBoardTap 和 engineToGo 方法，在两个方法中，都有对扫描结果处理的 switch 语句，修改它们当判断出胜负后，调用上边的三个方法显示胜负结果。</p>\r\n<p>\r\n    修改 _BattlePageState 的 onBoardTap 方法，改成下边的样子：</p>\r\n<pre><code id=\"code-8\">onBoardTap(BuildContext context, int index) {\r\n\r\n  ...\r\n\r\n   // 之前已经有棋子被选中了\r\n   if (Battle.shared.focusIndex != Move.InvalidIndex &amp;&amp;\r\n       Side.of(phase.pieceAt(Battle.shared.focusIndex)) == Side.Red) {\r\n     //\r\n    ...\r\n\r\n     // 现在点击的棋子和上一次选择棋子不同边，要得是吃子，要么是移动棋子到空白处\r\n     if (Battle.shared.move(Battle.shared.focusIndex, index)) {\r\n       //\r\n       final result = Battle.shared.scanBattleResult();\r\n\r\n       switch (result) {\r\n         case BattleResult.Pending:\r\n           engineToGo();\r\n           break;\r\n         case BattleResult.Win:\r\n           gotWin();\r\n           break;\r\n         case BattleResult.Lose:\r\n           gotLose();\r\n           break;\r\n         case BattleResult.Draw:\r\n           gotDraw();\r\n           break;\r\n      }\r\n    }\r\n     //\r\n  } else {\r\n    ...\r\n  }\r\n\r\n  ...\r\n}\r\n</code></pre>\r\n<p>\r\n    将 _BattlePageState 的 engineToGo 方法改成下边的样子：</p>\r\n<pre><code id=\"code-9\">engineToGo() async {\r\n\r\n   ...\r\n\r\n   if (response.type == \'move\') {\r\n     //\r\n    ...\r\n\r\n     final result = Battle.shared.scanBattleResult();\r\n\r\n     switch (result) {\r\n       case BattleResult.Pending:\r\n         changeStatus(\'请走棋...\');\r\n         break;\r\n       case BattleResult.Win:\r\n         gotWin();\r\n         break;\r\n       case BattleResult.Lose:\r\n         gotLose();\r\n         break;\r\n       case BattleResult.Draw:\r\n         gotDraw();\r\n         break;\r\n    }\r\n     //\r\n  } else {\r\n    ...\r\n  }\r\n}\r\n</code></pre>\r\n<p>\r\n    一切都很好！经过这么长时间的努力，现在我们的象棋游戏有严格的行棋规则，人和云端主机能决出一个胜负了。</p>\r\n<p>\r\n    运行产品试试看，多与云端服务器切磋两把吧！实际上提升棋力最好的方式就是与比自己水平高的对手下棋。</p>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/Qw5Gza.png\" alt=\"对战结果：虽败犹荣！\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\"></p>\r\n<p>\r\n    这一节的内容很多了，刻提交代码到 git 仓库，让自己放松一下喽！</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'胜负逻辑\'\r\n[master 8f50019] 胜负逻辑\r\n 4 files changed, 138 insertions(+), 9 deletions(-)\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 19, 完成.\r\n对象计数中: 100% (19/19), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (9/9), 完成.\r\n写入对象中: 100% (10/10), 2.04 KiB | 2.04 MiB/s, 完成.\r\n总共 10 （差异 6），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 2408:8256:686:857c:65a5:d57e:83b8:2920 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-08-30 01:59:33 (UTC), debug id 5f9e32.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   9bbb010..8f50019  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ \r\n</code>\r\n</pre>\r\n<h2 id=\"-3\">\r\n    小节回顾</h2>\r\n<p>\r\n    本节在玩家或引擎走棋后，对局面做游戏结果检查。在已经有游戏结果的时候弹出游戏结果界面。</p>\r\n<p>\r\n    此外，我们实现了在游戏结束以及游戏过程中重新开启一个新对局的功能。</p>\r\n<p>\r\n    「长将」的逻辑，我们交在后续课程中实现，而像「长捉」、「限着」等更完善的中国象棋游戏规则，大家可以尝试自己去挑战实现！</p>                            '),(30,'                                                                                                                                                                                                                                                                                                                                                                <p>\r\n    经过之前的持续努力，我们有了一个可以正常对战、且规则完备的象棋游戏了！</p>\r\n<p>\r\n    但要做为放在市场上的的一个有一定竞争力的游戏，体验还不能达标 — 太安静了、太朴素了！</p>\r\n<p>\r\n    本节我们来提升游戏的综合体验！</p>\r\n<h2 id=\"\">\r\n    本节概要</h2>\r\n<ul>\r\n    <li>导入音乐/图片设计资源</li>\r\n    <li>美化主菜单页面</li>\r\n    <li>象棋游戏中动效实现</li>\r\n    <li>实现音效和音乐播放</li>\r\n</ul>\r\n<h2 id=\"flutter\">\r\n    Flutter 图像资源的组织</h2>\r\n<p>\r\n    我们先来配置一下游戏中需要使用的图像资源。</p>\r\n<p>\r\n    为了方便大家跟随课程做试验性开发，你可以从Git（<a href=\"https://rocketgit.com/user/elapse/chinese_chess/source/tree/branch/master/tree/\" target=\"_blank\">https://rocketgit.com/user/elapse/chinese_chess/source/tree/branch/master/tree/</a>）<a href=\"https://rocketgit.com/user/elapse/chinese_chess/source/tree/branch/master/tree/\">&nbsp;这里</a>下载我们提供的样本。\r\n</p>\r\n<blockquote>\r\n    <p>一个游戏必不可少 Logo，它是你游戏的灵魂载体，你最好自己设计它！</p>\r\n</blockquote>\r\n<p>\r\n    将我们提供的的图版资源复制到项目根目录下的 images 文件夹中，然后打开项目根目下的&nbsp;<code>pubspec.yaml</code>&nbsp;文件，我们将在其中注册我们的图片：\r\n</p>\r\n<pre><code id=\"code-1\">...\r\n\r\nflutter:\r\n\r\n...\r\n\r\nassets:\r\n  - images/logo.png\r\n  - images/logo-mini.png\r\n  - images/mei.png\r\n  - images/zhu.png\r\n\r\n...\r\n</code></pre>\r\n<p>\r\n    在 Flutter 中加载图像资源可以很好的覆盖不同密度屏幕。直接在 images 下分别建立不同的密度倍数的子文件夹：1.5x、2.0x、3.0x……，在进行 Assets\r\n    资源引用的时候，不需要在资源路径中带上密度指示文件夹，Flutter 会自动地选择适应当前屏幕的图像资源：</p>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/s5XHd6.png\" alt=\"Flutter Assets 图像可以自动配置屏幕密度\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p>\r\n<p>\r\n    现在，我们开始美化主菜单页面。</p>\r\n<h2 id=\"-1\">\r\n    美化主菜单页</h2>\r\n<p>\r\n    打到 MainMenu 类的 build 方法中的 menuItems 变量的定义，我们为主界面添加 Logo 和点缀用的一丛梅花、几株竹子的的图片，将它修改成下边的样子：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-2\">  @override\r\n  Widget build(BuildContext context) {\r\n    //\r\n    final nameStyle = TextStyle(\r\n      fontSize: 64,\r\n      color: Colors.black,\r\n    );\r\n\r\n    final menuItemStyle = TextStyle(\r\n      fontSize: 28,\r\n      color: ColorConsts.Primary,\r\n    );\r\n\r\n    final menuItems = Center(\r\n      child: Column(\r\n        children: <widget>[\r\n          Expanded(child: SizedBox(), flex: 3),\r\n          Image.asset(\'images/logo.png\'), // logo\r\n          Expanded(child: SizedBox()),\r\n          Text(\'中国象棋\', style: nameStyle, textAlign: TextAlign.center),\r\n          Expanded(child: SizedBox()),\r\n          FlatButton(child: Text(\'单机对战\', style: menuItemStyle), onPressed: () {}),\r\n          Expanded(child: SizedBox()),\r\n          FlatButton(\r\n            child: Text(\'挑战云主机\', style: menuItemStyle),\r\n            onPressed: () {\r\n              Navigator.of(context).push(\r\n                MaterialPageRoute(builder: (context) =&gt; BattlePage()),\r\n              );\r\n            },\r\n          ),\r\n          Expanded(child: SizedBox()),\r\n          FlatButton(child: Text(\'排行榜\', style: menuItemStyle), onPressed: () {}),\r\n          Expanded(child: SizedBox(), flex: 3),\r\n          Text(\'用心娱乐，为爱传承\', style: TextStyle(color: Colors.black54, fontSize: 16)),\r\n          Expanded(child: SizedBox()),\r\n        ],\r\n      ),\r\n    );\r\n\r\n    return Scaffold(\r\n      backgroundColor: ColorConsts.LightBackground,\r\n      body: Stack(\r\n        children: <widget>[\r\n          // 右上角显示梅花\r\n          Positioned(right: 0, top: 0, child: Image(image: AssetImage(\'images/mei.png\'))),\r\n          // 左下角显示竹子\r\n          Positioned(left: 0, bottom: 0, child: Image(image: AssetImage(\'images/zhu.png\'))),\r\n          menuItems,\r\n          Positioned(\r\n            top: ChessRoadApp.StatusBarHeight,\r\n            left: 10,\r\n            child: IconButton(\r\n              icon: Icon(Icons.settings, color: ColorConsts.Primary),\r\n              onPressed: () {},\r\n            ),\r\n          ),\r\n        ],\r\n      ),\r\n    );\r\n  }\r\n</widget></widget></code></pre>\r\n<p>\r\n    一图顶万言！在 vscode 中按&nbsp;<code>F5</code>&nbsp;运行代码看看，因为\r\n    Logo 和两张图片的加入，浓浓的中国风味道出来了！</p>\r\n <img src=\"https://elapse.date/static/uploads/1598756317_52135f516b2ab65cca51.png\" data-filename=\"img\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\">\r\n<h2 id=\"logohero\">\r\n    Logo 上的 Hero 动画</h2>\r\n<p>\r\n    Logo 是品宣的重要元素，怎么突出都不算过份。</p>\r\n<p>\r\n    接着，我们在对战页面顶部添加小 Logo，打开 _BattlePageState 类的 createPageHeader 方法，找到&nbsp;<code>Text(\'单机对战\', style: titleStyle)</code>&nbsp;代码行，在之上插入两行代码：\r\n</p>\r\n<pre><code id=\"code-5\">Image.asset(\'images/logo-mini.png\'),\r\nSizedBox(width: 10),\r\n</code></pre>\r\n<p>\r\n    这会在对战页面最醒目的位置 — 标题前边添加我们的“将帅象棋”小 logo。</p>\r\n<p>\r\n    我们将使用 Hero 牵引动效，以加深 Logo 在用户心中的份量，它会在 MainMenu 和 BattlePage 两个页面转场的过程中，产生动画牵引效果。</p>\r\n<p>\r\n    实现方法比较简单，在 MainMenu 和 _BattlePageState 页面中，用 Hero Widget 包裹 Logo 和小 logo，并给它们指定相同的 hero tag。</p>\r\n<p>\r\n    在 MainMenu 中找到&nbsp;<code>Image.asset(\'images/logo.png\')</code>，用\r\n    Hero 包裹它：</p>\r\n<pre><code id=\"code-7\">Hero(child: Image.asset(\'images/logo.png\'), tag: \'logo\'),\r\n</code></pre>\r\n<p>\r\n    在 BattlePage 中找到&nbsp;<code>Image.asset(\'images/logo-mini.png\')</code>，用\r\n    Hero 包裹它：</p>\r\n<pre><code id=\"code-9\">Hero(child: Image.asset(\'images/logo-mini.png\'), tag: \'logo\'),\r\n</code></pre>\r\n<p>\r\n    两个页面中被 Hero 包裹且有相同 Tag 的 Widget，在发生页面转场时，Hero 包裹的 Widget 将自动地从前一个页面变换到另一个页面具有相同 TAG 的 Hero 的 Widget 的新位置。</p>\r\n<p>\r\n    现在运行产品看看，体会一下 Hero 动画虽简单但神奇的效果：\r\n</p>\r\n<img src=\"https://elapse.date/static/uploads/1598757930_6cd8313b56dc6735650a.png\" data-filename=\"img\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\"> \r\n<h2 id=\"-2\">\r\n    动效和动态阴隐</h2>\r\n<p>\r\n    现在再看首页 UI，文字过于平面化！我们给它添加一些阴隐，应该有助于消除这种感觉！</p>\r\n<p>\r\n    在 MainMenu 中找到 build 方法开始始处的两个文字样式定义，在它们之前添加两上 shadow 定义，并把它们用在应用标题和菜单的文字样式上：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-10\">final nameShadow = Shadow(\r\n color: Color.fromARGB(0x99, 66, 0, 0),\r\n offset: Offset(0, 2),\r\n blurRadius: 4，\r\n);\r\nfinal menuItemShadow = Shadow(\r\n color: Color.fromARGB(0x7F, 0, 0, 0),\r\n offset: Offset(0, 2),\r\n blurRadius: 4，\r\n);\r\n\r\nfinal nameStyle = TextStyle(\r\n fontSize: 64,\r\n color: Colors.black,\r\n shadows: [nameShadow],\r\n);\r\nfinal menuItemStyle = TextStyle(\r\n fontSize: 28,\r\n color: ColorConsts.Primary,\r\n shadows: [menuItemShadow],\r\n);\r\n</code></pre>\r\n<p>\r\n    用了不同的颜色设置了游戏名称和菜单的阴影效果了，运行程序看看。</p>\r\n<p>&nbsp;<img src=\"https://elapse.date/static/uploads/1598756317_52135f516b2ab65cca51.png\" data-filename=\"img\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\"><img src=\"https://elapse.date/static/uploads/1598758780_afeff8ca16f3177bf2b5.png\" data-filename=\"img\" style=\"max-width: 100%; zoom: 0.25; outline: 0px !important;\">\r\n</p>\r\n<p>\r\n    首页有那么点样子了！如果说还差点什么的话，应该是差点动效了，那我们动手吧！</p>\r\n<p>\r\n    将 MainMenu 从 StatelessWidget 改为 StatefulWidget，前文说过修改方法：</p>\r\n<blockquote>\r\n    <p>在 vscode 里面，将光标停留在&nbsp;<code>class MainMenu</code>&nbsp;字样上，按&nbsp;<code>Cmd+.</code>，在弹出菜单中选择&nbsp;<code>Convert to StatefuleWidget</code>。\r\n    </p>\r\n</blockquote>\r\n<p>\r\n    在 _MainMenuState 类中添加两个动画以及两个动画的控制器变量的定义，并为 _MainMenuState 添加 TickerProviderStateMixin 注入：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-14\">\r\nclass _MainMenuState extends State<mainmenu> with TickerProviderStateMixin {\r\n  //\r\n  AnimationController inController, shadowController;\r\n  Animation inAnimation, shadowAnimation;\r\n\r\n  ...\r\n}\r\n</mainmenu></code></pre>\r\n<p>\r\n    接着，覆盖 _MianMenuState 的 initState 方法，并在其中初始化动画实例：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-15\">@override\r\nvoid initState() {\r\n  //\r\n  super.initState();\r\n\r\n  // 标题缩放动画\r\n  inController = AnimationController(\r\n    duration: Duration(milliseconds: 600),\r\n    vsync: this,\r\n  );\r\n  inAnimation = CurvedAnimation(parent: inController, curve: Curves.bounceIn);\r\n  inAnimation = new Tween(begin: 1.6, end: 1.0).animate(inController);\r\n\r\n  // 阴影厚度变化\r\n  shadowController = AnimationController(\r\n    duration: Duration(milliseconds: 1500),\r\n    vsync: this, // 自身已经 Mixin 进了 TickerProviderStateMixin\r\n  );\r\n  shadowAnimation = new Tween(begin: 0.0, end: 12.0).animate(shadowController);\r\n\r\n  // 缩放动画完成后，开始阴影厚度变换动画\r\n  inController.addStatusListener((status) {\r\n    if (status == AnimationStatus.completed) shadowController.forward();\r\n  });\r\n\r\n  // 阴影厚度变换动画完成后，自动复位（为下一次呈现做准备）\r\n  shadowController.addStatusListener((status) {\r\n    if (status == AnimationStatus.completed) shadowController.reverse();\r\n  });\r\n\r\n   /// use \'try...catch\' to avoid exception -\r\n   /// \'setState() or markNeedsBuild() called during build.\'\r\n   inAnimation.addListener(() {\r\n     try {\r\n       setState(() {});\r\n    } catch (e) {}\r\n  });\r\n   shadowAnimation.addListener(() {\r\n     try {\r\n       setState(() {});\r\n    } catch (e) {}\r\n  });\r\n\r\n   inController.forward();\r\n}\r\n</code></pre>\r\n<p>\r\n    上边的代码定义了两个动画，并定义了两动画的状态转换关系：</p>\r\n<ul>\r\n    <li>第一个动画 inAnimation 在入场时动态的缩放「中国象棋」几个字</li>\r\n    <li>第二个动画动态地为「中国象棋」几个字生成厚度不同的阴影效果</li>\r\n    <li>第一个动画完成后，自动开始第二个动画。</li>\r\n    <li>第二个动画完成后，再反向复位消除阴影</li>\r\n</ul>\r\n<p>\r\n    接着，我们让动画结合到具体的 Widget 上去。在 _MainMenuState 类的 build 方法中找到以下的代码：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-16\">Text(\'中国象棋\', style: nameStyle, textAlign: TextAlign.center)\r\n</code></pre>\r\n<p>\r\n    将它用 Transform 包裹，改成下边的样子：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-17\">Transform.scale(\r\n  scale: inAnimation.value,\r\n  child: Text(\'中国象棋\', style: nameStyle, textAlign: TextAlign.center),\r\n),\r\n</code></pre>\r\n<p>\r\n    之后，找到 _MainMenuState 类的 build 方法开始的处的两个 shadown 的定义，将它改成下边的样子：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-18\">final nameShadow = Shadow(\r\n  color: Color.fromARGB(0x99, 66, 0, 0),\r\n  offset: Offset(0, shadowAnimation.value / 2),\r\n  blurRadius: shadowAnimation.value,\r\n);\r\nfinal menuItemShadow = Shadow(\r\n  color: Color.fromARGB(0x7F, 0, 0, 0),\r\n  offset: Offset(0, shadowAnimation.value / 6),\r\n  blurRadius: shadowAnimation.value / 3,\r\n);\r\n</code></pre>\r\n<p>\r\n    这样一来，在动画的变换过程中，标题「中国象棋」几个字将从大到小入场，完了之后它的阴隐从无到有，然后从薄到厚地呈现，再从厚到薄，再消失……</p>\r\n<p>\r\n    使用动画时，别忘了 dispose 动画控制器，覆盖 _MainMenuState 的 dispose 方法，释放动画控制器：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-19\">@override\r\n void dispose() {\r\n   //\r\n   inController.dispose();\r\n   shadowController.dispose();\r\n\r\n   super.dispose();\r\n}\r\n</code></pre>\r\n<p>\r\n    动画运行完美，就是这简单称手！但仅限入场的时候呈现。如果从其它页面返回首页菜单也能呈现动画就好了。</p>\r\n<p>\r\n    我们做点调整来实现从其它页面重返时的动效吧。首先在 _MainMenuState 类中添加下的方法：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-20\">  navigateTo(Widget page) async {\r\n    //\r\n    await Navigator.of(context).push(\r\n      MaterialPageRoute(builder: (context) =&gt; page),\r\n    );\r\n\r\n    // 从其它页面返回后，再呈现动效效果\r\n    inController.reset();\r\n    shadowController.reset();\r\n    inController.forward();\r\n  }\r\n</code></pre>\r\n<p>\r\n    然后在 _MainMenuState 的 build 方法中，找到以下代码：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-21\">FlatButton(\r\n  child: Text(\'挑战云主机\', style: menuItemStyle),\r\n  onPressed: () {\r\n    Navigator.of(context).push(\r\n      MaterialPageRoute(builder: (context) =&gt; BattlePage()),\r\n    );\r\n  },\r\n),\r\n</code></pre>\r\n<p>\r\n    将它修改成下边的样子：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-22\">FlatButton(\r\n  child: Text(\'挑战云主机\', style: menuItemStyle),\r\n  onPressed: () =&gt; navigateTo(BattlePage()),\r\n),\r\n</code></pre>\r\n<p>\r\n    界面动画讲究「刚刚好」，就这些吧。在 vscode 中按&nbsp;<code>F5</code>&nbsp;运行产品看看：\r\n</p>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/jKEvgq.gif\" alt=\"动画效果演示\" style=\"max-width: 100%; outline: 0px !important;\"></p>\r\n<p>先把动画这一部份代码push到Git：</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'添加动画效果\'\r\n[master 8075ce0] 添加动画效果\r\n 24 files changed, 895 insertions(+), 14 deletions(-)\r\n create mode 100644 images/1.5x/logo-mini.png\r\n create mode 100644 images/1.5x/logo.png\r\n create mode 100644 images/1.5x/mei.png\r\n create mode 100644 images/1.5x/zhu.png\r\n create mode 100644 images/2.0x/logo-mini.png\r\n create mode 100644 images/2.0x/logo.png\r\n create mode 100644 images/2.0x/mei.png\r\n create mode 100644 images/2.0x/zhu.png\r\n create mode 100644 images/3.0x/logo-mini.png\r\n create mode 100644 images/3.0x/logo.png\r\n create mode 100644 images/3.0x/mei.png\r\n create mode 100644 images/3.0x/zhu.png\r\n create mode 100644 images/4.0x/logo-mini.png\r\n create mode 100644 images/4.0x/logo.png\r\n create mode 100644 images/4.0x/mei.png\r\n create mode 100644 images/4.0x/zhu.png\r\n create mode 100644 images/logo-mini.png\r\n create mode 100644 images/logo.png\r\n create mode 100644 images/mei.png\r\n create mode 100644 images/zhu.png\r\n create mode 100644 lib/luck.html\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 39, 完成.\r\n对象计数中: 100% (39/39), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (33/33), 完成.\r\n写入对象中: 100% (33/33), 2.09 MiB | 54.00 KiB/s, 完成.\r\n总共 33 （差异 4），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 2408:8256:686:857c:65a5:d57e:83b8:2920 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-08-30 05:20:16 (UTC), debug id b4df61.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   8f50019..8075ce0  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ \r\n</code>\r\n</pre>\r\n<h2 id=\"-3\">\r\n    导入游戏音效</h2>\r\n<p>\r\n    游戏怎么能只有画面，没有音效呢？因此，我们需要添加一些声音资源到游戏中。</p>\r\n<p>\r\n    与前面的图片一样，我们有些素材提供，大家可以从Git下载这些声音素材。下载声音素材后，请将它复制到项目根上下，如下图所示：\r\n</p>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/SXRmdg.png\" alt=\"将音效资源放置到正确位置\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p>\r\n<p>\r\n    为了能在项目中使用这素材，我们首先要将素材在&nbsp;<code>pubspec.yaml</code>&nbsp;文件中进行注册：\r\n</p>\r\n<pre><code class=\"yaml language-yaml\" id=\"code-25\">...\r\n\r\nflutter:\r\n\r\n  ...\r\n\r\n  assets:\r\n\r\n   ...\r\n\r\n    - audios/bg_music.mp3\r\n    - audios/capture.mp3\r\n    - audios/check.mp3\r\n    - audios/click.mp3\r\n    - audios/regret.mp3\r\n    - audios/draw.mp3\r\n    - audios/tips.mp3\r\n    - audios/invalid.mp3\r\n    - audios/lose.mp3\r\n    - audios/move.mp3\r\n    - audios/win.mp3\r\n\r\n    ...\r\n</code></pre>\r\n<p>\r\n    音效资源注册好了，现在准备播放声音！</p>\r\n<h2 id=\"-4\">\r\n    使用三方音效插件</h2>\r\n<p>\r\n    这儿有一个坏消息，Flutter 只是一套 UI 库，声音的处理不在 Flutter 内部支持功能的范围！</p>\r\n<p>\r\n    不过呢，使用第三方为处理与系统相关的事务是 Flutter 推荐的方式，我们只需要找一个评价好的三方插件就解决问题了。</p>\r\n<p>\r\n    查找和安装第三方插件的常规的方法是这样的：</p>\r\n<p>\r\n    使用浏览器打开&nbsp;<a href=\"https://pub.dev/\">https://pub.dev</a>，查找你关心的关键词，这里我们用&nbsp;<code>audio</code>&nbsp;作关键词搜索，可以看到大量插件出现在搜索结果，我们需要选出适用的那一个。\r\n</p>\r\n<p>\r\n    对插件进行大致选择有个重要依据，一个是其它开发者对其给出的评价：</p>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/3EtlgP.png\" alt=\"pubdev 上有很多音效播放插件\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p>\r\n<p>\r\n    但这显然不够，还要考虑开发语言是不是一致这些因素，这个随然也有兼容处理的方案，但总是多一事不如少一事。</p>\r\n<p>\r\n    试过几个音效播放插件，有些不能从 assets 资源中播放，有些不支持提前缓存，各有各的问题，最后我选择了 audioplayers 插件：</p>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/BBYNvf.png\" alt=\"我们将要使用音效插件\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p>\r\n<p>\r\n    图上的插件名称为&nbsp;<code>audioplayers</code>&nbsp;，当前版本&nbsp;<code>0.14.0</code>，把对它的依赖和版本加到你项目根目的&nbsp;<code>pubspec.yaml</code>&nbsp;文件中去：\r\n</p>\r\n<pre><code class=\"yaml language-yaml\" id=\"code-30\">...\r\n\r\ndependencies:\r\n  flutter:\r\n    sdk: flutter\r\n\r\n  cupertino_icons: ^0.1.2\r\n  audioplayers: ^0.14.0\r\n\r\n...\r\n</code></pre>\r\n<blockquote>\r\n    <p>版本号前的「^」，相关于从这个版本开始找之后的新版本，然后使用它</p>\r\n</blockquote>\r\n<p>\r\n    在 vscode 中直接保持&nbsp;<code>pubspec.yaml</code>&nbsp;文件的改动时，会自动开始执行&nbsp;<code>flutter pub get</code>&nbsp;指令，等指令运行完成后就可以使用插件了。\r\n</p>\r\n<p>\r\n    创建 lib/services 文件夹，在其下创建 audios.dart 文件，其中的 Audios 类用以包装音效播放相关的操作：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-33\">import \'package:audioplayers/audio_cache.dart\';\r\nimport \'package:audioplayers/audioplayers.dart\';\r\n\r\nclass Audios {\r\n  //\r\n  static AudioPlayer _fixedBgmPlayer, _fixedTonePlayer;\r\n  static AudioCache _bgmPlayer, _tonePlayer;\r\n\r\n  // 专门负责音乐轮播\r\n  static loopBgm(String fileName) async {\r\n    //\r\n    try {\r\n      if (_bgmPlayer == null) {\r\n        //\r\n        _fixedBgmPlayer = AudioPlayer();\r\n        _bgmPlayer = AudioCache(prefix: \'audios/\', fixedPlayer: _fixedBgmPlayer);\r\n\r\n        await _bgmPlayer.loadAll([\'bg_music.mp3\']);\r\n      }\r\n\r\n      _fixedBgmPlayer.stop();\r\n      _bgmPlayer.loop(fileName);\r\n    } catch (e) {}\r\n  }\r\n\r\n  // 专门负责音效播放\r\n  static playTone(String fileName) async {\r\n    //\r\n    try {\r\n      if (_tonePlayer == null) {\r\n        //\r\n        _fixedTonePlayer = AudioPlayer();\r\n        _tonePlayer = AudioCache(prefix: \'audios/\', fixedPlayer: _fixedTonePlayer);\r\n\r\n        await _tonePlayer.loadAll([\r\n          \'capture.mp3\',\r\n          \'check.mp3\',\r\n          \'click.mp3\',\r\n          \'regret.mp3\',\r\n          \'draw.mp3\',\r\n          \'tips.mp3\',\r\n          \'invalid.mp3\',\r\n          \'lose.mp3\',\r\n          \'move.mp3\',\r\n          \'win.mp3\',\r\n        ]);\r\n      }\r\n\r\n      _fixedTonePlayer.stop();\r\n      _tonePlayer.play(fileName);\r\n    } catch (e) {}\r\n  }\r\n\r\n  static stopBgm() {\r\n    try {\r\n      if (_fixedBgmPlayer != null) _fixedBgmPlayer.stop();\r\n    } catch (e) {}\r\n  }\r\n\r\n  // 停止音乐和音效\r\n  static Future<void> release() async {\r\n    try {\r\n      if (_fixedBgmPlayer != null) {\r\n        await _fixedBgmPlayer.release();\r\n      }\r\n      if (_fixedTonePlayer != null) {\r\n        await _fixedTonePlayer.release();\r\n      }\r\n    } catch (e) {}\r\n  }\r\n}\r\n</void></code></pre>\r\n<p>\r\n    在游戏中，长时间循环播放的背景音乐，和只是叮一声、咚一声响一下的短暂音效处理方式是不同的。因此我们在 Audios 类中实现了 Bgm 播放和 tone 播放的独立控制。</p>\r\n<p>\r\n    这个插件有个好处，就是可以预先把音效都先加载到缓存，这样播放的时候就几乎没有延迟了。</p>\r\n<p>\r\n    音效工具准备好了，我们只需要在合理的地方放置音效播放代码就完事了。</p>\r\n<p>\r\n    为了得到更细致的生命周期方法控制，我们将 main.dart 中的 ChessApp 由 StatelessWidget 改为 StatefulWidget。</p>\r\n<blockquote>\r\n    <p style=\"margin-bottom: 1.1em; font-size: 1em; line-height: 1.45; outline: 0px !important;\">前文件两次说过这个技巧，请大家记住：</p>\r\n    <p>在 vscode 中，将方法放在&nbsp;<code>class ChessApp</code>&nbsp;上按&nbsp;<code>Cmd+.</code>&nbsp;，然后在弹出的菜单中选择&nbsp;<code>Convert to StatefulWidget</code>。\r\n    </p>\r\n</blockquote>\r\n<p>\r\n    在 _ChessAppState 类中覆盖 initState 方法，启动背景音乐循环播放：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-37\">@override\r\nvoid initState() {\r\n  super.initState();\r\n  Audios.loopBgm(\'bg_music.mp3\');\r\n}\r\n</code></pre>\r\n<blockquote>\r\n    <p>注意这里只使用音效的名称，因为之前已经将音乐文件预告加入缓存了。</p>\r\n</blockquote>\r\n<p>\r\n    在 _ChessAppState 类的 build 方法中，我们使用 WillPopScope 包裹 MainMenu 的实例，这将会在页面被弹出时得到回调机会，具体的 build 方法代码如下：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-38\">@override\r\nWidget build(BuildContext context) {\r\n  //\r\n  return MaterialApp(\r\n    theme: ThemeData(primarySwatch: Colors.brown, fontFamily: \'QiTi\'),\r\n    debugShowCheckedModeBanner: false,\r\n    home: WillPopScope(\r\n      onWillPop: () async {\r\n        // 菜单页被弹出时，停止音乐\r\n        Audios.release();\r\n        return true;\r\n      },\r\n      child: MainMenu(),\r\n    ),\r\n  );\r\n}\r\n</code></pre>\r\n<p>\r\n    MainMenu 被弹出（android 的 back 键退出）方法被回调时，我们停止所有音乐、音效播放。</p>\r\n<p>\r\n    在 _BattlePageState 中找到 gotWin 方法的实现，在最开始的地方添加一行代码：</p>\r\n<pre><code id=\"code-39\">Audios.playTone(\'win.mp3\');\r\n</code></pre>\r\n<p>\r\n    类似的，在 gotLose 方法最开始的地方，也添加如下的一行代码：</p>\r\n<pre><code id=\"code-40\">Audios.playTone(\'lose.mp3\');\r\n</code></pre>\r\n<p>\r\n    在 Battle 类中找到 select 方法的实现代码，在最后添加一行代码：</p>\r\n<pre><code id=\"code-41\">Audios.playTone(\'click.mp3\');\r\n</code></pre>\r\n<p>\r\n    为了能判断刚才着法有没有吃子（或只是移动棋子），我们将 Phase 类的 move 方法修改成如下的样子：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-42\">// 修改后的 move 方法不再返回 bool 值，而是返回字符串\r\n// null 表示着法不合法，字符表示被吃掉的棋子\r\nString move(int from, int to) {\r\n  //\r\n  if (!validateMove(from, to)) return null;\r\n\r\n  final captured = _pieces[to];\r\n\r\n  if (captured != Piece.Empty) {\r\n    halfMove = 0;\r\n  } else {\r\n    halfMove++;\r\n  }\r\n\r\n  if (fullMove == 0) {\r\n    fullMove++;\r\n  } else if (side == Side.Black) {\r\n    fullMove++;\r\n  }\r\n\r\n  // 修改棋盘\r\n  _pieces[to] = _pieces[from];\r\n  _pieces[from] = Piece.Empty;\r\n\r\n  // 交换走棋方\r\n  _side = Side.oppo(_side);\r\n\r\n  return captured;\r\n}\r\n</code></pre>\r\n<p>\r\n    修改 Battle 类的 move 方法，修改后像下边这样：</p>\r\n<pre><code class=\"dart language-dart\" id=\"code-43\"> bool move(int from, int to) {\r\n   //\r\n   final captured = _phase.move(from, to);\r\n\r\n   // 着法无效\r\n   if (captured == null) {\r\n     Audios.playTone(\'invalid.mp3\');\r\n     return false;\r\n  }\r\n\r\n   _blurIndex = from;\r\n   _focusIndex = to;\r\n\r\n   // 将军\r\n   if (ChessRules.checked(_phase)) {\r\n     Audios.playTone(\'check.mp3\');\r\n  } else {\r\n     // 吃子或仅仅是移动棋子\r\n     Audios.playTone(captured != Piece.Empty ? \'capture.mp3\' : \'move.mp3\');\r\n  }\r\n\r\n   return true;\r\n}\r\n</code></pre>\r\n<p>\r\n    美妙的音乐响起，驱散一切沉闷！试试运行我们的产品，听到背景音乐了吗？是不是更有意愿多走两了？</p>\r\n<p>\r\n    将代码提交到 git 仓库，多多感受一下我们的象棋游戏吧！</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'添加声音\'\r\n[master 46f767f] 添加声音\r\n 19 files changed, 246 insertions(+), 774 deletions(-)\r\n create mode 100644 audios/bg_music.mp3\r\n create mode 100644 audios/capture.mp3\r\n create mode 100644 audios/check.mp3\r\n create mode 100644 audios/click.mp3\r\n create mode 100644 audios/draw.mp3\r\n create mode 100644 audios/invalid.mp3\r\n create mode 100644 audios/lose.mp3\r\n create mode 100644 audios/move.mp3\r\n create mode 100644 audios/regret.mp3\r\n create mode 100644 audios/tips.mp3\r\n create mode 100644 audios/win.mp3\r\n delete mode 100644 lib/luck.html\r\n create mode 100644 lib/services/audios.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 37, 完成.\r\n对象计数中: 100% (37/37), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (24/24), 完成.\r\n写入对象中: 100% (26/26), 3.23 MiB | 96.00 KiB/s, 完成.\r\n总共 26 （差异 8），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 112.94.53.44 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-08-30 08:57:13 (UTC), debug id c753d0.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   8075ce0..46f767f  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$\r\n</code>\r\n</pre>\r\n<h2 id=\"-5\">\r\n    小节回顾</h2>\r\n<p>\r\n    本节开头，我们介绍了向 App 引入图片、音乐等设计资源的方式。</p>\r\n<p>\r\n    接着，我们使用和图片资源来美化了主菜单页面的视觉效果。</p>\r\n<p>\r\n    之后，我们在主菜单的菜单条上，实现了菜单项基础变换动效的阴隐厚度变换动效；</p>\r\n<p>\r\n    这之后，我们在主菜单和对战页面之间实现了 Hero 牵引动效；</p>\r\n<p>\r\n    最后，我们从 pub.dev 寻找了一个播放音效的三方插件，使用它来轮播了游戏的背景音乐，并为行棋等环节添加了动效。</p>\r\n<p>\r\n    在 Flutter 开发中，我们时常需要寻找三方插件来完善 Flutter 的能力。使用大多数三方插件的引入流程与我们引入音效播放插件的流程是一致，大家可以标记这一部分内容，将来以此为参考。</p>                                                                                                                                                                                                                                                                                                                    '),(31,'                                                                                                                                                                <p>\r\n    在对战过程，玩家经常需要悔棋功能，这种让时间倒流的技能不会太简单的，这一节的任务就是让我们的象棋游戏支持悔棋！</p>\r\n<h2 id=\"\">\r\n    本节概要</h2>\r\n<ul>\r\n    <li>重构 Phase 类，抽取记谱功能</li>\r\n    <li>依据棋谱记录添加悔棋逻辑</li>\r\n    <li>显示对战着法的棋谱</li>\r\n</ul>\r\n<h2 id=\"phase\">\r\n    Phase 重构</h2>\r\n<p>\r\n    目前，在我们的 Phase 类中已经存在一些记录之前走棋过程的能力，我们将重构这一部分的设计，在一个专门的记录工具类中实现更完善的行棋记录功能，以为悔棋的实现作好准备。</p>\r\n<p>\r\n    我们在 lib/cchess 下新建一个 cc-recorder.dart 文件，计划由它来记录走棋的整个过程：</p>\r\n<pre><code id=\"code-0\">class CCRecorder {\r\n  //\r\n  // 无吃子步数、总回合数\r\n  int halfMove, fullMove;\r\n  String lastCapturedPhase;\r\n  final _history = <move>[];\r\n\r\n  CCRecorder({this.halfMove = 0, this.fullMove = 0, this.lastCapturedPhase});\r\n}\r\n</move></code></pre>\r\n<p>\r\n    大家可以发现这个类中的三个成员变量都在 Phase 类中出现过了，我们现在这里创建 Recorder 工具，稍后我们从 Phase 中将这部分功能转换到新建的 Recorder 中来。</p>\r\n<p>\r\n    接下来，我们为 CCRecorder 类添加几个方法，用于记录新的行其步骤以及悔棋时，删除掉尾部添加的着法：</p>\r\n<pre><code id=\"code-1\">void stepIn(Move move, Phase phase) {\r\n  //\r\n  if (move.captured != Piece.Empty) {\r\n    halfMove = 0;\r\n  } else {\r\n    halfMove++;\r\n  }\r\n\r\n  if (fullMove == 0) {\r\n    fullMove++;\r\n  } else if (phase.side != Side.Black) {\r\n    fullMove++;\r\n  }\r\n\r\n  _history.add(move);\r\n\r\n  if (move.captured != Piece.Empty) {\r\n    lastCapturedPhase = phase.toFen();\r\n  }\r\n}\r\n\r\nMove removeLast() {\r\n  if (_history.isEmpty) return null;\r\n  return _history.removeLast();\r\n}\r\n\r\nget last =&gt; _history.isEmpty ? null : _history.last;\r\n</code></pre>\r\n<p>\r\n    「悔棋」需要从当前局面恢复到之前的局面，我们需要一个方法取出自上一次吃子以来的着法列表，并反向应用到当前棋盘局面上。这个方法用于在悔棋时，基于当前局面一步一步地「还原」走这一步之前的棋盘局面。</p>\r\n<p>\r\n    继续在 CCRecorder 类中添加方法 reverseMovesToPrevCapture：</p>\r\n<pre><code id=\"code-2\">// 自上一个咋子局面后的着法列表，反向存放在返回列表中\r\nList<move> reverseMovesToPrevCapture() {\r\n  //\r\n  List<move> moves = [];\r\n\r\n  for (var i = _history.length - 1; i &gt;= 0; i--) {\r\n    if (_history[i].captured != Piece.Empty) break;\r\n    moves.add(_history[i]);\r\n  }\r\n\r\n  return moves;\r\n}\r\n</move></move></code></pre>\r\n<p>\r\n    FEN 串的最后两上数字表示了「无吃步数」和「全局回合数」。这两个数字跟着行棋过程一直变化，悔棋时也要一步一步地进行恢复。为此我们要改造一下 Move 类，在其中增加一个成员变量，并在构造方法中体现对这个成员变量的传值初始化：\r\n</p>\r\n<pre><code id=\"code-3\">class Move {\r\n\r\n  ...\r\n\r\n  // 这一步走完后的 FEN 记数，用于悔棋时恢复 FEN 步数 Counter\r\n  String counterMarks;\r\n\r\n  Move(this.from, this.to, {\r\n    this.captured = Piece.Empty, this.counterMarks = \'0 0\'}) {\r\n    ...\r\n  }\r\n\r\n  ...\r\n}\r\n</code></pre>\r\n<p>\r\n    回头我们还要在 CCRecorder 添加一个命名构造方法，并覆盖 toString 方法，前者从 counterMarks 里面解析出无吃子步数和回合数，另一个将出无吃子步数和回合数转换成一个 counterMarks 字符串：\r\n</p>\r\n<pre><code id=\"code-4\">class CCRecorder \r\n\r\n  ...\r\n\r\n  // 从 FEN 尾部两个字段解析无吃子步数和总回合数\r\n  CCRecorder.fromCounterMarks(String marks) {\r\n    //\r\n    var segments = marks.split(\' \');\r\n    if (segments.length != 2) {\r\n      throw \'Error: Invalid Counter Marks: $marks\';\r\n    }\r\n\r\n    halfMove = int.parse(segments[0]);\r\n    fullMove = int.parse(segments[1]);\r\n\r\n    if (halfMove == null || fullMove == null) {\r\n      throw \'Error: Invalid Counter Marks: $marks\';\r\n    }\r\n  }\r\n\r\n  ...\r\n\r\n  @override\r\n  String toString() {\r\n    return \'$halfMove $fullMove\';\r\n  }\r\n}\r\n</code></pre>\r\n<p>\r\n    现在 Recorder 类准备好了，我们需要在 Phase 类中将 Recorder 使用起来。</p>\r\n<p>\r\n    先将 Phase 类中的以下三个成员变量的定义删除，交添加 Recorder 类的实例，并添加几个基于 Recorder 的 getter。修改前：</p>\r\n<pre><code id=\"code-5\">// 无吃子步数、总回合数\r\nint halfMove = 0, fullMove = 0;\r\n// 最近一个吃子局面\r\nString lastCapturedPhase;\r\nfinal _history = <move>[];\r\n\r\n...\r\n</move></code></pre>\r\n<p>\r\n    修改后：</p>\r\n<pre><code id=\"code-6\">CCRecordder _recorder;\r\n\r\n...\r\n\r\nget halfMove =&gt; _recorder.halfMove;\r\n\r\nget fullMove =&gt; _recorder.fullMove;\r\n\r\nget lastMove =&gt; _recorder.last;\r\n\r\nget lastCapturedPhase =&gt; _recorder.lastCapturedPhase;\r\n</code></pre>\r\n<p>\r\n    修改 Phase.clone 构造方法的尾部两行代码，修改前：</p>\r\n<pre><code id=\"code-7\">Phase.clone(Phase other) {\r\n\r\n  ...\r\n\r\n  halfMove = other.halfMove;\r\n  fullMove = other.fullMove;\r\n}\r\n</code></pre>\r\n<p>\r\n    修改后：</p>\r\n<pre><code id=\"code-8\">Phase.clone(Phase other) {\r\n\r\n  ...\r\n\r\n  _recorder = other._recorder;\r\n}\r\n</code></pre>\r\n<p>\r\n    修改 Phase 类的 initDefaultPhase 方法尾部代码，修改前：</p>\r\n<pre><code id=\"code-9\">initDefaultPhase() {\r\n\r\n  ...\r\n\r\n  lastCapturedPhase = toFen();\r\n  halfMove = fullMove = 0;\r\n\r\n  _history.clear();\r\n}\r\n</code></pre>\r\n<p>\r\n    修改后：</p>\r\n<pre><code id=\"code-10\">initDefaultPhase() {\r\n\r\n  ...\r\n\r\n  _recorder = CCRecorder(lastCapturedPhase: toFen());\r\n}\r\n</code></pre>\r\n<p>\r\n    将 Phase 类的 move 方法修改成下边的样子：</p>\r\n<pre><code id=\"code-11\">String move(int from, int to) {\r\n  //\r\n  if (!validateMove(from, to)) return null;\r\n\r\n  final captured = _pieces[to];\r\n\r\n  // 修改棋盘\r\n  _pieces[to] = _pieces[from];\r\n  _pieces[from] = Piece.Empty;\r\n\r\n  _recorder.stepIn(Move(from, to, captured: captured), this);\r\n\r\n  // 交换走棋方\r\n  _side = Side.oppo(_side);\r\n\r\n  return captured;\r\n}\r\n</code></pre>\r\n<p>\r\n    修改 Phase 类的 toFen 方法的尾部，修改前：</p>\r\n<pre><code id=\"code-12\">String toFen() {\r\n  //\r\n  ...\r\n\r\n  // step counter\r\n  fen += \'$halfMove $fullMove\';\r\n\r\n  return fen;\r\n}\r\n</code></pre>\r\n<p>\r\n    修改后：</p>\r\n<pre><code id=\"code-13\">String toFen() {\r\n  //\r\n  ...\r\n\r\n  // step counter\r\n  fen += \'${_recorder?.halfMove ?? 0} ${_recorder?.fullMove ?? 0}\';\r\n\r\n  return fen;\r\n}\r\n</code></pre>\r\n<p>\r\n    为了保护好 Recorder 的内部结构，我们不直接暴露 Recorder 内部的成员变量，仅在 CCRecorder 类中添加两个数据获取方法：</p>\r\n<pre><code id=\"code-14\">class CCRecorder {\r\n  ...\r\n\r\n  stepAt(int index) =&gt; _history[index];\r\n\r\n  get stepsCount =&gt; _history.length;\r\n}\r\n</code></pre>\r\n<p>\r\n    最后在 Phase 中添加 movesSinceLastCaptured 方法如下：</p>\r\n<pre><code id=\"code-15\">String movesSinceLastCaptured() {\r\n  //\r\n  var steps = \'\', posAfterLastCaptured = 0;\r\n\r\n  for (var i = _recorder.stepsCount - 1; i &gt;= 0; i--) {\r\n    if (_recorder.stepAt(i).captured != Piece.Empty) break;\r\n    posAfterLastCaptured = i;\r\n  }\r\n\r\n  for (var i = posAfterLastCaptured; i &lt; _recorder.stepsCount; i++) {\r\n    steps += \' ${_recorder.stepAt(i).step}\';\r\n  }\r\n\r\n  return steps.length &gt; 0 ? steps.substring(1) : \'\';\r\n}\r\n</code></pre>\r\n<h2 id=\"-1\">\r\n    添加悔棋逻辑</h2>\r\n<p>\r\n    重构完成了，必要的工具方法也准备就绪，我们在 Phase 类中添加悔棋方法：</p>\r\n<pre><code id=\"code-16\">bool regret() {\r\n  // 首先撤销最后一条行棋记录\r\n  final lastMove = _recorder.removeLast();\r\n  if (lastMove == null) return false;\r\n\r\n  // 还原到最后一步行棋之前的局面\r\n  _pieces[lastMove.from] = _pieces[lastMove.to];\r\n  _pieces[lastMove.to] = lastMove.captured;\r\n\r\n  // 回调行棋方\r\n  _side = Side.oppo(_side);\r\n\r\n  // 还原着法计数器\r\n  final counterMarks = CCRecorder.fromCounterMarks(lastMove.counterMarks);\r\n  _recorder.halfMove = counterMarks.halfMove;\r\n  _recorder.fullMove = counterMarks.fullMove;\r\n\r\n  /// 更新最近一个咋子着法\r\n  /// 这儿有点逻辑，因为引擎理解局面需要传递上一次的吃子局面，以及此后的无咋子着法列表\r\n  /// 所以如果刚撤销的着法是吃子着法，我们就需要再向前找上一个吃子着法\r\n  if (lastMove.captured != Piece.Empty) {\r\n    //\r\n    // 查找上一个吃子局面（或开局），NativeEngine 需要\r\n    final tempPhase = Phase.clone(this);\r\n\r\n    final moves = _recorder.reverseMovesToPrevCapture();\r\n    moves.forEach((move) {\r\n      //\r\n      tempPhase._pieces[move.from] = tempPhase._pieces[move.to];\r\n      tempPhase._pieces[move.to] = move.captured;\r\n\r\n      tempPhase._side = Side.oppo(tempPhase._side);\r\n    });\r\n\r\n    _recorder.lastCapturedPhase = tempPhase.toFen();\r\n  }\r\n\r\n    // 将游戏结果重新设置为未决\r\n  // 例如引擎已经将你杀败，你点击悔棋后，需要将游戏结果从失败变回未决\r\n  result = BattleResult.Pending;\r\n\r\n  return true;\r\n}\r\n</code></pre>\r\n<p>\r\n    前边所做的事情，都是为「悔棋」这个功能做的铺垫，现在是正主登场的时刻了！</p>\r\n<p>\r\n    在 Battle 类中，添加一个 regret 方法，这个方法带一个 steps 参数，表示棋盘上要回退的步数，一般来说悔棋要先撤销对方走的棋和自己上一步着法，所以默认一次回退两步：</p>\r\n<pre><code id=\"code-17\">bool regret({steps = 2}) {\r\n  //\r\n  // 轮到自己走棋的时候，才能悔棋\r\n  if (_phase.side != Side.Red) {\r\n    Audios.playTone(\'invalid.mp3\');\r\n    return false;\r\n  }\r\n\r\n  var regreted = false;\r\n\r\n  /// 悔棋一回合（两步），才能撤回自己上一次的动棋\r\n\r\n  for (var i = 0; i &lt; steps; i++) {\r\n    //\r\n    if (!_phase.regret()) break;\r\n\r\n    final lastMove = _phase.lastMove;\r\n\r\n    if (lastMove != null) {\r\n      //\r\n      _blurIndex = lastMove.from;\r\n      _focusIndex = lastMove.to;\r\n      //\r\n    } else {\r\n      //\r\n      _blurIndex = _focusIndex = Move.InvalidIndex;\r\n    }\r\n\r\n    regreted = true;\r\n  }\r\n\r\n  if (regreted) {\r\n    Audios.playTone(\'regret.mp3\');\r\n    return true;\r\n  }\r\n\r\n  Audios.playTone(\'invalid.mp3\');\r\n  return false;\r\n}\r\n</code></pre>\r\n<p>\r\n    的 createOperatorBar 方法中，找到以下代码：</p>\r\n<pre><code id=\"code-18\">FlatButton(child: Text(\'悔棋\', style: buttonStyle), onPressed: () {}),\r\n</code></pre>\r\n<p>\r\n    修改它，在 onPressed 上调用悔棋方法：</p>\r\n<pre><code id=\"code-19\">FlatButton(\r\n  child: Text(\'悔棋\', style: buttonStyle),\r\n  onPressed: () {\r\n    Battle.shared.regret(steps: 2);\r\n    setState(() {});\r\n  },\r\n),\r\n</code></pre>\r\n<p>\r\n    现在可以时间穿梭吃后悔药了，运行起来试试，由于可以无限悔棋，人类基本也就无敌啦！</p>\r\n<p>更新悔棋代码到Git: </p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'bug\'\r\n[master 95c31ba] bug\r\n 5 files changed, 211 insertions(+), 19 deletions(-)\r\n create mode 100644 lib/cchess/cc-recorder.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elpase\r\nPassword for \'https://elpase@rocketgit.com\': \r\n枚举对象: 20, 完成.\r\n对象计数中: 100% (20/20), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (10/10), 完成.\r\n写入对象中: 100% (11/11), 3.59 KiB | 3.59 MiB/s, 完成.\r\n总共 11 （差异 6），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 27.47.11.191 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-09-04 07:13:32 (UTC), debug id 849ee7.\r\nremote: RocketGit: Error: refs/heads/master\r\nremote: RocketGit: Error: You have no rights to push bad whitespace:\r\nremote: RocketGit: Error: lib/cchess/phase.dart:189: trailing whitespace.\r\nremote: RocketGit: Error: +    /* \r\nremote: RocketGit: Error: lib/cchess/phase.dart:209: trailing whitespace.\r\nremote: RocketGit: Error: +    /*\r\nremote: error: hook declined to update refs/heads/master\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n ! [remote rejected] master -&gt; master (hook declined)\r\nerror: 推送一些引用到 \'https://rocketgit.com/user/elapse/chinese_chess\' 失败\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 20, 完成.\r\n对象计数中: 100% (20/20), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (10/10), 完成.\r\n写入对象中: 100% (11/11), 3.59 KiB | 3.59 MiB/s, 完成.\r\n总共 11 （差异 6），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 27.47.11.191 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-09-04 07:17:24 (UTC), debug id 2632c2.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   46f767f..95c31ba  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ \r\n</code>\r\n</pre>\r\n<h2 id=\"-2\">\r\n    显示棋谱</h2>\r\n<p>\r\n    之前做屏幕适配的时候，我们有一点遗留问题 — 还没有显示棋谱信息！现在是时候补上这一块了！</p>\r\n<p>\r\n    首先，我们在Move类中stepName来记录棋谱：\r\n</p>\r\n<pre><code>\r\nclass Move {\r\n   ...\r\n  String stepName; //棋谱招法\r\n  ...\r\n}\r\n</code>\r\n</pre>\r\n<p>\r\n然后在“cchess”文件夹中添加文件“step-name.dart”，加如下内容：\r\n</p>\r\n<pre><code>\r\nimport \'cc-base.dart\';\r\nimport \'phase.dart\';\r\nimport \'../common/math-ext.dart\';\r\n\r\n/* 棋谱步骤名 */\r\nclass StepName {\r\n  static const RedColNames = \'九八七六五四三二一\';\r\n  static const BlackColNames = \'１２３４５６７８９\';\r\n\r\n  static const RedDigits = \'零一二三四五六七八九\';\r\n  static const BlackDigits = \'０１２３４５６７８９\';\r\n\r\n  static translate(Phase phase, Move step) {\r\n    final colNames = [RedColNames, BlackColNames];\r\n    final digits = [RedDigits, BlackDigits];\r\n\r\n    final side = Side.of(phase.pieceAt(step.from));\r\n    final sideIndex = (side == Side.Red) ? 0 : 1;\r\n\r\n    final chessName = nameOf(phase, step);\r\n\r\n    String result = chessName;\r\n\r\n    if (step.ty == step.fy) {\r\n      result += \'平${colNames[sideIndex][step.tx]}\';\r\n    } else {\r\n      final direction = (side == Side.Red) ? -1 : 1;\r\n      final dir = ((step.ty - step.fy) * direction &gt; 0) ? \'进\' : \'退\';\r\n\r\n      final piece = phase.pieceAt(step.from);\r\n\r\n      final specialPieces = [\r\n        Piece.RedKnight,\r\n        Piece.BlackKnight,\r\n        Piece.RedBishop,\r\n        Piece.BlackBishop,\r\n        Piece.RedAdvisor,\r\n        Piece.BlackAdvisor,\r\n      ];\r\n\r\n      String targetPos;\r\n\r\n      if (specialPieces.contains(piece)) {\r\n        targetPos = \'${colNames[sideIndex][step.tx]}\';\r\n      } else {\r\n        targetPos = \'${digits[sideIndex][abs(step.ty - step.fy)]}\';\r\n      }\r\n\r\n      result += \'$dir$targetPos\';\r\n    }\r\n    return step.stepName = result;\r\n  }\r\n\r\n  static nameOf(Phase phase, Move step) {\r\n    final colNames = [RedColNames, BlackColNames];\r\n    final digits = [RedDigits, BlackDigits];\r\n\r\n    final side = Side.of(phase.pieceAt(step.from));\r\n    final sideIndex = (side == Side.Red) ? 0 : 1;\r\n\r\n    final piece = phase.pieceAt(step.from);\r\n    final chessName = Piece.Names[piece]; //棋子名\r\n\r\n    /* \r\n    士相由于行动行动路径有限，不会出现同一列两个士相都可以进或退的情况\r\n    所以一般不说「前士、前相」之类的，根据「进、退」动作即可判断是前一个还是后一个\r\n    */\r\n    if (piece == Piece.RedAdvisor ||\r\n        piece == Piece.RedBishop ||\r\n        piece == Piece.BlackAdvisor ||\r\n        piece == Piece.BlackBishop) {\r\n      return \'$chessName${colNames[sideIndex][step.fx]}\';\r\n    }\r\n\r\n    /* \r\n    此 Map 的 Key 为「列」， Value 为此列上出现所查寻棋子的 y 坐标（row）列表\r\n    返回结果中进行了过滤，如果某一列包含所查寻棋子的数量 &lt; 2，此列不包含在返回结果中\r\n    */\r\n    final Map<int, list<int=\"\">&gt; cols = findPieceSameCol(phase, piece);\r\n    final fyIndexes = cols[step.fx];\r\n\r\n    /* 正在动棋的这一列不包含多个同类棋子 */\r\n    if (fyIndexes == null) {\r\n      return \'$chessName${colNames[sideIndex][step.fx]}\';\r\n    }\r\n\r\n    /* 只有正在动棋的这一列包含多个同类棋子 */\r\n    if (cols.length == 1) {\r\n      var order = fyIndexes.indexOf(step.fy);\r\n      if (side == Side.Black) order = fyIndexes.length - 1 - order;\r\n\r\n      if (fyIndexes.length == 2) {\r\n        return \'${\'前后\'[order]}$chessName\';\r\n      }\r\n      if (fyIndexes.length == 3) {\r\n        return \'${\'前中后\'[order]}$chessName\';\r\n      }\r\n      return \'${digits[sideIndex][order]}$chessName\';\r\n    }\r\n\r\n    /* \r\n    这种情况表示有两列都有两个或以上正在查寻的棋子\r\n    这种情况下，从右列开始为棋子指定序数（从前到后），然后再左列\r\n    */\r\n    if (cols.length == 2) {\r\n      //\r\n      final fxIndexes = cols.keys.toList();\r\n      fxIndexes.sort((a, b) =&gt; a - b);\r\n\r\n      // 已经按列的 x 坐标排序，当前动子列是否是在右边的列\r\n      final currentColStart = (step.fx == fxIndexes[1 - sideIndex]);\r\n\r\n      if (currentColStart) {\r\n        //\r\n        var order = fyIndexes.indexOf(step.fy);\r\n        if (side == Side.Black) order = fyIndexes.length - 1 - order;\r\n\r\n        return \'${digits[sideIndex][order]}$chessName\';\r\n        //\r\n      } else {\r\n        // 当前列表在左边，后计序数\r\n        final fxOtherCol = fxIndexes[sideIndex];\r\n\r\n        var order = fyIndexes.indexOf(step.fy);\r\n        if (side == Side.Black) order = fyIndexes.length - 1 - order;\r\n\r\n        return \'${digits[sideIndex][cols[fxOtherCol].length + order]}$chessName\';\r\n      }\r\n    }\r\n\r\n    return \'=招法错误=\';\r\n  }\r\n\r\n  static findPieceSameCol(Phase phase, String piece) {\r\n    //\r\n    final map = Map<int, list<int=\"\">&gt;();\r\n\r\n    for (var row = 0; row &lt; 10; row++) {\r\n      for (var col = 0; col &lt; 9; col++) {\r\n        //\r\n        if (phase.pieceAt(row * 9 + col) == piece) {\r\n          //\r\n          var fyIndexes = map[col] ?? [];\r\n          fyIndexes.add(row);\r\n          map[col] = fyIndexes;\r\n        }\r\n      }\r\n    }\r\n\r\n    final Map<int, list<int=\"\">&gt; result = {};\r\n\r\n    map.forEach((k, v) {\r\n      if (v.length &gt; 1) result[k] = v;\r\n    });\r\n\r\n    return result;\r\n  }\r\n}\r\n\r\n</int,></int,></int,></code>\r\n</pre>\r\n<p>\r\n接着将修改 Phase 类中的 move 方法修改成下边的样子：</p>\r\n<pre><code id=\"code-20\">  String move(int from, int to) {\r\n    //\r\n    if (!validateMove(from, to)) return null;\r\n\r\n    final captured = _pieces[to];\r\n\r\n    final move = Move(from, to, captured: captured);\r\n    // 翻译着法为中文，后续实现\r\n    StepName.translate(this, move);\r\n    _recorder.stepIn(move, this);\r\n\r\n    // 修改棋盘\r\n    _pieces[to] = _pieces[from];\r\n    _pieces[from] = Piece.Empty;\r\n\r\n    // 交换走棋方\r\n    _side = Side.oppo(_side);\r\n\r\n    return captured;\r\n  }\r\n</code></pre>\r\n<p>\r\n    接着，我们在 CCRecorder 类中添加一个方法：</p>\r\n<pre><code id=\"code-21\">// 从着法列表生成双列文字，供对战局面显示\r\nString buildManualText({cols = 2}) {\r\n  //\r\n  var manualText = \'\';\r\n\r\n  for (var i = 0; i &lt; _history.length; i++) {\r\n    manualText += \'${i &lt; 9 ? \' \' : \'\'}${i + 1}. ${_history[i].stepName}　\';\r\n    if ((i + 1) % cols == 0) manualText += \'\\n\';\r\n  }\r\n\r\n  if (manualText.isEmpty) {\r\n    manualText = \'&lt;暂无招法&gt;\';\r\n  }\r\n\r\n  return manualText;\r\n}\r\n</code></pre>\r\n<p>\r\n    然后，我们在 Phase 类中添加一个 getter，转调用刚建立的 buildManualText 方法：</p>\r\n<pre><code id=\"code-22\">get manualText =&gt; _recorder.buildManualText();\r\n</code></pre>\r\n<p>\r\n    最后，我们在 _BattlePageState 的 buildFooter 方法中找到下边的一行代码：</p>\r\n<pre><code id=\"code-23\">final manualText = \'&lt;暂无棋谱&gt;\';\r\n</code></pre>\r\n<p>\r\n    将它修改成下边的样子：</p>\r\n<pre><code id=\"code-24\">final manualText = Battle.shared.phase.manualText;\r\n</code></pre>\r\n<p>\r\n    现在可以显示走棋的着法列表了！运行产品试试看！</p>\r\n<p>\r\n    别忘了提交代码到 git 仓库，本节目标达成！</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'显示棋谱\'\r\n[master c574648] 显示棋谱\r\n 5 files changed, 186 insertions(+), 2 deletions(-)\r\n create mode 100644 lib/cchess/step-name.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 18, 完成.\r\n对象计数中: 100% (18/18), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (10/10), 完成.\r\n写入对象中: 100% (10/10), 3.03 KiB | 3.03 MiB/s, 完成.\r\n总共 10 （差异 6），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 27.47.4.53 by http(s).\r\nremote: RocketGit: Info: date/time: 2020-09-04 16:08:48 (UTC), debug id 9f8b76.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   95c31ba..c574648  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ \r\n</code>\r\n</pre>\r\n<h2 id=\"-3\">\r\n    小节回顾</h2>\r\n<p>\r\n    本节内容中，我们从 Phase 中抽取了棋谱记录的逻辑，创建了专门的棋谱记录工具类。</p>\r\n<p>\r\n    然后，依据棋谱记录的工具类，我们将局面回溯到之前的场景，实现了「悔棋」功能。</p>\r\n<p>\r\n    最后，我们使用根据行棋的着法，生成了当前对局的棋谱，并显示在对战页面的尾部（对于短屏幕手机，我们使用弹出框方式显示棋谱）。</p>                                                                                                                                            '),(32,'                                                                                                <p>\r\n    局面分析是一个让你可以「超神」的能力！</p>\r\n<p>\r\n    一方面，有了局面分析功能，你下棋过程中像是有一个云服务器始终在给你支招。这很利于学棋者提升自己对局面的理解；</p>\r\n<p>\r\n    另一方面，对于开局的某一个局面，可能让云端分析告诉你目前走哪了步比较好，主要的几种可靠招法的效果得多少分。</p>\r\n<h2 id=\"\">\r\n    本节概要</h2>\r\n<ul>\r\n    <li>添加 Flutter 版的 Toast 组件</li>\r\n    <li>翻译中文行棋着法</li>\r\n    <li>调用云库 API 分析局面</li>\r\n    <li>呈现局面分析结果</li>\r\n</ul>\r\n<p>\r\n    因为有「象棋云库」的加持，实现局面分析并不是很困难！我们使用前边云库人机对战的那一系列 API 来请求云库对局面进行分析，推荐和评估可行的着法。</p>\r\n<p>\r\n    在开始局面分析之前，我们先做一点热身运行吧！</p>\r\n<h2 id=\"toast\">\r\n    添加 Toast 工具类</h2>\r\n<p>\r\n    在分析过程中，我们希望显示一些轻量的提示消息给用户，我们添加一个 Toast 工具类，在文件夹“common”中新建toast.dart文件，如下内容：</p>\r\n<pre>    <code id=\"code-0\">import \'package:flutter/cupertino.dart\';\r\nimport \'package:flutter/material.dart\';\r\n\r\n// Toast 显示位置控制\r\nenum ToastPostion { top, center, bottom }\r\n\r\nclass Toast {\r\n  // toast靠它加到屏幕上\r\n  static OverlayEntry _overlayEntry;\r\n  // toast是否正在showing\r\n  static bool _showing = false;\r\n  // 开启一个新toast的当前时间，用于对比是否已经展示了足够时间\r\n  static DateTime _startedTime;\r\n  // 提示内容\r\n  static String _msg;\r\n  // toast显示时间\r\n  static int _showTime;\r\n  // 背景颜色\r\n  static Color _bgColor;\r\n  // 文本颜色\r\n  static Color _textColor;\r\n  // 文字大小\r\n  static double _textSize;\r\n  // 显示位置\r\n  static ToastPostion _toastPosition;\r\n  // 左右边距\r\n  static double _pdHorizontal;\r\n  // 上下边距\r\n  static double _pdVertical;\r\n\r\n  static void toast(\r\n    BuildContext context, {\r\n    // 显示的文本\r\n    String msg,\r\n    // 显示的时间 单位毫秒\r\n    int showTime = 1000,\r\n    // 显示的背景\r\n    Color bgColor = Colors.black,\r\n    // 显示的文本颜色\r\n    Color textColor = Colors.white,\r\n    // 显示的文字大小\r\n    double textSize = 16.0,\r\n    // 显示的位置\r\n    ToastPostion position = ToastPostion.center,\r\n    // 文字水平方向的内边距\r\n    double pdHorizontal = 20.0,\r\n    // 文字垂直方向的内边距\r\n    double pdVertical = 10.0,\r\n  }) async {\r\n    assert(msg != null);\r\n\r\n    _msg = msg;\r\n    _startedTime = DateTime.now();\r\n    _showTime = showTime;\r\n    _bgColor = bgColor;\r\n    _textColor = textColor;\r\n    _textSize = textSize;\r\n    _toastPosition = position;\r\n    _pdHorizontal = pdHorizontal;\r\n    _pdVertical = pdVertical;\r\n\r\n    // 获取OverlayState\r\n    OverlayState overlayState = Overlay.of(context);\r\n\r\n    _showing = true;\r\n\r\n    if (_overlayEntry == null) {\r\n      //\r\n      // OverlayEntry负责构建布局\r\n      // 通过OverlayEntry将构建的布局插入到整个布局的最上层\r\n      _overlayEntry = OverlayEntry(\r\n        builder: (BuildContext context) =&gt; Positioned(\r\n          // top值，可以改变这个值来改变toast在屏幕中的位置\r\n          top: buildToastPosition(context),\r\n          child: Container(\r\n              alignment: Alignment.center,\r\n              width: MediaQuery.of(context).size.width,\r\n              child: Padding(\r\n                padding: EdgeInsets.symmetric(horizontal: 40.0),\r\n                child: AnimatedOpacity(\r\n                  opacity: _showing ? 1.0 : 0.0, // 目标透明度\r\n                  duration: _showing ? \r\n                      Duration(milliseconds: 100) : Duration(milliseconds: 400),\r\n                  child: _buildToastWidget(),\r\n                ),\r\n              )),\r\n        ),\r\n      );\r\n\r\n      // 插入到整个布局的最上层\r\n      overlayState.insert(_overlayEntry);\r\n      //\r\n    } else {\r\n      // 重新绘制UI，类似setState\r\n      _overlayEntry.markNeedsBuild();\r\n    }\r\n\r\n    // 等待时间\r\n    await Future.delayed(Duration(milliseconds: _showTime));\r\n\r\n    // 2 秒后 到底消失不消失\r\n    if (DateTime.now().difference(_startedTime).inMilliseconds &gt;= _showTime) {\r\n      _showing = false;\r\n      _overlayEntry.markNeedsBuild();\r\n      await Future.delayed(Duration(milliseconds: 400));\r\n      _overlayEntry.remove();\r\n      _overlayEntry = null;\r\n    }\r\n  }\r\n\r\n  // toast 绘制\r\n  static _buildToastWidget() {\r\n    return Center(\r\n      child: Card(\r\n        color: _bgColor,\r\n        child: Padding(\r\n          padding: EdgeInsets.symmetric(horizontal: _pdHorizontal, vertical: _pdVertical),\r\n          child: Text(_msg, style: TextStyle(fontSize: _textSize, color: _textColor)),\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n\r\n// 设置toast位置\r\n  static buildToastPosition(context) {\r\n    //\r\n    var backResult;\r\n\r\n    if (_toastPosition == ToastPostion.top) {\r\n      backResult = MediaQuery.of(context).size.height * 1 / 4;\r\n    } else if (_toastPosition == ToastPostion.center) {\r\n      backResult = MediaQuery.of(context).size.height * 2 / 5;\r\n    } else {\r\n      backResult = MediaQuery.of(context).size.height * 3 / 4;\r\n    }\r\n\r\n    return backResult;\r\n  }\r\n}</code></pre>\r\n<h2 id=\"-2\">\r\n    调用云库接口分析局面</h2>\r\n<p>\r\n    我们在 lib/engine 文件夹下新建 analysis.dart 文件，创建两个解析 chess-db 着法响应的工具类：</p>\r\n<pre><code id=\"code-5\">class AnalysisItem {\r\n  // 着法，着法中文描述\r\n  String move, stepName;\r\n  // 此着法应用后的局面分值\r\n  int score;\r\n  // 使用此着法后的棋局胜率估算\r\n  double winrate;\r\n\r\n  AnalysisItem({this.move, this.score, this.winrate});\r\n\r\n  @override\r\n  String toString() {\r\n    return \'{move: ${stepName ?? move}, score: $score, winrate: $winrate}\';\r\n  }\r\n}\r\n\r\n// 解析云库的分析结果\r\nclass AnalysisFetcher {\r\n  // 默认解析前5种着法\r\n  static List<analysisitem> fetch(String response, {limit = 5}) {\r\n    //\r\n    final segments = response.split(\'|\');\r\n\r\n    List<analysisitem> result = [];\r\n\r\n    final regx = RegExp(r\'move:(.{4}).+score:(\\-?\\d+).+winrate:(\\d+.?\\d*)\');\r\n\r\n    for (var segment in segments) {\r\n      //\r\n      final match = regx.firstMatch(segment);\r\n\r\n      if (match == null) break;\r\n\r\n      final move = match.group(1);\r\n      final score = int.parse(match.group(2));\r\n      final winrate = double.parse(match.group(3));\r\n\r\n      result.add(AnalysisItem(move: move, score: score, winrate: winrate));\r\n      if (result.length == limit) break;\r\n    }\r\n\r\n    return result;\r\n  }\r\n}\r\n</analysisitem></analysisitem></code></pre>\r\n<p>\r\n    在 CloudEngine 类中，我们添加一个 analysis 方法来封装 chess-db 着法查询 API：</p>\r\n<pre><code id=\"code-6\">// 给云库引擎添加分析方法，之后会调用前述的分析结果解析工具\r\nstatic Future<engineresponse> analysis(Phase phase) async {\r\n  //\r\n  final fen = phase.toFen();\r\n  var response = await ChessDB.query(fen);\r\n\r\n  if (response == null) return EngineResponse(\'network-error\');\r\n\r\n  if (response.startsWith(\'move:\')) {\r\n    final items = AnalysisFetcher.fetch(response);\r\n    if (items.isEmpty) return EngineResponse(\'no-result\');\r\n    return EngineResponse(\'analysis\', value: items);\r\n  }\r\n\r\n  print(\'ChessDB.query: $response\\n\');\r\n  return EngineResponse(\'unknown-error\');\r\n}\r\n</engineresponse></code></pre>\r\n<p>\r\n    云库的 API 包装就这么简单地搞定了！</p>\r\n<h2 id=\"-3\">\r\n    呈现分析结果</h2>\r\n<p>\r\n    我们进入 _BattlePageState 类，先声明一个 bool 型的成员变量，它是为了预防上一个分析结果还没有返回，用户又请求下一次分析的：</p>\r\n<pre><code id=\"code-7\">class _BattlePageState extends State<battlepage> {\r\n  //\r\n  ...\r\n  bool _analysising = false;\r\n\r\n  ...\r\n}\r\n</battlepage></code></pre>\r\n<p>\r\n    接着，我们在 _BattlePageState 类中添加两个方法，用于调用我们刚才实现于 CloudEngine 中的分析方法，并呈现给用户：</p>\r\n<pre><code id=\"code-8\">analysisPhase() async {\r\n    //\r\n    Toast.toast(context, msg: \'正在分析局面...\', position: ToastPostion.bottom);\r\n\r\n    setState(() =&gt; _analysising = true);\r\n\r\n    try {\r\n      final result = await CloudEngine.analysis(Battle.shared.phase);\r\n\r\n      // 云库反回了正确的分析结果\r\n      if (result.type == \'analysis\') {\r\n        //\r\n        List<analysisitem> items = result.value;\r\n        items.forEach(\r\n          (item) =&gt; item.stepName = StepName.translate(\r\n            Battle.shared.phase,\r\n            Move.fromEngineStep(item.move),\r\n          ),\r\n        );\r\n        showAnalysisItems(\r\n          context,\r\n          title: \'推荐招法\',\r\n          items: result.value,\r\n          callback: (index) =&gt; Navigator.of(context).pop(),\r\n        );\r\n      } else if (result.type == \'no-result\') {\r\n        // 云库表示无分析结论\r\n        // 我们提交服务器后台进行计算，玩家可以过一会再点击分析来查看分析结论\r\n        Toast.toast(\r\n          context,\r\n          msg: \'已请求服务器计算，请稍后查看！\',\r\n          position: ToastPostion.bottom,\r\n        );\r\n      } else {\r\n        Toast.toast(\r\n          context,\r\n          msg: \'错误: ${result.type}\',\r\n          position: ToastPostion.bottom,\r\n        );\r\n      }\r\n    } catch (e) {\r\n      Toast.toast(context, msg: \'错误: $e\', position: ToastPostion.bottom);\r\n    } finally {\r\n      setState(() =&gt; _analysising = false);\r\n    }\r\n  }\r\n\r\n    // 显示分析结论\r\n  showAnalysisItems(\r\n    BuildContext context, {\r\n    String title,\r\n    List<analysisitem> items,\r\n    Function(AnalysisItem item) callback,\r\n  }) {\r\n    //\r\n    final List<widget> children = [];\r\n\r\n    for (var item in items) {\r\n      children.add(\r\n        ListTile(\r\n          title: Text(item.stepName, style: TextStyle(fontSize: 18)),\r\n          subtitle: Text(\'胜率：${item.winrate}%\'),\r\n          trailing: Text(\'分数：${item.score}\'),\r\n          onTap: () =&gt; callback(item),\r\n        ),\r\n      );\r\n      children.add(Divider());\r\n    }\r\n\r\n    children.insert(0, SizedBox(height: 10));\r\n    children.add(SizedBox(height: 56));\r\n\r\n    showModalBottomSheet(\r\n      context: context,\r\n      builder: (BuildContext context) =&gt; SingleChildScrollView(\r\n        child: Column(mainAxisSize: MainAxisSize.min, children: children),\r\n      ),\r\n    );\r\n  }\r\n</widget></analysisitem></analysisitem></code></pre>\r\n<p>\r\n    最后，在 createOperatorBar 方法中找到以下代码：</p>\r\n<pre><code id=\"code-9\">FlatButton(child: Text(\'分析局面\', style: buttonStyle), onPressed: () {}),\r\n</code></pre>\r\n<p>\r\n    将它修改成下边的样子：</p>\r\n<pre><code id=\"code-10\">FlatButton(\r\n  child: Text(\'分析局面\', style: buttonStyle),\r\n  onPressed: _analysising ? null : analysisPhase,\r\n),\r\n</code></pre>\r\n<p>\r\n    现在运行产品试试：轮到你走棋的时候，你可以点击「分析局面」，然后会从屏幕底部弹出一个弹框，提示有哪些推荐的着法，信息还包括应用指定着法后的局面分值和胜率！</p>\r\n<p>\r\n    有了云库的局面分析做后盾，杀个特大也不特别难样~~</p>\r\n<p>\r\n    记得将代码提交到 git 仓库，多玩玩我们的产品，找到你自己的体验提升点！</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'云库局面分析-带bug\'\r\n[master da1a94e] 云库局面分析-带bug\r\n 6 files changed, 303 insertions(+), 3 deletions(-)\r\n create mode 100644 lib/common/toast.dart\r\n create mode 100644 lib/engine/analysis.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 21, 完成.\r\n对象计数中: 100% (21/21), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (12/12), 完成.\r\n写入对象中: 100% (12/12), 4.39 KiB | 2.20 MiB/s, 完成.\r\n总共 12 （差异 6），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 2408:8256:686:a5d9:c8f6:779b:a786:ce9e by http(s).\r\nremote: RocketGit: Info: date/time: 2020-09-07 10:34:17 (UTC), debug id acaa59.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   c574648..da1a94e  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ \r\n</code>\r\n</pre>\r\n<h2 id=\"-4\">\r\n    小节回顾</h2>\r\n<p>\r\n    本小节中，我们实现了局面分析的功能，这个功能使用云库的 API 来给当前局面查找最优的后续着法，并对每个可能着法进行评分。</p>\r\n<p>\r\n    为了向玩家展示着法，我们首先实现了对着法的中文化翻译，这部分功能也在记谱中被使用。</p>\r\n<p>\r\n    接着，我们使用与云库引擎类似的方式来封装了云库的 API 接口，通过将局面 FEN 传给云库来获取云库对局面的着法推荐和着法评估。</p>\r\n<p>\r\n    最后，我们把云库返回的着法以中文化的着法列表方式显示给玩家，供玩家理解和学习局面。</p>                                                                                    '),(33,'                                                                                                                                <p>\r\n    从游戏的完整性角度来说，我们还有一些工作要做。例如人机对战的难度，我们可以进行调节；背景音乐要不要自动播放，我们也需要设置；如果有人喜欢我们的游戏，想联系我们，我们应该有个关于页面让别人能找到我们。因此，我们需要给游戏添加一个设置页。\r\n</p>\r\n<h2 id=\"\">\r\n    本节概要</h2>\r\n<ul>\r\n    <li>实现本地配置的持久化工具</li>\r\n    <li>实现设置页面</li>\r\n    <li>在关于页面中获取版本信息和链接</li>\r\n</ul>\r\n<h2 id=\"-1\">\r\n    实现保存配置的工具类</h2>\r\n<p>\r\n    为了能让玩家的设置被保留起来，我们先在 lib/common 文件夹下新建 \"profile.dart\"，它以键值对的方式，将用户设置信息保存在手机存储中，下次游戏开始时，自动加载并应用这些配置信息：</p>\r\n<pre><code id=\"code-0\">import \'dart:convert\';\r\nimport \'dart:io\';\r\nimport \'package:path_provider/path_provider.dart\';\r\n\r\n// 基于本地文件和 Json 操作，实现本地持久化\r\nclass Profile {\r\n  //\r\n  static const DefaultFileName = \'default-profile.json\';\r\n  static Profile _shared;\r\n\r\n  File _file;\r\n  Map<string, dynamic=\"\"> _values = {};\r\n\r\n  static shared() async {\r\n    //\r\n    if (_shared == null) {\r\n      _shared = Profile();\r\n      await _shared._load(DefaultFileName);\r\n    }\r\n\r\n    return _shared;\r\n  }\r\n\r\n  // 重定义数组操作\r\n\r\n  operator [](String key) =&gt; _values[key];\r\n\r\n  operator []=(String key, dynamic value) =&gt; _values[key] = value;\r\n\r\n  // 保存数据的修改\r\n  Future<bool> commit() async {\r\n    //\r\n    _file.create(recursive: true);\r\n\r\n    try {\r\n      final contents = jsonEncode(_values);\r\n      await _file.writeAsString(contents);\r\n    } catch (e) {\r\n      print(\'Error: $e\');\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  // 从文件中加载数据\r\n  Future<bool> _load(String fileName) async {\r\n    //\r\n    final docDir = await getApplicationDocumentsDirectory();\r\n    _file = File(\'${docDir.path}/$fileName\');\r\n\r\n    try {\r\n      final contents = await _file.readAsString();\r\n      _values = jsonDecode(contents);\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n</bool></bool></string,></code></pre>\r\n<p>\r\n    这个类运行后，默认会在应用的文档目录下创建一个 default-profile.json 文件，并交用户的配置信息保存在这个文件中。这个类重载了「=」和「=()」运算符，直接可以，可以像使用 Map 一样操作操作配置项。</p>\r\n<p>\r\n    基于于 Profile，我们在 lib/common 文件夹下新建“config.dart”文件，这个类用于管理用户的配置内容：</p>\r\n<pre><code id=\"code-1\">import \'profile.dart\';\r\n\r\n// 基于本地文件持久化工具实现的配置管理类\r\nclass Config {\r\n  //\r\n  static bool bgmEnabled = true;\r\n  static bool toneEnabled = true;\r\n  static int stepTime = 5000;\r\n\r\n  // 加载配置项\r\n  static Future<void> loadProfile() async {\r\n    //\r\n    final profile = await Profile.shared();\r\n\r\n    Config.bgmEnabled = profile[\'bgm-enabled\'] ?? true;\r\n    Config.toneEnabled = profile[\'tone-enabled\'] ?? true;\r\n    Config.stepTime = profile[\'step-time\'] ?? 5000;\r\n\r\n    return true;\r\n  }\r\n\r\n  // 保存配置项到本地文件\r\n  static Future<bool> save() async {\r\n    //\r\n    final profile = await Profile.shared();\r\n\r\n    profile[\'bgm-enabled\'] = Config.bgmEnabled;\r\n    profile[\'tone-enabled\'] = Config.toneEnabled;\r\n    profile[\'step-time\'] = Config.stepTime;\r\n\r\n    profile.commit();\r\n\r\n    return true;\r\n  }\r\n}\r\n</bool></void></code></pre>\r\n<p>\r\n    这个工具类集中管理了游戏中需要进行配置的三个设置项。</p>\r\n<h2 id=\"-2\">\r\n    实现设置页面</h2>\r\n<p>\r\n    现在我们来添加设置页面，我们在 lib/routes 文件夹下新建 setting-page.dart 文件：</p>\r\n<pre><code id=\"code-2\">import \'package:chessroad/services/player.dart\';\r\nimport \'package:flutter/material.dart\';\r\nimport \'package:flutter/services.dart\';\r\nimport \'package:package_info/package_info.dart\';\r\nimport \'../common/toast.dart\';\r\nimport \'../common/color-consts.dart\';\r\nimport \'../common/config.dart\';\r\nimport \'../services/audios.dart\';\r\nimport \'edit-page.dart\';\r\n\r\nclass SettingsPage extends StatefulWidget {\r\n  @override\r\n  _SettingsPageState createState() =&gt; _SettingsPageState();\r\n}\r\n\r\nclass _SettingsPageState extends State<settingspage> {\r\n  //\r\n  String _version = \'Ver 1.00\';\r\n\r\n  @override\r\n  void initState() {\r\n    super.initState();\r\n    loadVersionInfo();\r\n  }\r\n\r\n  // 使用三方插件读取应用的版本信息\r\n  loadVersionInfo() async {\r\n    //\r\n    final packageInfo = await PackageInfo.fromPlatform();\r\n    setState(() {\r\n      _version = \'Version ${packageInfo.version} (${packageInfo.buildNumber})\';\r\n    });\r\n  }\r\n\r\n  // 切换引擎的难度等级\r\n  changeDifficult() {\r\n    //\r\n    callback(int stepTime) async {\r\n      //\r\n      Navigator.of(context).pop();\r\n\r\n      setState(() {\r\n        Config.stepTime = stepTime;\r\n      });\r\n\r\n      Config.save();\r\n    }\r\n\r\n    // 难度等级目前是由给引擎的思考时间决定的\r\n    // 其它一些可调整的因素还包括：\r\n    // = 是否启用开局库\r\n    // = 是否在选择着法时放弃最优着法\r\n    showModalBottomSheet(\r\n      context: context,\r\n      builder: (BuildContext context) =&gt; Column(\r\n        mainAxisSize: MainAxisSize.min,\r\n        children: <widget>[\r\n          SizedBox(height: 10),\r\n          RadioListTile(\r\n            activeColor: ColorConsts.Primary,\r\n            title: Text(\'初级\'),\r\n            groupValue: Config.stepTime,\r\n            value: 5000,\r\n            onChanged: callback,\r\n          ),\r\n          Divider(),\r\n          RadioListTile(\r\n            activeColor: ColorConsts.Primary,\r\n            title: Text(\'中级\'),\r\n            groupValue: Config.stepTime,\r\n            value: 15000,\r\n            onChanged: callback,\r\n          ),\r\n          Divider(),\r\n          RadioListTile(\r\n            activeColor: ColorConsts.Primary,\r\n            title: Text(\'高级\'),\r\n            groupValue: Config.stepTime,\r\n            value: 30000,\r\n            onChanged: callback,\r\n          ),\r\n          Divider(),\r\n          SizedBox(height: 56),\r\n        ],\r\n      ),\r\n    );\r\n  }\r\n\r\n  // 开头背景音乐\r\n  switchMusic(bool value) async {\r\n    //\r\n    setState(() {\r\n      Config.bgmEnabled = value;\r\n    });\r\n\r\n    if (Config.bgmEnabled) {\r\n      Audios.loopBgm(\'bg_music.mp3\');\r\n    } else {\r\n      Audios.stopBgm();\r\n    }\r\n\r\n    Config.save();\r\n  }\r\n\r\n  // 开关动作音效\r\n  switchTone(bool value) async {\r\n    //\r\n    setState(() {\r\n      Config.toneEnabled = value;\r\n    });\r\n\r\n    Config.save();\r\n  }\r\n\r\n  // 修改玩家的游戏名\r\n  changeName() async {\r\n    //\r\n    final newName = await Navigator.of(context).push(\r\n      MaterialPageRoute(builder: (context) =&gt; EditPage(\'棋手姓名\', initValue: Player.shared.name)),\r\n    );\r\n\r\n    if (newName != null) nameChanged(newName);\r\n  }\r\n\r\n  nameChanged(String newName) async {\r\n    //\r\n    setState(() {\r\n      Player.shared.name = newName;\r\n    });\r\n\r\n    Player.shared.saveAndUpload();\r\n  }\r\n\r\n  // 显示关于对话框\r\n  showAbout() {\r\n    //\r\n    showDialog(\r\n      context: context,\r\n      barrierDismissible: false,\r\n      builder: (context) =&gt; AlertDialog(\r\n        title: Text(\'关于「棋路」\', style: TextStyle(color: ColorConsts.Primary)),\r\n        content: Column(\r\n          mainAxisSize: MainAxisSize.min,\r\n          crossAxisAlignment: CrossAxisAlignment.start,\r\n          children: <widget>[\r\n            SizedBox(height: 5),\r\n            Text(\'版本\', style: TextStyle(fontFamily: \'\')),\r\n            Text(\'$_version\', style: TextStyle(fontFamily: \'\')),\r\n            SizedBox(height: 15),\r\n            Text(\'QQ群\', style: TextStyle(fontFamily: \'\')),\r\n            GestureDetector(\r\n              onTap: () {\r\n                Clipboard.setData(ClipboardData(text: \'67220535\'));\r\n                Toast.toast(context, msg: \'群号已复制！\');\r\n              },\r\n              child: Text(\r\n                \"67220535\",\r\n                style: TextStyle(fontFamily: \'\', color: Colors.blue),\r\n              ),\r\n            ),\r\n            SizedBox(height: 15),\r\n            Text(\'官网\', style: TextStyle(fontFamily: \'\')),\r\n            GestureDetector(\r\n              onTap: () {\r\n                Clipboard.setData(\r\n                  ClipboardData(text: \'https://www.apppk.cn/apps/chessroad.html\'),\r\n                );\r\n                Toast.toast(context, msg: \'网址已复制！\');\r\n              },\r\n              child: Text(\r\n                \"https://www.apppk.cn/apps/chessroad.html\",\r\n                style: TextStyle(fontFamily: \'\', color: Colors.blue),\r\n              ),\r\n            ),\r\n          ],\r\n        ),\r\n        actions: <widget>[\r\n          FlatButton(child: Text(\'好的\'), onPressed: () =&gt; Navigator.of(context).pop()),\r\n        ],\r\n      ),\r\n    );\r\n  }\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    //\r\n    final TextStyle headerStyle = TextStyle(color: ColorConsts.Secondary, fontSize: 20.0);\r\n    final TextStyle itemStyle = TextStyle(color: ColorConsts.Primary);\r\n\r\n    return Scaffold(\r\n      backgroundColor: ColorConsts.LightBackground,\r\n      appBar: AppBar(title: Text(\'设置\')),\r\n      body: SingleChildScrollView(\r\n        padding: const EdgeInsets.all(16),\r\n        child: Column(\r\n          crossAxisAlignment: CrossAxisAlignment.start,\r\n          children: <widget>[\r\n            const SizedBox(height: 10.0),\r\n            Text(\"人机难度\", style: headerStyle),\r\n            const SizedBox(height: 10.0),\r\n            Card(\r\n              color: ColorConsts.BoardBackground,\r\n              elevation: 0.5,\r\n              margin: const EdgeInsets.symmetric(vertical: 4.0, horizontal: 0),\r\n              child: Column(\r\n                children: <widget>[\r\n                  ListTile(\r\n                    title: Text(\"游戏难度\", style: itemStyle),\r\n                    trailing: Row(mainAxisSize: MainAxisSize.min, children: <widget>[\r\n                      Text(Config.stepTime &lt;= 5000 ? \'初级\' :\r\n                           Config.stepTime &lt;= 15000 ? \'中级\' : \'高级\'),\r\n                      Icon(Icons.keyboard_arrow_right, color: ColorConsts.Secondary),\r\n                    ]),\r\n                    onTap: changeDifficult,\r\n                  ),\r\n                ],\r\n              ),\r\n            ),\r\n            const SizedBox(height: 16),\r\n            Text(\"声音\", style: headerStyle),\r\n            Card(\r\n              color: ColorConsts.BoardBackground,\r\n              margin: const EdgeInsets.symmetric(vertical: 10),\r\n              child: Column(\r\n                children: <widget>[\r\n                  SwitchListTile(\r\n                    activeColor: ColorConsts.Primary,\r\n                    value: Config.bgmEnabled,\r\n                    title: Text(\"背景音乐\", style: itemStyle),\r\n                    onChanged: switchMusic,\r\n                  ),\r\n                  _buildDivider(),\r\n                  SwitchListTile(\r\n                    activeColor: ColorConsts.Primary,\r\n                    value: Config.toneEnabled,\r\n                    title: Text(\"提示音效\", style: itemStyle),\r\n                    onChanged: switchTone,\r\n                  ),\r\n                ],\r\n              ),\r\n            ),\r\n            const SizedBox(height: 16),\r\n            Text(\"排行榜\", style: headerStyle),\r\n            Card(\r\n              color: ColorConsts.BoardBackground,\r\n              margin: const EdgeInsets.symmetric(vertical: 10),\r\n              child: Column(\r\n                children: <widget>[\r\n                  ListTile(\r\n                    title: Text(\"棋手姓名\", style: itemStyle),\r\n                    trailing: Row(mainAxisSize: MainAxisSize.min, children: <widget>[\r\n                      Text(Player.shared.name),\r\n                      Icon(Icons.keyboard_arrow_right, color: ColorConsts.Secondary),\r\n                    ]),\r\n                    onTap: changeName,\r\n                  ),\r\n                ],\r\n              ),\r\n            ),\r\n            const SizedBox(height: 16),\r\n            Text(\"关于\", style: headerStyle),\r\n            Card(\r\n              color: ColorConsts.BoardBackground,\r\n              margin: const EdgeInsets.symmetric(vertical: 10),\r\n              child: Column(\r\n                children: <widget>[\r\n                  ListTile(\r\n                    title: Text(\"关于「棋路」\", style: itemStyle),\r\n                    trailing: Row(mainAxisSize: MainAxisSize.min, children: <widget>[\r\n                      Text(_version ?? \'\'),\r\n                      Icon(Icons.keyboard_arrow_right, color: ColorConsts.Secondary),\r\n                    ]),\r\n                    onTap: showAbout,\r\n                  ),\r\n                ],\r\n              ),\r\n            ),\r\n            const SizedBox(height: 60.0),\r\n          ],\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n\r\n  Container _buildDivider() {\r\n    return Container(\r\n      margin: const EdgeInsets.symmetric(horizontal: 16),\r\n      width: double.infinity,\r\n      height: 1.0,\r\n      color: ColorConsts.LightLine,\r\n    );\r\n  }\r\n}\r\n</widget></widget></widget></widget></widget></widget></widget></widget></widget></widget></widget></settingspage></code></pre>\r\n<p>\r\n    页面中可以修改排行榜上的玩家名称，因此我们还需要引入一个专门用来编辑玩家名称的页面，我们在 lib/routes 文件夹下新建一个 edit-page.dart 文件：</p>\r\n<pre><code>\r\nimport \'package:flutter/material.dart\';\r\nimport \'../common/color-consts.dart\';\r\n\r\nclass EditPage extends StatefulWidget {\r\n  //\r\n  final String title, initValue;\r\n  EditPage(this.title, {this.initValue});\r\n\r\n  @override\r\n  _EditPageState createState() =&gt; _EditPageState();\r\n}\r\n\r\nclass _EditPageState extends State<editpage> {\r\n  //\r\n  TextEditingController _textController;\r\n  FocusNode _commentFocus = FocusNode();\r\n\r\n  onSubmit(String input) {\r\n    Navigator.of(context).pop(input);\r\n  }\r\n\r\n  @override\r\n  void initState() {\r\n    //\r\n    _textController = TextEditingController();\r\n    _textController.text = widget.initValue;\r\n\r\n    Future.delayed(\r\n      Duration(milliseconds: 10),\r\n      () =&gt; FocusScope.of(context).requestFocus(_commentFocus),\r\n    );\r\n\r\n    super.initState();\r\n  }\r\n\r\n  @override\r\n  Widget build(BuildContext context) {\r\n    //\r\n    final inputBorder = OutlineInputBorder(\r\n      borderRadius: BorderRadius.circular(25),\r\n      borderSide: BorderSide(color: ColorConsts.Secondary),\r\n    );\r\n\r\n    return Scaffold(\r\n      appBar: AppBar(\r\n        title: Text(widget.title, style: TextStyle(fontFamily: \'\')),\r\n        actions: <widget>[\r\n          FlatButton(\r\n            child: Text(\'确定\',\r\n                style: TextStyle(fontFamily: \'\', color: Colors.white)),\r\n            onPressed: () =&gt; onSubmit(_textController.text),\r\n          )\r\n        ],\r\n      ),\r\n      backgroundColor: ColorConsts.LightBackground,\r\n      body: Container(\r\n        margin: EdgeInsets.all(16),\r\n        child: Column(\r\n          children: <widget>[\r\n            TextField(\r\n              controller: _textController,\r\n              decoration: InputDecoration(\r\n                contentPadding:\r\n                    EdgeInsets.symmetric(vertical: 0, horizontal: 16),\r\n                enabledBorder: inputBorder,\r\n                focusedBorder: inputBorder,\r\n              ),\r\n              style: TextStyle(\r\n                  color: ColorConsts.Primary, fontSize: 16, fontFamily: \'\'),\r\n              onSubmitted: (input) =&gt; onSubmit(input),\r\n              focusNode: _commentFocus,\r\n            ),\r\n          ],\r\n        ),\r\n      ),\r\n    );\r\n  }\r\n\r\n  @override\r\n  void deactivate() {\r\n    FocusScope.of(context).requestFocus(FocusNode());\r\n    super.deactivate();\r\n  }\r\n}\r\n\r\n</widget></widget></editpage></code></pre>\r\n<p>\r\n    这样，一个美观的设置页就完成了！</p>\r\n<h2 id=\"-3\">\r\n    获取版本信息和链接</h2>\r\n<p>\r\n    这个页还基本功能是没有问题，但还有两个可以优化的点：</p>\r\n<ul>\r\n    <li>首先，应用版本应该自动从程序的打包信息中获取，而不应该只是写一个固定的值，避免以后每次发版都要修改设置页里面的版本信息；</li>\r\n    <li>其次，关于而成放置了我们的 QQ 群和访问网址，用户虽然能看到，但不能点击访问，我们可以试着优化玩家访问 QQ 群和网址的体验。</li>\r\n</ul>\r\n<p>\r\n    为了能从包中获取应用版本，我们引入一个插件&nbsp;<a href=\"https://pub.dev/packages/package_info\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">package_info</a>。\r\n</p>\r\n<p>\r\n    我们在 pubspec.yaml 中引入我们需要的包，在 vscode 中保存这个文件将自动触发 pub get 指令：</p>\r\n<pre><code class=\"yaml language-yaml\" id=\"code-4\">...\r\n\r\ndependencies:\r\n  flutter:\r\n    sdk: flutter\r\n\r\n  ...\r\n\r\n  package_info: ^0.4.0+16\r\n\r\n...\r\n</code></pre>\r\n<p>\r\n    然后我们回到 _SettingPageState 类，我们我覆盖 initState 方法，并在其中使用代码获取应用的版本信息，并将获取到的版本信息存到 _version 变量，然后使用 setState 方法通知 State\r\n    重新构造：</p>\r\n<pre><code id=\"code-5\">class _SettingsPageState extends State<settingspage> {\r\n  //\r\n  String _version;\r\n\r\n  @override\r\n  void initState() {\r\n    super.initState();\r\n    loadVersionInfo();\r\n  }\r\n\r\n  loadVersionInfo() async {\r\n    //\r\n    final packageInfo = await PackageInfo.fromPlatform();\r\n    setState(() {\r\n      _version = \'Version ${packageInfo.version} (${packageInfo.buildNumber})\';\r\n    });\r\n  }\r\n\r\n  ...\r\n}\r\n</settingspage></code></pre>\r\n<p>\r\n    我们再来处理网址和群号点击后的如何访问的问题。</p>\r\n<p>\r\n    如果用户点击了 QQ 群号或网址，我们现在的处理方案是自动把群号或网址复制到剪贴板，并告诉用户已经复制群号或网址。在 _SettingPageState 类的 showAbout 方法中找到以下的代码：</p>\r\n<pre><code id=\"code-6\">class _SettingsPageState extends State<settingspage> {\r\n  //\r\n  ...\r\n\r\n  showAbout() {\r\n    //\r\n    showDialog(\r\n      ...,\r\n            Text(\'QQ群\', style: TextStyle(fontFamily: \'\')),\r\n            Text(\"http://67220535\", style: TextStyle(fontFamily: \'\')),\r\n            SizedBox(height: 15),\r\n            Text(\'官网\', style: TextStyle(fontFamily: \'\')),\r\n            Text(\r\n              \"https://www.apppk.cn/apps/chessroad.html\",\r\n              style: TextStyle(fontFamily: \'\'),\r\n            ),\r\n      ...\r\n    );\r\n  }\r\n\r\n  ...\r\n}\r\n</settingspage></code></pre>\r\n<p>\r\n    我们使用 GestureDetector Widget 来包裹群号和网址，这样能检测到它们的点击事件。此外，为了让玩家觉得群号和链接可以点击，我们需要修改一下链接和群号的文字样式：</p>\r\n<pre><code id=\"code-7\">class _SettingsPageState extends State<settingspage> {\r\n  //\r\n  ...\r\n\r\n  showAbout() {\r\n    //\r\n    showDialog(\r\n      ...,\r\n            Text(\'QQ群\', style: TextStyle(fontFamily: \'\')),\r\n                  // 点击 QQ 群时，复制 QQ 群号到剪贴板\r\n            GestureDetector(\r\n              onTap: () {\r\n                Clipboard.setData(ClipboardData(text: \'67220535\'));\r\n                Toast.toast(context, msg: \'群号已复制！\');\r\n              },\r\n              child: Text(\r\n                \"http://67220535\",\r\n                style: TextStyle(fontFamily: \'\', color: Colors.blue),\r\n              ),\r\n            ),\r\n            SizedBox(height: 15),\r\n            Text(\'官网\', style: TextStyle(fontFamily: \'\')),\r\n                  // 点击官网地址时，复制地址到剪贴板\r\n            GestureDetector(\r\n              onTap: () {\r\n                Clipboard.setData(\r\n                  ClipboardData(text: \'https://www.apppk.cn/apps/chessroad.html\'),\r\n                );\r\n                Toast.toast(context, msg: \'网址已复制！\');\r\n              },\r\n              child: Text(\r\n                \"https://www.apppk.cn/apps/chessroad.html\",\r\n                style: TextStyle(fontFamily: \'\', color: Colors.blue),\r\n              ),\r\n            ),\r\n      ...\r\n    );\r\n  }\r\n\r\n  ...\r\n}\r\n</settingspage></code></pre>\r\n<p>\r\n    这样，玩家在关于对话框时点击群号或链接时，会弹出 Toast 告知群号或网址已复制到剪贴板上，他们可以方便在 QQ 中添加我们的玩家群，或是在浏览器中访问我们的网址了。</p>\r\n<p>\r\n    最后一步，我们在各个完整页面上的右上角（菜单页在左上角）的按钮中做关联。</p>\r\n<p>\r\n    我们全局搜索（在 vscode 中按&nbsp;<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">Cmd+Shift+F</code>）\r\n    一下&nbsp;<code style=\"font-family: \" source=\"\" code=\"\" pro\",=\"\" monospace;=\"\" font-size:=\"\" 0.9em;=\"\" color:=\"\" rgb(63,=\"\" 63,=\"\" 63);=\"\" background-color:=\"\" rgba(128,=\"\" 128,=\"\" 0.075);=\"\" outline:=\"\" 0px=\"\" !important;\"=\"\">Icons.settings</code>，这是页面左上角或右上角的设置按钮。应该能搜索到两处，单机对战和挑战云主机用一相同的页面。\r\n</p>\r\n<p>\r\n    我们先在 MainMenu 页的 build 方法中找到以下代码：</p>\r\n<pre><code id=\"code-10\">child: IconButton(\r\n  icon: Icon(Icons.settings, color: ColorConsts.Primary), \r\n  onPressed: () {},\r\n),\r\n</code></pre>\r\n<p>\r\n    将它改成下边的样子：</p>\r\n<pre><code id=\"code-11\">child: IconButton(\r\n  icon: Icon(Icons.settings, color: ColorConsts.Primary),\r\n  onPressed: () =&gt; Navigator.of(context).push(\r\n    MaterialPageRoute(builder: (context) =&gt; SettingsPage()),\r\n  ),\r\n),\r\n</code></pre>\r\n<p>\r\n    之后，我们在 _BattlePageState 的 createPageHeader 方法中，找到以下的代码：</p>\r\n<pre><code id=\"code-12\">IconButton(\r\n  icon: Icon(Icons.settings, color: ColorConsts.DarkTextPrimary),\r\n  onPressed: () {},\r\n),\r\n</code></pre>\r\n<p>\r\n    将它改成下边的样子：</p>\r\n<pre><code id=\"code-13\">IconButton(\r\n  icon: Icon(Icons.settings, color: ColorConsts.DarkTextPrimary),\r\n  onPressed: () =&gt; Navigator.of(context).push(\r\n    MaterialPageRoute(builder: (context) =&gt; SettingsPage()),\r\n  ),\r\n),\r\n</code></pre>\r\n<p>\r\n    现在，如果你在一个安静的环境中想玩两盘象棋，去设置面关掉背景音乐和音效即可。</p>\r\n<p>\r\n    记得将代码提示到 git 仓库，游戏的开发工作靠一段落！</p>\r\n<pre><code>\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git add .\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ git commit -m \'游戏设置-带bug\'\r\n[master 404a7a7] 游戏设置-带bug\r\n 8 files changed, 684 insertions(+), 2 deletions(-)\r\n create mode 100644 lib/common/config.dart\r\n create mode 100644 lib/common/profile.dart\r\n create mode 100644 lib/routes/edit-page.dart\r\n create mode 100644 lib/routes/setting-page.dart\r\n create mode 100644 lib/services/player.dart\r\n create mode 100644 lib/services/ranks.dart\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ sudo git push\r\n[sudo] elapse 的密码： \r\nUsername for \'https://rocketgit.com\': elapse\r\nPassword for \'https://elapse@rocketgit.com\': \r\n枚举对象: 21, 完成.\r\n对象计数中: 100% (21/21), 完成.\r\n使用 4 个线程进行压缩\r\n压缩对象中: 100% (14/14), 完成.\r\n写入对象中: 100% (14/14), 6.44 KiB | 6.44 MiB/s, 完成.\r\n总共 14 （差异 4），复用 0 （差异 0）\r\nremote: RocketGit: Info: == Welcome to RocketGit! ==\r\nremote: RocketGit: Info: you are connecting from IP 2408:8256:686:a5d9:c8f6:779b:a786:ce9e by http(s).\r\nremote: RocketGit: Info: date/time: 2020-09-07 11:50:22 (UTC), debug id 0024a5.\r\nTo https://rocketgit.com/user/elapse/chinese_chess\r\n   da1a94e..404a7a7  master -&gt; master\r\nelapse@elapse-PC:~/Language/Flutter/chinese_chess$ \r\n</code>\r\n</pre>\r\n<h2 id=\"-4\">\r\n    小节回顾</h2>\r\n<p>\r\n    这一节没有复杂的内容，我们先是通过文件操作，实现了文件持久化的工具，用来保存用户的配备到本地文件，并且实时加载和启用这些配置信息。</p>\r\n<p>\r\n    然后，我们实现了一个美观的设置页面，在其中玩家可以调整对战的难度以及控制音乐和音效是否被启用。</p>\r\n<p>\r\n    最后我们实现了一个关于对话框，用于呈现我们的联系、交流信息，并使用三方插件来获取应用的版本信息、显示一个可点击的链接……</p>                                                                                                                '),(34,'<p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">经历了漫长的征程，我们即将到达到目的地！也好似种了一季的庄稼，终于到了收割的时节了！</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">关于 Flutter 的 App 发布，官方其实有规范的文档可以参考的：</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><a href=\"https://flutter.cn/docs/deployment/ios\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">打包并发布 iOS 应用</a></p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><a href=\"https://flutter.cn/docs/deployment/android\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">打包并发布 Android 应用</a></p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">我们的游戏在这一块也不怎么特别！我们顺着文档一步一步地往下走！</p><h2 id=\"\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; color: rgb(32, 35, 38); margin: 1.6em 0px; font-size: 20px; outline: 0px !important;\">本节概要</h2><ul style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><li style=\"outline: 0px !important;\">准备 iOS 发布</li><li style=\"outline: 0px !important;\">准备 Android 发布</li></ul><h2 id=\"ios\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; color: rgb(32, 35, 38); margin: 1.6em 0px; font-size: 20px; outline: 0px !important;\">准备 iOS 发布</h2><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">我们从 iOS 应用开始吧！</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">你先得有自己的苹果开发者 ID，这个不需要多说了吧？如果没有，去 AppStore 下载苹果的 Developer App。使用这个 App，你可以完成苹果开发者的注册，以及 Program 的购买！</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">拥有开发者身份后，登录自己的 Apple 开发者页面。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">首先，先注册我们要使用的 Bundle ID。在创建 Bundle ID 的过程中需要指定你使用的服务：</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><img src=\"https://images.gitbook.cn/g7Y6UA.png\" alt=\"创建 Bundle ID\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">到目前，我们什么服务都没见有使用，什么都不用选，下一步到底，我们就完成了 Bundle ID 的注册了。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">然后，我们要在 iTunes Connect 上创建我们的应用。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><img src=\"https://images.gitbook.cn/hp25tu.png\" alt=\"在 iTunes Connect 中创建应用\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">新建应用其中有一步，在 App Information 的 General Information 部分, 需要选择你第一步创建的 Bundle ID。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">第一步创建 Bundle ID 后，这个地方可能不会马上出现新建的 Bundle ID 供你选择，我是等了一天之后才出现的。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">其后，应用的基本信息和第一个版本有大量信息要填写和提供，包括应用的名称、宣传语、关键字、屏幕截图……</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">苹果的审核是全方位的，你看着办法吧，倒也不复杂！</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">这些信息配置好了之后，我们加到 Xcode，打开项目根目录下的 ios/Runner.xcworkspace，我们要确认应用的一些基本信息。</p><blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; outline: 0px !important;\"><p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">注意在 ios 文件夹下可能还存在一个 Xcode 可以打开的 Runner.xcproject 文件，注意我们要打开的是一个工作空间，而非仅 Runner 项目。</p></blockquote><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">在 Xcode 项目导航器中选择 Runner 项目，在主视图边栏中，选择 Runner Target，然后在右侧选中 Gerneral 选项卡：</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">在 Identity 部分有两个信息需要确认:</p><ul style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><li style=\"outline: 0px !important;\">Display Name：要在主屏幕和其他地方显示的应用程序的名称，这里我们可以直接使用「棋路」。</li><li style=\"outline: 0px !important;\">Bundle Identifier：之前在 iTunes Connect 上注册的 Bundle ID，之前示例中建立是 cn.apppk.books.flutterchess</li></ul><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><img src=\"https://images.gitbook.cn/wonX0T.png\" alt=\"配置应用的 Bundle ID 和版本\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">应用的版本和 build 号也需要在在如上的 Gerneral 卡片上进行配置，Xcode 的版本号不会随着我们在 Flutter 项目的 pubspec.yaml 中的配置而自动修改，所以打包前别忘了修改版本。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">除此以外，本地信息中还需要修改的就是我们的应用图标和 Splash 图片了。我们先来看看图标的尺寸要求：</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><img src=\"https://images.gitbook.cn/yKzgaA.png\" alt=\"使用 Xcode 的 Assets工具，直接将图标拖进去就好了\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">iOS App 要求以下尺寸的应用图标：</p><ul style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><li style=\"outline: 0px !important;\">iPhone 通知：20x20, 2x, 3x</li><li style=\"outline: 0px !important;\">iPhone 设置：29x29, 1x, 2x, 3x</li><li style=\"outline: 0px !important;\">iPhone Stoplight：40x40, 2x, 3x</li><li style=\"outline: 0px !important;\">iPhone App：60x60, 2x, 3x</li><li style=\"outline: 0px !important;\">iPad 通知：20x20, 1x, 2x</li><li style=\"outline: 0px !important;\">iPad 设置：29x29, 1x, 2x</li><li style=\"outline: 0px !important;\">iPad Stoplight：40x40, 1x, 2x</li><li style=\"outline: 0px !important;\">iPad App：76x76, 1x, 2x</li><li style=\"outline: 0px !important;\">iPad Pro App：83.5x83.5, 2x</li><li style=\"outline: 0px !important;\">App Store：1024x1024, 1x</li></ul><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">你可以从这里<a href=\"https://www.apppk.cn/books/flutter_cchess/ios_icons.zip\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">下载</a>我们的示例图标集直接使用。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">为了避免应用启动时的白屏，你还可以配置 Launch Image，从这里<a href=\"https://www.apppk.cn/books/flutter_cchess/launch_images.zip\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">下载</a>我们提供的示例。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">这些都做完了，就只剩下一样了：直接选择 Xcode 菜单 Archive 菜单项，构造我们的 Release 包吧。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">过程中需要应用签名的时候，直接选择由 XCode 自动管理签名即可。在 Xcode 中直接上传代码到 AppStore，或是安装苹果推荐的专门传输工具 Transporter，都是你的选择！</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">这样一来，我们的应用就可以发布到 iPhone 和 iPad 设备上了，当然目前由于 Flutter 自身的问题，还不能发布到 iTV，相信很快就能实现这个小目标的。</p><h2 id=\"android\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; color: rgb(32, 35, 38); margin: 1.6em 0px; font-size: 20px; outline: 0px !important;\">准备 Android 发布</h2><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">Android 的发布过程其实类似。这儿不需要 Google Play 或是哪个应用市场做配合的，做好自己本地的工作就完事了。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">在前文中，我们已经为 Android 应用设置好了包名，现在我们需要确认的信息主要是应用的名称和图标了。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">首先是确认应用名称。在 manifest 文件中，你可以修改应用的名称，这里使用「棋路」：</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><img src=\"https://images.gitbook.cn/Z7mVG4.png\" alt=\"修改应用名称\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">其次，Android 应用的图标需要你按屏幕密度提供。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">Android 应用需要你提供以下几种尺寸的图标：</p><ul style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\"><li style=\"outline: 0px !important;\">hdpi：72x72</li><li style=\"outline: 0px !important;\">mdpi：48x48</li><li style=\"outline: 0px !important;\">xhdpi：96x96</li><li style=\"outline: 0px !important;\">xxhdpi：144x144</li><li style=\"outline: 0px !important;\">xxxhdpi：192x192</li></ul><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">这里可以<a href=\"https://www.apppk.cn/books/flutter_cchess/android_icons.zip\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">下载</a>我们提供的示例图标，然后复制到应用的相应的目录替换默认的图标；</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">Flutter 的安卓应用的启动 Splash 是可以配置的，为了避免白屏，你应该修改 drawable 文件夹下的 launch_background.xml 文件，在这个文件中引用你的启动 Splash 图片，我们的 launch_background.xml 内容如下：</p><pre style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; padding: 10px 20px; margin-bottom: 1.1em; line-height: 1.45; word-break: break-word; background-color: rgba(128, 128, 128, 0.05); border-width: 0px; border-style: initial; border-color: initial; border-radius: 5px; position: relative; outline: 0px !important;\"><code class=\"xml language-xml hljs\" id=\"code-0\" style=\"font-family: &quot;Source Code Pro&quot;, monospace; padding: 0.5em; color: rgb(56, 58, 66); background: rgb(250, 250, 250); white-space: pre; display: block; overflow-x: auto; opacity: 1; outline: 0px !important;\"><span class=\"php\" style=\"outline: 0px !important;\"><span class=\"hljs-meta\" style=\"color: rgb(64, 120, 242); outline: 0px !important;\">&lt;?</span>xml version=<span class=\"hljs-string\" style=\"color: rgb(80, 161, 79); outline: 0px !important;\">\"1.0\"</span> encoding=<span class=\"hljs-string\" style=\"color: rgb(80, 161, 79); outline: 0px !important;\">\"utf-8\"</span><span class=\"hljs-meta\" style=\"color: rgb(64, 120, 242); outline: 0px !important;\">?&gt;</span></span><span class=\"hljs-comment\" style=\"color: rgb(160, 161, 167); font-style: italic; outline: 0px !important;\">&lt;!-- Modify this file to customize your launch splash screen --&gt;</span>\r\n<span class=\"hljs-tag\" style=\"outline: 0px !important;\">&lt;<span class=\"hljs-name\" style=\"color: rgb(228, 86, 73); outline: 0px !important;\">layer-list</span> <span class=\"hljs-attr\" style=\"color: rgb(152, 104, 1); outline: 0px !important;\">xmlns:android</span>=<span class=\"hljs-string\" style=\"color: rgb(80, 161, 79); outline: 0px !important;\">\"http://schemas.android.com/apk/res/android\"</span>&gt;</span>\r\n    <span class=\"hljs-comment\" style=\"color: rgb(160, 161, 167); font-style: italic; outline: 0px !important;\">&lt;!-- You can insert your own image assets here --&gt;</span>\r\n    <span class=\"hljs-tag\" style=\"outline: 0px !important;\">&lt;<span class=\"hljs-name\" style=\"color: rgb(228, 86, 73); outline: 0px !important;\">item</span> <span class=\"hljs-attr\" style=\"color: rgb(152, 104, 1); outline: 0px !important;\">android:drawable</span>=<span class=\"hljs-string\" style=\"color: rgb(80, 161, 79); outline: 0px !important;\">\"@color/game_light_bg\"</span> /&gt;</span>\r\n    <span class=\"hljs-tag\" style=\"outline: 0px !important;\">&lt;<span class=\"hljs-name\" style=\"color: rgb(228, 86, 73); outline: 0px !important;\">item</span>&gt;</span><span class=\"hljs-tag\" style=\"outline: 0px !important;\">&lt;<span class=\"hljs-name\" style=\"color: rgb(228, 86, 73); outline: 0px !important;\">bitmap</span> <span class=\"hljs-attr\" style=\"color: rgb(152, 104, 1); outline: 0px !important;\">android:gravity</span>=<span class=\"hljs-string\" style=\"color: rgb(80, 161, 79); outline: 0px !important;\">\"center\"</span> <span class=\"hljs-attr\" style=\"color: rgb(152, 104, 1); outline: 0px !important;\">android:src</span>=<span class=\"hljs-string\" style=\"color: rgb(80, 161, 79); outline: 0px !important;\">\"@mipmap/launch\"</span> /&gt;</span><span class=\"hljs-tag\" style=\"outline: 0px !important;\">&lt;/<span class=\"hljs-name\" style=\"color: rgb(228, 86, 73); outline: 0px !important;\">item</span>&gt;</span>\r\n<span class=\"hljs-tag\" style=\"outline: 0px !important;\">&lt;/<span class=\"hljs-name\" style=\"color: rgb(228, 86, 73); outline: 0px !important;\">layer-list</span>&gt;</span>\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">文件中引用了 @mipmap/launch 中的图片，前边下载安装图标的图片压缩包已经包含了它。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">如果你已经在 Flutter 项目的 pubspec.yaml 文件中指定了应用的版本和 Build 号，Android 中不需要特别去指定应用版本，它可以自动地从 pubspec.yaml 中去获取。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">Android 的 Release 版本需要明确地指定签名方式，我们来处理象棋游戏的自动签名：</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">第一步，创建我们的 keystore：</p><pre style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; padding: 10px 20px; margin-bottom: 1.1em; line-height: 1.45; word-break: break-word; background-color: rgba(128, 128, 128, 0.05); border-width: 0px; border-style: initial; border-color: initial; border-radius: 5px; position: relative; outline: 0px !important;\"><code class=\"bash language-bash hljs\" id=\"code-1\" style=\"font-family: &quot;Source Code Pro&quot;, monospace; padding: 0.5em; color: rgb(56, 58, 66); background: rgb(250, 250, 250); white-space: pre; display: block; overflow-x: auto; outline: 0px !important;\">keytool -genkey -v -keystore ~/key.jks -keyalg RSA -keysize 2048 -validity 10000 -alias key\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><blockquote style=\"padding-top: 15px; padding-bottom: 15px; margin-bottom: 1.1em; font-size: 17px; border: none; background: rgb(250, 250, 252); border-radius: 4px; color: rgb(32, 35, 38); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; outline: 0px !important;\"><p style=\"font-size: 1em; line-height: 1.45; outline: 0px !important;\">保持文件私密; 不要将它加入到公共源代码控制中</p></blockquote><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">第二步，创建一个名为<code style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">/android/key.properties</code>的文件，其中包含对密钥库的引用：</p><pre style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; padding: 10px 20px; margin-bottom: 1.1em; line-height: 1.45; word-break: break-word; background-color: rgba(128, 128, 128, 0.05); border-width: 0px; border-style: initial; border-color: initial; border-radius: 5px; position: relative; outline: 0px !important;\"><code class=\"text language-text\" id=\"code-3\" style=\"font-family: &quot;Source Code Pro&quot;, monospace; white-space: pre; outline: 0px !important;\">storePassword=&lt;password from previous step&gt;\r\nkeyPassword=&lt;password from previous step&gt;\r\nkeyAlias=key\r\nstoreFile=&lt;location of the key store file, e.g. /Users/&lt;user name&gt;/key.jks&gt;\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">第三步，在 gradle 中配置签名：在&nbsp;<code style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">/android/app/build.gradle</code>&nbsp;文件中找到以下代码位置：</p><pre style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; padding: 10px 20px; margin-bottom: 1.1em; line-height: 1.45; word-break: break-word; background-color: rgba(128, 128, 128, 0.05); border-width: 0px; border-style: initial; border-color: initial; border-radius: 5px; position: relative; outline: 0px !important;\"><code class=\"groovy language-groovy\" id=\"code-5\" style=\"font-family: &quot;Source Code Pro&quot;, monospace; white-space: pre; outline: 0px !important;\">android {\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">将它替换为：</p><pre style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; padding: 10px 20px; margin-bottom: 1.1em; line-height: 1.45; word-break: break-word; background-color: rgba(128, 128, 128, 0.05); border-width: 0px; border-style: initial; border-color: initial; border-radius: 5px; position: relative; outline: 0px !important;\"><code class=\"groovy language-groovy\" id=\"code-6\" style=\"font-family: &quot;Source Code Pro&quot;, monospace; white-space: pre; outline: 0px !important;\">def keystorePropertiesFile = rootProject.file(\"key.properties\")\r\ndef keystoreProperties = new Properties()\r\nkeystoreProperties.load(new FileInputStream(keystorePropertiesFile))\r\n\r\nandroid {\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">继续在&nbsp;<code style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">/android/app.build.gradle</code>&nbsp;中找到以下代码位置：</p><pre style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; padding: 10px 20px; margin-bottom: 1.1em; line-height: 1.45; word-break: break-word; background-color: rgba(128, 128, 128, 0.05); border-width: 0px; border-style: initial; border-color: initial; border-radius: 5px; position: relative; outline: 0px !important;\"><code class=\"groovy language-groovy\" id=\"code-8\" style=\"font-family: &quot;Source Code Pro&quot;, monospace; white-space: pre; outline: 0px !important;\">buildTypes {\r\n    release {\r\n        // TODO: Add your own signing config for the release build.\r\n        // Signing with the debug keys for now, so `flutter run --release` works.\r\n        signingConfig signingConfigs.debug\r\n    }\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">将它替换为：</p><pre style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; padding: 10px 20px; margin-bottom: 1.1em; line-height: 1.45; word-break: break-word; background-color: rgba(128, 128, 128, 0.05); border-width: 0px; border-style: initial; border-color: initial; border-radius: 5px; position: relative; outline: 0px !important;\"><code class=\"groovy language-groovy\" id=\"code-9\" style=\"font-family: &quot;Source Code Pro&quot;, monospace; white-space: pre; outline: 0px !important;\">signingConfigs {\r\n    release {\r\n        keyAlias keystoreProperties[\'keyAlias\']\r\n        keyPassword keystoreProperties[\'keyPassword\']\r\n        storeFile file(keystoreProperties[\'storeFile\'])\r\n        storePassword keystoreProperties[\'storePassword\']\r\n    }\r\n}\r\nbuildTypes {\r\n    release {\r\n        signingConfig signingConfigs.release\r\n    }\r\n}\r\n</code><div title=\"copy\" class=\"copy-btn\" style=\"position: absolute; right: 10px; top: 5px; font-size: 12px; cursor: pointer; outline: 0px !important;\">复制</div></pre><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">这样就在 gradle 中添加好了自动签名任务了。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">最后，在命令行下使用&nbsp;<code style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">flutter build apk</code>&nbsp;或&nbsp;<code style=\"font-family: &quot;Source Code Pro&quot;, monospace; font-size: 0.9em; color: rgb(63, 63, 63); background-color: rgba(128, 128, 128, 0.075); outline: 0px !important;\">flutter build appbundle</code>，即可打包 Release 应用，拿你的 aar 或 apk 到各大市场去发布吧！</p><h2 id=\"-1\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; color: rgb(32, 35, 38); margin: 1.6em 0px; font-size: 20px; outline: 0px !important;\">小节回顾</h2><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">我们在本节中完成了游戏的 Logo、名称、版本信息的配置，也启用了 Android 的自动签名软件能力。你随时可以通过简单的命令生成我们的游戏的发布版本了。</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">但老实说，向应用市场发软件还有很多其它的事情需要考虑，例如使用什么样的游戏名称、关键字、描述对应用市场的搜索引才友好。制作什么样的动画或是截图，有利于用户快速地爱上我们的 App。在国内 Android 应用市场上线应该还需要申请软件版本登录等等……</p><p style=\"margin-bottom: 1.1em; color: rgb(23, 27, 31); font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; font-size: 17px; outline: 0px !important;\">这些步骤完成了，我们都还要面对0起点的应用推广？</p>'),(35,'<h2>\r\n    概述</h2>\r\n<p>\r\n    中国象棋通用引擎协议 (Universal Chinese Chess Protocol，简称UCCI)，是一种象棋界面和象棋引擎之间的基于文本的通讯协议。</p>\r\n<p>\r\n    规范通用引擎协议 UCCI 协议，为棋软的 AI 引擎与界面分享提供标准接口，一些团队可以实现优美的界面，而另一些团队可以关注于 AI 引擎算法提升。</p>\r\n<p>\r\n    中国象棋的软件理论主要参考了国际象棋，通用引擎协议也是这样。UCCI 参考国际象棋的 UCI 来制定的。 　</p>\r\n<h2 id=\"-1\">\r\n    通讯方法</h2>\r\n<p>\r\n    通常情况下，引擎程序以独立进程方式运行，以标准输入输出与界面程序进行通信。</p>\r\n<p>\r\n    独立进程运行的情况下，象棋软件使用输入输出管道方式与作为子进程的引擎程序进行通信，通信内容为文本。 /Users/linmi/Documents/Work/GitChat/专栏/照云/flutter 实战：中国象棋\r\n    引擎也可以象棋程序的线程方式运行，象棋软件和引擎运行于同一个内存空间，可以使用更灵活的方式进行通信。</p>\r\n<p>\r\n    象棋程序与引擎之间的通信过程一般是这样的：</p>\r\n<ol>\r\n    <li>象棋软件向引擎发送的「指令」信息</li>\r\n    <li>引擎理解并执行指令，发送的「反馈」信息给象棋程序</li>\r\n    <li>UCCI 协议以文件为基础，一个指令或反馈都在同一行</li>\r\n</ol>\r\n<h2 id=\"-2\">\r\n    局面和着法表示</h2>\r\n<h3 id=\"-3\" class=\"0\">\r\n    局面表示</h3>\r\n<p>\r\n    象棋程序以&nbsp;<code>position</code>&nbsp;指令告知引擎局面信息。局面信息以\r\n    FEN 方式标记，一个典型的局面指令：</p>\r\n<pre><code class=\"text language-text\" id=\"code-1\">position fen rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR w - - 0 1\r\n</code></pre>\r\n<p>\r\n    为了让引擎自动判断禁手（重复等），可以在&nbsp;<code>position</code>&nbsp;指令中分两部分反应局面信息，一部分是上一次吃子（或开局）后的局面，另一部分是上一次吃子后的招法列表。\r\n</p>\r\n<pre><code class=\"text language-text\" id=\"code-3\">position fen rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR w - - 0 1\r\n</code></pre>\r\n<p>\r\n    Case 2 - 红方走出了炮二平五，请求引擎为黑方出着：无咋子局面，使用开局局面，有一步着法：</p>\r\n<pre><code class=\"text language-text\" id=\"code-4\">position fen rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR w - - 0 1 moves h2e2\r\n</code></pre>\r\n<p>\r\n    Case 3 - 黑方炮8平5，请引擎为红方出着：无吃子过程，有两步着法：</p>\r\n<pre><code class=\"text language-text\" id=\"code-5\">position fen rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR w - - 0 1 moves h2e2 h7e7\r\n</code></pre>\r\n<p>\r\n    Case 4 - 红方炮五进四，请引擎为黑方出着：前一步红方吃子，局面变化最最近吃子局面，无着法列表：</p>\r\n<pre><code class=\"text language-text\" id=\"code-6\">position fen rnbakabnr/9/1c2c4/p1p1C1p1p/9/9/P1P1P1P1P/1C7/9/RNBAKABNR b - - 0 2\r\n</code></pre>\r\n<p>\r\n    Case 5 - 黑方走出士4进5，请引擎为红方出着，使用上一个咋子局面，着法列表中是上一步黑方「士4进5」：</p>\r\n<pre><code class=\"text language-text\" id=\"code-7\">position fen rnbakabnr/9/1c2c4/p1p1C1p1p/9/9/P1P1P1P1P/1C7/9/RNBAKABNR b - - 0 2 moves d9e8\r\n</code></pre>\r\n<h3 id=\"-4\" class=\"1\">\r\n    着法表示</h3>\r\n<p>\r\n    象棋应用和引擎程序之间对着法的表示使用 ICCS 格式。</p>\r\n<p>\r\n    ICCS 格式用 4 个字符表示一步着法的，例如&nbsp;<code>b0c2</code>&nbsp;：\r\n</p>\r\n<ul>\r\n    <li>ICCS 着法基于左下角坐标系</li>\r\n    <li>用 a ~ i 表示从左到右的 9 列</li>\r\n    <li>用 0 ~ 9 表示从下到上 10 行</li>\r\n</ul>\r\n<p>\r\n    举个例子，引擎返回着法&nbsp;<code>b0c2</code>，表示将<code>第2列第1行的棋子移动到第3列第3行</code>。\r\n</p>\r\n<h2 id=\"-5\">\r\n    指令和反馈</h2>\r\n<h3 id=\"-6\" class=\"2\">\r\n    指令</h3>\r\n<pre><code class=\"text language-text\" id=\"code-11\">ucci\r\n</code></pre>\r\n<p>\r\n    这是引擎启动后，界面需要给引擎发送的第一条指令，通知引擎现在使用的协议是UCCI。</p>\r\n<h3 id=\"1\" class=\"3\">\r\n    响应1</h3>\r\n<pre><code class=\"text language-text\" id=\"code-12\">id {name | copyright | author | user} &lt;信息&gt;\r\n</code></pre>\r\n<p>\r\n    返回引擎的版本号、版权、作者和授权用户，例如：</p>\r\n<pre><code class=\"text language-text\" id=\"code-13\">id name ElephantEye 1.6 Beta\r\nid copyright 2004-2006 www.xqbase.com\r\nid author Morning Yellow\r\nid user ElephantEye Test Team\r\n</code></pre>\r\n<h3 id=\"2\" class=\"4\">\r\n    响应2</h3>\r\n<pre><code class=\"text language-text\" id=\"code-14\">option &lt;选项&gt; type &lt;类型&gt; [min &lt;最小值&gt;] [max &lt;最大值&gt;] [var &lt;可选项&gt; [var &lt;可选项&gt; [...]]] [default &lt;默认值&gt;]\r\n</code></pre>\r\n<p>\r\n    显示引擎所支持的选项，UCCI 引擎支持以下选项：</p>\r\n<ul>\r\n    <li>usemillisec true，通知界面采用毫秒模式</li>\r\n    <li>batch false，批处理模式，默认是关闭的；</li>\r\n    <li>debug false，调试模式，默认是关闭的；</li>\r\n    <li>ponder false，是否使用后台思考的时间策略，默认是关闭的；</li>\r\n    <li>usebook true，是否使用开局库的着法，默认是启用的；</li>\r\n    <li>useegtb true，是否使用残局库，默认是启用的；</li>\r\n    <li>bookfiles &lt;bookfile-name&gt;，设定开局库文件的名称，可指定多个开局库文件，用分号「;」隔开；</li>\r\n    <li>egtbpaths &lt;bookfile-name&gt;，设定残局库路径的名称，和 bookfiles 类似；</li>\r\n    <li>evalapi &lt;lib-name&gt;，设定局面评价API函数库文件的名称，和 bookfiles 类似，但只能是一个文件；</li>\r\n    <li>hashsize &lt;number&gt;，以MB为单位规定Hash表的大小，0表示让引擎自动分配Hash表；</li>\r\n    <li>threads &lt;number&gt;，支持多处理器并行运算(SMP)的引擎可指定线程数(即最多可运行在多少处理器上)，0表示让引擎自动分配线程数；\r\n    </li>\r\n    <li>idle\r\n        &lt;none|small|medium|large&gt;，设定处理器的空闲状态，通常有none(满负荷)、small(高负荷)、medium(中负荷)、large(低符合)四种选项，引擎默认总是以满负荷状态运行的；\r\n    </li>\r\n    <li>promotion false，是否允许仕(士)相(象)升变成兵(卒)，这是一种中国象棋的改良玩法，默认是不允许的；</li>\r\n    <li>pruning &lt;none|small|medium|large&gt;，设定裁剪程度，裁剪越多则引擎的搜索速度越快，但搜索结果不准确的可能性越大；\r\n    </li>\r\n    <li>knowledge\r\n        &lt;none|small|medium|large&gt;，设定知识大小，通常知识量越多则程序的静态局面评价越准确，但的运算速度会变慢；</li>\r\n    <li>randomness\r\n        &lt;none|small|medium|large&gt;，设定随机性系数，一般都设为none，以保证引擎走出它认为最好的着法，但为了增强走棋的趣味性，可以把这个参数调高；</li>\r\n    <li>style &lt;solid|normal|risky&gt;，设定下棋的风格；</li>\r\n    <li>newgame，设置新局或新的局面，引擎收到该指令时，可以执行导入开局库、清空Hash表等操作；</li>\r\n</ul>\r\n<h3 id=\"3\" class=\"5\">\r\n    响应3</h3>\r\n<pre><code class=\"text language-text\" id=\"code-15\">ucciok\r\n</code></pre>\r\n<p>\r\n    引导状态的反馈，此后引擎进入空闲状态。</p>\r\n<h3 id=\"-7\" class=\"6\">\r\n    指令</h3>\r\n<pre><code class=\"text language-text\" id=\"code-16\">isready\r\n</code></pre>\r\n<p>\r\n    检测引擎是否处于就绪状态</p>\r\n<h3 id=\"-8\" class=\"7\">\r\n    响应</h3>\r\n<pre><code class=\"text language-text\" id=\"code-17\">readyok\r\n</code></pre>\r\n<p>\r\n    表明引擎处于就绪状态。</p>\r\n<h3 id=\"-9\" class=\"8\">\r\n    指令</h3>\r\n<pre><code class=\"text language-text\" id=\"code-18\">setoption &lt;选项&gt; [&lt;值&gt;]\r\n</code></pre>\r\n<p>\r\n    设置引擎参数，这些参数都应该是前述 ucci 指令的 option 反馈的参数，例如：</p>\r\n<p>\r\n    setoption usebook false，不让引擎使用开局库； setoption selectivity large，把选择性设成最大； setoption style risky，指定冒进的走棋风格； setoption\r\n    loadbook，初始化开局库。</p>\r\n<h3 id=\"-10\" class=\"9\">\r\n    指令</h3>\r\n<pre><code class=\"text language-text\" id=\"code-19\">position {fen &lt;FEN串&gt; | startpos} [moves &lt;后续着法列表&gt;]\r\n</code></pre>\r\n<p>\r\n    设置局面，用 fen 来指定 FEN 格式串，moves\r\n    后面跟的是随后走过的着法。startpos表示开始局面，它等价于&nbsp;<code>rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR w - - 0 1</code>\r\n</p>\r\n<h3 id=\"-11\" class=\"10\">\r\n    指令</h3>\r\n<pre><code class=\"text language-text\" id=\"code-21\">banmoves &lt;禁止着法列表&gt;\r\n</code></pre>\r\n<p>\r\n    为当前局面设置禁手，以解决引擎无法处理的长打问题</p>\r\n<h3 id=\"-12\" class=\"11\">\r\n    指令</h3>\r\n<pre><code class=\"text language-text\" id=\"code-22\">go [ponder | draw] &lt;思考模式&gt;\r\n</code></pre>\r\n<p>\r\n    要求引擎根据 position 指令设定的棋盘来思考，各选项为思考方式，有三种模式可供选择：</p>\r\n<ul>\r\n    <li>depth &lt;深度&gt; | infinite：限定搜索深度，infinite 表示无限制思考（直到找到杀棋或用 stop 指令中止）。如果深度设定为\r\n        0，那么引擎可以只列出当前局面静态评价的分数，并且反馈 nobestmove。</li>\r\n    <li>nodes &lt;结点数&gt;：限定搜索结点数。</li>\r\n    <li>time &lt;时间&gt; [movestogo &lt;剩余步数&gt; | increment &lt;每步加时&gt;] [opptime\r\n        &lt;对方时间&gt; [oppmovestogo &lt;对方剩余步数&gt; | oppincrement &lt;对方每步加时&gt;]]：限定时间，时间单位毫秒</li>\r\n    <li>movestogo适用于时段制</li>\r\n    <li>increment适用于加时制</li>\r\n    <li>opptime、oppmovestogo 和 oppincrement 可以让界面把对方的用时情况告诉引擎。</li>\r\n    <li>如果指定 ponder 选项，则引擎思考时时钟不走，直到接受到 ponderhit 指令后才计时，该选项用于后台思考，它只对限定时间的思考模式有效。</li>\r\n    <li>指定 draw 选项表示向引擎提和，引擎以 bestmove 提供的选项作为反馈，参阅 bestmove 指令。</li>\r\n    <li>ponder 和 draw 选项不能同时使用，如果界面向正在后台思考中的引擎求和，则使用 ponderhit draw 指令。</li>\r\n</ul>\r\n<h3 id=\"1-1\" class=\"12\">\r\n    响应1</h3>\r\n<pre><code class=\"text language-text\" id=\"code-23\">info &lt;思考信息&gt;\r\n</code></pre>\r\n<p>\r\n    显示引擎思考信息，通常有以下几种信息：</p>\r\n<ul>\r\n    <li>time &lt;已花费的时间&gt; nodes &lt;已搜索的结点数&gt;</li>\r\n    <li>depth &lt;当前搜索深度&gt; [score &lt;分值&gt; pv &lt;主要变例&gt;]：输出引擎思考到的深度及其思考路线和好坏\r\n    </li>\r\n    <li>currmove &lt;当前搜索着法&gt;：输出引擎正在思考的着法</li>\r\n    <li>message &lt;提示信息&gt;：输出引擎要直接告诉用户的信息</li>\r\n</ul>\r\n<h3 id=\"-13\" class=\"13\">\r\n    中间指令</h3>\r\n<pre><code class=\"text language-text\" id=\"code-24\">ponderhit [draw]\r\n</code></pre>\r\n<p>\r\n    思考过程中的指令，告诉引擎后台思考命中，现在转入正常思考模式（引擎继续处于思考状态，此时go指令设定的时限开始起作用）。draw 选项表示向引擎提和，引擎以 bestmove 提供的选项作为反馈。</p>\r\n<h3 id=\"-14\" class=\"14\">\r\n    中间指令</h3>\r\n<pre><code class=\"text language-text\" id=\"code-25\">stop\r\n</code></pre>\r\n<p>\r\n    中止引擎的思考。注意：发出该指令并不意味着引擎将立即回到空闲状态，而是要等到引擎反馈bestmove或nobestmove后才表示回到空闲状态。</p>\r\n<h3 id=\"21\" class=\"15\">\r\n    响应2-1</h3>\r\n<pre><code class=\"text language-text\" id=\"code-26\">bestmove &lt;最佳着法&gt; [ponder &lt;后台思考的猜测着法&gt;] [draw | resign]\r\n</code></pre>\r\n<p>\r\n    思考结果反馈，以及猜测在这个着法后对手会有怎样的应对。</p>\r\n<p>\r\n    通常，最佳着法是思考路线、中的第一个着法，而后台思考的猜测着法则是第二个着法。在对手尚未落子时，可以根据该着法来设定局面，并作后台思考。当对手走出的着法和后台思考的猜测着法吻合时，称为“后台思考命中”。</p>\r\n<p>\r\n    draw 选项表示引擎提和或者接受界面向引擎发送的提和请求</p>\r\n<p>\r\n    resign 选项表示引擎认输。</p>\r\n<h3 id=\"22\" class=\"16\">\r\n    响应2-2</h3>\r\n<pre><code class=\"text language-text\" id=\"code-27\">nobestmove\r\n</code></pre>\r\n<p>\r\n    反馈思考结果，但引擎一步着法也没计算，表示当前局面是死局面，或者接收到诸如 go depth 0 等只让引擎给出静态局面评价的指令。</p>\r\n<h3 id=\"-15\" class=\"17\">\r\n    指令</h3>\r\n<pre><code class=\"text language-text\" id=\"code-28\">quit\r\n</code></pre>\r\n<p>\r\n    让引擎退出运转。</p>\r\n<h3 id=\"-16\" class=\"18\">\r\n    响应</h3>\r\n<pre><code class=\"text language-text\" id=\"code-29\">bye\r\n</code></pre>\r\n<p>\r\n    接收到 quit 指令后的反馈</p>\r\n<h2 id=\"ucci\">\r\n    电脑象棋联赛中的 UCCI</h2>\r\n<p>\r\n    　 电脑象棋联赛使用 UCCI 引擎，参赛引擎必须能够识别并正确处理以下的指令：</p>\r\n<ul>\r\n    <li>ucci；</li>\r\n    <li>position fen … [moves …]；</li>\r\n    <li>banmoves …；</li>\r\n    <li>go [draw] time … increment … [opptime … oppincrement …]；</li>\r\n    <li>quit。</li>\r\n</ul>\r\n<p>\r\n    参赛引擎必须能够反馈的信息有：</p>\r\n<ul>\r\n    <li>ucciok；</li>\r\n    <li>bestmove … [draw | resign]。</li>\r\n</ul>\r\n<p>\r\n    为了更好地让引擎适应模拟器，引擎最好能够实现以下功能：</p>\r\n<ul>\r\n    <li>支持毫秒制，即启动时有 option usemillisec 的反馈，能够识别并处理 setoption usemillisec true 的指令</li>\r\n    <li>支持认输和提和，即当引擎觉得没有机会获胜时，可以用 bestmove … draw 提和或接受提和</li>\r\n    <li>支持 stop 指令</li>\r\n</ul>\r\n<p>\r\n    另外，识别 setoption 指令不是必须的，但在联赛中也会有用，例如用 setoption bookfiles …来导入开局库。</p>'),(36,'<h2 id=\"\">\r\n    象棋棋具</h2>\r\n<h3 id=\"-1\" class=\"0\">\r\n    棋盘</h3>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/qcw604.png\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p>\r\n<p>\r\n    棋子活动的场所，叫作“棋盘”。在方形的平面上，由九条平行的竖线和十条平行的横线相交组成，共有九十个交叉点，棋子就摆在交叉点上。中间部分，也就是棋盘的第五，第六两横线之间未画竖线的空白地带称为“河界”。两端的中间，也就是两端第四条到第六条竖线之间的正方形部位，以斜交叉线构成“米”字方格的地方，叫作“九宫”（它恰好有九个交叉点）。整个棋盘以“河界”分为相等的两部分。为了比赛记录和学习棋谱方便起见，现行规则规定：按九条竖线从右至左用中文数字一至九来表示红方的每条竖线，用阿拉伯数字“1”~“9”来表示黑方的每条竖线。对弈开始之前，红黑双方应该把棋子摆放在规定的位置。任何棋子每走一步，进就写“进”，退就写“退”，如果像车一样横着走，就写“平”。\r\n</p>\r\n<h3 id=\"-2\" class=\"1\">\r\n    直线</h3>\r\n<p>\r\n    棋盘上较长的平行排列的边称为直线，共有9条，其中7条被河界隔断。用红色棋子一方的直线从右往左依次用中文数字一、二、三、四、五、六、七、八、九表示;用黑色棋于一方的直线在红方对面也从右往左依次用阿拉伯数字1、2、3、4、5、6、7、8、9表示。\r\n</p>\r\n<h3 id=\"-3\" class=\"2\">\r\n    横线</h3>\r\n<p>\r\n    棋盘上较短的平行排列的边称为横线。横线共有10条，用红色棋子一方的横线从红方底线算起，从下往上依次用中文数字一至十表示;用黑色棋子一方的横线则从黑方底线开始，依次用阿拉伯数字1-10表示。</p>\r\n<h3 id=\"-4\" class=\"3\">\r\n    交叉点</h3>\r\n<p>\r\n    直线与横线相交的地方称为“交叉点”。整个棋盘共有90个交叉点，棋子就摆放和活动在这些交叉点上。</p>\r\n<h3 id=\"-5\" class=\"4\">\r\n    河界</h3>\r\n<p>\r\n    棋盘中央没有画直线的地方称为“河界”。它代表弃战双方的分界线，确定了各自的地域。</p>\r\n<h3 id=\"-6\" class=\"5\">\r\n    九宫</h3>\r\n<p>\r\n    棋盘两端各画有斜交叉线的地方称为“九宫”。将则只能在各自“九宫”的9个交叉点上活动。</p>\r\n<p>\r\n    “楚汉界河”指的是河南省荥阳市黄河南岸广武山上的鸿沟。沟口宽约800米，深达200米，是古代的一处军事要地。西汉初年楚汉相争时，汉高祖刘邦和西楚霸王项羽仅在荥阳一带就爆发了“大战七十，小战四十”，因种种原因项羽“乃与汉约，中分天下，割鸿沟以西为汉，以东为楚”，鸿沟便成了楚汉的边界。如今鸿沟两边还有当年两军对垒的城址，东边是霸王城，西边是汉王城。现汉霸王城面临坍塌的危险，有关部门正在保卫我国的古战场。\r\n</p>\r\n<h2 id=\"-7\">\r\n    棋子</h2>\r\n<p>\r\n    棋子共有三十二个，分为红、黑两组，每组共十六个，各分七种，其名称和数目如下：</p>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/62TXU0.png\" alt=\"中国象棋初始局面\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p>\r\n<p>\r\n    红棋子：帅一个，车、马、炮、相、仕各两个，兵五个。</p>\r\n<p>\r\n    黑棋子：将一个，车、马、炮、象、士各两个，卒五个。</p>\r\n<h3 id=\"-8\" class=\"6\">\r\n    帅/将</h3>\r\n<p>\r\n    红方为“帅”，黑方为“将”。帅和将是棋中的首脑，是双方竭力争夺的目标。</p>\r\n<p>\r\n    它只能在\"九宫\"之内活动，可上可下，可左可右，每次走动只能按竖线或横线走动一格。帅与将不能在同一直线上直接对面，否则走方判负。</p>\r\n<h3 id=\"-9\" class=\"7\">\r\n    仕/士</h3>\r\n<p>\r\n    红方为“仕”，黑方为“士”。它也只能在九宫内走动。它的行棋路径只能是九宫内的斜线。士一次只能走一个斜格。</p>\r\n<h3 id=\"-10\" class=\"8\">\r\n    象/相</h3>\r\n<p>\r\n    红方为“相”，黑方为“象”。它的走法是每次循对角线走两格，俗称“象飞田”。相（象）的活动范围限于“河界”以内的本方阵地，不能过河，且如果它走的“田”字中央有一个棋子，就不能走，俗称“塞象眼”。</p>\r\n<h3 id=\"j\" class=\"9\">\r\n    车（jū ）</h3>\r\n<p>\r\n    车在象棋中威力最大，无论横线、竖线均可行走，只要无子阻拦，步数不受限制。俗称“车行直路”。因此，一车最多可以控制十七个点，故有“一车十子寒”之称。</p>\r\n<h3 id=\"-11\" class=\"10\">\r\n    炮</h3>\r\n<p>\r\n    炮在不吃子的时候，走动与车完全相同，但炮在吃子时，必须跳过一个棋子，我方的和敌方的都可以，俗称“炮打隔子”、“翻山”。</p>\r\n<h3 id=\"-12\" class=\"11\">\r\n    马</h3>\r\n<p>\r\n    马走动的方法是一直一斜，即先横着或直着走一格，然后再斜着走一个对角线，俗称“马走日”。马一次可走的选择点可以达到四周的八个点，故有“八面威风”之说。如果在要去的方向有别的棋子挡住，马就无法走过去，俗称“蹩马腿”。</p>\r\n<h3 id=\"-13\" class=\"12\">\r\n    兵/卒</h3>\r\n<p>\r\n    红方为“兵”，黑方为“卒”。</p>\r\n<p>\r\n    兵（卒）只能向前走，不能后退，在未过河前，不能横走。过河以后还可左、右移动，但也只能一次一步，即使这样，兵（卒）的威力也大大增强，故有“小卒过河顶大车”之说。</p>\r\n<h2 id=\"-14\">\r\n    行棋规则</h2>\r\n<p>\r\n    中国象棋是由两人轮流走子，在战法上遵循古代孙子兵法中的“不战而屈人之兵，善之善者也”的作战思想，以“将死”或“困毙”对方将（帅）为胜的一种二人对抗性游戏。对局时，由执红棋的一方先走，双方轮流各走一招，直至分出胜、负、和，对局即终了。在棋战中，人们可以从攻与防、虚与实、整体与局部等复杂关系的变化中提升思维能力。\r\n</p>\r\n<ul>\r\n    <li>对局开始前，双方棋子在棋盘上的摆法见下图：</li>\r\n</ul>\r\n<p>\r\n    <img src=\"https://images.gitbook.cn/WmC4Go.png\" style=\"max-width: 100%; zoom: 0.5; outline: 0px !important;\"></p>\r\n<ul>\r\n    <li>对局时，由执红棋的一方先走，双方轮流走一步。</li>\r\n    <li>轮到走棋的一方，将某个棋子从一个交叉点走到另一个交叉点，或者吃掉对方的棋子而占领其交叉点，都算走了一着。</li>\r\n    <li>双方各走一着，称为一个回合。</li>\r\n    <li>走一着棋时，如果己方棋子能够走到的位置有对方棋子存在，就可以把对方棋子吃掉而占领那个位置。</li>\r\n    <li>\r\n        一方的棋子攻击对方的帅（将），并在下一着要把它吃掉，称为“照将”，或简称“将”。“照将”不必声明。被“照将”的一方必须立即“应将”，即用自己的着法去化解被“将”的状态。如果被“照将”而无法“应将”，就算被“将死”。</li>\r\n</ul>\r\n<h2 id=\"-15\">\r\n    棋例总纲</h2>\r\n<h3 id=\"-16\" class=\"13\">\r\n    棋例释义</h3>\r\n<ul>\r\n    <li>对局中有时出现双方着法循环不变的重复局面。据以裁处这种局面的规则条例，称为《棋例》。</li>\r\n    <li>长将、长杀、长捉、一将一杀、一将一捉、一杀一捉等循环重复的攻击手段，统称为“禁止着法”。</li>\r\n    <li>闲着（含：兑、献、拦、跟）、数将一闲、数杀一闲、数捉一闲等着法，无论是否重复，统称为“允许着法”。</li>\r\n    <li>车、马、炮、过河兵（卒）、士、相（象），均算“子力”。帅（将）、未过河兵（卒），不算“子力”。“子力”简称“子”。</li>\r\n    <li>\r\n        子力价值是衡量子力得失的尺度，也是判断是否“捉子”的依据之一。原则上，一车相当于双马、双炮或一马一炮；马炮相等；士相（象）相等；过河兵（卒）价值浮动，一兵换取数子或一子换取数兵均不算得子。</li>\r\n</ul>\r\n<h3 id=\"-17\" class=\"14\">\r\n    棋例总则</h3>\r\n<ul>\r\n    <li>在任何情况下，均不允许单方面长将。</li>\r\n    <li>双方均为允许着法，双方不变作和。</li>\r\n    <li>双方均为禁止着法（不包括一方为长将），双方不变作和。</li>\r\n    <li>一方为禁止着法，另一方为允许着法，应由前者变着，不变判负。</li>\r\n</ul>\r\n<h3 id=\"-18\" class=\"15\">\r\n    棋例通则</h3>\r\n<ul>\r\n    <li>允许帅（将）本身步步叫吃对方的棋子，按闲着处理。</li>\r\n    <li>其他棋子和帅（将）同时捉吃或借帅（将）之力捉吃对方的棋子，均按捉处理。</li>\r\n    <li>兵（卒）本身捉吃对方的棋子（不含将杀），按闲处理；如形成相互长打局面，则应按捉处理。</li>\r\n    <li>占据防守要点，立即构成简明和棋，附带产生的捉士相（象），按闲处理。</li>\r\n    <li>凡走子兼具多种作用时，应从重称呼和裁处。如杀兼捉，按杀；捉兼况，按捉等，依此类推。</li>\r\n</ul>\r\n<h3 id=\"-19\" class=\"16\">\r\n    棋例细则</h3>\r\n<ul>\r\n    <li>在任何情况下，均不许可单方面长将。</li>\r\n    <li>凡是走子前不存在捉，而走子后造成捉的（即从没捉到捉），一律按捉处理。</li>\r\n    <li>凡走子后，预计下一着能在子力价值上构成得子者，均按捉处理。</li>\r\n    <li>凡用作为根的子捉吃对方的子，也按捉处理。</li>\r\n    <li>凡捉子兼具兑献。送吃，也按捉处理。</li>\r\n    <li>凡是原来已经捉着子的子或相关子，走动后无新的捉子行为（即从捉到捉）均捉闲着处理。</li>\r\n    <li>凡形式上捉子，一旦吃子立即会被对方将死者,均闲着处理。</li>\r\n    <li>双方均为禁止着法（不包括单方面长将），双方不变作和。</li>\r\n    <li>其他棋子和帅（将）同时捉吃对方的棋子，均按捉处理。</li>\r\n    <li>过河兵（卒）子力价值浮动。</li>\r\n    <li>发生互打时，兵（卒）叫吃子均按捉处理。</li>\r\n    <li>凡走子兼具多种作用，从重定性。</li>\r\n    <li>占据防守要点，立即形成简明和棋,附带产生的捉士、相（象），按闲处理。 [16]</li>\r\n</ul>\r\n<h3 id=\"-20\" class=\"17\">\r\n    胜负规则</h3>\r\n<h4 id=\"-21\" class=\"18\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; color: rgb(32, 35, 38); margin: 1.6em 0px; font-size: 17px; outline: 0px !important;\">\r\n    胜负</h4>\r\n<p>\r\n    对局中，出现下列情况之一，本方算输，对方赢：</p>\r\n<ul>\r\n    <li>己方的帅（将）被对方棋子将死或吃掉；</li>\r\n    <li>己方无子可走（被困毙）；</li>\r\n    <li>己方对对方“长将”或“长捉”；</li>\r\n    <li>己方发出认输请求；</li>\r\n    <li>有步时要求的，己方走棋超出步时限制；</li>\r\n    <li>有时间要求的，超过规定时间；</li>\r\n    <li>违反比赛规则。</li>\r\n</ul>\r\n<h4 id=\"-22\" class=\"19\" style=\"font-family: -apple-system, BlinkMacSystemFont, Roboto, &quot;Segoe UI&quot;, &quot;Helvetica Neue&quot;, &quot;Microsoft YaHei&quot;, sans-serif; color: rgb(32, 35, 38); margin: 1.6em 0px; font-size: 17px; outline: 0px !important;\">\r\n    和棋</h4>\r\n<p>\r\n    出现下列情况之一，为和棋：</p>\r\n<ul>\r\n    <li>双方均无可能取胜的简单局势；</li>\r\n    <li>一方提议作和，另一方表示同意；</li>\r\n    <li>双方走棋出现循环反复三次，符合《棋例》中“不变作和”的有关规定；</li>\r\n    <li>符合自然限着的回合规定，即在连续60个回合中（也可根据比赛等级酌减），双方都没有吃过一个棋子。</li>\r\n</ul>\r\n<h2 id=\"-23\">\r\n    记谱方法</h2>\r\n<h3 id=\"-24\" class=\"20\">\r\n    方法</h3>\r\n<p>\r\n    中国象棋的记谱方法一般由四个字组成：</p>\r\n<ul>\r\n    <li>第 1 字是棋子的名称。如“马”或“车”。</li>\r\n    <li>第 2 字是棋子所在纵线的数码。</li>\r\n    <li>第 3 字表示棋子移动的方向：横走用“平”，向前走用“进”或“上”，向后走用“退”或“下”。</li>\r\n    <li>第 4 字是车、炮等前后进退的格数，或者马、象等斜走到达纵线的数码。</li>\r\n</ul>\r\n<h3 id=\"-25\" class=\"21\">\r\n    举例</h3>\r\n<p>\r\n    “炮二平五”，表示红炮从纵线二平移到纵线五。</p>\r\n<p>\r\n    “马8进7”，表示黑马从纵线8向前走到纵线7。</p>\r\n<p>\r\n    “车2退3”，表示黑车沿纵线2向后移动3格。</p>\r\n<p>\r\n    当一方有2个以上名称相同的棋子位于同一纵线时，需要用“前”或“后”来加以区别。例如，“前马退六”（表示前面的红马退到直线六）、“后炮平4”（表示后面的黑炮平移到直线4）。</p>\r\n<p>\r\n    兵卒在特殊局面下的记谱方法（主要创作排局时遇到的多，实战也可遇到）：</p>\r\n<p>\r\n    当兵卒在同一纵线达到3个，用前、中、后来区分，达到4个，用前、二、三、四区分，达到5个，用前、二、三、四、五区分。</p>\r\n<p>\r\n    当兵卒在两个纵线都达到两个以上时，按照旧的记谱方式举例：前兵九平八，此时可省略数字九，记做前兵平八，以达到都用4个汉字记谱的要求，是对中文记谱方法的一个重要完善。</p>\r\n<h2 id=\"-26\">\r\n    象棋术语</h2>\r\n<h3 id=\"-27\" class=\"22\">\r\n    非着法类</h3>\r\n<ul>\r\n    <li>\r\n        <p>河界线</p>\r\n        <p>棋盘 [18] 中间未画直线的空白地带称为“河界”，构成河界的两条横线即为“河界线”。</p>\r\n    </li>\r\n    <li>\r\n        <p>中线</p>\r\n        <p>\r\n            棋盘中第五条直线。是有关将、帅安危的生命线，亦为双方必争的战略要点。对局时，须力争控制该线，使之不被对方棋子侵入或牵制。</p>\r\n    </li>\r\n    <li>\r\n        <p>肋道</p>\r\n        <p>\r\n            也称“两肋线”，名词。棋盘中的第四、第六条直线。因在中线将位左右，形似人体的两肋，故名。均为对局双方攻守的要道线，控制肋道，应以对方上士的动向为进攻目标。</p>\r\n    </li>\r\n    <li>\r\n        <p>兵线</p>\r\n        <p>\r\n            也称“卒林线”、“兵行线”。名词。棋盘中靠近河界线的第一条横线，供双方置兵、卒。兵、卒有巩固阵地、绊马阻子的作用，已方棋子如能占据对方的兵线，就能予对方以压力和威胁。</p>\r\n    </li>\r\n    <li>\r\n        <p>九宫</p>\r\n        <p>也称“九宫禁区”。名词，指棋盘上由斜交叉线构成的“\r\n            米”字形方格。是将（帅）、士活动的地区。如被对方车、兵占据，就易发生危险。</p>\r\n    </li>\r\n    <li>\r\n        <p>局面</p>\r\n        <p>指对局中某一阶段双方棋子颁的状态，通常包括“ 先手”、“优势”、“平稳”、“对攻”、“复杂”、“简化”\r\n            、“均势”等。</p>\r\n    </li>\r\n    <li>\r\n        <p>对局评注</p>\r\n        <p>\r\n            在报刊或棋谱上，对比赛中一些著名棋手的实战对局，用复盘形式加以评述，分析双方战略战术中的优劣得失，与各种攻防着法的变化，以供爱好者欣赏、借鉴、参考，从中汲取有益的经验和技巧。</p>\r\n    </li>\r\n    <li>\r\n        <p>复盘</p>\r\n        <p>\r\n            也称“复局”。术语。指对局完毕后，复演该盘棋的记录，以检查对局中着法的优劣与得失关键。一般用以自学，或请高手给予指导分析。如按照棋排演，类如复盘，称“打谱”或 “研阅棋谱”。</p>\r\n    </li>\r\n    <li>\r\n        <p>棋谱</p>\r\n        <p>用图和文字记述棋局的书籍。按所记述的棋局排演，可参考吸收其着法，或探讨研究名手的棋艺风格。</p>\r\n    </li>\r\n    <li>\r\n        <p>先手</p>\r\n        <p>有二义：1、也称“先走”。开局时的先走者。2、也称“得先”。棋局形势中的主动者。</p>\r\n    </li>\r\n    <li>\r\n        <p>后手</p>\r\n        <p>有二义：1、开局时后者。2、也称“失先”、“落后”。棋局形势中的被动者。</p>\r\n    </li>\r\n    <li>\r\n        <p>均势</p>\r\n        <p>也称“并先”。术语。指对局中双方局势均衡，兵力相等。</p>\r\n    </li>\r\n    <li>\r\n        <p>着</p>\r\n        <p>对局中轮到走棋的一方，把某个棋从一个交叉点走到另一个交叉点，或吃掉对方的棋子而占领其交叉点，即为走了一着。\r\n        </p>\r\n    </li>\r\n    <li>\r\n        <p>回合</p>\r\n        <p>对局中，双方各走一着，称为一个回合。</p>\r\n    </li>\r\n    <li>\r\n        <p>闲着</p>\r\n        <p>也称“停着”，一种适宜于对局相持阶段的着法。走子不起进攻作用，目的在于等待时机。</p>\r\n    </li>\r\n    <li>\r\n        <p>强子</p>\r\n        <p>指车、马、炮等战斗力较强的各类子。兵、卒须视形势而定，一般以过河界的为强，在自界的为弱。</p>\r\n    </li>\r\n    <li>\r\n        <p>吃子</p>\r\n        <p>\r\n            对局中，轮到走棋的一方，把某一棋子从棋盘的这一交叉点走到另一交叉点而吃掉对方棋子，并占领后一交叉点，称为“吃子”。</p>\r\n    </li>\r\n    <li>\r\n        <p>弃子</p>\r\n        <p>对局中，舍弃某一子，称为“弃子”。常作为一种战术。主动而有计划的弃子，可得先而占优势或攻主局。</p>\r\n    </li>\r\n    <li>\r\n        <p>胜势</p>\r\n        <p>对局中，局势大体已定，于胜利在望一方，称为“胜势”。</p>\r\n    </li>\r\n    <li>\r\n        <p>绝杀</p>\r\n        <p>指对局，下一着要将死，而对方又无法解救。</p>\r\n    </li>\r\n    <li>\r\n        <p>入局</p>\r\n        <p>一般指攻入对方阵地而能构成杀局的着法。常见于中局阶段，多数为“弃子入局”。</p>\r\n    </li>\r\n    <li>\r\n        <p>例胜</p>\r\n        <p>实用残局结尾时，攻方可以必胜守方，称为“例胜”。</p>\r\n    </li>\r\n    <li>\r\n        <p>例和</p>\r\n        <p>实用残局结尾时，守方对攻方可以弈成必和的棋势，称为“例和”。</p>\r\n    </li>\r\n    <li>\r\n        <p>巧胜</p>\r\n        <p>指实用残局结尾时，由于守方未能及时弈成例和的棋势，被攻方乘机取胜，称为“巧胜”。</p>\r\n    </li>\r\n    <li>\r\n        <p>巧和</p>\r\n        <p>实用残局结尾时，守方以巧着弈和攻方，称“巧和”。</p>\r\n    </li>\r\n</ul>\r\n<h3 id=\"-28\" class=\"23\">\r\n    着法类</h3>\r\n<ul>\r\n    <li>\r\n        <p>两头蛇</p>\r\n        <p>指马二进三再马八进七后，再三兵与七兵齐挺一步后的形势。此时双马显得灵活，其状如“两头蛇”，故名。</p>\r\n    </li>\r\n    <li>\r\n        <p>仙人指路</p>\r\n        <p>一种开局着法，指第一步走兵三进一或兵七进一。因一子当先，意向莫测，有试探对方棋路的意图，故得名。</p>\r\n    </li>\r\n    <li>\r\n        <p>窝心马</p>\r\n        <p>也称“塞心马”、“入宫马”。指马走入己方的九宫花心，通常此着走后使将、士壅塞，易受到对方子力的牵制。</p>\r\n    </li>\r\n    <li>\r\n        <p>盘头马</p>\r\n        <p>也称“中炮连环夹马”，指开局先走一方架中炮挺进中兵（卒），双马则从中路连环策应。</p>\r\n    </li>\r\n    <li>\r\n        <p>鸳鸯马</p>\r\n        <p>指对弈中一方两马结成连环，互保互助，因而得名。又称“连环马”。</p>\r\n    </li>\r\n    <li>\r\n        <p>屏风马</p>\r\n        <p>\r\n            一种开局着法，在双炮尚未开动时，一方双马并踞（炮二平五、马8进7，马二进三、马2进3），保护中卒（兵），状似屏风，故名。</p>\r\n    </li>\r\n    <li>\r\n        <p>单提马</p>\r\n        <p>布局术语，指开局阶段一方一马正起，一马屯边，多用于先手五七炮开局和后手起横车布局。</p>\r\n    </li>\r\n    <li>\r\n        <p>反宫马</p>\r\n        <p>布局术语，开局一方双马正起，士角有一炮相隔，故亦称“夹炮屏风”。</p>\r\n    </li>\r\n    <li>\r\n        <p>拐角马</p>\r\n        <p>布局术语，上象后马二进四从象田出动，跳到己方士前位置，再穿上角奔河头。</p>\r\n    </li>\r\n    <li>\r\n        <p>先锋马</p>\r\n        <p>先挺三兵或七兵，随即进马河口，如军队行军时的先头部队，故名。</p>\r\n    </li>\r\n    <li>\r\n        <p>当头炮</p>\r\n        <p>也称中炮，一种开局着法。起着把炮放在正中线位，是先走一方采取主动攻势的一种布局。又称炮二平五。</p>\r\n    </li>\r\n    <li>\r\n        <p>五六炮</p>\r\n        <p>是一种开局着法，先手一方走成中炮六路炮。多数用于对屏风马、反宫马，属于稳健缓攻型布局。</p>\r\n    </li>\r\n    <li>\r\n        <p>巡河炮</p>\r\n        <p>\r\n            象棋中利用开局利用炮的一种形式。在开局时，一方的炮从原始位置直升至己方河线，然后利用挺兵作为像中路一侧的炮架。</p>\r\n    </li>\r\n    <li>\r\n        <p>过宫炮 一种开局着法，走炮二平六或炮八平四，因经过将（帅）的中宫而得名。</p>\r\n    </li>\r\n    <li>\r\n        <p>五七炮</p>\r\n        <p>一种开局着法，先手一方（后手）走成中炮七路炮。是缓攻型布局的典范。</p>\r\n    </li>\r\n    <li>\r\n        <p>卒底炮</p>\r\n        <p>一种开局着法，指后手方用炮2平3或炮8平7，对付对方兵七进一或兵三进一。</p>\r\n    </li>\r\n    <li>\r\n        <p>金钩炮</p>\r\n        <p>布局着法，和卒底炮类似，一方用另一架炮制约对方的兵或相。</p>\r\n    </li>\r\n    <li>\r\n        <p>担子炮</p>\r\n        <p>指双炮在一条直线上中间隔一子，两炮互相联络、保护，其状如扁担，故名。</p>\r\n    </li>\r\n    <li>\r\n        <p>天地炮</p>\r\n        <p>象棋专业术语，一炮镇中路，一炮压底线，使对方的士象将五子都受牵制。</p>\r\n    </li>\r\n    <li>\r\n        <p>横车</p>\r\n        <p>一方走“车一进一（车1进1）”或“车九进一（车9进1）”，以后横向出动，称为“横车”。</p>\r\n    </li>\r\n    <li>\r\n        <p>直车</p>\r\n        <p>一方走“车一平二”或“车九平八”，以后从二路或八路两直线出动，称为“直车”。</p>\r\n    </li>\r\n    <li>\r\n        <p>肋车</p>\r\n        <p>指把车开到四路（4路）和六路（6路）。因其紧贴将门要道，酷似人的双肋而得名。</p>\r\n    </li>\r\n    <li>\r\n        <p>骑河车</p>\r\n        <p>一方的车进到对方河口，称为“骑河车”。可限制对方兵、马等各子的活动，禁子有力。</p>\r\n    </li>\r\n    <li>\r\n        <p>三步虎</p>\r\n        <p>开盘伊始一方走上马、平炮、亮车，三步开出主力车。因状如虎爪揪地，又棋谚有云“车强如虎”，故称之为“三步虎”。\r\n        </p>\r\n    </li>\r\n</ul>'),(37,'                                <h2>\r\n    简述</h2>\r\n<p>\r\n    FEN (Forsyth-Edwards Notation) 是专门用来表示象棋局面的记录规范，在这个规范下，一个局面可以简单地用一行“FEN格式串”来表示。</p>\r\n<p>\r\n    FEN 由有限的几个字母、数字和符号组成一个字符串，便于传递棋局局面信息。 　</p>\r\n<h4 id=\"fen\" class=\"0\">\r\n    FEN 格式规约</h4>\r\n<p>\r\n    FEN 局面表示来源于国际象棋，在中国象棋的 FEN 局面记录中延续了国际象棋的规则，另有一些变通。</p>\r\n<p>\r\n    国际象棋的 FEN 串由 6 段 ASCII 字符组成，彼此间则空格隔开，各段所表示的意义如下：</p>\r\n<ol>\r\n    <li>\r\n        <p>棋盘上棋子位置分布；</p>\r\n    </li>\r\n    <li>\r\n        <p>轮到哪方走子；</p>\r\n    </li>\r\n    <li>\r\n        <p>王车易位可能；</p>\r\n    </li>\r\n    <li>\r\n        <ol start=\"5\">\r\n            <li>关于中国象棋记谱的规范在<a href=\"https://gitbook.cn/gitchat/column/5e9d67352b34772795873df4/topic/docs/%E4%B8%AD%E5%9B%BD%E8%B1%A1%E6%A3%8B%E6%B8%B8%E6%88%8F%E8%A7%84%E8%8C%83\" style=\"background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; color: rgb(79, 161, 219); transition: background-color 0.15s ease-in-out 0s, color 0.15s ease-in-out 0s, border-color 0.15s ease-in-out 0s; outline: 0px !important;\">中国象棋游戏规范</a>的「记谱方法」一篇有详细说明。\r\n            </li>\r\n        </ol>\r\n    </li>\r\n    <li>\r\n        <p>无吃子或进兵步数；</p>\r\n    </li>\r\n    <li>\r\n        <p>棋局总回合数；</p>\r\n    </li>\r\n</ol>\r\n<p>\r\n    中国象棋有自己的一些特色，所以 FEN 串应用于中国象棋时作了以下的变通：</p>\r\n<ul>\r\n    <li>中国象棋无「王车易位」和「吃过路兵」着法，FEN 串的第 3、4 空缺；</li>\r\n    <li>国际象棋棋子颜色分「白、黑」，中国象棋棋子颜色分「红、黑」，实际应用中用「w」代表中国象棋的红方；</li>\r\n</ul>\r\n<p>\r\n    我们以最中国象棋的初始局面为例说明 FEN 串的结构：</p>\r\n<pre><code id=\"code-0\">rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR w - - 0 1\r\n</code></pre>\r\n<p>\r\n    上边的串符合前述的 FEN 的 6 段表示规则，各段之间用空间分隔：</p>\r\n<ol>\r\n    <li>第一段：<code>rnbakabnr/9/1c5c1/p1p1p1p1p/9/9/P1P1P1P1P/1C5C1/9/RNBAKABNR</code> 表示棋盘上的棋子布局：\r\n    </li>\r\n    <li>中国象棋棋盘有 10 行，所以用9个「/」把每一行隔开；</li>\r\n    <li>棋子名用字母表示，小写表示黑方，大写表示红方<ul>\r\n            <li>车：R/r</li>\r\n            <li>马：N/n</li>\r\n            <li>相/象：B/b</li>\r\n            <li>仕/士：A/a</li>\r\n            <li>将/帅：K/k</li>\r\n            <li>炮/砲：C/c</li>\r\n            <li>兵/卒：P/p</li>\r\n        </ul>\r\n    </li>\r\n    <li>第二段：<code>w</code> 表示轮到哪一方走子，「w」表示红方，「b」表示黑方；\r\n    </li>\r\n    <li>第三段：始终用「-」表示；</li>\r\n    <li>第四段，始终用「-」表示；</li>\r\n    <li>第五段，表示无吃子步数，通常该值达到120 就要判和 — 六十回合自然限着</li>\r\n    <li>第六段，表示总回合数，两步为一回合</li>\r\n</ol>\r\n<h4 id=\"fen-1\" class=\"1\">\r\n    FEN文件</h4>\r\n<p>\r\n    FEN 文件它是象棋局面传递的一个有效方式；将一个代表当前局面的 FEN 串以文本文件的方式保存，通常后缀为「.FEN」，这就形成了一个 FEN 文件。</p>\r\n<p>\r\n    {% page-ref page=\"fen-ju-mian-biao-shi.md\" %}</p>                            '),(38,'<p>可能是电脑性能跟不上，还是我开的东西太多，昨晚在写Flutter时，运行调试有点卡住了，看了下时间，有点晚了，就想关机睡大觉，Xubuntu卡住，点不了关机，人有点急躁就直接把电脑断电了（按下插座的开关来关电脑），没想到今天早上起来重新开机后，死活进不了Xubuntu的图形界面，自动跳转到了命令行。然后登录root账户，输入命令\"init 5\"也启动不了图形界面。再看下电脑IP是否能正常获取“ip address\"看到正常自动获取了IP ，再看下是否能正常上网”ping <a href=\"www.qq.com&quot;没通，再看下网关通不通“ping\">www.qq.com\"没通，再看下网关通不通“ping</a>&nbsp;172.18.9.8” 通了，那就是DNS没正常。为何呢？IP自动获取正确，DNS也是自动获取的，反而没正确？？那就只能手机去给xubuntu来设置下DNS ，</p><p>vim /etc/resolv.conf&nbsp;</p><p>nameserver 114.114.114.114</p><p>nameserver 1.0.0.1</p><p>保存。没想到死活保存不了。没理由呀，我这可是超级root用户呀？？！！&nbsp;&nbsp;</p>\r\n<pre><code>\r\nroot@elapse-PC:~# ls -al /etc/|grep pwd\r\n-rw-------   1 root root        0 4月  23 15:32 .pwd.lock\r\nroot@elapse-PC:~# rm -rf /etc/.pwd.lock\r\n这里死活删除不了。只能看下重新挂载下根/\r\nroot@elapse-PC:~# mount -o remount rw /\r\n这里也死活重新挂载不了。\r\n</code>\r\n</pre>\r\n<p><br></p><p>后来想了一下，开机时的错误提示<span style=\"color: rgb(255, 0, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-size: 18px; font-weight: 700;\">\"</span><span style=\"color: rgb(255, 0, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-size: 18px; font-weight: 700;\">Read-only file system</span><span style=\"color: rgb(255, 0, 0); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-size: 18px; font-weight: 700;\">”</span>是指，文件只有读的权限？？！！</p><p>好吧，那就是昨晚强制断电开关造成的的问题了。</p><p>只能<span style=\"color: rgb(77, 77, 77); font-family: -apple-system, &quot;SF UI Text&quot;, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif, SimHei, SimSun; font-size: 18px;\">借助系统自带的磁盘检测命令操作修复</span></p>\r\n<pre><code>\r\nroot@elapse-PC:~# df -h\r\n文件系统        容量  已用  可用 已用% 挂载点\r\nudev            3.4G     0  3.4G    0% /dev\r\ntmpfs           696M  1.7M  695M    1% /run\r\n/dev/sda2       117G  104G  7.1G   94% /\r\ntmpfs           3.4G  349M  3.1G   11% /dev/shm\r\ntmpfs           5.0M  4.0K  5.0M    1% /run/lock\r\ntmpfs           3.4G     0  3.4G    0% /sys/fs/cgroup\r\n/dev/loop1      163M  163M     0  100% /snap/chromium/1298\r\n/dev/loop5      161M  161M     0  100% /snap/gnome-3-28-1804/116\r\n/dev/loop2      234M  234M     0  100% /snap/atom/259\r\n/dev/loop4       29M   29M     0  100% /snap/chromium-ffmpeg/15\r\n/dev/loop6       98M   98M     0  100% /snap/core/9993\r\n/dev/loop3       55M   55M     0  100% /snap/core18/1880\r\n/dev/loop7       33M   33M     0  100% /snap/chromium-ffmpeg/17\r\n/dev/loop0      184M  184M     0  100% /snap/dbeaver-ce/79\r\n/dev/loop8      162M  162M     0  100% /snap/gnome-3-28-1804/128\r\n/dev/loop9       93M   93M     0  100% /snap/insomnia/102\r\n/dev/loop10     234M  234M     0  100% /snap/atom/260\r\n/dev/loop11      68M   68M     0  100% /snap/motrix/5\r\n/dev/loop12      97M   97M     0  100% /snap/core/9804\r\n/dev/loop13      77M   77M     0  100% /snap/insomnia/77\r\n/dev/loop14     145M  145M     0  100% /snap/opera-beta/79\r\n/dev/loop15     145M  145M     0  100% /snap/opera-beta/78\r\n/dev/loop16      31M   31M     0  100% /snap/snapd/9279\r\n/dev/loop17      30M   30M     0  100% /snap/snapd/8790\r\n/dev/loop18      63M   63M     0  100% /snap/gtk-common-themes/1506\r\n/dev/loop19     193M  193M     0  100% /snap/dbeaver-ce/80\r\n/dev/loop20      56M   56M     0  100% /snap/core18/1885\r\n/dev/sda1       511M  212M  300M   42% /boot/efi\r\n/dev/loop22      68M   68M     0  100% /snap/motrix/4\r\n/dev/loop21     162M  162M     0  100% /snap/chromium/1320\r\ntmpfs           696M   12K  696M    1% /run/user/1000\r\n/dev/sdb2       481G  470G   11G   98% /media/elapse/幸运星\r\nroot@elapse-PC:~# 这里看到我的根分区是在第二块硬盘上/dev/sda2里的\r\nroot@elapse-PC:~# fsck -y /dev/sda2\r\n\r\n</code>\r\n</pre>\r\n没想到上面的命令执行完后，直接就自动跳到了XUbuntu的图形界面了，问题直接给解决啦！！！\r\n<p><br></p><p><br></p><p><br></p>'),(39,'                                                                                                                                                                <p>&nbsp; &nbsp; &nbsp; &nbsp;本人的电脑系统是XUbuntu,不知道是不是由于我的只是一个集显的原因(也有可能是VGA线太便宜了).装上显示器后,第二屏只有可怜的640*480可选择,无其它分辨率.\r\n<br>\r\n<img style=\"width: 85%;\" src=\"https://elapse.date/static/uploads/1602995429_bb7739791a6e3632192c.png\" data-filename=\"img\">\r\n</p>\r\n<p>没法了,只能放狗去搜索一下!!最终找到两种方法:</p>\r\n<p>一 修改\"/etc/X11/xorg.conf\"文件(永久性,重启也不失效),但问题是我的系统里没有找到此文件,所以不适用.</p>\r\n<p>二 <a href=\"https://www.cnblogs.com/ViokingJava/p/8184476.html\" target=\"_blank\">利用cvt命令生成一个分辨率,再用xrandr命令来设置</a>,但此是临时性生效,重启后会失效.</p>\r\n<p>先临时修改(步骤是:先用命令xrandr来查看当前的所有显示分辨率设置,再用命令cvt增加分辨率1920*1080,然后把分辨率加到第二显示器,最后再设置显示器分辨率):</p>\r\n<pre><code>\r\nroot@elapse-PC:/etc/X11# xrandr\r\nScreen 0: minimum 320 x 200, current 3840 x 1080, maximum 16384 x 16384\r\nHDMI-A-0 connected 1920x1080+0+0 (normal left inverted right x axis y axis) 527mm x 296mm\r\n   1920x1080     60.00*+  50.00    59.94  \r\n   1680x1050     59.88  \r\n   1600x900      60.00  \r\n   1280x1024     75.02    60.02  \r\n   1440x900      60.00  \r\n   1366x768      59.79  \r\n   1280x800      59.91  \r\n   1280x720      60.00    50.00    59.94  \r\n   1024x768      75.03    70.07    60.00  \r\n   832x624       74.55  \r\n   800x600       72.19    75.00    60.32    56.25  \r\n   720x576       50.00  \r\n   720x480       60.00    59.94  \r\n   640x480       75.00    72.81    66.67    60.00    59.94  \r\n   720x400       70.08  \r\nDVI-D-0 disconnected (normal left inverted right x axis y axis)\r\nDisplayPort-0 connected 640x480+1920+600 (normal left inverted right x axis y axis) 0mm x 0mm\r\n   640x480       59.94* \r\nroot@elapse-PC:/etc/X11# cvt 1920 1080\r\n# 1920x1080 59.96 Hz (CVT 2.07M9) hsync: 67.16 kHz; pclk: 173.00 MHz\r\nModeline \"1920x1080_60.00\"  173.00  1920 2048 2248 2576  1080 1083 1088 1120 -hsync +vsync\r\nroot@elapse-PC:/etc/X11#         注释:使用xrandr 创建新的mode，--newmode后面跟刚刚cvt产生的modeline信息\r\nroot@elapse-PC:/etc/X11# xrandr --newmode \"1920x1080_60.00\" 173.00 1920 2048 2248 2576  1080 1083 1088 1120 -hsync +vsync\r\nroot@elapse-PC:/etc/X11# 注释:使用xrandr中--addmode后面跟的是在\"xrandr\"查看到的显示器名称(1.HDMI-A-0 2.DVI-D-0 3.DisplayPort-0)\r\nroot@elapse-PC:/home/elapse# xrandr --addmode DisplayPort-0 \"1920x1080_60.00\"\r\nroot@elapse-PC:/etc/X11# 注释:到这一步,在图形界面中就可以看到第二个显示器(DisplayPort-0)已经多了分辨率1920*1080可选择了,可以直接用图形界面来设置了,也可以用下面命令设置\r\nroot@elapse-PC:/etc/X11# xrandr --output DisplayPort-0 --mode \"1920x1080_60.00\"\r\n\r\n</code></pre>\r\n<p><br></p><p>至此大功告成,第二显示器已经可以正常的1920*1080来显示了!!但还要在文件\" ~/.profile \"中末尾加上如下:\r\n</p><pre><code>\r\n#设置第二显示器(~/.profile末尾加上如下几句)\r\ncvt 1920 1080\r\nxrandr --newmode \"1920x1080_60.00\" 173.00 1920 2048 2248 2576  1080 1083 1088 1120 -hsync +vsync \r\nxrandr --addmode DisplayPort-0 \"1920x1080_60.00\"\r\nxrandr --output DisplayPort-0 --mode \"1920x1080_60.00\"\r\n</code></pre>\r\n<p></p>\r\n<p>这来样子重启后也会自动生效了,看下我双屏的效果:</p>\r\n<p><img src=\"https://elapse.date/static/uploads/1602996985_74c25096ee50b2c720c9.png\" data-filename=\"img\" style=\"width: 100%;\"><br></p>                                                                                                                                            '),(40,'                                <div>\r\ngitlat服务器的安装：<a href=\"https://www.cnblogs.com/youzhibing/p/12487043.html\" target=\"_blank\">https://www.cnblogs.com/youzhibing/p/12487043.html</a>\r\n<br>\r\ngitlat官方安装教程：<a href=\"https://about.gitlab.com/install/#ubuntu\" target=\"_blank\">https://about.gitlab.com/install/#ubuntu</a>\r\n</div>                                                                                                \r\n<div>找到gitlab服务器的项目对应的hooks文件夹（/var/opt/gitlab/git-data/repositories/root/xxx.git/hooks/）</div>\r\n<div>这里的是：/var/opt/gitlab/git-data/repositories/root/new_lapu.git/hooks&nbsp; （\"root\"这个是你创建些git的账户名为目录;\"new_lapu.git\"这个是GIT地址后面那个）</div><div><br></div><div><div><br></div>\r\n<div>但是我们需要到目录/var/opt/gitlab/git-data/repositories/root/xxx.git/下\r\n\r\n<pre><code>\r\nroot@elapse.date:~# ##新建 custom_hooks目录##\r\nroot@elapse.date:~# cd /var/opt/gitlab/git-data/repositories/root/new_lapu.git\r\nroot@elapse.date:~# ##新建post-receive文件##\r\nroot@elapse.date:~# mkdir custom_hooks\r\nroot@elapse.date:~# chown git:git custom_hooks\r\nroot@elapse.date:~# chmod 755 custom_hooks\r\nroot@elapse.date:~# ls -al|grep custom_hooks\r\nlrwxrwxrwx  1 git git     47 Nov 24 10:22 hooks -&gt; /opt/gitlab/embedded/service/gitlab-shell/hooks\r\nroot@elapse.date:~# cd custom_hooks\r\nroot@elapse.date:~# ##新建post-receive文件##\r\nroot@elapse.date:~# vim post-receive\r\n\r\n#!/bin/bash\r\n\r\necho \"正在同步更新测试服代码...\"\r\n#cd /home/wwwroot/20201114lapu/git_lapu\r\n##unset GIT_DIR\r\n##git pull origin master\r\n\r\n#自动部署的路径\r\nGIT_WORK_TREE=/home/wwwroot/20201114lapu/lapu/\r\n#BRANCH=develop\r\n#这里设置为要自动部署的分支名\r\nBRANCH=master  \r\n\r\nwhile read oldrev newrev ref\r\ndo\r\n    if [[ $ref =~ .*/${BRANCH}$ ]];\r\n    then\r\n        echo \"$BRANCH ref received.  Deploying $BRANCH branch to testserver...\"\r\n        git --work-tree=${GIT_WORK_TREE} checkout ${BRANCH} -f\r\n        # chmod -R 777 ${GIT_WORK_TREE} \r\n        echo \"Git自动化部署测试服代码目录：${GIT_WORK_TREE}\"\r\n    else\r\n        echo \"Ref $ref successfully received.  自动布置测试服什么也没处理：只有分支 $BRANCH 才会自动布暑到测试服！ \"\r\n    fi\r\ndone\r\n\r\necho \"测试服git代码自动化布置完成！  --临来笑笑生\"\r\n# post-receive文件内容结束\r\nroot@elapse.date:~# chown git:git post-receive\r\nroot@elapse.date:~# chmod 755 post-receive\r\nroot@elapse.date:~# ##记得还要去\"自动部署的路径\"给git权限：##\r\nroot@elapse.date:~# chmod 777 -R /home/wwwroot/20201114lapu/lapu/\r\nroot@elapse.date:~# \r\n</code></pre>\r\n到此结束，可以去客户端push代码到自动部署的分支上，然后在服务自动部署路径看有没有自动生成文件了。\r\n</div></div>                                                                                                                '),(41,'<div>rsync 文件同步脚本。</div><div>=========================================================================================================</div><div>参考：https://blog.whsir.com/post-1097.html&nbsp; &nbsp;&nbsp;</div><div><br></div><div>客户端安装：yum -y install rsync</div><div>==============================================================================&nbsp;</div><div># Debian</div><div>$ sudo apt-get install rsync</div><div><br></div><div># Red Hat</div><div>$ sudo yum install rsync</div><div><br></div><div># Arch Linux</div><div>$ sudo pacman -S rsync</div><div>==============================================================================</div><div>配置文件：vim /etc/rsyncd.conf</div><div>&nbsp; 1 uid = root</div><div>&nbsp; 2 gid = root</div><div>&nbsp; 3 use chroot = no</div><div>&nbsp; 4 hosts allow=*</div><div>&nbsp; 5 max connections = 3</div><div>&nbsp; 6 pid file = /var/run/rsyncd.pid</div><div>&nbsp; 7 lock file = /var/run/rsync.lock</div><div>&nbsp; 8 [tongbu]</div><div>&nbsp; 9 path = /whsir</div><div>&nbsp;10 comment = whsir</div><div>&nbsp;11 read only = false</div><div>&nbsp;-----------------这个目录要先创建好------------------------</div><div>配置文件示例：</div><div>----------------------start----------------------------------------------------</div><div># /etc/rsyncd: configuration file for rsync daemon mode</div><div># See rsyncd.conf man page for more options.</div><div># configuration example:</div><div><br></div><div>uid = root</div><div>gid = root</div><div>address = 172.18.156.198&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #监听IP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>port = 873&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #监听端口</div><div><br></div><div>use chroot = yes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#是否囚牢，锁定家目录，rsync被黑之后，黑客无法再rsync运行的家目录之外创建文件，选项设置为yes&nbsp;&nbsp;</div><div><br></div><div>#最大连接数</div><div>max connections = 200</div><div>pid file = /var/run/rsyncd.pid</div><div>#支持max connections参数的锁文件</div><div>lock file = /var/run/rsyncd.lock</div><div>#日志文件位置，启动rsync后自动产生这个文件，无需提前创建</div><div>log file = /var/log/rsyncd.log</div><div>read only = false&nbsp; #设置rsync服务端文件为读写权限</div><div>list = false #不显示rsync服务端资源列表</div><div>#允许进行数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开</div><div>#hosts allow = 192.168.139.0/24&nbsp;</div><div>hosts allow = 172.18.156.198,172.18.156.195,172.18.156.197,172.18.156.196</div><div>#hosts deny = 0.0.0.0/32 #禁止数据同步的客户端IP地址，可以设置多个，用英文状态下逗号隔开</div><div>auth users = rsync,rsyncbak #执行数据同步的用户名，可以设置多个，用英文状态下逗号隔开</div><div><br></div><div>#用户认证配置文件，里面保存用户名称和密码，后面会创建这个文件</div><div>secrets file = /etc/rsync.password&nbsp; &nbsp; &nbsp; &nbsp;</div><div><br></div><div># exclude = lost+found/</div><div># transfer logging = yes</div><div># timeout = 900</div><div># ignore nonreadable = yes</div><div># dont compress&nbsp; &nbsp;= *.gz *.tgz *.zip *.z *.Z *.rpm *.deb *.bz2</div><div><br></div><div># [ftp]</div><div>#&nbsp; &nbsp; &nbsp; &nbsp; path = /home/ftp</div><div>#&nbsp; &nbsp; &nbsp; &nbsp; comment = ftp export area</div><div><br></div><div>[backup]&nbsp; &nbsp;#自定义模块名称&nbsp;&nbsp;</div><div>path = /backup&nbsp; #rsync服务端数据目录路径</div><div>comment = used for web-data root&nbsp; &nbsp; #模块描述</div><div>read only = false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#设置服务端文件读写权限&nbsp; &nbsp;</div><div>list = yes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #是否允许查看模块信息</div><div>auth users = rsyncbak&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #备份的用户，和系统用户无关</div><div>secrets file = /etc/rsync.password&nbsp; &nbsp; #存放用户的密码文件(chmod 600 /etc/rsync.passwd)，格式是&nbsp; 用户名：密码&nbsp; &nbsp;</div><div>----------------------------------------------------</div><div>uid = root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#运行进程的身份&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div><div>gid = root&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#运行进程的组&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>address =192.168.0.50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #监听IP&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>port =873&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #监听端口&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>hosts allow =192.168.0.0/24&nbsp; &nbsp; &nbsp; &nbsp; #允许同步客户端的IP地址，可以是网段，或者用*表示所有 192.168.1.0/24或192.168.1.0/255.255.255.0&nbsp;&nbsp;</div><div>use chroot = yes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#是否囚牢，锁定家目录，rsync被黑之后，黑客无法再rsync运行的家目录之外创建文件，选项设置为yes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</div><div>max connections =10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#最大连接数&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div><div>pid file =/var/run/rsyncd.pid&nbsp; &nbsp; &nbsp; &nbsp;#进程PID，自动生成&nbsp;&nbsp;</div><div>lock file =/var/run/rsync.lock&nbsp; &nbsp; &nbsp; #指max connectios参数的锁文件</div><div>log file =/var/log/rsyncd.log&nbsp; &nbsp; &nbsp; &nbsp;#日志文件位置</div><div><br></div><div>&nbsp;</div><div>[wwwroot]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#同步模块名称&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</div><div>path =/opt/cosmo/test/&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #同步文件路径&nbsp; &nbsp; &nbsp;</div><div>comment = used for web-data root&nbsp; &nbsp; #模块描述</div><div>read only = false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#设置服务端文件读写权限&nbsp; &nbsp;</div><div>list = yes&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #是否允许查看模块信息</div><div>auth users = rsyncuser&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; #备份的用户，和系统用户无关</div><div>secrets file =/etc/rsync.passwd&nbsp; &nbsp; &nbsp;#存放用户的密码文件，格式是&nbsp; 用户名：密码</div><div>----------------------end------------------------------------------------------</div><div>启动同步服务： /usr/bin/rsync --daemon</div><div>关闭命令：</div><div>启动服务</div><div>rsync --daemon</div><div># 关闭服务</div><div>pkill rsync</div><div><br></div><div><br></div><div>#启动rsync服务</div><div>systemctl start rsyncd.service</div><div>systemctl enable rsyncd.service</div><div><br></div><div>#检查是否已经成功启动</div><div>netstat -lnp|grep 873</div><div>---------------------------------------------------------</div><div><br></div><div>服务端：</div><div>cd /usr/local/</div><div>wget http://down.whsir.com/downloads/sersync2.5.4_64bit_binary_stable_final.tar.gz</div><div>tar -zxvf sersync2.5.4_64bit_binary_stable_final.tar.gz&nbsp;</div><div>mv GNU-Linux-x86 sersync</div><div>cp confxml.xml confxml.xml.yl</div><div>chmod +x sersync2</div><div>vim confxml.xml</div><div>--------------------------start------------------------------------</div><div>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;</div><div>&lt;head version=\"2.5\"&gt;</div><div>&nbsp; &nbsp; &lt;host hostip=\"localhost\" port=\"8008\"&gt;&lt;/host&gt;</div><div>&nbsp; &nbsp; &lt;debug start=\"false\"/&gt;</div><div>&nbsp; &nbsp; &lt;fileSystem xfs=\"false\"/&gt;</div><div>&nbsp; &nbsp; &lt;filter start=\"false\"&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;exclude expression=\"(.*)\\.svn\"&gt;&lt;/exclude&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;exclude expression=\"(.*)\\.gz\"&gt;&lt;/exclude&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;exclude expression=\"^info/*\"&gt;&lt;/exclude&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;exclude expression=\"^static/*\"&gt;&lt;/exclude&gt;</div><div>&nbsp; &nbsp; &lt;/filter&gt;</div><div>&nbsp; &nbsp; &lt;inotify&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;delete start=\"true\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;createFolder start=\"true\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;createFile start=\"false\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;closeWrite start=\"true\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;moveFrom start=\"true\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;moveTo start=\"true\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;attrib start=\"false\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;modify start=\"false\"/&gt;</div><div>&nbsp; &nbsp; &lt;/inotify&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;sersync&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;localpath watch=\"/opt/tongbu\"&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;remote ip=\"172.18.156.198\" name=\"tongbu\"/&gt;</div><div><br></div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;remote ip=\"172.18.156.197\" name=\"www\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;remote ip=\"172.18.156.195\" name=\"www\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;!--&lt;remote ip=\"192.168.8.39\" name=\"tongbu\"/&gt;--&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;!--&lt;remote ip=\"192.168.8.40\" name=\"tongbu\"/&gt;--&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;/localpath&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;rsync&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;commonParams params=\"-artuz\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;auth start=\"false\" users=\"root\" passwordfile=\"/etc/rsync.pas\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;userDefinedPort start=\"false\" port=\"874\"/&gt;&lt;!-- port=874 --&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;timeout start=\"false\" time=\"100\"/&gt;&lt;!-- timeout=100 --&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;ssh start=\"false\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;/rsync&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;failLog path=\"/tmp/rsync_fail_log.sh\" timeToExecute=\"60\"/&gt;&lt;!--default every 60mins execute once--&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;crontab start=\"false\" schedule=\"600\"&gt;&lt;!--600mins--&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;crontabfilter start=\"false\"&gt;</div><div><span style=\"white-space:pre\">		</span>&lt;exclude expression=\"*.php\"&gt;&lt;/exclude&gt;</div><div><span style=\"white-space:pre\">		</span>&lt;exclude expression=\"info/*\"&gt;&lt;/exclude&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;/crontabfilter&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;/crontab&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;plugin start=\"false\" name=\"command\"/&gt;</div><div>&nbsp; &nbsp; &lt;/sersync&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;plugin name=\"command\"&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;param prefix=\"/bin/sh\" suffix=\"\" ignoreError=\"true\"/&gt;<span style=\"white-space:pre\">	</span>&lt;!--prefix /opt/tongbu/mmm.sh suffix--&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;filter start=\"false\"&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;include expression=\"(.*)\\.php\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;include expression=\"(.*)\\.sh\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;/filter&gt;</div><div>&nbsp; &nbsp; &lt;/plugin&gt;</div><div><br></div><div>&nbsp; &nbsp; &lt;plugin name=\"socket\"&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;localpath watch=\"/opt/tongbu\"&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;deshost ip=\"192.168.138.20\" port=\"8009\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;/localpath&gt;</div><div>&nbsp; &nbsp; &lt;/plugin&gt;</div><div>&nbsp; &nbsp; &lt;plugin name=\"refreshCDN\"&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;localpath watch=\"/data0/htdocs/cms.xoyo.com/site/\"&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;cdninfo domainname=\"ccms.chinacache.com\" port=\"80\" username=\"xxxx\" passwd=\"xxxx\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;sendurl base=\"http://pic.xoyo.com/cms\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&nbsp; &nbsp; &lt;regexurl regex=\"false\" match=\"cms.xoyo.com/site([/a-zA-Z0-9]*).xoyo.com/images\"/&gt;</div><div><span style=\"white-space:pre\">	</span>&lt;/localpath&gt;</div><div>&nbsp; &nbsp; &lt;/plugin&gt;</div><div>&lt;/head&gt;</div><div>----------------------------end-------------------------------------</div><div>以下为参照：</div><div>----------------------start-----------------------------------------</div><div>&lt;?xml version=\"1.0\" encoding=\"ISO-8859-1\"?&gt;</div><div>&lt;head version=\"2.5\"&gt;</div><div>&lt;host hostip=\"localhost\" port=\"8008\"&gt;&lt;/host&gt; #保留字段，默认即可</div><div>&lt;debug start=\"false\"/&gt; #是否开启调试模式,默认false即可</div><div>&lt;fileSystem xfs=\"true\"/&gt; #是否开启支持xfs文件系统，Centos7默认都是xfs的了，所以建议true开启</div><div>&lt;filter start=\"false\"&gt; #是否开启过滤模式，根据需求开启，例:过滤以.php结尾的文件(.*)\\.php</div><div>&lt;exclude expression=\"(.*)\\.svn\"&gt;&lt;/exclude&gt; #过滤以.svn结尾的文件</div><div>&lt;exclude expression=\"(.*)\\.gz\"&gt;&lt;/exclude&gt; #过滤以.gz结尾的文件</div><div>&lt;exclude expression=\"^info/*\"&gt;&lt;/exclude&gt; #过滤监控目录下的info路径</div><div>&lt;exclude expression=\"^static/*\"&gt;&lt;/exclude&gt; #过滤监控目录下的static路径</div><div>&lt;exclude expression=\"wwwroot/blogwhsir/*\"&gt;&lt;/exclude&gt; #过滤wwwroot/blogwhsir/目录下所有文件</div><div>&lt;/filter&gt;</div><div>&lt;inotify&gt; #inotify监控事件</div><div>&lt;delete start=\"true\"/&gt; #如果不开启此项，在删除监控目录下的文件时，目标服务器的文件则不会同时删除，根据需求开启</div><div>&lt;createFolder start=\"true\"/&gt; #不开启不能监控子目录，建议true</div><div>&lt;createFile start=\"false\"/&gt; #关闭提高通讯性能，默认就好</div><div>&lt;closeWrite start=\"true\"/&gt;</div><div>&lt;moveFrom start=\"true\"/&gt;</div><div>&lt;moveTo start=\"true\"/&gt;</div><div>&lt;attrib start=\"false\"/&gt;</div><div>&lt;modify start=\"false\"/&gt;</div><div>&lt;/inotify&gt;</div><div>&nbsp;</div><div>&lt;sersync&gt;</div><div>&lt;localpath watch=\"/opt/tongbu\"&gt; #指定要监控的本地目录</div><div>&lt;remote ip=\"127.0.0.1\" name=\"tongbu1\"/&gt; #指定要同步的目标服务器的IP地址，及目标服务器rsync的[模块]</div><div>&lt;!--&lt;remote ip=\"192.168.8.39\" name=\"tongbu\"/&gt;--&gt;</div><div>&lt;!--&lt;remote ip=\"192.168.8.40\" name=\"tongbu\"/&gt;--&gt;</div><div>&lt;/localpath&gt;</div><div>&lt;rsync&gt; #配置rsync</div><div>&lt;commonParams params=\"-artuz\"/&gt; #rsync的参数</div><div>&lt;auth start=\"false\" users=\"root\" passwordfile=\"/etc/rsync.pas\"/&gt; #是否开启rsync的认证模式，需要配置users及passwordfile，根据情况开启（如果开启，注意密码文件权限一定要是600）</div><div>&lt;userDefinedPort start=\"false\" port=\"874\"/&gt;&lt;!-- port=874 --&gt; #远程目标服务器的端口不是默认端口时使用</div><div>&lt;timeout start=\"false\" time=\"100\"/&gt;&lt;!-- timeout=100 --&gt; #是否开启rsync的超时时间</div><div>&lt;ssh start=\"false\"/&gt;</div><div>&lt;/rsync&gt;</div><div>&lt;failLog path=\"/tmp/rsync_fail_log.sh\" timeToExecute=\"60\"/&gt;&lt;!--default every 60mins execute once--&gt; #目标服务器传输失败时会重新传输，再次失败会写入rsync_fail_log中，每隔一段时间（timeToExecute）执行脚本再次传输</div><div>&lt;crontab start=\"false\" schedule=\"600\"&gt;&lt;!--600mins--&gt; #对监控目录与目标服务器每隔一段时间进行一次整体同步，默认600分钟，根据个人情况是否开启</div><div>&lt;crontabfilter start=\"false\"&gt; #如果之前开启了文件过滤，这里也要设置过滤</div><div>&lt;exclude expression=\"*.php\"&gt;&lt;/exclude&gt;</div><div>&lt;exclude expression=\"info/*\"&gt;&lt;/exclude&gt;</div><div>&lt;/crontabfilter&gt;</div><div>&lt;/crontab&gt;</div><div>&lt;plugin start=\"false\" name=\"command\"/&gt;</div><div>&lt;/sersync&gt;</div><div>&nbsp;</div><div>&lt;plugin name=\"command\"&gt; #下面就是插件的设置（不做过多说明）</div><div>&lt;param prefix=\"/bin/sh\" suffix=\"\" ignoreError=\"true\"/&gt; &lt;!--prefix /opt/tongbu/mmm.sh suffix--&gt;</div><div>&lt;filter start=\"false\"&gt;</div><div>&lt;include expression=\"(.*)\\.php\"/&gt;</div><div>&lt;include expression=\"(.*)\\.sh\"/&gt;</div><div>&lt;/filter&gt;</div><div>&lt;/plugin&gt;</div><div>&nbsp;</div><div>&lt;plugin name=\"socket\"&gt;</div><div>&lt;localpath watch=\"/opt/tongbu\"&gt;</div><div>&lt;deshost ip=\"192.168.138.20\" port=\"8009\"/&gt;</div><div>&lt;/localpath&gt;</div><div>&lt;/plugin&gt;</div><div>&lt;plugin name=\"refreshCDN\"&gt;</div><div>&lt;localpath watch=\"/data0/htdocs/cms.xoyo.com/site/\"&gt;</div><div>&lt;cdninfo domainname=\"ccms.chinacache.com\" port=\"80\" username=\"xxxx\" passwd=\"xxxx\"/&gt;</div><div>&lt;sendurl base=\"https://blog.whsir.com\"/&gt;</div><div>&lt;regexurl regex=\"false\" match=\"cms.xoyo.com/site([/a-zA-Z0-9]*).xoyo.com/images\"/&gt;</div><div>&lt;/localpath&gt;</div><div>&lt;/plugin&gt;</div><div>&lt;/head&gt;</div><div>---------------------end------------------------------------------------------------</div><div>启动：&nbsp; &nbsp;/usr/local/sersync/sersync2 -n 16 -d -o /usr/local/sersync/confxml.xml</div><div>如果没有报错，就可以去测试文件是否能同眇了&nbsp; ,这里开了16线程</div><div><br></div><div>启动时，如下没产生报错就可以了</div><div>[root@iZwz9dv2hn8jtmeie8ipc0Z sersync]# /usr/local/sersync/sersync2 -n 16 -d -o /usr/local/sersync/confxml.xml</div><div>set the system param</div><div>execute：echo 50000000 &gt; /proc/sys/fs/inotify/max_user_watches</div><div>execute：echo 327679 &gt; /proc/sys/fs/inotify/max_queued_events</div><div>parse the command param</div><div>option: -n&nbsp; &nbsp; &nbsp; thread num is：&nbsp; 16</div><div>option: -d&nbsp; &nbsp; &nbsp; run as a daemon</div><div>option: -o&nbsp; &nbsp; &nbsp; config xml name：&nbsp; /usr/local/sersync/confxml.xml</div><div>parse xml config file</div><div>host ip : localhost&nbsp; &nbsp; &nbsp;host port: 8008</div><div>daemon start，sersync run behind the console&nbsp;</div><div>config xml parse success</div><div>please set /etc/rsyncd.conf max connections=0 Manually</div><div>sersync working thread 18&nbsp; = 1(primary thread) + 1(fail retry thread) + 16(daemon sub threads)&nbsp;</div><div>Max threads numbers is: 50 = 18(Thread pool nums) + 32(Sub threads)</div><div>please according your cpu ，use -n param to adjust the cpu rate</div><div>run the sersync:&nbsp;</div><div>watch path is: /home/www/project</div><div>[root@iZwz9dv2hn8jtmeie8ipc0Z sersync]#</div><div><br></div><div><br></div><div>查看文件同步进程</div><div>[root@iZwz9dv2hn8jtmeie8ipc0Z ~]# ps -ef|grep rsync</div><div>root&nbsp; &nbsp; &nbsp; 5249&nbsp; 6073&nbsp; 0 Dec06 ?&nbsp; &nbsp; &nbsp; &nbsp; 00:09:50 /bin/sh /tmp/rsync_fail_log.sh</div><div>root&nbsp; &nbsp; &nbsp; 6073&nbsp; &nbsp; &nbsp;1&nbsp; 0 Dec06 ?&nbsp; &nbsp; &nbsp; &nbsp; 00:00:04 /usr/local/sersync/sersync2 -n 16 -d -o /usr/local/sersync/confxml.xml</div><div>root&nbsp; &nbsp; &nbsp;10087&nbsp; 5249&nbsp; 0 09:34 ?&nbsp; &nbsp; &nbsp; &nbsp; 00:00:00 rsync -artuz -R ./lapu/Application/Runtime/Logs/Api/20_12_05.log 172.18.156.197::www</div><div>root&nbsp; &nbsp; &nbsp;10090&nbsp; 9623&nbsp; 0 09:34 pts/1&nbsp; &nbsp; 00:00:00 grep --color=auto rsync</div><div>[root@iZwz9dv2hn8jtmeie8ipc0Z ~]#</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div>========================== 下面不用看，没用的&nbsp; =====================================================================================================================</div><div><br></div><div><br></div><div>&nbsp;</div><div><br></div><div><br></div><div>----------------- rsync 命令 ---------------------------------</div><div>$ rsync -r source1 source2 destination</div><div>上面命令中，source1、source2都会被同步到destination目录。</div><div>-a参数可以替代-r，除了可以递归同步以外，还可以同步元信息（比如修改时间、权限等）。由于 rsync 默认使用文件大小和修改时间决定文件是否需要更新，所以-a比-r更有用。下面的用法才是常见的写法。</div><div>$ rsync -a source destination</div><div>如果只想同步源目录source里面的内容到目标目录destination，则需要在源目录后面加上斜杠</div><div><br></div><div>-n 参数</div><div>如果不确定 rsync 执行后会产生什么结果，可以先用-n或--dry-run参数模拟执行的结果。</div><div><br></div><div><br></div><div>$ rsync -anv source/ destination</div><div>上面命令中，-n参数模拟命令执行的结果，并不真的执行命令。-v参数则是将结果输出到终端，这样就可以看到哪些内容会被同步。</div><div><br></div><div>$ rsync -av --delete source/ destination</div><div>上面命令中，--delete参数会使得destination成为source的一个镜像。</div><div>=======================================================================================</div><div>下面是一个脚本示例，备份用户的主目录</div><div>#!/bin/bash</div><div><br></div><div># A script to perform incremental backups using rsync</div><div><br></div><div>set -o errexit</div><div>set -o nounset</div><div>set -o pipefail</div><div><br></div><div>readonly SOURCE_DIR=\"${HOME}\"</div><div>readonly BACKUP_DIR=\"/mnt/data/backups\"</div><div>readonly DATETIME=\"$(date \'+%Y-%m-%d_%H:%M:%S\')\"</div><div>readonly BACKUP_PATH=\"${BACKUP_DIR}/${DATETIME}\"</div><div>readonly LATEST_LINK=\"${BACKUP_DIR}/latest\"</div><div><br></div><div>mkdir -p \"${BACKUP_DIR}\"</div><div><br></div><div>rsync -av --delete \\</div><div>&nbsp; \"${SOURCE_DIR}/\" \\</div><div>&nbsp; --link-dest \"${LATEST_LINK}\" \\</div><div>&nbsp; --exclude=\".cache\" \\</div><div>&nbsp; \"${BACKUP_PATH}\"</div><div><br></div><div>rm -rf \"${LATEST_LINK}\"</div><div>ln -s \"${BACKUP_PATH}\" \"${LATEST_LINK}\"</div><div># 上面脚本中，每一次同步都会生成一个新目录${BACKUP_DIR}/${DATETIME}，并将软链接${BACKUP_DIR}/latest指向这个目录。</div><div>下一次备份时，就将${BACKUP_DIR}/latest作为基准目录，生成新的备份目录。最后，再将软链接${BACKUP_DIR}/latest指向新的备份目录。</div><div>=======================================================================================</div><div>-------------------------------------------------------------</div><div><br></div><div>A、推文件：&nbsp; rsync -av /etc/passwd&nbsp; 192.168.204.168:/tmp/passwd.txt</div><div>B、拉文件：&nbsp; rsync -av&nbsp; 192.168.204.168:/tmp/passwd.txt&nbsp; /tmp/test.txt</div><div>指定ssh端口： rsync -av -e \"ssh -p 22\" 192.168.204.168:/tmp/passwd.txt&nbsp; /tmp/a.txt</div><div>==========================================================================</div><div>备份数据库：mysqldump --opt -uroot -p elapse &gt; elapse.2020.08.19.sql</div><div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mysqldump --opt -uroot -p tokay &gt; tokay.sql</div><div>恢复库：mysql -u root -p tokay &lt; tokay.sql</div><div><br></div><div>导出某些数据表：</div><div>mysqldump -uusername -ppassword db1 table1 table2 &gt; tb1tb2.sql</div><div>导入某些数据表</div><div>mysql -uusername -ppassword db1 &lt; tb1tb2.sql</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div>'),(42,'<div>内网机上执行:</div><div>ssh -o ServerAliveInterval=60 -f -N -R 9090:192.168.0.154:22 root@1.1.1.1</div><div>这句代码的意思是让公网机的9090端口能够监听到内网机的22端口，这样我们就能通过访问公网机的9090端口直接登录内网机器。</div><div>ServerAliveInterval=60 防止连接不稳定，这里设置每60秒发送一次数据包</div><div>这样我们就能连接通过外网机登录内网机器了</div><div><br></div><div>ssh -o ServerAliveInterval=60 -f -N -R 9090:192.168.1.98:22 root@111.230.245.63</div><div><br></div><div>ssh -o ServerAliveInterval=60 -f -N -R 9090:192.168.1.158:22 root@47.115.44.149</div><div><br></div><div>公网机上输入 curl http://127.0.0.1:9090， 看到下面这串回复说明ssh已经通了:</div><div>root@111-230-245-63:~# curl http://127.0.0.1:9090</div><div>SSH-2.0-OpenSSH_7.2p2 Ubuntu-4ubuntu2.4</div><div>Protocol mismatch.</div><div><br></div><div>公网机上输入： ssh root@127.0.0.1 -p9090 在键入密码就可以登录到内网机</div><div><br></div><div>但是这里还有个问题就是ssh只能连接到外网机的本机回路地址127.0.0.1上，</div><div>我们还无法通过外网ip 1.1.1.1来连接内网机。所以这里还要做如下配置：</div><div>外网机输入:iptables -t nat -A PREROUTING -p tcp --dport 9090 -j DNAT --to-destination 127.0.0.1:9090</div><div>这句代码的意思是访问9090端口的请求都转发到回路地址127.0.0.1:9090这个地址上.</div><div>iptables -t nat -A PREROUTING -p tcp --dport 9090 -j DNAT --to-destination 127.0.0.1:9090</div><div><br></div><div>Linux系统出于安全考虑，是不允许将请求转发至127.0.0.1这个回环地址上的，所以我们还需要修改内核参数。</div><div>sysctl -w net.ipv4.conf.eth0.route_localnet=1</div><div>到此我们所有配置完成.</div><div><br></div><div>输入： curl http://1.1.1.1:9090</div><div>出如下，就成功了：</div><div>SSH-2.0-OpenSSH_7.4</div><div>Protocol mismatch.</div><div><br></div><div>在做最终的测试，任意选择一台机器（ssh 正常使用）</div><div>命令行输入：·ssh root@1.1.1.1 -p9090</div><div>root@1.1.1.1\'s password: 注意这里是内网机的密码，不是外网机的密码。</div>'),(43,'<p>CentOS:</p><p>安装:<span style=\"background-color: rgb(34, 34, 34); color: rgb(213, 206, 217); font-family: &quot;Droid Sans Mono&quot;, monospace, monospace, &quot;Droid Sans Fallback&quot;; font-size: 14px; white-space: pre;\">yum install -y cronie</span></p><div style=\"color: rgb(213, 206, 217); background-color: rgb(34, 34, 34); font-family: &quot;Droid Sans Mono&quot;, monospace, monospace, &quot;Droid Sans Fallback&quot;; font-size: 14px; line-height: 19px; white-space: pre;\"><div> 1、直接编辑配置文件</div><div>    配置文件路径：/etc/crontab</div><br><div>    2、使用crontab -e 命令编辑</div><br><div>    3、直接编辑目标文件</div><div>进入/var/spool/cron/</div><br><div>    systemctl start   crond         启动服务</div><div>systemctl stop    crond         停止服务</div><div>systemctl restart crond         重启服务</div><div>systemctl reload  crond         重载配置文件</div><div>systemctl status  crond         查看状态</div><br><div>crontab常用命令</div><div>crontab -u         设定某个用户的cron服务</div><div>crontab -l        显示crontab文件(显示已设置的定时任务)</div><div>crontab -e        编辑crontab文件(编辑定时任务)</div><div>crontab -r        删除crontab文件(删除定时任务)</div><div>crontab -i        删除crontab文件提醒用户(删除定时任务)</div></div>'),(44,'                                                                                                                                                                <p></p><p>\r\n按照先查看日志再排查的原理，先去看vim /usr/local/php/etc/php-fpm.conf，看到日志文件是在：error_log = /usr/local/php/var/log/php-fpm.log<br>日志中报了如下：<br>\r\n</p><pre><code>\r\nWARNING: [pool www] seems busy (you may need to increase pm.start_servers, or pm.min/max_spare_servers), spawning 8 children, there are 0 idle, and 100 total children\r\nWARNING: [pool www] seems busy (you may need to increase pm.start_servers, or pm.min/max_spare_servers), spawning 32 children, there are 0 idle, and 1591 total children\r\nWARNING: [pool www] seems busy (you may need to increase pm.start_servers, or pm.min/max_spare_servers), spawning 8 children, there are 27 idle, and 3511 total children\r\n</code></pre>\r\n这个日志说明了是高并发下PHP的子线程不够用，php出现告警了，要增加php的，pm.start_servers, or pm.min/max_spare_servers的值,不然会产生nginx请求出现很多的502超时.\r\n那么我们在服务器硬件还能支持更多的PHP子线程时，修改如下的参数,以达到增大PHP-FPM线程：\r\n<pre><code>\r\n[root@120-24-111-219 log]# vim /usr/local/php/etc/php-fpm.conf\r\npm = dynamic\r\n pm.max_children = 5800\r\n pm.start_servers = 800\r\n pm.min_spare_servers = 40\r\n pm.max_spare_servers = 5800\r\n\r\n</code>\r\n</pre>\r\n保存退出后，重启PHP。\r\n再用\"netstat -anpo | grep php-fpm | wc -l\",来查看php的线程数是否在高并发时上来了。\r\n<p>\r\n参数分析：\r\npm= dynamic  表示php启用的动态模式  注： php有动态和静态(static)两种工作模式，默认是动态模式。\r\npm.max_children      表示静态下最大线程数\r\npm.start_servers      表示动态下启动时的线程数，该参数大于pm.min_spare_servers，小于pm.max_spare_servers\r\npm.min_spare_servers      表示动态下最小空闲线程数\r\npm.max_spare_servers      表示动态下最大空闲线程数\r\n工作模式：\r\nStatic模式\r\n当工作模式设置为静态后，就只有pm.max_children项有效，即表示php-fpm工作时一直保持的线程数。\r\nDynamic 模式\r\n动态模式下，与他相关的参数有pm.start_servers、pm.min_spare_servers 、pm.max_spare_servers，分别表示开启的php进程数，最小的进程数、与最大的进程数。\r\n模式比较：\r\n静态模式的话，比较适合一些内存比较大一点的服务器，8G及以上的，因为对于比较大内存的服务器来说，设置为静态的话会提高效率。\r\n动态模式适合小内存机器，灵活分配进程，省内存。可以让php自动增加和减少进程数，不过动态创建回收进程对服务器也是一种消耗。\r\n</p>参考:<a href=\"https://blog.51cto.com/xiaozhagn/2136667\">https://blog.51cto.com/xiaozhagn/2136667</a><br>\r\n<p>\r\n好了，处理完PHP的报错调优后，本以为一切终于可以正常了，没想到PHP是正常了，这下轮到了mysql的默认连接数问题了，\r\n在PHP框架上产生了如下的报错：\r\n</p><pre><code>\r\n[ error ] [10501]SQLSTATE[42000]: Syntax error or access violation: 1461 Can\'t create more than max_prepared_stmt_count statements (current value: 16382)\r\n</code>\r\n</pre>\r\n意思是说mysql中的max_prepared_stmt_count参数默认为：16382，已经超过。所以如果数据库的服务器硬盘跟得上的话，就增大max_prepared_stmt_count参数的值。\r\n一般默认值应该是足够用的，因为并发没有那么大。也可能是应用端（PHP的代码有错误,没能正常关闭，然后越积赵多）那边没有关闭prepared的语句。\r\n<p></p>       \r\n<p>\r\n查看mysql如下3个参数值：\r\nCom_stmt_close prepare语句关闭的次数\r\nCom_stmt_execute prepare语句执行的次数\r\nCom_stmt_prepare prepare语句创建的次数\r\n通过以下命令修改max_prepared_stmt_count的值（该值可动态修改，也可在配置文件中指定后重启服务生效）\r\n</p><pre><code>\r\n[root@elapse.date ~]# mysql -hrm-wzsafaeeasdf.mysql.rds.aliyuncs.com -uroot -p\r\nEnter password: \r\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\r\nYour MySQL connection id is 13412261\r\nServer version: 5.7.14-AliSQL-X-Cluster-1.5.1.7-20200918-log Source distribution\r\n\r\nCopyright (c) 2000, 2020, Oracle and/or its affiliates. All rights reserved.\r\n\r\nOracle is a registered trademark of Oracle Corporation and/or its\r\naffiliates. Other names may be trademarks of their respective\r\nowners.\r\n\r\nType \'help;\' or \'\\h\' for help. Type \'\\c\' to clear the current input statement.\r\n\r\nmysql&gt; SHOW GLOBAL STATUS LIKE \'com_stmt%\';\r\n+-------------------------+------------+\r\n| Variable_name           | Value      |\r\n+-------------------------+------------+\r\n| Com_stmt_execute        | 1611653381 |\r\n| Com_stmt_close          | 1611634907 |\r\n| Com_stmt_fetch          | 0          |\r\n| Com_stmt_prepare        | 1611663970 |\r\n| Com_stmt_reset          | 0          |\r\n| Com_stmt_send_long_data | 0          |\r\n| Com_stmt_reprepare      | 0          |\r\n+-------------------------+------------+\r\n7 rows in set (0.02 sec)\r\n\r\nmysql&gt; set global max_prepared_stmt_count=1048575;\r\nERROR 1227 (42000): Access denied; you need (at least one of) the SUPER privilege(s) for this operation\r\nmysql&gt; GRANT SYSTEM_USER ON *.* TO \'root\'\r\n    -&gt; ;\r\nERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'SYSTEM_USER ON *.* TO \'root\'\' at line 1\r\nmysql&gt; GRANT SYSTEM_USER ON *.* TO root\r\n    -&gt; ;\r\nERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near \'SYSTEM_USER ON *.* TO root\' at line 1\r\nmysql&gt; exit;\r\nBye\r\n</code>\r\n</pre>\r\n<p>\r\n数据库参考：<a href=\"https://zhuanlan.zhihu.com/p/67188414\" target=\"_blank\">https://zhuanlan.zhihu.com/p/67188414</a>\r\n</p>  \r\n\r\n<p>\r\n修改完后，以为全部问题解决了，没想到，又报了这“ERROR 1040 (HY000): Too many connections”mysql的链接数满了。\r\n</p>\r\n按MySQL sleep连接过多 解决办法，把超时等待时间设置短\r\n<pre><code>\r\nelapse@luck:/var/www$ /usr/local/mysql/bin/mysql -uroot -p\r\nEnter password: \r\nWelcome to the MariaDB monitor.  Commands end with ; or \\g.\r\nYour MariaDB connection id is 31\r\nServer version: 10.5.8-MariaDB MariaDB Server\r\n\r\nCopyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.\r\n\r\nType \'help;\' or \'\\h\' for help. Type \'\\c\' to clear the current input statement.\r\n\r\nMariaDB [(none)]&gt; create user \'test\'@\'localhost\' identified by \'test\';\r\nERROR 1396 (HY000): Operation CREATE USER failed for \'test\'@\'localhost\'\r\nMariaDB [(none)]&gt; set password for \'test\'@\'localhost\' = \'test1\';\r\nERROR 1372 (HY000): Password hash should be a 41-digit hexadecimal number\r\nMariaDB [(none)]&gt; grant all on *.*  to \'test\'@\'localhost\';\r\nQuery OK, 0 rows affected (0.001 sec)\r\n\r\nMariaDB [(none)]&gt; set password for \'test\'@\'localhost\' = \'test1\';\r\nERROR 1372 (HY000): Password hash should be a 41-digit hexadecimal number\r\nMariaDB [(none)]&gt; grant system_user on *.* to \'root\';\r\nERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near \'on *.* to \'root\'\' at line 1\r\nMariaDB [(none)]&gt; show global variables like \'wait_timeout\';\r\n+---------------+-------+\r\n| Variable_name | Value |\r\n+---------------+-------+\r\n| wait_timeout  | 28800 |\r\n+---------------+-------+\r\n1 row in set (0.001 sec)\r\n\r\nMariaDB [(none)]&gt; set global wait_timeout=30;\r\nQuery OK, 0 rows affected (0.000 sec)\r\n\r\nMariaDB [(none)]&gt; show global variables like \'wait_timeout\';\r\n+---------------+-------+\r\n| Variable_name | Value |\r\n+---------------+-------+\r\n| wait_timeout  | 30    |\r\n+---------------+-------+\r\n1 row in set (0.001 sec)\r\n\r\nMariaDB [(none)]&gt; SHOW GLOBAL VARIABLES LIKE \'interactive_timeout\';\r\n+---------------------+-------+\r\n| Variable_name       | Value |\r\n+---------------------+-------+\r\n| interactive_timeout | 28800 |\r\n+---------------------+-------+\r\n1 row in set (0.001 sec)\r\n\r\nMariaDB [(none)]&gt; SHOW GLOBAL VARIABLES LIKE \'interactive_timeout\';\r\n+---------------------+-------+\r\n| Variable_name       | Value |\r\n+---------------------+-------+\r\n| interactive_timeout | 28800 |\r\n+---------------------+-------+\r\n1 row in set (0.001 sec)\r\n\r\nMariaDB [(none)]&gt; set global interactive_timeout=30;\r\nQuery OK, 0 rows affected (0.000 sec)\r\n\r\nMariaDB [(none)]&gt; SHOW GLOBAL VARIABLES LIKE \'interactive_timeout\';\r\n+---------------------+-------+\r\n| Variable_name       | Value |\r\n+---------------------+-------+\r\n| interactive_timeout | 30    |\r\n+---------------------+-------+\r\n1 row in set (0.001 sec)\r\n\r\nMariaDB [(none)]&gt; \r\n\r\n</code>\r\n</pre>\r\n                                                                                                                                   '),(45,'                                <p></p><p>\r\n<span>安装Mono环境</span><br>\r\n</p><pre><code>\r\nelapse@luck_KUbuntu:~/soft/app$  sudo apt-get install mono-complete\r\n</code>\r\n</pre>\r\n下载一个最新的版本:http://fiddler.wikidot.com/mono\r\n用unzip解压fiddler压缩包\r\n进入解压后目录, 命令启动 mono Fiddler.exe\r\n\r\n<p></p>\r\n<p>\r\n开始手机抓包,\r\n1`先设置手机的代理服务器,先ifconfig(ubuntu)或者ipconfig(windows)看下电脑ip地址 \r\n代理 选项选择 手动\r\n-主机名为电脑ip\r\n-端口为Fiddler的监听端口, 默认是8888\r\n-IP设置为DHCP\r\n</p>\r\n<p>\r\n服务端Fiddler设置\r\nTools-&gt;Fiddler Options如下,勾上Allow remote computers to connect,允许远程计算机链接!\r\n</p>\r\n参考：<a href=\"https://www.jianshu.com/p/4505c732e378\" target=\"_blank\">https://www.jianshu.com/p/4505c732e378</a>\r\n<p></p><p>下载: <a href=\"http://fiddler.wikidot.com/mono\" target=\"_blank\">http://fiddler.wikidot.com/mono</a>\r\n\r\n\r\n</p>                            '),(46,'                                                                <div><br></div><div><br></div>\r\n<div>安装微信：</div><div>参考：https://blog.csdn.net/cxrshiz7890/article/details/106037534</div><div><br></div>\r\n<div>1.安装wine</div>\r\n<div>&nbsp; 官方安装：https://wiki.winehq.org/Ubuntu</div><div>&nbsp; 安装是请不要切换root账户，不然每次启动微信都要用root的密码</div>\r\n<div>&nbsp; sudo dpkg --add-architecture i386&nbsp;</div><div>&nbsp; #下面的URL,请对应自己的系统版本</div><div>&nbsp; wget -nc https://dl.winehq.org/wine-builds/winehq.key</div>\r\n<div>&nbsp; sudo apt-key add winehq.key</div><div><span style=\"color: rgb(34, 34, 34); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 14px; background-color: rgb(248, 249, 250);\">sudo add-apt-repository \'deb&nbsp;</span><a rel=\"nofollow\" class=\"external free\" href=\"https://dl.winehq.org/wine-builds/ubuntu/\" style=\"color: rgb(102, 51, 102); background: linear-gradient(transparent, transparent) right center no-repeat, url(&quot;data:image/svg+xml,%3Csvg xmlns=%22http://www.w3.org/2000/svg%22 width=%2213%22 height=%2213%22%3E %3Cpath fill=%22%2336b%22 d=%22M5.002 1.01h7v7l-2-2-3 2v-1l3-2.25 1 1V2.01h-3.75l1 1-2.25 3h-1l2-3z%22/%3E %3Cpath fill=%22%2336b%22 d=%22M7.002 3.01h-5v8h8v-5h-1v4h-6v-6h4z%22/%3E %3Cpath fill=%22%2315a5ea%22 d=%22M4.082 5.51c0-.621.621-.621.621-.621 1.864.621 3.107 1.864 3.728 3.728 0 0 0 .621-.62.621-1.245-1.864-1.866-2.485-3.73-3.728z%22/%3E %3C/svg%3E&quot;) rgb(248, 249, 250); padding-right: 13px; overflow-wrap: break-word; font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 14px; font-weight: 400;\">https://dl.winehq.org/wine-builds/ubuntu/</a><span style=\"color: rgb(34, 34, 34); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 14px; background-color: rgb(248, 249, 250);\">&nbsp;focal main\'</span><br></div><div>&nbsp; sudo apt update</div><div>&nbsp; sudo apt install --install-recommends winehq-stable</div><div>&nbsp; 查看安装好的版本，这里安装了wine-6.0</div><div>&nbsp; wine --version&nbsp;</div><div>&nbsp;&nbsp;</div><div>2.安装wine管理软件</div><div>&nbsp; sudo apt install winetricks</div><div>&nbsp; 在终端执行：winetricks riched20</div><div>&nbsp; 注意查看命令是否失败，失败了，就手动下载文件替换，（如不解决，安装好的微信不能正确显示输入框里的文字）</div><div>&nbsp; 从https://blog.csdn.net/Ivansyi/article/details/105616383 中下载文件。</div><div><br></div><div>3.解决wine所有软件乱码（中文不显示）问题</div><div>&nbsp; 下载以下链接文件，压缩包Fonts.zip里包含了所有Windows的字体。</div><div>&nbsp; &nbsp;链接: https://pan.baidu.com/s/1SWTe1Dj485FTJSdKqI6QCA&nbsp; 密码: 4abj</div><div>&nbsp; &nbsp;解压该压缩包</div><div>&nbsp; &nbsp;unzip Fonts.zip</div><div>&nbsp; &nbsp;先运行一次wine,使其产生“~/.wine/drive_c/windows/Fonts/”文件夹</div><div>&nbsp; &nbsp;把Fonts文件夹内所有字体复制到wine的映射目录内</div><div>&nbsp; &nbsp;cp Fonts/* ~/.wine/drive_c/windows/Fonts/</div><div>&nbsp; &nbsp;终端输入winecfg，然后点击“显示”界面，可以发现红框处由原来的乱码变成了可显示的中文字体</div><div>&nbsp; &nbsp;在使用其他windows软件时，就不会出现乱码的问题了！</div><div><br></div><div>4、在官网下载最新版windows微信，直接右键选择使用Wine Windows Program Loader打开，直接安装就可以了</div><div><br></div><div>&nbsp;&nbsp;</div>                                                        '),(47,'<pre><code>\r\nsudo sh -c \'echo \"deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main\" &gt; /etc/apt/sources.list.d/pgdg.list\'\r\nwget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -\r\nsudo apt-get update\r\nsudo apt-get -y install postgresql\r\n</code></pre>');
/*!40000 ALTER TABLE `article_content` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `column`
--

DROP TABLE IF EXISTS `column`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `column` (
  `id` tinyint(20) NOT NULL AUTO_INCREMENT COMMENT 'ID',
  `title` varchar(50) NOT NULL COMMENT '标题',
  `subhead` varchar(50) NOT NULL COMMENT '副标题',
  `surface_plot` varchar(255) DEFAULT NULL COMMENT '封面图',
  `author` varchar(50) DEFAULT NULL COMMENT '作者',
  `excerpt` text DEFAULT NULL COMMENT '简介',
  `price` decimal(15,2) DEFAULT 0.00 COMMENT '价格',
  `visit` int(11) NOT NULL DEFAULT 0 COMMENT '阅读次数',
  `collect` int(11) NOT NULL DEFAULT 0 COMMENT '收藏次数',
  `amount` int(11) DEFAULT NULL COMMENT '专栏文章数',
  `complete` int(11) NOT NULL DEFAULT 0 COMMENT '已发布文章数',
  `seo_title` varchar(255) DEFAULT NULL COMMENT 'SEO标题',
  `seo_keywords` varchar(255) DEFAULT NULL COMMENT 'SEO关键词',
  `seo_description` varchar(255) DEFAULT NULL COMMENT 'SEO描述',
  `create_id` tinyint(20) DEFAULT NULL COMMENT '文章发表用户ID',
  `create` bigint(20) DEFAULT NULL COMMENT '创建时间( Unix 时间戳)',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 COMMENT='文章专栏表';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `column`
--

LOCK TABLES `column` WRITE;
/*!40000 ALTER TABLE `column` DISABLE KEYS */;
INSERT INTO `column` VALUES (1,'Flutter象棋','实战 Flutter 象棋从零到上架',NULL,'临来笑笑生',NULL,0.00,0,0,NULL,0,NULL,NULL,NULL,1,NULL);
/*!40000 ALTER TABLE `column` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `menus`
--

DROP TABLE IF EXISTS `menus`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `menus` (
  `id` tinyint(10) unsigned NOT NULL AUTO_INCREMENT,
  `order_by` tinyint(2) unsigned NOT NULL COMMENT '排序',
  `class` varchar(20) NOT NULL COMMENT '类',
  `method` varchar(30) NOT NULL COMMENT '方法',
  `name` varchar(20) NOT NULL COMMENT '菜单名字',
  `level` tinyint(2) unsigned DEFAULT 0 COMMENT '菜单层级',
  `parent` tinyint(10) unsigned DEFAULT 0 COMMENT '父级',
  `icon` varchar(50) DEFAULT NULL COMMENT 'ICON',
  `department` varchar(20) DEFAULT NULL COMMENT '所属顶级',
  `is_show` tinyint(1) NOT NULL DEFAULT 1 COMMENT '是否显示：默认1显示，0不显示',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=13 DEFAULT CHARSET=utf8 COMMENT='后台菜单表';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `menus`
--

LOCK TABLES `menus` WRITE;
/*!40000 ALTER TABLE `menus` DISABLE KEYS */;
INSERT INTO `menus` VALUES (1,1,'love','index','后台首页',1,0,'fa-desktop','1',1),(2,8,'','','系统设置',1,0,'fa-cogs','请选择',1),(3,1,'menus','index','菜单管理',2,2,'fa-folder','2',1),(4,4,'record','index','操作日志',2,2,NULL,'2',1),(5,3,'roles','index','角色管理',2,2,'fa-key','2',1),(6,2,'admins','index','后台用户',2,2,'ssssss','2',1),(7,2,'nav','index','导航菜单',1,0,'fa-fire','请选择',1),(8,2,'','','文章管理',1,0,'fa-leanpub','请选择',1),(9,1,'example','index','示例数据',1,0,'fa-fire','请选择',0),(10,1,'articleCategory','index','文章分类',2,8,'','8',1),(11,3,'article','index','文章列表',2,8,'','8',1),(12,2,'column','index','文章专栏',0,8,NULL,'8',1);
/*!40000 ALTER TABLE `menus` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `record`
--

DROP TABLE IF EXISTS `record`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `record` (
  `id` int(100) unsigned NOT NULL AUTO_INCREMENT,
  `table_id` int(10) unsigned NOT NULL COMMENT '操作表ID',
  `table_name` varchar(180) NOT NULL COMMENT '操作表名',
  `user_id` int(10) unsigned NOT NULL COMMENT '操作用户ID',
  `username` varchar(16) NOT NULL COMMENT '操作用户名',
  `action` varchar(180) NOT NULL COMMENT '操作动作',
  `ip` varchar(39) NOT NULL COMMENT '操作IP',
  `record_time` datetime NOT NULL DEFAULT current_timestamp() COMMENT '操作时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=202 DEFAULT CHARSET=utf8 COMMENT='操作记录表';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `record`
--

LOCK TABLES `record` WRITE;
/*!40000 ALTER TABLE `record` DISABLE KEYS */;
INSERT INTO `record` VALUES (1,9,'menus',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(2,9,'menus',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(3,9,'menus',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(4,8,'menus',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(5,10,'menus',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(6,11,'menus',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(7,10,'menus',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(8,10,'menus',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(9,1,'articleCategory',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(10,2,'articleCategory',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(11,2,'articleCategory',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(12,2,'articleCategory',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(13,2,'articleCategory',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(14,2,'articleCategory',1,'fortune','expurgate','127.0.0.1','0000-00-00 00:00:00'),(15,1,'articleCategory',1,'fortune','delete','127.0.0.1','0000-00-00 00:00:00'),(16,3,'articleCategory',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(17,4,'articleCategory',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(18,3,'articleCategory',1,'fortune','expurgate','127.0.0.1','0000-00-00 00:00:00'),(19,5,'articleCategory',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(20,17,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(21,17,'article',1,'fortune','expurgate','127.0.0.1','0000-00-00 00:00:00'),(22,18,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(23,19,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(24,20,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(25,21,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(26,22,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(27,23,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(28,24,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(29,25,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(30,26,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(31,27,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(32,28,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(33,29,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(34,30,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(35,31,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(36,32,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(37,33,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(38,34,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(39,35,'article',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(40,35,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(41,35,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(42,34,'article',1,'fortune','delete','127.0.0.1','0000-00-00 00:00:00'),(43,33,'article',1,'fortune','delete','127.0.0.1','0000-00-00 00:00:00'),(44,32,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(45,35,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(46,35,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(47,1,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(48,1,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(49,1,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(50,6,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(51,35,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(52,35,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(53,29,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(54,21,'article',1,'fortune','expurgate','127.0.0.1','0000-00-00 00:00:00'),(55,6,'articleCategory',1,'fortune','create','127.0.0.1','0000-00-00 00:00:00'),(56,5,'articleCategory',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(57,32,'article',1,'fortune','edit','127.0.0.1','0000-00-00 00:00:00'),(58,18,'article',1,'fortune','expurgate','127.0.0.1','0000-00-00 00:00:00'),(59,12,'menus',1,'fortune','create','127.0.0.1','2020-03-07 14:39:32'),(60,11,'menus',1,'fortune','edit','127.0.0.1','2020-03-07 14:40:01'),(61,1,'column',1,'fortune','create','27.47.6.84','2020-09-08 21:58:31'),(62,3,'articleCategory',1,'fortune','edit','27.47.9.103','0000-00-00 00:00:00'),(63,17,'article',1,'fortune','create','27.47.9.103','0000-00-00 00:00:00'),(64,17,'article',1,'fortune','edit','27.47.9.103','0000-00-00 00:00:00'),(65,17,'article',1,'fortune','edit','27.47.9.103','0000-00-00 00:00:00'),(66,17,'article',1,'fortune','edit','27.47.9.103','0000-00-00 00:00:00'),(67,17,'article',1,'fortune','edit','27.47.9.103','0000-00-00 00:00:00'),(68,17,'article',1,'fortune','edit','27.47.9.103','0000-00-00 00:00:00'),(69,17,'article',1,'fortune','edit','27.47.9.103','0000-00-00 00:00:00'),(70,17,'article',1,'fortune','edit','27.47.9.103','0000-00-00 00:00:00'),(71,17,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(72,17,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(73,17,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(74,17,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(75,17,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(76,17,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(77,17,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(78,17,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(79,17,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(80,18,'article',1,'fortune','create','27.47.6.229','0000-00-00 00:00:00'),(81,18,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(82,18,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(83,18,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(84,18,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(85,18,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(86,18,'article',1,'fortune','edit','27.47.6.229','0000-00-00 00:00:00'),(87,19,'article',1,'fortune','create','27.47.6.229','0000-00-00 00:00:00'),(88,19,'article',1,'fortune','edit','27.47.8.9','0000-00-00 00:00:00'),(89,19,'article',1,'fortune','edit','27.47.8.9','0000-00-00 00:00:00'),(90,19,'article',1,'fortune','edit','27.47.8.9','0000-00-00 00:00:00'),(91,19,'article',1,'fortune','edit','27.47.8.9','0000-00-00 00:00:00'),(92,19,'article',1,'fortune','edit','27.47.8.9','0000-00-00 00:00:00'),(93,19,'article',1,'fortune','edit','27.47.8.9','0000-00-00 00:00:00'),(94,19,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(95,19,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(96,19,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(97,17,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(98,19,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(99,20,'article',1,'fortune','create','112.94.53.74','0000-00-00 00:00:00'),(100,19,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(101,20,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(102,20,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(103,20,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(104,20,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(105,20,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(106,20,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(107,20,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(108,20,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(109,21,'article',1,'fortune','create','112.94.53.74','0000-00-00 00:00:00'),(110,21,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(111,21,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(112,21,'article',1,'fortune','edit','112.94.53.74','0000-00-00 00:00:00'),(113,21,'article',1,'fortune','edit','27.47.5.58','0000-00-00 00:00:00'),(114,21,'article',1,'fortune','edit','27.47.5.58','0000-00-00 00:00:00'),(115,22,'article',1,'fortune','create','27.47.5.58','0000-00-00 00:00:00'),(116,22,'article',1,'fortune','edit','27.47.5.58','0000-00-00 00:00:00'),(117,22,'article',1,'fortune','edit','27.47.4.14','0000-00-00 00:00:00'),(118,23,'article',1,'fortune','create','27.47.4.14','0000-00-00 00:00:00'),(119,23,'article',1,'fortune','edit','27.47.4.14','0000-00-00 00:00:00'),(120,23,'article',1,'fortune','edit','27.47.4.14','0000-00-00 00:00:00'),(121,23,'article',1,'fortune','edit','27.47.4.14','0000-00-00 00:00:00'),(122,23,'article',1,'fortune','edit','27.47.4.14','0000-00-00 00:00:00'),(123,24,'article',1,'fortune','create','112.94.53.44','0000-00-00 00:00:00'),(124,24,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(125,25,'article',1,'fortune','create','112.94.53.44','0000-00-00 00:00:00'),(126,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(127,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(128,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(129,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(130,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(131,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(132,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(133,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(134,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(135,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(136,25,'article',1,'fortune','edit','112.94.53.44','0000-00-00 00:00:00'),(137,26,'article',1,'fortune','create','27.47.4.104','2020-01-09 00:17:05'),(138,26,'article',1,'fortune','edit','27.47.4.104','2020-01-09 16:50:39'),(139,26,'article',1,'fortune','edit','27.47.11.191','2020-04-09 13:11:29'),(140,26,'article',1,'fortune','edit','27.47.11.191','2020-04-09 15:23:49'),(141,26,'article',1,'fortune','edit','27.47.4.53','2020-04-09 23:51:16'),(142,26,'article',1,'fortune','edit','27.47.4.53','2020-05-09 00:11:31'),(143,27,'article',1,'fortune','create','112.94.52.44','2020-06-09 13:03:23'),(144,27,'article',1,'fortune','edit','112.94.53.160','2020-06-09 15:39:44'),(145,27,'article',1,'fortune','edit','112.94.53.160','2020-06-09 15:51:11'),(146,28,'article',1,'fortune','create','112.94.55.90','2020-07-09 18:32:45'),(147,27,'article',1,'fortune','edit','112.94.55.90','2020-07-09 18:35:54'),(148,28,'article',1,'fortune','edit','112.94.55.90','2020-07-09 18:56:47'),(149,28,'article',1,'fortune','edit','112.94.55.90','2020-07-09 19:15:47'),(150,28,'article',1,'fortune','edit','112.94.55.90','2020-07-09 19:33:37'),(151,28,'article',1,'fortune','edit','112.94.55.90','2020-07-09 19:51:59'),(152,17,'article',1,'fortune','edit','112.94.55.90','2020-07-09 19:55:35'),(153,29,'article',1,'fortune','create','112.94.55.90','2020-07-09 20:10:39'),(154,30,'article',1,'fortune','create','112.94.55.90','2020-07-09 20:26:12'),(155,31,'article',1,'fortune','create','112.94.55.90','2020-07-09 20:30:01'),(156,32,'article',1,'fortune','create','112.94.55.90','2020-07-09 20:36:31'),(157,17,'article',1,'fortune','edit','27.47.6.2','0000-00-00 00:00:00'),(158,17,'article',1,'fortune','edit','27.47.6.2','0000-00-00 00:00:00'),(159,17,'article',1,'fortune','edit','27.47.6.2','0000-00-00 00:00:00'),(160,17,'article',1,'fortune','edit','27.47.6.2','0000-00-00 00:00:00'),(161,32,'article',1,'fortune','edit','27.47.6.2','0000-00-00 00:00:00'),(162,33,'article',1,'fortune','create','112.94.54.139','0000-00-00 00:00:00'),(163,34,'article',1,'fortune','create','27.47.11.104','0000-00-00 00:00:00'),(164,34,'article',1,'fortune','edit','27.47.11.104','0000-00-00 00:00:00'),(165,34,'article',1,'fortune','edit','27.47.11.104','0000-00-00 00:00:00'),(166,34,'article',1,'fortune','edit','27.47.11.104','0000-00-00 00:00:00'),(167,34,'article',1,'fortune','edit','27.47.11.104','0000-00-00 00:00:00'),(168,34,'article',1,'fortune','edit','27.47.6.13','0000-00-00 00:00:00'),(169,35,'article',1,'fortune','create','116.21.231.120','2020-01-12 11:30:18'),(170,35,'article',1,'fortune','edit','116.21.231.120','2020-01-12 11:30:56'),(171,35,'article',1,'fortune','edit','116.21.231.120','2020-02-12 18:39:59'),(172,36,'article',1,'fortune','create','116.21.231.151','0000-00-00 00:00:00'),(173,37,'article',1,'fortune','create','116.21.231.151','0000-00-00 00:00:00'),(174,38,'article',1,'fortune','create','27.47.6.25','2021-01-01 15:32:06'),(175,1,'article',1,'fortune','edit','113.111.4.70','2021-07-01 12:03:16'),(176,39,'article',1,'fortune','create','59.42.75.129','0000-00-00 00:00:00'),(177,39,'article',1,'fortune','edit','59.42.75.129','0000-00-00 00:00:00'),(178,39,'article',1,'fortune','edit','59.42.75.129','0000-00-00 00:00:00'),(179,39,'article',1,'fortune','edit','59.42.75.129','0000-00-00 00:00:00'),(180,39,'article',1,'fortune','edit','59.42.75.129','0000-00-00 00:00:00'),(181,39,'article',1,'fortune','edit','59.42.75.129','0000-00-00 00:00:00'),(182,40,'article',1,'fortune','create','116.21.229.79','0000-00-00 00:00:00'),(183,40,'article',1,'fortune','edit','116.21.229.79','0000-00-00 00:00:00'),(184,35,'article',1,'fortune','edit','113.111.4.40','0000-00-00 00:00:00'),(185,35,'article',1,'fortune','edit','113.111.4.40','0000-00-00 00:00:00'),(186,1,'article',1,'fortune','edit','113.111.5.169','2021-01-02 10:03:57'),(187,8,'article',1,'fortune','edit','59.42.75.199','2021-02-02 10:19:13'),(188,8,'article',1,'fortune','edit','59.42.75.199','2021-02-02 10:24:34'),(189,8,'article',1,'fortune','edit','59.42.75.199','2021-02-02 11:01:36'),(190,8,'article',1,'fortune','edit','59.42.75.199','2021-02-02 11:16:57'),(191,8,'article',1,'fortune','edit','59.42.75.199','2021-02-02 18:28:43'),(192,17,'article',1,'fortune','edit','116.21.231.21','2021-04-02 14:28:04'),(193,41,'article',1,'fortune','create','116.21.231.21','2021-04-02 15:20:58'),(194,41,'article',1,'fortune','edit','116.21.231.21','2021-04-02 15:22:00'),(195,41,'article',1,'fortune','edit','27.47.7.198','2021-04-02 23:41:19'),(196,1,'article',1,'fortune','edit','27.47.11.25','2021-06-02 20:33:50'),(197,2,'article',1,'fortune','edit','27.47.11.244','2021-08-02 15:05:59'),(198,1,'article',1,'fortune','edit','27.47.11.244','2021-08-02 15:19:40'),(199,1,'article',1,'fortune','edit','27.47.11.244','2021-08-02 15:30:42'),(200,1,'article',1,'fortune','edit','27.47.6.179','0000-00-00 00:00:00'),(201,42,'article',1,'fortune','create','27.47.6.179','0000-00-00 00:00:00');
/*!40000 ALTER TABLE `record` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `rights`
--

DROP TABLE IF EXISTS `rights`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `rights` (
  `right_id` tinyint(10) unsigned NOT NULL AUTO_INCREMENT,
  `right_name` varchar(50) DEFAULT NULL,
  `right_class` varchar(30) DEFAULT NULL,
  `right_method` varchar(30) DEFAULT NULL,
  `right_detail` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`right_id`)
) ENGINE=InnoDB AUTO_INCREMENT=28 DEFAULT CHARSET=utf8 COMMENT='权限表';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `rights`
--

LOCK TABLES `rights` WRITE;
/*!40000 ALTER TABLE `rights` DISABLE KEYS */;
INSERT INTO `rights` VALUES (1,NULL,'love','index',NULL),(2,NULL,'menus','index',NULL),(3,NULL,'menus','create',NULL),(4,NULL,'menus','edit',NULL),(5,NULL,'admins','index',NULL),(6,NULL,'admins','edit',NULL),(7,NULL,'roles','index',NULL),(8,NULL,'admins','create',NULL),(9,NULL,'roles','edit',NULL),(10,NULL,'roles','create',NULL),(11,NULL,'record','index',NULL),(12,NULL,'article','index',NULL),(13,NULL,'article','test',NULL),(14,NULL,'article','edit',NULL),(15,NULL,'article','create',NULL),(16,NULL,'nav','index',NULL),(17,NULL,'order','index',NULL),(18,NULL,'articlecategory','create',NULL),(19,NULL,'articlecategory','index',NULL),(20,NULL,'articlecategory','edit',NULL),(21,NULL,'articlecategory','expurgate',NULL),(22,NULL,'articlecategory','delete',NULL),(23,NULL,'article','expurgate',NULL),(24,NULL,'upload','summernote',NULL),(25,NULL,'article','delete',NULL),(26,NULL,'column','index',NULL),(27,NULL,'column','create',NULL);
/*!40000 ALTER TABLE `rights` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `roles`
--

DROP TABLE IF EXISTS `roles`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `roles` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(20) NOT NULL,
  `rights` varchar(255) DEFAULT NULL,
  `default` varchar(50) DEFAULT NULL COMMENT '默认登录页',
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
) ENGINE=MyISAM AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 COMMENT='管理角色组表';
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `roles`
--

LOCK TABLES `roles` WRITE;
/*!40000 ALTER TABLE `roles` DISABLE KEYS */;
INSERT INTO `roles` VALUES (1,'root=>超级管理员','','');
/*!40000 ALTER TABLE `roles` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2021-03-24 13:41:56
